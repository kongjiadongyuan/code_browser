<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>xfrm_user.c source code [linux/net/xfrm/xfrm_user.c] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="xfrm_dump_info,xfrm_link "/>
<link rel="stylesheet" href="../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'linux/net/xfrm/xfrm_user.c'; var root_path = '../../..'; var data_path = '../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../..'>linux</a>/<a href='..'>net</a>/<a href='./'>xfrm</a>/<a href='xfrm_user.c.html'>xfrm_user.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* xfrm_user.c: User interface to configure xfrm engine.</i></td></tr>
<tr><th id="2">2</th><td><i> *</i></td></tr>
<tr><th id="3">3</th><td><i> * Copyright (C) 2002 David S. Miller (davem@redhat.com)</i></td></tr>
<tr><th id="4">4</th><td><i> *</i></td></tr>
<tr><th id="5">5</th><td><i> * Changes:</i></td></tr>
<tr><th id="6">6</th><td><i> *	Mitsuru KANDA @USAGI</i></td></tr>
<tr><th id="7">7</th><td><i> * 	Kazunori MIYAZAWA @USAGI</i></td></tr>
<tr><th id="8">8</th><td><i> * 	Kunihiro Ishiguro &lt;kunihiro@ipinfusion.com&gt;</i></td></tr>
<tr><th id="9">9</th><td><i> * 		IPv6 support</i></td></tr>
<tr><th id="10">10</th><td><i> *</i></td></tr>
<tr><th id="11">11</th><td><i> */</i></td></tr>
<tr><th id="12">12</th><td></td></tr>
<tr><th id="13">13</th><td><u>#include <a href="../../include/linux/crypto.h.html">&lt;linux/crypto.h&gt;</a></u></td></tr>
<tr><th id="14">14</th><td><u>#include <a href="../../include/linux/module.h.html">&lt;linux/module.h&gt;</a></u></td></tr>
<tr><th id="15">15</th><td><u>#include <a href="../../include/linux/kernel.h.html">&lt;linux/kernel.h&gt;</a></u></td></tr>
<tr><th id="16">16</th><td><u>#include <a href="../../include/linux/types.h.html">&lt;linux/types.h&gt;</a></u></td></tr>
<tr><th id="17">17</th><td><u>#include <a href="../../include/linux/slab.h.html">&lt;linux/slab.h&gt;</a></u></td></tr>
<tr><th id="18">18</th><td><u>#include <a href="../../include/linux/socket.h.html">&lt;linux/socket.h&gt;</a></u></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="../../include/linux/string.h.html">&lt;linux/string.h&gt;</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="../../include/linux/net.h.html">&lt;linux/net.h&gt;</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="../../include/linux/skbuff.h.html">&lt;linux/skbuff.h&gt;</a></u></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="../../include/uapi/linux/pfkeyv2.h.html">&lt;linux/pfkeyv2.h&gt;</a></u></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="../../include/uapi/linux/ipsec.h.html">&lt;linux/ipsec.h&gt;</a></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="../../include/linux/init.h.html">&lt;linux/init.h&gt;</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../../include/linux/security.h.html">&lt;linux/security.h&gt;</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../../include/net/sock.h.html">&lt;net/sock.h&gt;</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../../include/net/xfrm.h.html">&lt;net/xfrm.h&gt;</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../../include/net/netlink.h.html">&lt;net/netlink.h&gt;</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../../include/net/ah.h.html">&lt;net/ah.h&gt;</a></u></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="../../include/linux/uaccess.h.html">&lt;linux/uaccess.h&gt;</a></u></td></tr>
<tr><th id="31">31</th><td><u>#<span data-ppcond="31">if</span> <a class="macro" href="../../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../../include/generated/autoconf.h.html#77" title="1" data-ref="_M/CONFIG_IPV6">CONFIG_IPV6</a>)</u></td></tr>
<tr><th id="32">32</th><td><u>#include <a href="../../include/linux/in6.h.html">&lt;linux/in6.h&gt;</a></u></td></tr>
<tr><th id="33">33</th><td><u>#<span data-ppcond="31">endif</span></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../../arch/x86/include/asm/unaligned.h.html">&lt;asm/unaligned.h&gt;</a></u></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="verify_one_alg" title='verify_one_alg' data-type='int verify_one_alg(struct nlattr ** attrs, enum xfrm_attr_type_t type)' data-ref="verify_one_alg" data-ref-filename="verify_one_alg">verify_one_alg</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col1 decl" id="1attrs" title='attrs' data-type='struct nlattr **' data-ref="1attrs" data-ref-filename="1attrs">attrs</dfn>, <b>enum</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_attr_type_t" title='xfrm_attr_type_t' data-ref="xfrm_attr_type_t" data-ref-filename="xfrm_attr_type_t">xfrm_attr_type_t</a> <dfn class="local col2 decl" id="2type" title='type' data-type='enum xfrm_attr_type_t' data-ref="2type" data-ref-filename="2type">type</dfn>)</td></tr>
<tr><th id="37">37</th><td>{</td></tr>
<tr><th id="38">38</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col3 decl" id="3rt" title='rt' data-type='struct nlattr *' data-ref="3rt" data-ref-filename="3rt">rt</dfn> = <a class="local col1 ref" href="#1attrs" title='attrs' data-ref="1attrs" data-ref-filename="1attrs">attrs</a>[<a class="local col2 ref" href="#2type" title='type' data-ref="2type" data-ref-filename="2type">type</a>];</td></tr>
<tr><th id="39">39</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a> *<dfn class="local col4 decl" id="4algp" title='algp' data-type='struct xfrm_algo *' data-ref="4algp" data-ref-filename="4algp">algp</dfn>;</td></tr>
<tr><th id="40">40</th><td></td></tr>
<tr><th id="41">41</th><td>	<b>if</b> (!<a class="local col3 ref" href="#3rt" title='rt' data-ref="3rt" data-ref-filename="3rt">rt</a>)</td></tr>
<tr><th id="42">42</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="43">43</th><td></td></tr>
<tr><th id="44">44</th><td>	<a class="local col4 ref" href="#4algp" title='algp' data-ref="4algp" data-ref-filename="4algp">algp</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col3 ref" href="#3rt" title='rt' data-ref="3rt" data-ref-filename="3rt">rt</a>);</td></tr>
<tr><th id="45">45</th><td>	<b>if</b> (<a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col3 ref" href="#3rt" title='rt' data-ref="3rt" data-ref-filename="3rt">rt</a>) &lt; (<em>int</em>)<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_len" title='xfrm_alg_len' data-ref="xfrm_alg_len" data-ref-filename="xfrm_alg_len">xfrm_alg_len</a>(<a class="local col4 ref" href="#4algp" title='algp' data-ref="4algp" data-ref-filename="4algp">algp</a>))</td></tr>
<tr><th id="46">46</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="47">47</th><td></td></tr>
<tr><th id="48">48</th><td>	<b>switch</b> (<a class="local col2 ref" href="#2type" title='type' data-ref="2type" data-ref-filename="2type">type</a>) {</td></tr>
<tr><th id="49">49</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>:</td></tr>
<tr><th id="50">50</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>:</td></tr>
<tr><th id="51">51</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>:</td></tr>
<tr><th id="52">52</th><td>		<b>break</b>;</td></tr>
<tr><th id="53">53</th><td></td></tr>
<tr><th id="54">54</th><td>	<b>default</b>:</td></tr>
<tr><th id="55">55</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="56">56</th><td>	}</td></tr>
<tr><th id="57">57</th><td></td></tr>
<tr><th id="58">58</th><td>	<a class="local col4 ref" href="#4algp" title='algp' data-ref="4algp" data-ref-filename="4algp">algp</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>[<b>sizeof</b>(<a class="local col4 ref" href="#4algp" title='algp' data-ref="4algp" data-ref-filename="4algp">algp</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>) - <var>1</var>] = <kbd>'\0'</kbd>;</td></tr>
<tr><th id="59">59</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="60">60</th><td>}</td></tr>
<tr><th id="61">61</th><td></td></tr>
<tr><th id="62">62</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="verify_auth_trunc" title='verify_auth_trunc' data-type='int verify_auth_trunc(struct nlattr ** attrs)' data-ref="verify_auth_trunc" data-ref-filename="verify_auth_trunc">verify_auth_trunc</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col5 decl" id="5attrs" title='attrs' data-type='struct nlattr **' data-ref="5attrs" data-ref-filename="5attrs">attrs</dfn>)</td></tr>
<tr><th id="63">63</th><td>{</td></tr>
<tr><th id="64">64</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col6 decl" id="6rt" title='rt' data-type='struct nlattr *' data-ref="6rt" data-ref-filename="6rt">rt</dfn> = <a class="local col5 ref" href="#5attrs" title='attrs' data-ref="5attrs" data-ref-filename="5attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>];</td></tr>
<tr><th id="65">65</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth" title='xfrm_algo_auth' data-ref="xfrm_algo_auth" data-ref-filename="xfrm_algo_auth">xfrm_algo_auth</a> *<dfn class="local col7 decl" id="7algp" title='algp' data-type='struct xfrm_algo_auth *' data-ref="7algp" data-ref-filename="7algp">algp</dfn>;</td></tr>
<tr><th id="66">66</th><td></td></tr>
<tr><th id="67">67</th><td>	<b>if</b> (!<a class="local col6 ref" href="#6rt" title='rt' data-ref="6rt" data-ref-filename="6rt">rt</a>)</td></tr>
<tr><th id="68">68</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="69">69</th><td></td></tr>
<tr><th id="70">70</th><td>	<a class="local col7 ref" href="#7algp" title='algp' data-ref="7algp" data-ref-filename="7algp">algp</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col6 ref" href="#6rt" title='rt' data-ref="6rt" data-ref-filename="6rt">rt</a>);</td></tr>
<tr><th id="71">71</th><td>	<b>if</b> (<a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col6 ref" href="#6rt" title='rt' data-ref="6rt" data-ref-filename="6rt">rt</a>) &lt; (<em>int</em>)<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_auth_len" title='xfrm_alg_auth_len' data-ref="xfrm_alg_auth_len" data-ref-filename="xfrm_alg_auth_len">xfrm_alg_auth_len</a>(<a class="local col7 ref" href="#7algp" title='algp' data-ref="7algp" data-ref-filename="7algp">algp</a>))</td></tr>
<tr><th id="72">72</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="73">73</th><td></td></tr>
<tr><th id="74">74</th><td>	<a class="local col7 ref" href="#7algp" title='algp' data-ref="7algp" data-ref-filename="7algp">algp</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_name" title='xfrm_algo_auth::alg_name' data-ref="xfrm_algo_auth::alg_name" data-ref-filename="xfrm_algo_auth..alg_name">alg_name</a>[<b>sizeof</b>(<a class="local col7 ref" href="#7algp" title='algp' data-ref="7algp" data-ref-filename="7algp">algp</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_name" title='xfrm_algo_auth::alg_name' data-ref="xfrm_algo_auth::alg_name" data-ref-filename="xfrm_algo_auth..alg_name">alg_name</a>) - <var>1</var>] = <kbd>'\0'</kbd>;</td></tr>
<tr><th id="75">75</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="76">76</th><td>}</td></tr>
<tr><th id="77">77</th><td></td></tr>
<tr><th id="78">78</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="verify_aead" title='verify_aead' data-type='int verify_aead(struct nlattr ** attrs)' data-ref="verify_aead" data-ref-filename="verify_aead">verify_aead</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col8 decl" id="8attrs" title='attrs' data-type='struct nlattr **' data-ref="8attrs" data-ref-filename="8attrs">attrs</dfn>)</td></tr>
<tr><th id="79">79</th><td>{</td></tr>
<tr><th id="80">80</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col9 decl" id="9rt" title='rt' data-type='struct nlattr *' data-ref="9rt" data-ref-filename="9rt">rt</dfn> = <a class="local col8 ref" href="#8attrs" title='attrs' data-ref="8attrs" data-ref-filename="8attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>];</td></tr>
<tr><th id="81">81</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead" title='xfrm_algo_aead' data-ref="xfrm_algo_aead" data-ref-filename="xfrm_algo_aead">xfrm_algo_aead</a> *<dfn class="local col0 decl" id="10algp" title='algp' data-type='struct xfrm_algo_aead *' data-ref="10algp" data-ref-filename="10algp">algp</dfn>;</td></tr>
<tr><th id="82">82</th><td></td></tr>
<tr><th id="83">83</th><td>	<b>if</b> (!<a class="local col9 ref" href="#9rt" title='rt' data-ref="9rt" data-ref-filename="9rt">rt</a>)</td></tr>
<tr><th id="84">84</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="85">85</th><td></td></tr>
<tr><th id="86">86</th><td>	<a class="local col0 ref" href="#10algp" title='algp' data-ref="10algp" data-ref-filename="10algp">algp</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col9 ref" href="#9rt" title='rt' data-ref="9rt" data-ref-filename="9rt">rt</a>);</td></tr>
<tr><th id="87">87</th><td>	<b>if</b> (<a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col9 ref" href="#9rt" title='rt' data-ref="9rt" data-ref-filename="9rt">rt</a>) &lt; (<em>int</em>)<a class="ref fn" href="../../include/net/xfrm.h.html#aead_len" title='aead_len' data-ref="aead_len" data-ref-filename="aead_len">aead_len</a>(<a class="local col0 ref" href="#10algp" title='algp' data-ref="10algp" data-ref-filename="10algp">algp</a>))</td></tr>
<tr><th id="88">88</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="89">89</th><td></td></tr>
<tr><th id="90">90</th><td>	<a class="local col0 ref" href="#10algp" title='algp' data-ref="10algp" data-ref-filename="10algp">algp</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead::alg_name" title='xfrm_algo_aead::alg_name' data-ref="xfrm_algo_aead::alg_name" data-ref-filename="xfrm_algo_aead..alg_name">alg_name</a>[<b>sizeof</b>(<a class="local col0 ref" href="#10algp" title='algp' data-ref="10algp" data-ref-filename="10algp">algp</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead::alg_name" title='xfrm_algo_aead::alg_name' data-ref="xfrm_algo_aead::alg_name" data-ref-filename="xfrm_algo_aead..alg_name">alg_name</a>) - <var>1</var>] = <kbd>'\0'</kbd>;</td></tr>
<tr><th id="91">91</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="92">92</th><td>}</td></tr>
<tr><th id="93">93</th><td></td></tr>
<tr><th id="94">94</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="verify_one_addr" title='verify_one_addr' data-type='void verify_one_addr(struct nlattr ** attrs, enum xfrm_attr_type_t type, xfrm_address_t ** addrp)' data-ref="verify_one_addr" data-ref-filename="verify_one_addr">verify_one_addr</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col1 decl" id="11attrs" title='attrs' data-type='struct nlattr **' data-ref="11attrs" data-ref-filename="11attrs">attrs</dfn>, <b>enum</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_attr_type_t" title='xfrm_attr_type_t' data-ref="xfrm_attr_type_t" data-ref-filename="xfrm_attr_type_t">xfrm_attr_type_t</a> <dfn class="local col2 decl" id="12type" title='type' data-type='enum xfrm_attr_type_t' data-ref="12type" data-ref-filename="12type">type</dfn>,</td></tr>
<tr><th id="95">95</th><td>			   <a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a> **<dfn class="local col3 decl" id="13addrp" title='addrp' data-type='xfrm_address_t **' data-ref="13addrp" data-ref-filename="13addrp">addrp</dfn>)</td></tr>
<tr><th id="96">96</th><td>{</td></tr>
<tr><th id="97">97</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col4 decl" id="14rt" title='rt' data-type='struct nlattr *' data-ref="14rt" data-ref-filename="14rt">rt</dfn> = <a class="local col1 ref" href="#11attrs" title='attrs' data-ref="11attrs" data-ref-filename="11attrs">attrs</a>[<a class="local col2 ref" href="#12type" title='type' data-ref="12type" data-ref-filename="12type">type</a>];</td></tr>
<tr><th id="98">98</th><td></td></tr>
<tr><th id="99">99</th><td>	<b>if</b> (<a class="local col4 ref" href="#14rt" title='rt' data-ref="14rt" data-ref-filename="14rt">rt</a> &amp;&amp; <a class="local col3 ref" href="#13addrp" title='addrp' data-ref="13addrp" data-ref-filename="13addrp">addrp</a>)</td></tr>
<tr><th id="100">100</th><td>		*<a class="local col3 ref" href="#13addrp" title='addrp' data-ref="13addrp" data-ref-filename="13addrp">addrp</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#14rt" title='rt' data-ref="14rt" data-ref-filename="14rt">rt</a>);</td></tr>
<tr><th id="101">101</th><td>}</td></tr>
<tr><th id="102">102</th><td></td></tr>
<tr><th id="103">103</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="verify_sec_ctx_len" title='verify_sec_ctx_len' data-type='int verify_sec_ctx_len(struct nlattr ** attrs)' data-ref="verify_sec_ctx_len" data-ref-filename="verify_sec_ctx_len">verify_sec_ctx_len</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col5 decl" id="15attrs" title='attrs' data-type='struct nlattr **' data-ref="15attrs" data-ref-filename="15attrs">attrs</dfn>)</td></tr>
<tr><th id="104">104</th><td>{</td></tr>
<tr><th id="105">105</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col6 decl" id="16rt" title='rt' data-type='struct nlattr *' data-ref="16rt" data-ref-filename="16rt">rt</dfn> = <a class="local col5 ref" href="#15attrs" title='attrs' data-ref="15attrs" data-ref-filename="15attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>];</td></tr>
<tr><th id="106">106</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a> *<dfn class="local col7 decl" id="17uctx" title='uctx' data-type='struct xfrm_user_sec_ctx *' data-ref="17uctx" data-ref-filename="17uctx">uctx</dfn>;</td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td>	<b>if</b> (!<a class="local col6 ref" href="#16rt" title='rt' data-ref="16rt" data-ref-filename="16rt">rt</a>)</td></tr>
<tr><th id="109">109</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="110">110</th><td></td></tr>
<tr><th id="111">111</th><td>	<a class="local col7 ref" href="#17uctx" title='uctx' data-ref="17uctx" data-ref-filename="17uctx">uctx</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col6 ref" href="#16rt" title='rt' data-ref="16rt" data-ref-filename="16rt">rt</a>);</td></tr>
<tr><th id="112">112</th><td>	<b>if</b> (<a class="local col7 ref" href="#17uctx" title='uctx' data-ref="17uctx" data-ref-filename="17uctx">uctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx::len" title='xfrm_user_sec_ctx::len' data-ref="xfrm_user_sec_ctx::len" data-ref-filename="xfrm_user_sec_ctx..len">len</a> != (<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a>) + <a class="local col7 ref" href="#17uctx" title='uctx' data-ref="17uctx" data-ref-filename="17uctx">uctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx::ctx_len" title='xfrm_user_sec_ctx::ctx_len' data-ref="xfrm_user_sec_ctx::ctx_len" data-ref-filename="xfrm_user_sec_ctx..ctx_len">ctx_len</a>))</td></tr>
<tr><th id="113">113</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="114">114</th><td></td></tr>
<tr><th id="115">115</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="116">116</th><td>}</td></tr>
<tr><th id="117">117</th><td></td></tr>
<tr><th id="118">118</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="verify_replay" title='verify_replay' data-type='int verify_replay(struct xfrm_usersa_info * p, struct nlattr ** attrs)' data-ref="verify_replay" data-ref-filename="verify_replay">verify_replay</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col8 decl" id="18p" title='p' data-type='struct xfrm_usersa_info *' data-ref="18p" data-ref-filename="18p">p</dfn>,</td></tr>
<tr><th id="119">119</th><td>				<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col9 decl" id="19attrs" title='attrs' data-type='struct nlattr **' data-ref="19attrs" data-ref-filename="19attrs">attrs</dfn>)</td></tr>
<tr><th id="120">120</th><td>{</td></tr>
<tr><th id="121">121</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col0 decl" id="20rt" title='rt' data-type='struct nlattr *' data-ref="20rt" data-ref-filename="20rt">rt</dfn> = <a class="local col9 ref" href="#19attrs" title='attrs' data-ref="19attrs" data-ref-filename="19attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_ESN_VAL" title='XFRMA_REPLAY_ESN_VAL' data-ref="XFRMA_REPLAY_ESN_VAL" data-ref-filename="XFRMA_REPLAY_ESN_VAL">XFRMA_REPLAY_ESN_VAL</a>];</td></tr>
<tr><th id="122">122</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a> *<dfn class="local col1 decl" id="21rs" title='rs' data-type='struct xfrm_replay_state_esn *' data-ref="21rs" data-ref-filename="21rs">rs</dfn>;</td></tr>
<tr><th id="123">123</th><td></td></tr>
<tr><th id="124">124</th><td>	<b>if</b> (<a class="local col8 ref" href="#18p" title='p' data-ref="18p" data-ref-filename="18p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::flags" title='xfrm_usersa_info::flags' data-ref="xfrm_usersa_info::flags" data-ref-filename="xfrm_usersa_info..flags">flags</a> &amp; <a class="macro" href="../../include/uapi/linux/xfrm.h.html#383" title="128" data-ref="_M/XFRM_STATE_ESN">XFRM_STATE_ESN</a>) {</td></tr>
<tr><th id="125">125</th><td>		<b>if</b> (!<a class="local col0 ref" href="#20rt" title='rt' data-ref="20rt" data-ref-filename="20rt">rt</a>)</td></tr>
<tr><th id="126">126</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="127">127</th><td></td></tr>
<tr><th id="128">128</th><td>		<a class="local col1 ref" href="#21rs" title='rs' data-ref="21rs" data-ref-filename="21rs">rs</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col0 ref" href="#20rt" title='rt' data-ref="20rt" data-ref-filename="20rt">rt</a>);</td></tr>
<tr><th id="129">129</th><td></td></tr>
<tr><th id="130">130</th><td>		<b>if</b> (<a class="local col1 ref" href="#21rs" title='rs' data-ref="21rs" data-ref-filename="21rs">rs</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn::bmp_len" title='xfrm_replay_state_esn::bmp_len' data-ref="xfrm_replay_state_esn::bmp_len" data-ref-filename="xfrm_replay_state_esn..bmp_len">bmp_len</a> &gt; <a class="macro" href="../../include/uapi/linux/xfrm.h.html#90" title="4096" data-ref="_M/XFRMA_REPLAY_ESN_MAX">XFRMA_REPLAY_ESN_MAX</a> / <b>sizeof</b>(<a class="local col1 ref" href="#21rs" title='rs' data-ref="21rs" data-ref-filename="21rs">rs</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn::bmp" title='xfrm_replay_state_esn::bmp' data-ref="xfrm_replay_state_esn::bmp" data-ref-filename="xfrm_replay_state_esn..bmp">bmp</a>[<var>0</var>]) / <var>8</var>)</td></tr>
<tr><th id="131">131</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td>		<b>if</b> (<a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col0 ref" href="#20rt" title='rt' data-ref="20rt" data-ref-filename="20rt">rt</a>) &lt; (<em>int</em>)<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col1 ref" href="#21rs" title='rs' data-ref="21rs" data-ref-filename="21rs">rs</a>) &amp;&amp;</td></tr>
<tr><th id="134">134</th><td>		    <a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col0 ref" href="#20rt" title='rt' data-ref="20rt" data-ref-filename="20rt">rt</a>) != <b>sizeof</b>(*<a class="local col1 ref" href="#21rs" title='rs' data-ref="21rs" data-ref-filename="21rs">rs</a>))</td></tr>
<tr><th id="135">135</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="136">136</th><td>	}</td></tr>
<tr><th id="137">137</th><td></td></tr>
<tr><th id="138">138</th><td>	<b>if</b> (!<a class="local col0 ref" href="#20rt" title='rt' data-ref="20rt" data-ref-filename="20rt">rt</a>)</td></tr>
<tr><th id="139">139</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="140">140</th><td></td></tr>
<tr><th id="141">141</th><td>	<i>/* As only ESP and AH support ESN feature. */</i></td></tr>
<tr><th id="142">142</th><td>	<b>if</b> ((<a class="local col8 ref" href="#18p" title='p' data-ref="18p" data-ref-filename="18p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a> != <a class="macro" href="../../include/uapi/linux/in.h.html#58" title="IPPROTO_ESP" data-ref="_M/IPPROTO_ESP">IPPROTO_ESP</a>) &amp;&amp; (<a class="local col8 ref" href="#18p" title='p' data-ref="18p" data-ref-filename="18p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a> != <a class="macro" href="../../include/uapi/linux/in.h.html#60" title="IPPROTO_AH" data-ref="_M/IPPROTO_AH">IPPROTO_AH</a>))</td></tr>
<tr><th id="143">143</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="144">144</th><td></td></tr>
<tr><th id="145">145</th><td>	<b>if</b> (<a class="local col8 ref" href="#18p" title='p' data-ref="18p" data-ref-filename="18p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::replay_window" title='xfrm_usersa_info::replay_window' data-ref="xfrm_usersa_info::replay_window" data-ref-filename="xfrm_usersa_info..replay_window">replay_window</a> != <var>0</var>)</td></tr>
<tr><th id="146">146</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="147">147</th><td></td></tr>
<tr><th id="148">148</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="149">149</th><td>}</td></tr>
<tr><th id="150">150</th><td></td></tr>
<tr><th id="151">151</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="verify_newsa_info" title='verify_newsa_info' data-type='int verify_newsa_info(struct xfrm_usersa_info * p, struct nlattr ** attrs)' data-ref="verify_newsa_info" data-ref-filename="verify_newsa_info">verify_newsa_info</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col2 decl" id="22p" title='p' data-type='struct xfrm_usersa_info *' data-ref="22p" data-ref-filename="22p">p</dfn>,</td></tr>
<tr><th id="152">152</th><td>			     <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col3 decl" id="23attrs" title='attrs' data-type='struct nlattr **' data-ref="23attrs" data-ref-filename="23attrs">attrs</dfn>)</td></tr>
<tr><th id="153">153</th><td>{</td></tr>
<tr><th id="154">154</th><td>	<em>int</em> <dfn class="local col4 decl" id="24err" title='err' data-type='int' data-ref="24err" data-ref-filename="24err">err</dfn>;</td></tr>
<tr><th id="155">155</th><td></td></tr>
<tr><th id="156">156</th><td>	<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="157">157</th><td>	<b>switch</b> (<a class="local col2 ref" href="#22p" title='p' data-ref="22p" data-ref-filename="22p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::family" title='xfrm_usersa_info::family' data-ref="xfrm_usersa_info::family" data-ref-filename="xfrm_usersa_info..family">family</a>) {</td></tr>
<tr><th id="158">158</th><td>	<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#164" title="2" data-ref="_M/AF_INET">AF_INET</a>:</td></tr>
<tr><th id="159">159</th><td>		<b>break</b>;</td></tr>
<tr><th id="160">160</th><td></td></tr>
<tr><th id="161">161</th><td>	<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#172" title="10" data-ref="_M/AF_INET6">AF_INET6</a>:</td></tr>
<tr><th id="162">162</th><td><u>#<span data-ppcond="162">if</span> <a class="macro" href="../../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../../include/generated/autoconf.h.html#77" title="1" data-ref="_M/CONFIG_IPV6">CONFIG_IPV6</a>)</u></td></tr>
<tr><th id="163">163</th><td>		<b>break</b>;</td></tr>
<tr><th id="164">164</th><td><u>#<span data-ppcond="162">else</span></u></td></tr>
<tr><th id="165">165</th><td>		err = -EAFNOSUPPORT;</td></tr>
<tr><th id="166">166</th><td>		<b>goto</b> out;</td></tr>
<tr><th id="167">167</th><td><u>#<span data-ppcond="162">endif</span></u></td></tr>
<tr><th id="168">168</th><td></td></tr>
<tr><th id="169">169</th><td>	<b>default</b>:</td></tr>
<tr><th id="170">170</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="171">171</th><td>	}</td></tr>
<tr><th id="172">172</th><td></td></tr>
<tr><th id="173">173</th><td>	<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="174">174</th><td>	<b>switch</b> (<a class="local col2 ref" href="#22p" title='p' data-ref="22p" data-ref-filename="22p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>) {</td></tr>
<tr><th id="175">175</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/in.h.html#60" title="IPPROTO_AH" data-ref="_M/IPPROTO_AH">IPPROTO_AH</a>:</td></tr>
<tr><th id="176">176</th><td>		<b>if</b> ((!<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>]	&amp;&amp;</td></tr>
<tr><th id="177">177</th><td>		     !<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>]) ||</td></tr>
<tr><th id="178">178</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>]	||</td></tr>
<tr><th id="179">179</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>]	||</td></tr>
<tr><th id="180">180</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>]	||</td></tr>
<tr><th id="181">181</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>])</td></tr>
<tr><th id="182">182</th><td>			<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="183">183</th><td>		<b>break</b>;</td></tr>
<tr><th id="184">184</th><td></td></tr>
<tr><th id="185">185</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/in.h.html#58" title="IPPROTO_ESP" data-ref="_M/IPPROTO_ESP">IPPROTO_ESP</a>:</td></tr>
<tr><th id="186">186</th><td>		<b>if</b> (<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>])</td></tr>
<tr><th id="187">187</th><td>			<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="188">188</th><td>		<b>if</b> (!<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>] &amp;&amp;</td></tr>
<tr><th id="189">189</th><td>		    !<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>] &amp;&amp;</td></tr>
<tr><th id="190">190</th><td>		    !<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>] &amp;&amp;</td></tr>
<tr><th id="191">191</th><td>		    !<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>])</td></tr>
<tr><th id="192">192</th><td>			<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="193">193</th><td>		<b>if</b> ((<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>] ||</td></tr>
<tr><th id="194">194</th><td>		     <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>] ||</td></tr>
<tr><th id="195">195</th><td>		     <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>]) &amp;&amp;</td></tr>
<tr><th id="196">196</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>])</td></tr>
<tr><th id="197">197</th><td>			<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="198">198</th><td>		<b>if</b> (<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>] &amp;&amp;</td></tr>
<tr><th id="199">199</th><td>		    <a class="local col2 ref" href="#22p" title='p' data-ref="22p" data-ref-filename="22p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::mode" title='xfrm_usersa_info::mode' data-ref="xfrm_usersa_info::mode" data-ref-filename="xfrm_usersa_info..mode">mode</a> != <a class="macro" href="../../include/uapi/linux/xfrm.h.html#151" title="1" data-ref="_M/XFRM_MODE_TUNNEL">XFRM_MODE_TUNNEL</a>)</td></tr>
<tr><th id="200">200</th><td>			<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="201">201</th><td>		<b>break</b>;</td></tr>
<tr><th id="202">202</th><td></td></tr>
<tr><th id="203">203</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/in.h.html#70" title="IPPROTO_COMP" data-ref="_M/IPPROTO_COMP">IPPROTO_COMP</a>:</td></tr>
<tr><th id="204">204</th><td>		<b>if</b> (!<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>]	||</td></tr>
<tr><th id="205">205</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>]	||</td></tr>
<tr><th id="206">206</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>]	||</td></tr>
<tr><th id="207">207</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>]	||</td></tr>
<tr><th id="208">208</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>]	||</td></tr>
<tr><th id="209">209</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>]		||</td></tr>
<tr><th id="210">210</th><td>		    (<a class="macro" href="../../include/linux/byteorder/generic.h.html#140" title="(__builtin_constant_p((__u32)(( __u32)(__be32)(p-&gt;id.spi))) ? ((__u32)( (((__u32)(( __u32)(__be32)(p-&gt;id.spi)) &amp; (__u32)0x000000ffUL) &lt;&lt; 24) | (((__u32)(( __u32)(__be32)(p-&gt;id.spi)) &amp; (__u32)0x0000ff00UL) &lt;&lt; 8) | (((__u32)(( __u32)(__be32)(p-&gt;id.spi)) &amp; (__u32)0x00ff0000UL) &gt;&gt; 8) | (((__u32)(( __u32)(__be32)(p-&gt;id.spi)) &amp; (__u32)0xff000000UL) &gt;&gt; 24))) : __fswab32(( __u32)(__be32)(p-&gt;id.spi)))" data-ref="_M/ntohl">ntohl</a>(<a class="local col2 ref" href="#22p" title='p' data-ref="22p" data-ref-filename="22p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::spi" title='xfrm_id::spi' data-ref="xfrm_id::spi" data-ref-filename="xfrm_id..spi">spi</a>) &gt;= <var>0x10000</var>))</td></tr>
<tr><th id="211">211</th><td>			<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="212">212</th><td>		<b>break</b>;</td></tr>
<tr><th id="213">213</th><td></td></tr>
<tr><th id="214">214</th><td><u>#<span data-ppcond="214">if</span> <a class="macro" href="../../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../../include/generated/autoconf.h.html#77" title="1" data-ref="_M/CONFIG_IPV6">CONFIG_IPV6</a>)</u></td></tr>
<tr><th id="215">215</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/in6.h.html#137" title="60" data-ref="_M/IPPROTO_DSTOPTS">IPPROTO_DSTOPTS</a>:</td></tr>
<tr><th id="216">216</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/in6.h.html#133" title="43" data-ref="_M/IPPROTO_ROUTING">IPPROTO_ROUTING</a>:</td></tr>
<tr><th id="217">217</th><td>		<b>if</b> (<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>]	||</td></tr>
<tr><th id="218">218</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>]	||</td></tr>
<tr><th id="219">219</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>]	||</td></tr>
<tr><th id="220">220</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>]	||</td></tr>
<tr><th id="221">221</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>]	||</td></tr>
<tr><th id="222">222</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ENCAP" title='XFRMA_ENCAP' data-ref="XFRMA_ENCAP" data-ref-filename="XFRMA_ENCAP">XFRMA_ENCAP</a>]		||</td></tr>
<tr><th id="223">223</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>]	||</td></tr>
<tr><th id="224">224</th><td>		    <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>]		||</td></tr>
<tr><th id="225">225</th><td>		    !<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_COADDR" title='XFRMA_COADDR' data-ref="XFRMA_COADDR" data-ref-filename="XFRMA_COADDR">XFRMA_COADDR</a>])</td></tr>
<tr><th id="226">226</th><td>			<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="227">227</th><td>		<b>break</b>;</td></tr>
<tr><th id="228">228</th><td><u>#<span data-ppcond="214">endif</span></u></td></tr>
<tr><th id="229">229</th><td></td></tr>
<tr><th id="230">230</th><td>	<b>default</b>:</td></tr>
<tr><th id="231">231</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="232">232</th><td>	}</td></tr>
<tr><th id="233">233</th><td></td></tr>
<tr><th id="234">234</th><td>	<b>if</b> ((<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <a class="tu ref fn" href="#verify_aead" title='verify_aead' data-use='c' data-ref="verify_aead" data-ref-filename="verify_aead">verify_aead</a>(<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>)))</td></tr>
<tr><th id="235">235</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="236">236</th><td>	<b>if</b> ((<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <a class="tu ref fn" href="#verify_auth_trunc" title='verify_auth_trunc' data-use='c' data-ref="verify_auth_trunc" data-ref-filename="verify_auth_trunc">verify_auth_trunc</a>(<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>)))</td></tr>
<tr><th id="237">237</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="238">238</th><td>	<b>if</b> ((<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <a class="tu ref fn" href="#verify_one_alg" title='verify_one_alg' data-use='c' data-ref="verify_one_alg" data-ref-filename="verify_one_alg">verify_one_alg</a>(<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>)))</td></tr>
<tr><th id="239">239</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="240">240</th><td>	<b>if</b> ((<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <a class="tu ref fn" href="#verify_one_alg" title='verify_one_alg' data-use='c' data-ref="verify_one_alg" data-ref-filename="verify_one_alg">verify_one_alg</a>(<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>)))</td></tr>
<tr><th id="241">241</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="242">242</th><td>	<b>if</b> ((<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <a class="tu ref fn" href="#verify_one_alg" title='verify_one_alg' data-use='c' data-ref="verify_one_alg" data-ref-filename="verify_one_alg">verify_one_alg</a>(<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>)))</td></tr>
<tr><th id="243">243</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="244">244</th><td>	<b>if</b> ((<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <a class="tu ref fn" href="#verify_sec_ctx_len" title='verify_sec_ctx_len' data-use='c' data-ref="verify_sec_ctx_len" data-ref-filename="verify_sec_ctx_len">verify_sec_ctx_len</a>(<a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>)))</td></tr>
<tr><th id="245">245</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="246">246</th><td>	<b>if</b> ((<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <a class="tu ref fn" href="#verify_replay" title='verify_replay' data-use='c' data-ref="verify_replay" data-ref-filename="verify_replay">verify_replay</a>(<a class="local col2 ref" href="#22p" title='p' data-ref="22p" data-ref-filename="22p">p</a>, <a class="local col3 ref" href="#23attrs" title='attrs' data-ref="23attrs" data-ref-filename="23attrs">attrs</a>)))</td></tr>
<tr><th id="247">247</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="248">248</th><td></td></tr>
<tr><th id="249">249</th><td>	<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="250">250</th><td>	<b>switch</b> (<a class="local col2 ref" href="#22p" title='p' data-ref="22p" data-ref-filename="22p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::mode" title='xfrm_usersa_info::mode' data-ref="xfrm_usersa_info::mode" data-ref-filename="xfrm_usersa_info..mode">mode</a>) {</td></tr>
<tr><th id="251">251</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#150" title="0" data-ref="_M/XFRM_MODE_TRANSPORT">XFRM_MODE_TRANSPORT</a>:</td></tr>
<tr><th id="252">252</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#151" title="1" data-ref="_M/XFRM_MODE_TUNNEL">XFRM_MODE_TUNNEL</a>:</td></tr>
<tr><th id="253">253</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#152" title="2" data-ref="_M/XFRM_MODE_ROUTEOPTIMIZATION">XFRM_MODE_ROUTEOPTIMIZATION</a>:</td></tr>
<tr><th id="254">254</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#154" title="4" data-ref="_M/XFRM_MODE_BEET">XFRM_MODE_BEET</a>:</td></tr>
<tr><th id="255">255</th><td>		<b>break</b>;</td></tr>
<tr><th id="256">256</th><td></td></tr>
<tr><th id="257">257</th><td>	<b>default</b>:</td></tr>
<tr><th id="258">258</th><td>		<b>goto</b> <a class="lbl" href="#25out" data-ref="25out" data-ref-filename="25out">out</a>;</td></tr>
<tr><th id="259">259</th><td>	}</td></tr>
<tr><th id="260">260</th><td></td></tr>
<tr><th id="261">261</th><td>	<a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a> = <var>0</var>;</td></tr>
<tr><th id="262">262</th><td></td></tr>
<tr><th id="263">263</th><td><dfn class="lbl" id="25out" data-ref="25out" data-ref-filename="25out">out</dfn>:</td></tr>
<tr><th id="264">264</th><td>	<b>return</b> <a class="local col4 ref" href="#24err" title='err' data-ref="24err" data-ref-filename="24err">err</a>;</td></tr>
<tr><th id="265">265</th><td>}</td></tr>
<tr><th id="266">266</th><td></td></tr>
<tr><th id="267">267</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="attach_one_algo" title='attach_one_algo' data-type='int attach_one_algo(struct xfrm_algo ** algpp, u8 * props, struct xfrm_algo_desc *(*)(const char *, int) get_byname, struct nlattr * rta)' data-ref="attach_one_algo" data-ref-filename="attach_one_algo">attach_one_algo</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a> **<dfn class="local col6 decl" id="26algpp" title='algpp' data-type='struct xfrm_algo **' data-ref="26algpp" data-ref-filename="26algpp">algpp</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> *<dfn class="local col7 decl" id="27props" title='props' data-type='u8 *' data-ref="27props" data-ref-filename="27props">props</dfn>,</td></tr>
<tr><th id="268">268</th><td>			   <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_algo_desc" title='xfrm_algo_desc' data-ref="xfrm_algo_desc" data-ref-filename="xfrm_algo_desc">xfrm_algo_desc</a> *(*<dfn class="local col8 decl" id="28get_byname" title='get_byname' data-type='struct xfrm_algo_desc *(*)(const char *, int)' data-ref="28get_byname" data-ref-filename="28get_byname">get_byname</dfn>)(<em>const</em> <em>char</em> *, <em>int</em>),</td></tr>
<tr><th id="269">269</th><td>			   <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col9 decl" id="29rta" title='rta' data-type='struct nlattr *' data-ref="29rta" data-ref-filename="29rta">rta</dfn>)</td></tr>
<tr><th id="270">270</th><td>{</td></tr>
<tr><th id="271">271</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a> *<dfn class="local col0 decl" id="30p" title='p' data-type='struct xfrm_algo *' data-ref="30p" data-ref-filename="30p">p</dfn>, *<dfn class="local col1 decl" id="31ualg" title='ualg' data-type='struct xfrm_algo *' data-ref="31ualg" data-ref-filename="31ualg">ualg</dfn>;</td></tr>
<tr><th id="272">272</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_algo_desc" title='xfrm_algo_desc' data-ref="xfrm_algo_desc" data-ref-filename="xfrm_algo_desc">xfrm_algo_desc</a> *<dfn class="local col2 decl" id="32algo" title='algo' data-type='struct xfrm_algo_desc *' data-ref="32algo" data-ref-filename="32algo">algo</dfn>;</td></tr>
<tr><th id="273">273</th><td></td></tr>
<tr><th id="274">274</th><td>	<b>if</b> (!<a class="local col9 ref" href="#29rta" title='rta' data-ref="29rta" data-ref-filename="29rta">rta</a>)</td></tr>
<tr><th id="275">275</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="276">276</th><td></td></tr>
<tr><th id="277">277</th><td>	<a class="local col1 ref" href="#31ualg" title='ualg' data-ref="31ualg" data-ref-filename="31ualg">ualg</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col9 ref" href="#29rta" title='rta' data-ref="29rta" data-ref-filename="29rta">rta</a>);</td></tr>
<tr><th id="278">278</th><td></td></tr>
<tr><th id="279">279</th><td>	<a class="local col2 ref" href="#32algo" title='algo' data-ref="32algo" data-ref-filename="32algo">algo</a> = <a class="local col8 ref" href="#28get_byname" title='get_byname' data-ref="28get_byname" data-ref-filename="28get_byname">get_byname</a>(<a class="local col1 ref" href="#31ualg" title='ualg' data-ref="31ualg" data-ref-filename="31ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>, <var>1</var>);</td></tr>
<tr><th id="280">280</th><td>	<b>if</b> (!<a class="local col2 ref" href="#32algo" title='algo' data-ref="32algo" data-ref-filename="32algo">algo</a>)</td></tr>
<tr><th id="281">281</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#18" title="38" data-ref="_M/ENOSYS">ENOSYS</a>;</td></tr>
<tr><th id="282">282</th><td>	*<a class="local col7 ref" href="#27props" title='props' data-ref="27props" data-ref-filename="27props">props</a> = <a class="local col2 ref" href="#32algo" title='algo' data-ref="32algo" data-ref-filename="32algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::desc" title='xfrm_algo_desc::desc' data-ref="xfrm_algo_desc::desc" data-ref-filename="xfrm_algo_desc..desc">desc</a>.<a class="ref field" href="../../include/uapi/linux/pfkeyv2.h.html#sadb_alg::sadb_alg_id" title='sadb_alg::sadb_alg_id' data-ref="sadb_alg::sadb_alg_id" data-ref-filename="sadb_alg..sadb_alg_id">sadb_alg_id</a>;</td></tr>
<tr><th id="283">283</th><td></td></tr>
<tr><th id="284">284</th><td>	<a class="local col0 ref" href="#30p" title='p' data-ref="30p" data-ref-filename="30p">p</a> = <a class="ref fn" href="../../include/linux/string.h.html#kmemdup" title='kmemdup' data-ref="kmemdup" data-ref-filename="kmemdup">kmemdup</a>(<a class="local col1 ref" href="#31ualg" title='ualg' data-ref="31ualg" data-ref-filename="31ualg">ualg</a>, <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_len" title='xfrm_alg_len' data-ref="xfrm_alg_len" data-ref-filename="xfrm_alg_len">xfrm_alg_len</a>(<a class="local col1 ref" href="#31ualg" title='ualg' data-ref="31ualg" data-ref-filename="31ualg">ualg</a>), <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="285">285</th><td>	<b>if</b> (!<a class="local col0 ref" href="#30p" title='p' data-ref="30p" data-ref-filename="30p">p</a>)</td></tr>
<tr><th id="286">286</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="287">287</th><td></td></tr>
<tr><th id="288">288</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#strcpy" title='strcpy' data-ref="strcpy" data-ref-filename="strcpy">strcpy</a>(<a class="local col0 ref" href="#30p" title='p' data-ref="30p" data-ref-filename="30p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>, <a class="local col2 ref" href="#32algo" title='algo' data-ref="32algo" data-ref-filename="32algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::name" title='xfrm_algo_desc::name' data-ref="xfrm_algo_desc::name" data-ref-filename="xfrm_algo_desc..name">name</a>);</td></tr>
<tr><th id="289">289</th><td>	*<a class="local col6 ref" href="#26algpp" title='algpp' data-ref="26algpp" data-ref-filename="26algpp">algpp</a> = <a class="local col0 ref" href="#30p" title='p' data-ref="30p" data-ref-filename="30p">p</a>;</td></tr>
<tr><th id="290">290</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="291">291</th><td>}</td></tr>
<tr><th id="292">292</th><td></td></tr>
<tr><th id="293">293</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="attach_crypt" title='attach_crypt' data-type='int attach_crypt(struct xfrm_state * x, struct nlattr * rta)' data-ref="attach_crypt" data-ref-filename="attach_crypt">attach_crypt</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col3 decl" id="33x" title='x' data-type='struct xfrm_state *' data-ref="33x" data-ref-filename="33x">x</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col4 decl" id="34rta" title='rta' data-type='struct nlattr *' data-ref="34rta" data-ref-filename="34rta">rta</dfn>)</td></tr>
<tr><th id="294">294</th><td>{</td></tr>
<tr><th id="295">295</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a> *<dfn class="local col5 decl" id="35p" title='p' data-type='struct xfrm_algo *' data-ref="35p" data-ref-filename="35p">p</dfn>, *<dfn class="local col6 decl" id="36ualg" title='ualg' data-type='struct xfrm_algo *' data-ref="36ualg" data-ref-filename="36ualg">ualg</dfn>;</td></tr>
<tr><th id="296">296</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_algo_desc" title='xfrm_algo_desc' data-ref="xfrm_algo_desc" data-ref-filename="xfrm_algo_desc">xfrm_algo_desc</a> *<dfn class="local col7 decl" id="37algo" title='algo' data-type='struct xfrm_algo_desc *' data-ref="37algo" data-ref-filename="37algo">algo</dfn>;</td></tr>
<tr><th id="297">297</th><td></td></tr>
<tr><th id="298">298</th><td>	<b>if</b> (!<a class="local col4 ref" href="#34rta" title='rta' data-ref="34rta" data-ref-filename="34rta">rta</a>)</td></tr>
<tr><th id="299">299</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="300">300</th><td></td></tr>
<tr><th id="301">301</th><td>	<a class="local col6 ref" href="#36ualg" title='ualg' data-ref="36ualg" data-ref-filename="36ualg">ualg</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#34rta" title='rta' data-ref="34rta" data-ref-filename="34rta">rta</a>);</td></tr>
<tr><th id="302">302</th><td></td></tr>
<tr><th id="303">303</th><td>	<a class="local col7 ref" href="#37algo" title='algo' data-ref="37algo" data-ref-filename="37algo">algo</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_ealg_get_byname" title='xfrm_ealg_get_byname' data-ref="xfrm_ealg_get_byname" data-ref-filename="xfrm_ealg_get_byname">xfrm_ealg_get_byname</a>(<a class="local col6 ref" href="#36ualg" title='ualg' data-ref="36ualg" data-ref-filename="36ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>, <var>1</var>);</td></tr>
<tr><th id="304">304</th><td>	<b>if</b> (!<a class="local col7 ref" href="#37algo" title='algo' data-ref="37algo" data-ref-filename="37algo">algo</a>)</td></tr>
<tr><th id="305">305</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#18" title="38" data-ref="_M/ENOSYS">ENOSYS</a>;</td></tr>
<tr><th id="306">306</th><td>	<a class="local col3 ref" href="#33x" title='x' data-ref="33x" data-ref-filename="33x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::ealgo" title='xfrm_state::(anonymous struct)::ealgo' data-ref="xfrm_state::(anonymous)::ealgo" data-ref-filename="xfrm_state..(anonymous)..ealgo">ealgo</a> = <a class="local col7 ref" href="#37algo" title='algo' data-ref="37algo" data-ref-filename="37algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::desc" title='xfrm_algo_desc::desc' data-ref="xfrm_algo_desc::desc" data-ref-filename="xfrm_algo_desc..desc">desc</a>.<a class="ref field" href="../../include/uapi/linux/pfkeyv2.h.html#sadb_alg::sadb_alg_id" title='sadb_alg::sadb_alg_id' data-ref="sadb_alg::sadb_alg_id" data-ref-filename="sadb_alg..sadb_alg_id">sadb_alg_id</a>;</td></tr>
<tr><th id="307">307</th><td></td></tr>
<tr><th id="308">308</th><td>	<a class="local col5 ref" href="#35p" title='p' data-ref="35p" data-ref-filename="35p">p</a> = <a class="ref fn" href="../../include/linux/string.h.html#kmemdup" title='kmemdup' data-ref="kmemdup" data-ref-filename="kmemdup">kmemdup</a>(<a class="local col6 ref" href="#36ualg" title='ualg' data-ref="36ualg" data-ref-filename="36ualg">ualg</a>, <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_len" title='xfrm_alg_len' data-ref="xfrm_alg_len" data-ref-filename="xfrm_alg_len">xfrm_alg_len</a>(<a class="local col6 ref" href="#36ualg" title='ualg' data-ref="36ualg" data-ref-filename="36ualg">ualg</a>), <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="309">309</th><td>	<b>if</b> (!<a class="local col5 ref" href="#35p" title='p' data-ref="35p" data-ref-filename="35p">p</a>)</td></tr>
<tr><th id="310">310</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="311">311</th><td></td></tr>
<tr><th id="312">312</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#strcpy" title='strcpy' data-ref="strcpy" data-ref-filename="strcpy">strcpy</a>(<a class="local col5 ref" href="#35p" title='p' data-ref="35p" data-ref-filename="35p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>, <a class="local col7 ref" href="#37algo" title='algo' data-ref="37algo" data-ref-filename="37algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::name" title='xfrm_algo_desc::name' data-ref="xfrm_algo_desc::name" data-ref-filename="xfrm_algo_desc..name">name</a>);</td></tr>
<tr><th id="313">313</th><td>	<a class="local col3 ref" href="#33x" title='x' data-ref="33x" data-ref-filename="33x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::ealg" title='xfrm_state::ealg' data-ref="xfrm_state::ealg" data-ref-filename="xfrm_state..ealg">ealg</a> = <a class="local col5 ref" href="#35p" title='p' data-ref="35p" data-ref-filename="35p">p</a>;</td></tr>
<tr><th id="314">314</th><td>	<a class="local col3 ref" href="#33x" title='x' data-ref="33x" data-ref-filename="33x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::geniv" title='xfrm_state::geniv' data-ref="xfrm_state::geniv" data-ref-filename="xfrm_state..geniv">geniv</a> = <a class="local col7 ref" href="#37algo" title='algo' data-ref="37algo" data-ref-filename="37algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::uinfo" title='xfrm_algo_desc::uinfo' data-ref="xfrm_algo_desc::uinfo" data-ref-filename="xfrm_algo_desc..uinfo">uinfo</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::(anonymous)::encr" title='xfrm_algo_desc::(anonymous union)::encr' data-ref="xfrm_algo_desc::(anonymous)::encr" data-ref-filename="xfrm_algo_desc..(anonymous)..encr">encr</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_encr_info::geniv" title='xfrm_algo_encr_info::geniv' data-ref="xfrm_algo_encr_info::geniv" data-ref-filename="xfrm_algo_encr_info..geniv">geniv</a>;</td></tr>
<tr><th id="315">315</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="316">316</th><td>}</td></tr>
<tr><th id="317">317</th><td></td></tr>
<tr><th id="318">318</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="attach_auth" title='attach_auth' data-type='int attach_auth(struct xfrm_algo_auth ** algpp, u8 * props, struct nlattr * rta)' data-ref="attach_auth" data-ref-filename="attach_auth">attach_auth</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth" title='xfrm_algo_auth' data-ref="xfrm_algo_auth" data-ref-filename="xfrm_algo_auth">xfrm_algo_auth</a> **<dfn class="local col8 decl" id="38algpp" title='algpp' data-type='struct xfrm_algo_auth **' data-ref="38algpp" data-ref-filename="38algpp">algpp</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> *<dfn class="local col9 decl" id="39props" title='props' data-type='u8 *' data-ref="39props" data-ref-filename="39props">props</dfn>,</td></tr>
<tr><th id="319">319</th><td>		       <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col0 decl" id="40rta" title='rta' data-type='struct nlattr *' data-ref="40rta" data-ref-filename="40rta">rta</dfn>)</td></tr>
<tr><th id="320">320</th><td>{</td></tr>
<tr><th id="321">321</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a> *<dfn class="local col1 decl" id="41ualg" title='ualg' data-type='struct xfrm_algo *' data-ref="41ualg" data-ref-filename="41ualg">ualg</dfn>;</td></tr>
<tr><th id="322">322</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth" title='xfrm_algo_auth' data-ref="xfrm_algo_auth" data-ref-filename="xfrm_algo_auth">xfrm_algo_auth</a> *<dfn class="local col2 decl" id="42p" title='p' data-type='struct xfrm_algo_auth *' data-ref="42p" data-ref-filename="42p">p</dfn>;</td></tr>
<tr><th id="323">323</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_algo_desc" title='xfrm_algo_desc' data-ref="xfrm_algo_desc" data-ref-filename="xfrm_algo_desc">xfrm_algo_desc</a> *<dfn class="local col3 decl" id="43algo" title='algo' data-type='struct xfrm_algo_desc *' data-ref="43algo" data-ref-filename="43algo">algo</dfn>;</td></tr>
<tr><th id="324">324</th><td></td></tr>
<tr><th id="325">325</th><td>	<b>if</b> (!<a class="local col0 ref" href="#40rta" title='rta' data-ref="40rta" data-ref-filename="40rta">rta</a>)</td></tr>
<tr><th id="326">326</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="327">327</th><td></td></tr>
<tr><th id="328">328</th><td>	<a class="local col1 ref" href="#41ualg" title='ualg' data-ref="41ualg" data-ref-filename="41ualg">ualg</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col0 ref" href="#40rta" title='rta' data-ref="40rta" data-ref-filename="40rta">rta</a>);</td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>	<a class="local col3 ref" href="#43algo" title='algo' data-ref="43algo" data-ref-filename="43algo">algo</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_aalg_get_byname" title='xfrm_aalg_get_byname' data-ref="xfrm_aalg_get_byname" data-ref-filename="xfrm_aalg_get_byname">xfrm_aalg_get_byname</a>(<a class="local col1 ref" href="#41ualg" title='ualg' data-ref="41ualg" data-ref-filename="41ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>, <var>1</var>);</td></tr>
<tr><th id="331">331</th><td>	<b>if</b> (!<a class="local col3 ref" href="#43algo" title='algo' data-ref="43algo" data-ref-filename="43algo">algo</a>)</td></tr>
<tr><th id="332">332</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#18" title="38" data-ref="_M/ENOSYS">ENOSYS</a>;</td></tr>
<tr><th id="333">333</th><td>	*<a class="local col9 ref" href="#39props" title='props' data-ref="39props" data-ref-filename="39props">props</a> = <a class="local col3 ref" href="#43algo" title='algo' data-ref="43algo" data-ref-filename="43algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::desc" title='xfrm_algo_desc::desc' data-ref="xfrm_algo_desc::desc" data-ref-filename="xfrm_algo_desc..desc">desc</a>.<a class="ref field" href="../../include/uapi/linux/pfkeyv2.h.html#sadb_alg::sadb_alg_id" title='sadb_alg::sadb_alg_id' data-ref="sadb_alg::sadb_alg_id" data-ref-filename="sadb_alg..sadb_alg_id">sadb_alg_id</a>;</td></tr>
<tr><th id="334">334</th><td></td></tr>
<tr><th id="335">335</th><td>	<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a> = <a class="ref fn" href="../../include/linux/slab.h.html#kmalloc" title='kmalloc' data-ref="kmalloc" data-ref-filename="kmalloc">kmalloc</a>(<b>sizeof</b>(*<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>) + (<a class="local col1 ref" href="#41ualg" title='ualg' data-ref="41ualg" data-ref-filename="41ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_key_len" title='xfrm_algo::alg_key_len' data-ref="xfrm_algo::alg_key_len" data-ref-filename="xfrm_algo..alg_key_len">alg_key_len</a> + <var>7</var>) / <var>8</var>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="336">336</th><td>	<b>if</b> (!<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>)</td></tr>
<tr><th id="337">337</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="338">338</th><td></td></tr>
<tr><th id="339">339</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#strcpy" title='strcpy' data-ref="strcpy" data-ref-filename="strcpy">strcpy</a>(<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_name" title='xfrm_algo_auth::alg_name' data-ref="xfrm_algo_auth::alg_name" data-ref-filename="xfrm_algo_auth..alg_name">alg_name</a>, <a class="local col3 ref" href="#43algo" title='algo' data-ref="43algo" data-ref-filename="43algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::name" title='xfrm_algo_desc::name' data-ref="xfrm_algo_desc::name" data-ref-filename="xfrm_algo_desc..name">name</a>);</td></tr>
<tr><th id="340">340</th><td>	<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_key_len" title='xfrm_algo_auth::alg_key_len' data-ref="xfrm_algo_auth::alg_key_len" data-ref-filename="xfrm_algo_auth..alg_key_len">alg_key_len</a> = <a class="local col1 ref" href="#41ualg" title='ualg' data-ref="41ualg" data-ref-filename="41ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_key_len" title='xfrm_algo::alg_key_len' data-ref="xfrm_algo::alg_key_len" data-ref-filename="xfrm_algo..alg_key_len">alg_key_len</a>;</td></tr>
<tr><th id="341">341</th><td>	<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_trunc_len" title='xfrm_algo_auth::alg_trunc_len' data-ref="xfrm_algo_auth::alg_trunc_len" data-ref-filename="xfrm_algo_auth..alg_trunc_len">alg_trunc_len</a> = <a class="local col3 ref" href="#43algo" title='algo' data-ref="43algo" data-ref-filename="43algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::uinfo" title='xfrm_algo_desc::uinfo' data-ref="xfrm_algo_desc::uinfo" data-ref-filename="xfrm_algo_desc..uinfo">uinfo</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::(anonymous)::auth" title='xfrm_algo_desc::(anonymous union)::auth' data-ref="xfrm_algo_desc::(anonymous)::auth" data-ref-filename="xfrm_algo_desc..(anonymous)..auth">auth</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_auth_info::icv_truncbits" title='xfrm_algo_auth_info::icv_truncbits' data-ref="xfrm_algo_auth_info::icv_truncbits" data-ref-filename="xfrm_algo_auth_info..icv_truncbits">icv_truncbits</a>;</td></tr>
<tr><th id="342">342</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = ((ualg-&gt;alg_key_len + 7) / 8); void *__ret; if (__builtin_constant_p((ualg-&gt;alg_key_len + 7) / 8) &amp;&amp; __len &gt;= 64) __ret = __memcpy((p-&gt;alg_key), (ualg-&gt;alg_key), __len); else __ret = __builtin_memcpy((p-&gt;alg_key), (ualg-&gt;alg_key), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_key" title='xfrm_algo_auth::alg_key' data-ref="xfrm_algo_auth::alg_key" data-ref-filename="xfrm_algo_auth..alg_key">alg_key</a>, <a class="local col1 ref" href="#41ualg" title='ualg' data-ref="41ualg" data-ref-filename="41ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_key" title='xfrm_algo::alg_key' data-ref="xfrm_algo::alg_key" data-ref-filename="xfrm_algo..alg_key">alg_key</a>, (<a class="local col1 ref" href="#41ualg" title='ualg' data-ref="41ualg" data-ref-filename="41ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_key_len" title='xfrm_algo::alg_key_len' data-ref="xfrm_algo::alg_key_len" data-ref-filename="xfrm_algo..alg_key_len">alg_key_len</a> + <var>7</var>) / <var>8</var>);</td></tr>
<tr><th id="343">343</th><td></td></tr>
<tr><th id="344">344</th><td>	*<a class="local col8 ref" href="#38algpp" title='algpp' data-ref="38algpp" data-ref-filename="38algpp">algpp</a> = <a class="local col2 ref" href="#42p" title='p' data-ref="42p" data-ref-filename="42p">p</a>;</td></tr>
<tr><th id="345">345</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="346">346</th><td>}</td></tr>
<tr><th id="347">347</th><td></td></tr>
<tr><th id="348">348</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="attach_auth_trunc" title='attach_auth_trunc' data-type='int attach_auth_trunc(struct xfrm_algo_auth ** algpp, u8 * props, struct nlattr * rta)' data-ref="attach_auth_trunc" data-ref-filename="attach_auth_trunc">attach_auth_trunc</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth" title='xfrm_algo_auth' data-ref="xfrm_algo_auth" data-ref-filename="xfrm_algo_auth">xfrm_algo_auth</a> **<dfn class="local col4 decl" id="44algpp" title='algpp' data-type='struct xfrm_algo_auth **' data-ref="44algpp" data-ref-filename="44algpp">algpp</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> *<dfn class="local col5 decl" id="45props" title='props' data-type='u8 *' data-ref="45props" data-ref-filename="45props">props</dfn>,</td></tr>
<tr><th id="349">349</th><td>			     <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col6 decl" id="46rta" title='rta' data-type='struct nlattr *' data-ref="46rta" data-ref-filename="46rta">rta</dfn>)</td></tr>
<tr><th id="350">350</th><td>{</td></tr>
<tr><th id="351">351</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth" title='xfrm_algo_auth' data-ref="xfrm_algo_auth" data-ref-filename="xfrm_algo_auth">xfrm_algo_auth</a> *<dfn class="local col7 decl" id="47p" title='p' data-type='struct xfrm_algo_auth *' data-ref="47p" data-ref-filename="47p">p</dfn>, *<dfn class="local col8 decl" id="48ualg" title='ualg' data-type='struct xfrm_algo_auth *' data-ref="48ualg" data-ref-filename="48ualg">ualg</dfn>;</td></tr>
<tr><th id="352">352</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_algo_desc" title='xfrm_algo_desc' data-ref="xfrm_algo_desc" data-ref-filename="xfrm_algo_desc">xfrm_algo_desc</a> *<dfn class="local col9 decl" id="49algo" title='algo' data-type='struct xfrm_algo_desc *' data-ref="49algo" data-ref-filename="49algo">algo</dfn>;</td></tr>
<tr><th id="353">353</th><td></td></tr>
<tr><th id="354">354</th><td>	<b>if</b> (!<a class="local col6 ref" href="#46rta" title='rta' data-ref="46rta" data-ref-filename="46rta">rta</a>)</td></tr>
<tr><th id="355">355</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="356">356</th><td></td></tr>
<tr><th id="357">357</th><td>	<a class="local col8 ref" href="#48ualg" title='ualg' data-ref="48ualg" data-ref-filename="48ualg">ualg</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col6 ref" href="#46rta" title='rta' data-ref="46rta" data-ref-filename="46rta">rta</a>);</td></tr>
<tr><th id="358">358</th><td></td></tr>
<tr><th id="359">359</th><td>	<a class="local col9 ref" href="#49algo" title='algo' data-ref="49algo" data-ref-filename="49algo">algo</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_aalg_get_byname" title='xfrm_aalg_get_byname' data-ref="xfrm_aalg_get_byname" data-ref-filename="xfrm_aalg_get_byname">xfrm_aalg_get_byname</a>(<a class="local col8 ref" href="#48ualg" title='ualg' data-ref="48ualg" data-ref-filename="48ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_name" title='xfrm_algo_auth::alg_name' data-ref="xfrm_algo_auth::alg_name" data-ref-filename="xfrm_algo_auth..alg_name">alg_name</a>, <var>1</var>);</td></tr>
<tr><th id="360">360</th><td>	<b>if</b> (!<a class="local col9 ref" href="#49algo" title='algo' data-ref="49algo" data-ref-filename="49algo">algo</a>)</td></tr>
<tr><th id="361">361</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#18" title="38" data-ref="_M/ENOSYS">ENOSYS</a>;</td></tr>
<tr><th id="362">362</th><td>	<b>if</b> (<a class="local col8 ref" href="#48ualg" title='ualg' data-ref="48ualg" data-ref-filename="48ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_trunc_len" title='xfrm_algo_auth::alg_trunc_len' data-ref="xfrm_algo_auth::alg_trunc_len" data-ref-filename="xfrm_algo_auth..alg_trunc_len">alg_trunc_len</a> &gt; <a class="local col9 ref" href="#49algo" title='algo' data-ref="49algo" data-ref-filename="49algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::uinfo" title='xfrm_algo_desc::uinfo' data-ref="xfrm_algo_desc::uinfo" data-ref-filename="xfrm_algo_desc..uinfo">uinfo</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::(anonymous)::auth" title='xfrm_algo_desc::(anonymous union)::auth' data-ref="xfrm_algo_desc::(anonymous)::auth" data-ref-filename="xfrm_algo_desc..(anonymous)..auth">auth</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_auth_info::icv_fullbits" title='xfrm_algo_auth_info::icv_fullbits' data-ref="xfrm_algo_auth_info::icv_fullbits" data-ref-filename="xfrm_algo_auth_info..icv_fullbits">icv_fullbits</a>)</td></tr>
<tr><th id="363">363</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="364">364</th><td>	*<a class="local col5 ref" href="#45props" title='props' data-ref="45props" data-ref-filename="45props">props</a> = <a class="local col9 ref" href="#49algo" title='algo' data-ref="49algo" data-ref-filename="49algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::desc" title='xfrm_algo_desc::desc' data-ref="xfrm_algo_desc::desc" data-ref-filename="xfrm_algo_desc..desc">desc</a>.<a class="ref field" href="../../include/uapi/linux/pfkeyv2.h.html#sadb_alg::sadb_alg_id" title='sadb_alg::sadb_alg_id' data-ref="sadb_alg::sadb_alg_id" data-ref-filename="sadb_alg..sadb_alg_id">sadb_alg_id</a>;</td></tr>
<tr><th id="365">365</th><td></td></tr>
<tr><th id="366">366</th><td>	<a class="local col7 ref" href="#47p" title='p' data-ref="47p" data-ref-filename="47p">p</a> = <a class="ref fn" href="../../include/linux/string.h.html#kmemdup" title='kmemdup' data-ref="kmemdup" data-ref-filename="kmemdup">kmemdup</a>(<a class="local col8 ref" href="#48ualg" title='ualg' data-ref="48ualg" data-ref-filename="48ualg">ualg</a>, <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_auth_len" title='xfrm_alg_auth_len' data-ref="xfrm_alg_auth_len" data-ref-filename="xfrm_alg_auth_len">xfrm_alg_auth_len</a>(<a class="local col8 ref" href="#48ualg" title='ualg' data-ref="48ualg" data-ref-filename="48ualg">ualg</a>), <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="367">367</th><td>	<b>if</b> (!<a class="local col7 ref" href="#47p" title='p' data-ref="47p" data-ref-filename="47p">p</a>)</td></tr>
<tr><th id="368">368</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="369">369</th><td></td></tr>
<tr><th id="370">370</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#strcpy" title='strcpy' data-ref="strcpy" data-ref-filename="strcpy">strcpy</a>(<a class="local col7 ref" href="#47p" title='p' data-ref="47p" data-ref-filename="47p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_name" title='xfrm_algo_auth::alg_name' data-ref="xfrm_algo_auth::alg_name" data-ref-filename="xfrm_algo_auth..alg_name">alg_name</a>, <a class="local col9 ref" href="#49algo" title='algo' data-ref="49algo" data-ref-filename="49algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::name" title='xfrm_algo_desc::name' data-ref="xfrm_algo_desc::name" data-ref-filename="xfrm_algo_desc..name">name</a>);</td></tr>
<tr><th id="371">371</th><td>	<b>if</b> (!<a class="local col7 ref" href="#47p" title='p' data-ref="47p" data-ref-filename="47p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_trunc_len" title='xfrm_algo_auth::alg_trunc_len' data-ref="xfrm_algo_auth::alg_trunc_len" data-ref-filename="xfrm_algo_auth..alg_trunc_len">alg_trunc_len</a>)</td></tr>
<tr><th id="372">372</th><td>		<a class="local col7 ref" href="#47p" title='p' data-ref="47p" data-ref-filename="47p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_trunc_len" title='xfrm_algo_auth::alg_trunc_len' data-ref="xfrm_algo_auth::alg_trunc_len" data-ref-filename="xfrm_algo_auth..alg_trunc_len">alg_trunc_len</a> = <a class="local col9 ref" href="#49algo" title='algo' data-ref="49algo" data-ref-filename="49algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::uinfo" title='xfrm_algo_desc::uinfo' data-ref="xfrm_algo_desc::uinfo" data-ref-filename="xfrm_algo_desc..uinfo">uinfo</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::(anonymous)::auth" title='xfrm_algo_desc::(anonymous union)::auth' data-ref="xfrm_algo_desc::(anonymous)::auth" data-ref-filename="xfrm_algo_desc..(anonymous)..auth">auth</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_auth_info::icv_truncbits" title='xfrm_algo_auth_info::icv_truncbits' data-ref="xfrm_algo_auth_info::icv_truncbits" data-ref-filename="xfrm_algo_auth_info..icv_truncbits">icv_truncbits</a>;</td></tr>
<tr><th id="373">373</th><td></td></tr>
<tr><th id="374">374</th><td>	*<a class="local col4 ref" href="#44algpp" title='algpp' data-ref="44algpp" data-ref-filename="44algpp">algpp</a> = <a class="local col7 ref" href="#47p" title='p' data-ref="47p" data-ref-filename="47p">p</a>;</td></tr>
<tr><th id="375">375</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="376">376</th><td>}</td></tr>
<tr><th id="377">377</th><td></td></tr>
<tr><th id="378">378</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="attach_aead" title='attach_aead' data-type='int attach_aead(struct xfrm_state * x, struct nlattr * rta)' data-ref="attach_aead" data-ref-filename="attach_aead">attach_aead</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col0 decl" id="50x" title='x' data-type='struct xfrm_state *' data-ref="50x" data-ref-filename="50x">x</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col1 decl" id="51rta" title='rta' data-type='struct nlattr *' data-ref="51rta" data-ref-filename="51rta">rta</dfn>)</td></tr>
<tr><th id="379">379</th><td>{</td></tr>
<tr><th id="380">380</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead" title='xfrm_algo_aead' data-ref="xfrm_algo_aead" data-ref-filename="xfrm_algo_aead">xfrm_algo_aead</a> *<dfn class="local col2 decl" id="52p" title='p' data-type='struct xfrm_algo_aead *' data-ref="52p" data-ref-filename="52p">p</dfn>, *<dfn class="local col3 decl" id="53ualg" title='ualg' data-type='struct xfrm_algo_aead *' data-ref="53ualg" data-ref-filename="53ualg">ualg</dfn>;</td></tr>
<tr><th id="381">381</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_algo_desc" title='xfrm_algo_desc' data-ref="xfrm_algo_desc" data-ref-filename="xfrm_algo_desc">xfrm_algo_desc</a> *<dfn class="local col4 decl" id="54algo" title='algo' data-type='struct xfrm_algo_desc *' data-ref="54algo" data-ref-filename="54algo">algo</dfn>;</td></tr>
<tr><th id="382">382</th><td></td></tr>
<tr><th id="383">383</th><td>	<b>if</b> (!<a class="local col1 ref" href="#51rta" title='rta' data-ref="51rta" data-ref-filename="51rta">rta</a>)</td></tr>
<tr><th id="384">384</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="385">385</th><td></td></tr>
<tr><th id="386">386</th><td>	<a class="local col3 ref" href="#53ualg" title='ualg' data-ref="53ualg" data-ref-filename="53ualg">ualg</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col1 ref" href="#51rta" title='rta' data-ref="51rta" data-ref-filename="51rta">rta</a>);</td></tr>
<tr><th id="387">387</th><td></td></tr>
<tr><th id="388">388</th><td>	<a class="local col4 ref" href="#54algo" title='algo' data-ref="54algo" data-ref-filename="54algo">algo</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_aead_get_byname" title='xfrm_aead_get_byname' data-ref="xfrm_aead_get_byname" data-ref-filename="xfrm_aead_get_byname">xfrm_aead_get_byname</a>(<a class="local col3 ref" href="#53ualg" title='ualg' data-ref="53ualg" data-ref-filename="53ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead::alg_name" title='xfrm_algo_aead::alg_name' data-ref="xfrm_algo_aead::alg_name" data-ref-filename="xfrm_algo_aead..alg_name">alg_name</a>, <a class="local col3 ref" href="#53ualg" title='ualg' data-ref="53ualg" data-ref-filename="53ualg">ualg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead::alg_icv_len" title='xfrm_algo_aead::alg_icv_len' data-ref="xfrm_algo_aead::alg_icv_len" data-ref-filename="xfrm_algo_aead..alg_icv_len">alg_icv_len</a>, <var>1</var>);</td></tr>
<tr><th id="389">389</th><td>	<b>if</b> (!<a class="local col4 ref" href="#54algo" title='algo' data-ref="54algo" data-ref-filename="54algo">algo</a>)</td></tr>
<tr><th id="390">390</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#18" title="38" data-ref="_M/ENOSYS">ENOSYS</a>;</td></tr>
<tr><th id="391">391</th><td>	<a class="local col0 ref" href="#50x" title='x' data-ref="50x" data-ref-filename="50x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::ealgo" title='xfrm_state::(anonymous struct)::ealgo' data-ref="xfrm_state::(anonymous)::ealgo" data-ref-filename="xfrm_state..(anonymous)..ealgo">ealgo</a> = <a class="local col4 ref" href="#54algo" title='algo' data-ref="54algo" data-ref-filename="54algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::desc" title='xfrm_algo_desc::desc' data-ref="xfrm_algo_desc::desc" data-ref-filename="xfrm_algo_desc..desc">desc</a>.<a class="ref field" href="../../include/uapi/linux/pfkeyv2.h.html#sadb_alg::sadb_alg_id" title='sadb_alg::sadb_alg_id' data-ref="sadb_alg::sadb_alg_id" data-ref-filename="sadb_alg..sadb_alg_id">sadb_alg_id</a>;</td></tr>
<tr><th id="392">392</th><td></td></tr>
<tr><th id="393">393</th><td>	<a class="local col2 ref" href="#52p" title='p' data-ref="52p" data-ref-filename="52p">p</a> = <a class="ref fn" href="../../include/linux/string.h.html#kmemdup" title='kmemdup' data-ref="kmemdup" data-ref-filename="kmemdup">kmemdup</a>(<a class="local col3 ref" href="#53ualg" title='ualg' data-ref="53ualg" data-ref-filename="53ualg">ualg</a>, <a class="ref fn" href="../../include/net/xfrm.h.html#aead_len" title='aead_len' data-ref="aead_len" data-ref-filename="aead_len">aead_len</a>(<a class="local col3 ref" href="#53ualg" title='ualg' data-ref="53ualg" data-ref-filename="53ualg">ualg</a>), <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="394">394</th><td>	<b>if</b> (!<a class="local col2 ref" href="#52p" title='p' data-ref="52p" data-ref-filename="52p">p</a>)</td></tr>
<tr><th id="395">395</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="396">396</th><td></td></tr>
<tr><th id="397">397</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#strcpy" title='strcpy' data-ref="strcpy" data-ref-filename="strcpy">strcpy</a>(<a class="local col2 ref" href="#52p" title='p' data-ref="52p" data-ref-filename="52p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead::alg_name" title='xfrm_algo_aead::alg_name' data-ref="xfrm_algo_aead::alg_name" data-ref-filename="xfrm_algo_aead..alg_name">alg_name</a>, <a class="local col4 ref" href="#54algo" title='algo' data-ref="54algo" data-ref-filename="54algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::name" title='xfrm_algo_desc::name' data-ref="xfrm_algo_desc::name" data-ref-filename="xfrm_algo_desc..name">name</a>);</td></tr>
<tr><th id="398">398</th><td>	<a class="local col0 ref" href="#50x" title='x' data-ref="50x" data-ref-filename="50x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aead" title='xfrm_state::aead' data-ref="xfrm_state::aead" data-ref-filename="xfrm_state..aead">aead</a> = <a class="local col2 ref" href="#52p" title='p' data-ref="52p" data-ref-filename="52p">p</a>;</td></tr>
<tr><th id="399">399</th><td>	<a class="local col0 ref" href="#50x" title='x' data-ref="50x" data-ref-filename="50x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::geniv" title='xfrm_state::geniv' data-ref="xfrm_state::geniv" data-ref-filename="xfrm_state..geniv">geniv</a> = <a class="local col4 ref" href="#54algo" title='algo' data-ref="54algo" data-ref-filename="54algo">algo</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::uinfo" title='xfrm_algo_desc::uinfo' data-ref="xfrm_algo_desc::uinfo" data-ref-filename="xfrm_algo_desc..uinfo">uinfo</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_desc::(anonymous)::aead" title='xfrm_algo_desc::(anonymous union)::aead' data-ref="xfrm_algo_desc::(anonymous)::aead" data-ref-filename="xfrm_algo_desc..(anonymous)..aead">aead</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_algo_aead_info::geniv" title='xfrm_algo_aead_info::geniv' data-ref="xfrm_algo_aead_info::geniv" data-ref-filename="xfrm_algo_aead_info..geniv">geniv</a>;</td></tr>
<tr><th id="400">400</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="401">401</th><td>}</td></tr>
<tr><th id="402">402</th><td></td></tr>
<tr><th id="403">403</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="xfrm_replay_verify_len" title='xfrm_replay_verify_len' data-type='int xfrm_replay_verify_len(struct xfrm_replay_state_esn * replay_esn, struct nlattr * rp)' data-ref="xfrm_replay_verify_len" data-ref-filename="xfrm_replay_verify_len">xfrm_replay_verify_len</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a> *<dfn class="local col5 decl" id="55replay_esn" title='replay_esn' data-type='struct xfrm_replay_state_esn *' data-ref="55replay_esn" data-ref-filename="55replay_esn">replay_esn</dfn>,</td></tr>
<tr><th id="404">404</th><td>					 <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col6 decl" id="56rp" title='rp' data-type='struct nlattr *' data-ref="56rp" data-ref-filename="56rp">rp</dfn>)</td></tr>
<tr><th id="405">405</th><td>{</td></tr>
<tr><th id="406">406</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a> *<dfn class="local col7 decl" id="57up" title='up' data-type='struct xfrm_replay_state_esn *' data-ref="57up" data-ref-filename="57up">up</dfn>;</td></tr>
<tr><th id="407">407</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="58ulen" title='ulen' data-type='unsigned int' data-ref="58ulen" data-ref-filename="58ulen">ulen</dfn>;</td></tr>
<tr><th id="408">408</th><td></td></tr>
<tr><th id="409">409</th><td>	<b>if</b> (!<a class="local col5 ref" href="#55replay_esn" title='replay_esn' data-ref="55replay_esn" data-ref-filename="55replay_esn">replay_esn</a> || !<a class="local col6 ref" href="#56rp" title='rp' data-ref="56rp" data-ref-filename="56rp">rp</a>)</td></tr>
<tr><th id="410">410</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="411">411</th><td></td></tr>
<tr><th id="412">412</th><td>	<a class="local col7 ref" href="#57up" title='up' data-ref="57up" data-ref-filename="57up">up</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col6 ref" href="#56rp" title='rp' data-ref="56rp" data-ref-filename="56rp">rp</a>);</td></tr>
<tr><th id="413">413</th><td>	<a class="local col8 ref" href="#58ulen" title='ulen' data-ref="58ulen" data-ref-filename="58ulen">ulen</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col7 ref" href="#57up" title='up' data-ref="57up" data-ref-filename="57up">up</a>);</td></tr>
<tr><th id="414">414</th><td></td></tr>
<tr><th id="415">415</th><td>	<i>/* Check the overall length and the internal bitmap length to avoid</i></td></tr>
<tr><th id="416">416</th><td><i>	 * potential overflow. */</i></td></tr>
<tr><th id="417">417</th><td>	<b>if</b> (<a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col6 ref" href="#56rp" title='rp' data-ref="56rp" data-ref-filename="56rp">rp</a>) &lt; (<em>int</em>)<a class="local col8 ref" href="#58ulen" title='ulen' data-ref="58ulen" data-ref-filename="58ulen">ulen</a> ||</td></tr>
<tr><th id="418">418</th><td>	    <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col5 ref" href="#55replay_esn" title='replay_esn' data-ref="55replay_esn" data-ref-filename="55replay_esn">replay_esn</a>) != <a class="local col8 ref" href="#58ulen" title='ulen' data-ref="58ulen" data-ref-filename="58ulen">ulen</a> ||</td></tr>
<tr><th id="419">419</th><td>	    <a class="local col5 ref" href="#55replay_esn" title='replay_esn' data-ref="55replay_esn" data-ref-filename="55replay_esn">replay_esn</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn::bmp_len" title='xfrm_replay_state_esn::bmp_len' data-ref="xfrm_replay_state_esn::bmp_len" data-ref-filename="xfrm_replay_state_esn..bmp_len">bmp_len</a> != <a class="local col7 ref" href="#57up" title='up' data-ref="57up" data-ref-filename="57up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn::bmp_len" title='xfrm_replay_state_esn::bmp_len' data-ref="xfrm_replay_state_esn::bmp_len" data-ref-filename="xfrm_replay_state_esn..bmp_len">bmp_len</a>)</td></tr>
<tr><th id="420">420</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="421">421</th><td></td></tr>
<tr><th id="422">422</th><td>	<b>if</b> (<a class="local col7 ref" href="#57up" title='up' data-ref="57up" data-ref-filename="57up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn::replay_window" title='xfrm_replay_state_esn::replay_window' data-ref="xfrm_replay_state_esn::replay_window" data-ref-filename="xfrm_replay_state_esn..replay_window">replay_window</a> &gt; <a class="local col7 ref" href="#57up" title='up' data-ref="57up" data-ref-filename="57up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn::bmp_len" title='xfrm_replay_state_esn::bmp_len' data-ref="xfrm_replay_state_esn::bmp_len" data-ref-filename="xfrm_replay_state_esn..bmp_len">bmp_len</a> * <b>sizeof</b>(<a class="typedef" href="../../include/uapi/asm-generic/int-ll64.h.html#__u32" title='__u32' data-type='unsigned int' data-ref="__u32" data-ref-filename="__u32">__u32</a>) * <var>8</var>)</td></tr>
<tr><th id="423">423</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="424">424</th><td></td></tr>
<tr><th id="425">425</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="426">426</th><td>}</td></tr>
<tr><th id="427">427</th><td></td></tr>
<tr><th id="428">428</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_alloc_replay_state_esn" title='xfrm_alloc_replay_state_esn' data-type='int xfrm_alloc_replay_state_esn(struct xfrm_replay_state_esn ** replay_esn, struct xfrm_replay_state_esn ** preplay_esn, struct nlattr * rta)' data-ref="xfrm_alloc_replay_state_esn" data-ref-filename="xfrm_alloc_replay_state_esn">xfrm_alloc_replay_state_esn</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a> **<dfn class="local col9 decl" id="59replay_esn" title='replay_esn' data-type='struct xfrm_replay_state_esn **' data-ref="59replay_esn" data-ref-filename="59replay_esn">replay_esn</dfn>,</td></tr>
<tr><th id="429">429</th><td>				       <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a> **<dfn class="local col0 decl" id="60preplay_esn" title='preplay_esn' data-type='struct xfrm_replay_state_esn **' data-ref="60preplay_esn" data-ref-filename="60preplay_esn">preplay_esn</dfn>,</td></tr>
<tr><th id="430">430</th><td>				       <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col1 decl" id="61rta" title='rta' data-type='struct nlattr *' data-ref="61rta" data-ref-filename="61rta">rta</dfn>)</td></tr>
<tr><th id="431">431</th><td>{</td></tr>
<tr><th id="432">432</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a> *<dfn class="local col2 decl" id="62p" title='p' data-type='struct xfrm_replay_state_esn *' data-ref="62p" data-ref-filename="62p">p</dfn>, *<dfn class="local col3 decl" id="63pp" title='pp' data-type='struct xfrm_replay_state_esn *' data-ref="63pp" data-ref-filename="63pp">pp</dfn>, *<dfn class="local col4 decl" id="64up" title='up' data-type='struct xfrm_replay_state_esn *' data-ref="64up" data-ref-filename="64up">up</dfn>;</td></tr>
<tr><th id="433">433</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="65klen" title='klen' data-type='unsigned int' data-ref="65klen" data-ref-filename="65klen">klen</dfn>, <dfn class="local col6 decl" id="66ulen" title='ulen' data-type='unsigned int' data-ref="66ulen" data-ref-filename="66ulen">ulen</dfn>;</td></tr>
<tr><th id="434">434</th><td></td></tr>
<tr><th id="435">435</th><td>	<b>if</b> (!<a class="local col1 ref" href="#61rta" title='rta' data-ref="61rta" data-ref-filename="61rta">rta</a>)</td></tr>
<tr><th id="436">436</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="437">437</th><td></td></tr>
<tr><th id="438">438</th><td>	<a class="local col4 ref" href="#64up" title='up' data-ref="64up" data-ref-filename="64up">up</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col1 ref" href="#61rta" title='rta' data-ref="61rta" data-ref-filename="61rta">rta</a>);</td></tr>
<tr><th id="439">439</th><td>	<a class="local col5 ref" href="#65klen" title='klen' data-ref="65klen" data-ref-filename="65klen">klen</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col4 ref" href="#64up" title='up' data-ref="64up" data-ref-filename="64up">up</a>);</td></tr>
<tr><th id="440">440</th><td>	<a class="local col6 ref" href="#66ulen" title='ulen' data-ref="66ulen" data-ref-filename="66ulen">ulen</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col1 ref" href="#61rta" title='rta' data-ref="61rta" data-ref-filename="61rta">rta</a>) &gt;= (<em>int</em>)<a class="local col5 ref" href="#65klen" title='klen' data-ref="65klen" data-ref-filename="65klen">klen</a> ? <a class="local col5 ref" href="#65klen" title='klen' data-ref="65klen" data-ref-filename="65klen">klen</a> : <b>sizeof</b>(*<a class="local col4 ref" href="#64up" title='up' data-ref="64up" data-ref-filename="64up">up</a>);</td></tr>
<tr><th id="441">441</th><td></td></tr>
<tr><th id="442">442</th><td>	<a class="local col2 ref" href="#62p" title='p' data-ref="62p" data-ref-filename="62p">p</a> = <a class="ref fn" href="../../include/linux/slab.h.html#kzalloc" title='kzalloc' data-ref="kzalloc" data-ref-filename="kzalloc">kzalloc</a>(<a class="local col5 ref" href="#65klen" title='klen' data-ref="65klen" data-ref-filename="65klen">klen</a>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="443">443</th><td>	<b>if</b> (!<a class="local col2 ref" href="#62p" title='p' data-ref="62p" data-ref-filename="62p">p</a>)</td></tr>
<tr><th id="444">444</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="445">445</th><td></td></tr>
<tr><th id="446">446</th><td>	<a class="local col3 ref" href="#63pp" title='pp' data-ref="63pp" data-ref-filename="63pp">pp</a> = <a class="ref fn" href="../../include/linux/slab.h.html#kzalloc" title='kzalloc' data-ref="kzalloc" data-ref-filename="kzalloc">kzalloc</a>(<a class="local col5 ref" href="#65klen" title='klen' data-ref="65klen" data-ref-filename="65klen">klen</a>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="447">447</th><td>	<b>if</b> (!<a class="local col3 ref" href="#63pp" title='pp' data-ref="63pp" data-ref-filename="63pp">pp</a>) {</td></tr>
<tr><th id="448">448</th><td>		<a class="ref fn" href="../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree" data-ref-filename="kfree">kfree</a>(<a class="local col2 ref" href="#62p" title='p' data-ref="62p" data-ref-filename="62p">p</a>);</td></tr>
<tr><th id="449">449</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="450">450</th><td>	}</td></tr>
<tr><th id="451">451</th><td></td></tr>
<tr><th id="452">452</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (ulen); void *__ret; if (__builtin_constant_p(ulen) &amp;&amp; __len &gt;= 64) __ret = __memcpy((p), (up), __len); else __ret = __builtin_memcpy((p), (up), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col2 ref" href="#62p" title='p' data-ref="62p" data-ref-filename="62p">p</a>, <a class="local col4 ref" href="#64up" title='up' data-ref="64up" data-ref-filename="64up">up</a>, <a class="local col6 ref" href="#66ulen" title='ulen' data-ref="66ulen" data-ref-filename="66ulen">ulen</a>);</td></tr>
<tr><th id="453">453</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (ulen); void *__ret; if (__builtin_constant_p(ulen) &amp;&amp; __len &gt;= 64) __ret = __memcpy((pp), (up), __len); else __ret = __builtin_memcpy((pp), (up), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col3 ref" href="#63pp" title='pp' data-ref="63pp" data-ref-filename="63pp">pp</a>, <a class="local col4 ref" href="#64up" title='up' data-ref="64up" data-ref-filename="64up">up</a>, <a class="local col6 ref" href="#66ulen" title='ulen' data-ref="66ulen" data-ref-filename="66ulen">ulen</a>);</td></tr>
<tr><th id="454">454</th><td></td></tr>
<tr><th id="455">455</th><td>	*<a class="local col9 ref" href="#59replay_esn" title='replay_esn' data-ref="59replay_esn" data-ref-filename="59replay_esn">replay_esn</a> = <a class="local col2 ref" href="#62p" title='p' data-ref="62p" data-ref-filename="62p">p</a>;</td></tr>
<tr><th id="456">456</th><td>	*<a class="local col0 ref" href="#60preplay_esn" title='preplay_esn' data-ref="60preplay_esn" data-ref-filename="60preplay_esn">preplay_esn</a> = <a class="local col3 ref" href="#63pp" title='pp' data-ref="63pp" data-ref-filename="63pp">pp</a>;</td></tr>
<tr><th id="457">457</th><td></td></tr>
<tr><th id="458">458</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="459">459</th><td>}</td></tr>
<tr><th id="460">460</th><td></td></tr>
<tr><th id="461">461</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_user_sec_ctx_size" title='xfrm_user_sec_ctx_size' data-type='unsigned int xfrm_user_sec_ctx_size(struct xfrm_sec_ctx * xfrm_ctx)' data-ref="xfrm_user_sec_ctx_size" data-ref-filename="xfrm_user_sec_ctx_size">xfrm_user_sec_ctx_size</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx" title='xfrm_sec_ctx' data-ref="xfrm_sec_ctx" data-ref-filename="xfrm_sec_ctx">xfrm_sec_ctx</a> *<dfn class="local col7 decl" id="67xfrm_ctx" title='xfrm_ctx' data-type='struct xfrm_sec_ctx *' data-ref="67xfrm_ctx" data-ref-filename="67xfrm_ctx">xfrm_ctx</dfn>)</td></tr>
<tr><th id="462">462</th><td>{</td></tr>
<tr><th id="463">463</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col8 decl" id="68len" title='len' data-type='unsigned int' data-ref="68len" data-ref-filename="68len">len</dfn> = <var>0</var>;</td></tr>
<tr><th id="464">464</th><td></td></tr>
<tr><th id="465">465</th><td>	<b>if</b> (<a class="local col7 ref" href="#67xfrm_ctx" title='xfrm_ctx' data-ref="67xfrm_ctx" data-ref-filename="67xfrm_ctx">xfrm_ctx</a>) {</td></tr>
<tr><th id="466">466</th><td>		<a class="local col8 ref" href="#68len" title='len' data-ref="68len" data-ref-filename="68len">len</a> += <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a>);</td></tr>
<tr><th id="467">467</th><td>		<a class="local col8 ref" href="#68len" title='len' data-ref="68len" data-ref-filename="68len">len</a> += <a class="local col7 ref" href="#67xfrm_ctx" title='xfrm_ctx' data-ref="67xfrm_ctx" data-ref-filename="67xfrm_ctx">xfrm_ctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_len" title='xfrm_sec_ctx::ctx_len' data-ref="xfrm_sec_ctx::ctx_len" data-ref-filename="xfrm_sec_ctx..ctx_len">ctx_len</a>;</td></tr>
<tr><th id="468">468</th><td>	}</td></tr>
<tr><th id="469">469</th><td>	<b>return</b> <a class="local col8 ref" href="#68len" title='len' data-ref="68len" data-ref-filename="68len">len</a>;</td></tr>
<tr><th id="470">470</th><td>}</td></tr>
<tr><th id="471">471</th><td></td></tr>
<tr><th id="472">472</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="copy_from_user_state" title='copy_from_user_state' data-type='void copy_from_user_state(struct xfrm_state * x, struct xfrm_usersa_info * p)' data-ref="copy_from_user_state" data-ref-filename="copy_from_user_state">copy_from_user_state</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col9 decl" id="69x" title='x' data-type='struct xfrm_state *' data-ref="69x" data-ref-filename="69x">x</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col0 decl" id="70p" title='p' data-type='struct xfrm_usersa_info *' data-ref="70p" data-ref-filename="70p">p</dfn>)</td></tr>
<tr><th id="473">473</th><td>{</td></tr>
<tr><th id="474">474</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(x-&gt;id)); void *__ret; if (__builtin_constant_p(sizeof(x-&gt;id)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;id), (&amp;p-&gt;id), __len); else __ret = __builtin_memcpy((&amp;x-&gt;id), (&amp;p-&gt;id), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>, &amp;<a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>, <b>sizeof</b>(<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>));</td></tr>
<tr><th id="475">475</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(x-&gt;sel)); void *__ret; if (__builtin_constant_p(sizeof(x-&gt;sel)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;sel), (&amp;p-&gt;sel), __len); else __ret = __builtin_memcpy((&amp;x-&gt;sel), (&amp;p-&gt;sel), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::sel" title='xfrm_state::sel' data-ref="xfrm_state::sel" data-ref-filename="xfrm_state..sel">sel</a>, &amp;<a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::sel" title='xfrm_usersa_info::sel' data-ref="xfrm_usersa_info::sel" data-ref-filename="xfrm_usersa_info..sel">sel</a>, <b>sizeof</b>(<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::sel" title='xfrm_state::sel' data-ref="xfrm_state::sel" data-ref-filename="xfrm_state..sel">sel</a>));</td></tr>
<tr><th id="476">476</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(x-&gt;lft)); void *__ret; if (__builtin_constant_p(sizeof(x-&gt;lft)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;lft), (&amp;p-&gt;lft), __len); else __ret = __builtin_memcpy((&amp;x-&gt;lft), (&amp;p-&gt;lft), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lft" title='xfrm_state::lft' data-ref="xfrm_state::lft" data-ref-filename="xfrm_state..lft">lft</a>, &amp;<a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::lft" title='xfrm_usersa_info::lft' data-ref="xfrm_usersa_info::lft" data-ref-filename="xfrm_usersa_info..lft">lft</a>, <b>sizeof</b>(<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lft" title='xfrm_state::lft' data-ref="xfrm_state::lft" data-ref-filename="xfrm_state..lft">lft</a>));</td></tr>
<tr><th id="477">477</th><td>	<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::mode" title='xfrm_state::(anonymous struct)::mode' data-ref="xfrm_state::(anonymous)::mode" data-ref-filename="xfrm_state..(anonymous)..mode">mode</a> = <a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::mode" title='xfrm_usersa_info::mode' data-ref="xfrm_usersa_info::mode" data-ref-filename="xfrm_usersa_info..mode">mode</a>;</td></tr>
<tr><th id="478">478</th><td>	<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::replay_window" title='xfrm_state::(anonymous struct)::replay_window' data-ref="xfrm_state::(anonymous)::replay_window" data-ref-filename="xfrm_state..(anonymous)..replay_window">replay_window</a> = <a class="macro" href="../../include/linux/kernel.h.html#871" title="({ unsigned int __UNIQUE_ID_min1_130 = (p-&gt;replay_window); unsigned int __UNIQUE_ID_min2_131 = (sizeof(x-&gt;replay.bitmap) * 8); (void) (&amp;__UNIQUE_ID_min1_130 == &amp;__UNIQUE_ID_min2_131); __UNIQUE_ID_min1_130 &lt; __UNIQUE_ID_min2_131 ? __UNIQUE_ID_min1_130 : __UNIQUE_ID_min2_131; })" data-ref="_M/min_t">min_t</a>(<em>unsigned</em> <em>int</em>, <a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::replay_window" title='xfrm_usersa_info::replay_window' data-ref="xfrm_usersa_info::replay_window" data-ref-filename="xfrm_usersa_info..replay_window">replay_window</a>,</td></tr>
<tr><th id="479">479</th><td>					<b>sizeof</b>(<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay" title='xfrm_state::replay' data-ref="xfrm_state::replay" data-ref-filename="xfrm_state..replay">replay</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state::bitmap" title='xfrm_replay_state::bitmap' data-ref="xfrm_replay_state::bitmap" data-ref-filename="xfrm_replay_state..bitmap">bitmap</a>) * <var>8</var>);</td></tr>
<tr><th id="480">480</th><td>	<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::reqid" title='xfrm_state::(anonymous struct)::reqid' data-ref="xfrm_state::(anonymous)::reqid" data-ref-filename="xfrm_state..(anonymous)..reqid">reqid</a> = <a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::reqid" title='xfrm_usersa_info::reqid' data-ref="xfrm_usersa_info::reqid" data-ref-filename="xfrm_usersa_info..reqid">reqid</a>;</td></tr>
<tr><th id="481">481</th><td>	<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::family" title='xfrm_state::(anonymous struct)::family' data-ref="xfrm_state::(anonymous)::family" data-ref-filename="xfrm_state..(anonymous)..family">family</a> = <a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::family" title='xfrm_usersa_info::family' data-ref="xfrm_usersa_info::family" data-ref-filename="xfrm_usersa_info..family">family</a>;</td></tr>
<tr><th id="482">482</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(x-&gt;props.saddr)); void *__ret; if (__builtin_constant_p(sizeof(x-&gt;props.saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;props.saddr), (&amp;p-&gt;saddr), __len); else __ret = __builtin_memcpy((&amp;x-&gt;props.saddr), (&amp;p-&gt;saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>, &amp;<a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::saddr" title='xfrm_usersa_info::saddr' data-ref="xfrm_usersa_info::saddr" data-ref-filename="xfrm_usersa_info..saddr">saddr</a>, <b>sizeof</b>(<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>));</td></tr>
<tr><th id="483">483</th><td>	<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::flags" title='xfrm_state::(anonymous struct)::flags' data-ref="xfrm_state::(anonymous)::flags" data-ref-filename="xfrm_state..(anonymous)..flags">flags</a> = <a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::flags" title='xfrm_usersa_info::flags' data-ref="xfrm_usersa_info::flags" data-ref-filename="xfrm_usersa_info..flags">flags</a>;</td></tr>
<tr><th id="484">484</th><td></td></tr>
<tr><th id="485">485</th><td>	<b>if</b> (!<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::sel" title='xfrm_state::sel' data-ref="xfrm_state::sel" data-ref-filename="xfrm_state..sel">sel</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector::family" title='xfrm_selector::family' data-ref="xfrm_selector::family" data-ref-filename="xfrm_selector..family">family</a> &amp;&amp; !(<a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::flags" title='xfrm_usersa_info::flags' data-ref="xfrm_usersa_info::flags" data-ref-filename="xfrm_usersa_info..flags">flags</a> &amp; <a class="macro" href="../../include/uapi/linux/xfrm.h.html#381" title="32" data-ref="_M/XFRM_STATE_AF_UNSPEC">XFRM_STATE_AF_UNSPEC</a>))</td></tr>
<tr><th id="486">486</th><td>		<a class="local col9 ref" href="#69x" title='x' data-ref="69x" data-ref-filename="69x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::sel" title='xfrm_state::sel' data-ref="xfrm_state::sel" data-ref-filename="xfrm_state..sel">sel</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector::family" title='xfrm_selector::family' data-ref="xfrm_selector::family" data-ref-filename="xfrm_selector..family">family</a> = <a class="local col0 ref" href="#70p" title='p' data-ref="70p" data-ref-filename="70p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::family" title='xfrm_usersa_info::family' data-ref="xfrm_usersa_info::family" data-ref-filename="xfrm_usersa_info..family">family</a>;</td></tr>
<tr><th id="487">487</th><td>}</td></tr>
<tr><th id="488">488</th><td></td></tr>
<tr><th id="489">489</th><td><i  data-doc="xfrm_update_ae_params">/*</i></td></tr>
<tr><th id="490">490</th><td><i  data-doc="xfrm_update_ae_params"> * someday when pfkey also has support, we could have the code</i></td></tr>
<tr><th id="491">491</th><td><i  data-doc="xfrm_update_ae_params"> * somehow made shareable and move it to xfrm_state.c - JHS</i></td></tr>
<tr><th id="492">492</th><td><i  data-doc="xfrm_update_ae_params"> *</i></td></tr>
<tr><th id="493">493</th><td><i  data-doc="xfrm_update_ae_params">*/</i></td></tr>
<tr><th id="494">494</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="xfrm_update_ae_params" title='xfrm_update_ae_params' data-type='void xfrm_update_ae_params(struct xfrm_state * x, struct nlattr ** attrs, int update_esn)' data-ref="xfrm_update_ae_params" data-ref-filename="xfrm_update_ae_params">xfrm_update_ae_params</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="71x" title='x' data-type='struct xfrm_state *' data-ref="71x" data-ref-filename="71x">x</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col2 decl" id="72attrs" title='attrs' data-type='struct nlattr **' data-ref="72attrs" data-ref-filename="72attrs">attrs</dfn>,</td></tr>
<tr><th id="495">495</th><td>				  <em>int</em> <dfn class="local col3 decl" id="73update_esn" title='update_esn' data-type='int' data-ref="73update_esn" data-ref-filename="73update_esn">update_esn</dfn>)</td></tr>
<tr><th id="496">496</th><td>{</td></tr>
<tr><th id="497">497</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col4 decl" id="74rp" title='rp' data-type='struct nlattr *' data-ref="74rp" data-ref-filename="74rp">rp</dfn> = <a class="local col2 ref" href="#72attrs" title='attrs' data-ref="72attrs" data-ref-filename="72attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_VAL" title='XFRMA_REPLAY_VAL' data-ref="XFRMA_REPLAY_VAL" data-ref-filename="XFRMA_REPLAY_VAL">XFRMA_REPLAY_VAL</a>];</td></tr>
<tr><th id="498">498</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col5 decl" id="75re" title='re' data-type='struct nlattr *' data-ref="75re" data-ref-filename="75re">re</dfn> = <a class="local col3 ref" href="#73update_esn" title='update_esn' data-ref="73update_esn" data-ref-filename="73update_esn">update_esn</a> ? <a class="local col2 ref" href="#72attrs" title='attrs' data-ref="72attrs" data-ref-filename="72attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_ESN_VAL" title='XFRMA_REPLAY_ESN_VAL' data-ref="XFRMA_REPLAY_ESN_VAL" data-ref-filename="XFRMA_REPLAY_ESN_VAL">XFRMA_REPLAY_ESN_VAL</a>] : <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="499">499</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col6 decl" id="76lt" title='lt' data-type='struct nlattr *' data-ref="76lt" data-ref-filename="76lt">lt</dfn> = <a class="local col2 ref" href="#72attrs" title='attrs' data-ref="72attrs" data-ref-filename="72attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_LTIME_VAL" title='XFRMA_LTIME_VAL' data-ref="XFRMA_LTIME_VAL" data-ref-filename="XFRMA_LTIME_VAL">XFRMA_LTIME_VAL</a>];</td></tr>
<tr><th id="500">500</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col7 decl" id="77et" title='et' data-type='struct nlattr *' data-ref="77et" data-ref-filename="77et">et</dfn> = <a class="local col2 ref" href="#72attrs" title='attrs' data-ref="72attrs" data-ref-filename="72attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ETIMER_THRESH" title='XFRMA_ETIMER_THRESH' data-ref="XFRMA_ETIMER_THRESH" data-ref-filename="XFRMA_ETIMER_THRESH">XFRMA_ETIMER_THRESH</a>];</td></tr>
<tr><th id="501">501</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col8 decl" id="78rt" title='rt' data-type='struct nlattr *' data-ref="78rt" data-ref-filename="78rt">rt</dfn> = <a class="local col2 ref" href="#72attrs" title='attrs' data-ref="72attrs" data-ref-filename="72attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_THRESH" title='XFRMA_REPLAY_THRESH' data-ref="XFRMA_REPLAY_THRESH" data-ref-filename="XFRMA_REPLAY_THRESH">XFRMA_REPLAY_THRESH</a>];</td></tr>
<tr><th id="502">502</th><td></td></tr>
<tr><th id="503">503</th><td>	<b>if</b> (<a class="local col5 ref" href="#75re" title='re' data-ref="75re" data-ref-filename="75re">re</a>) {</td></tr>
<tr><th id="504">504</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a> *<dfn class="local col9 decl" id="79replay_esn" title='replay_esn' data-type='struct xfrm_replay_state_esn *' data-ref="79replay_esn" data-ref-filename="79replay_esn">replay_esn</dfn>;</td></tr>
<tr><th id="505">505</th><td>		<a class="local col9 ref" href="#79replay_esn" title='replay_esn' data-ref="79replay_esn" data-ref-filename="79replay_esn">replay_esn</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col5 ref" href="#75re" title='re' data-ref="75re" data-ref-filename="75re">re</a>);</td></tr>
<tr><th id="506">506</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (xfrm_replay_state_esn_len(replay_esn)); void *__ret; if (__builtin_constant_p(xfrm_replay_state_esn_len(replay_esn)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((x-&gt;replay_esn), (replay_esn), __len); else __ret = __builtin_memcpy((x-&gt;replay_esn), (replay_esn), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>, <a class="local col9 ref" href="#79replay_esn" title='replay_esn' data-ref="79replay_esn" data-ref-filename="79replay_esn">replay_esn</a>,</td></tr>
<tr><th id="507">507</th><td>		       <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col9 ref" href="#79replay_esn" title='replay_esn' data-ref="79replay_esn" data-ref-filename="79replay_esn">replay_esn</a>));</td></tr>
<tr><th id="508">508</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (xfrm_replay_state_esn_len(replay_esn)); void *__ret; if (__builtin_constant_p(xfrm_replay_state_esn_len(replay_esn)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((x-&gt;preplay_esn), (replay_esn), __len); else __ret = __builtin_memcpy((x-&gt;preplay_esn), (replay_esn), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::preplay_esn" title='xfrm_state::preplay_esn' data-ref="xfrm_state::preplay_esn" data-ref-filename="xfrm_state..preplay_esn">preplay_esn</a>, <a class="local col9 ref" href="#79replay_esn" title='replay_esn' data-ref="79replay_esn" data-ref-filename="79replay_esn">replay_esn</a>,</td></tr>
<tr><th id="509">509</th><td>		       <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col9 ref" href="#79replay_esn" title='replay_esn' data-ref="79replay_esn" data-ref-filename="79replay_esn">replay_esn</a>));</td></tr>
<tr><th id="510">510</th><td>	}</td></tr>
<tr><th id="511">511</th><td></td></tr>
<tr><th id="512">512</th><td>	<b>if</b> (<a class="local col4 ref" href="#74rp" title='rp' data-ref="74rp" data-ref-filename="74rp">rp</a>) {</td></tr>
<tr><th id="513">513</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state" title='xfrm_replay_state' data-ref="xfrm_replay_state" data-ref-filename="xfrm_replay_state">xfrm_replay_state</a> *<dfn class="local col0 decl" id="80replay" title='replay' data-type='struct xfrm_replay_state *' data-ref="80replay" data-ref-filename="80replay">replay</dfn>;</td></tr>
<tr><th id="514">514</th><td>		<a class="local col0 ref" href="#80replay" title='replay' data-ref="80replay" data-ref-filename="80replay">replay</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#74rp" title='rp' data-ref="74rp" data-ref-filename="74rp">rp</a>);</td></tr>
<tr><th id="515">515</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(*replay)); void *__ret; if (__builtin_constant_p(sizeof(*replay)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;replay), (replay), __len); else __ret = __builtin_memcpy((&amp;x-&gt;replay), (replay), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay" title='xfrm_state::replay' data-ref="xfrm_state::replay" data-ref-filename="xfrm_state..replay">replay</a>, <a class="local col0 ref" href="#80replay" title='replay' data-ref="80replay" data-ref-filename="80replay">replay</a>, <b>sizeof</b>(*<a class="local col0 ref" href="#80replay" title='replay' data-ref="80replay" data-ref-filename="80replay">replay</a>));</td></tr>
<tr><th id="516">516</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(*replay)); void *__ret; if (__builtin_constant_p(sizeof(*replay)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;preplay), (replay), __len); else __ret = __builtin_memcpy((&amp;x-&gt;preplay), (replay), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::preplay" title='xfrm_state::preplay' data-ref="xfrm_state::preplay" data-ref-filename="xfrm_state..preplay">preplay</a>, <a class="local col0 ref" href="#80replay" title='replay' data-ref="80replay" data-ref-filename="80replay">replay</a>, <b>sizeof</b>(*<a class="local col0 ref" href="#80replay" title='replay' data-ref="80replay" data-ref-filename="80replay">replay</a>));</td></tr>
<tr><th id="517">517</th><td>	}</td></tr>
<tr><th id="518">518</th><td></td></tr>
<tr><th id="519">519</th><td>	<b>if</b> (<a class="local col6 ref" href="#76lt" title='lt' data-ref="76lt" data-ref-filename="76lt">lt</a>) {</td></tr>
<tr><th id="520">520</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur" title='xfrm_lifetime_cur' data-ref="xfrm_lifetime_cur" data-ref-filename="xfrm_lifetime_cur">xfrm_lifetime_cur</a> *<dfn class="local col1 decl" id="81ltime" title='ltime' data-type='struct xfrm_lifetime_cur *' data-ref="81ltime" data-ref-filename="81ltime">ltime</dfn>;</td></tr>
<tr><th id="521">521</th><td>		<a class="local col1 ref" href="#81ltime" title='ltime' data-ref="81ltime" data-ref-filename="81ltime">ltime</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col6 ref" href="#76lt" title='lt' data-ref="76lt" data-ref-filename="76lt">lt</a>);</td></tr>
<tr><th id="522">522</th><td>		<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::curlft" title='xfrm_state::curlft' data-ref="xfrm_state::curlft" data-ref-filename="xfrm_state..curlft">curlft</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::bytes" title='xfrm_lifetime_cur::bytes' data-ref="xfrm_lifetime_cur::bytes" data-ref-filename="xfrm_lifetime_cur..bytes">bytes</a> = <a class="local col1 ref" href="#81ltime" title='ltime' data-ref="81ltime" data-ref-filename="81ltime">ltime</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::bytes" title='xfrm_lifetime_cur::bytes' data-ref="xfrm_lifetime_cur::bytes" data-ref-filename="xfrm_lifetime_cur..bytes">bytes</a>;</td></tr>
<tr><th id="523">523</th><td>		<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::curlft" title='xfrm_state::curlft' data-ref="xfrm_state::curlft" data-ref-filename="xfrm_state..curlft">curlft</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::packets" title='xfrm_lifetime_cur::packets' data-ref="xfrm_lifetime_cur::packets" data-ref-filename="xfrm_lifetime_cur..packets">packets</a> = <a class="local col1 ref" href="#81ltime" title='ltime' data-ref="81ltime" data-ref-filename="81ltime">ltime</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::packets" title='xfrm_lifetime_cur::packets' data-ref="xfrm_lifetime_cur::packets" data-ref-filename="xfrm_lifetime_cur..packets">packets</a>;</td></tr>
<tr><th id="524">524</th><td>		<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::curlft" title='xfrm_state::curlft' data-ref="xfrm_state::curlft" data-ref-filename="xfrm_state..curlft">curlft</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::add_time" title='xfrm_lifetime_cur::add_time' data-ref="xfrm_lifetime_cur::add_time" data-ref-filename="xfrm_lifetime_cur..add_time">add_time</a> = <a class="local col1 ref" href="#81ltime" title='ltime' data-ref="81ltime" data-ref-filename="81ltime">ltime</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::add_time" title='xfrm_lifetime_cur::add_time' data-ref="xfrm_lifetime_cur::add_time" data-ref-filename="xfrm_lifetime_cur..add_time">add_time</a>;</td></tr>
<tr><th id="525">525</th><td>		<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::curlft" title='xfrm_state::curlft' data-ref="xfrm_state::curlft" data-ref-filename="xfrm_state..curlft">curlft</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::use_time" title='xfrm_lifetime_cur::use_time' data-ref="xfrm_lifetime_cur::use_time" data-ref-filename="xfrm_lifetime_cur..use_time">use_time</a> = <a class="local col1 ref" href="#81ltime" title='ltime' data-ref="81ltime" data-ref-filename="81ltime">ltime</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur::use_time" title='xfrm_lifetime_cur::use_time' data-ref="xfrm_lifetime_cur::use_time" data-ref-filename="xfrm_lifetime_cur..use_time">use_time</a>;</td></tr>
<tr><th id="526">526</th><td>	}</td></tr>
<tr><th id="527">527</th><td></td></tr>
<tr><th id="528">528</th><td>	<b>if</b> (<a class="local col7 ref" href="#77et" title='et' data-ref="77et" data-ref-filename="77et">et</a>)</td></tr>
<tr><th id="529">529</th><td>		<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_maxage" title='xfrm_state::replay_maxage' data-ref="xfrm_state::replay_maxage" data-ref-filename="xfrm_state..replay_maxage">replay_maxage</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_get_u32" title='nla_get_u32' data-ref="nla_get_u32" data-ref-filename="nla_get_u32">nla_get_u32</a>(<a class="local col7 ref" href="#77et" title='et' data-ref="77et" data-ref-filename="77et">et</a>);</td></tr>
<tr><th id="530">530</th><td></td></tr>
<tr><th id="531">531</th><td>	<b>if</b> (<a class="local col8 ref" href="#78rt" title='rt' data-ref="78rt" data-ref-filename="78rt">rt</a>)</td></tr>
<tr><th id="532">532</th><td>		<a class="local col1 ref" href="#71x" title='x' data-ref="71x" data-ref-filename="71x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_maxdiff" title='xfrm_state::replay_maxdiff' data-ref="xfrm_state::replay_maxdiff" data-ref-filename="xfrm_state..replay_maxdiff">replay_maxdiff</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_get_u32" title='nla_get_u32' data-ref="nla_get_u32" data-ref-filename="nla_get_u32">nla_get_u32</a>(<a class="local col8 ref" href="#78rt" title='rt' data-ref="78rt" data-ref-filename="78rt">rt</a>);</td></tr>
<tr><th id="533">533</th><td>}</td></tr>
<tr><th id="534">534</th><td></td></tr>
<tr><th id="535">535</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="tu decl def fn" id="xfrm_state_construct" title='xfrm_state_construct' data-type='struct xfrm_state * xfrm_state_construct(struct net * net, struct xfrm_usersa_info * p, struct nlattr ** attrs, int * errp)' data-ref="xfrm_state_construct" data-ref-filename="xfrm_state_construct">xfrm_state_construct</dfn>(<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col2 decl" id="82net" title='net' data-type='struct net *' data-ref="82net" data-ref-filename="82net">net</dfn>,</td></tr>
<tr><th id="536">536</th><td>					       <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col3 decl" id="83p" title='p' data-type='struct xfrm_usersa_info *' data-ref="83p" data-ref-filename="83p">p</dfn>,</td></tr>
<tr><th id="537">537</th><td>					       <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col4 decl" id="84attrs" title='attrs' data-type='struct nlattr **' data-ref="84attrs" data-ref-filename="84attrs">attrs</dfn>,</td></tr>
<tr><th id="538">538</th><td>					       <em>int</em> *<dfn class="local col5 decl" id="85errp" title='errp' data-type='int *' data-ref="85errp" data-ref-filename="85errp">errp</dfn>)</td></tr>
<tr><th id="539">539</th><td>{</td></tr>
<tr><th id="540">540</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col6 decl" id="86x" title='x' data-type='struct xfrm_state *' data-ref="86x" data-ref-filename="86x">x</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_alloc" title='xfrm_state_alloc' data-ref="xfrm_state_alloc" data-ref-filename="xfrm_state_alloc">xfrm_state_alloc</a>(<a class="local col2 ref" href="#82net" title='net' data-ref="82net" data-ref-filename="82net">net</a>);</td></tr>
<tr><th id="541">541</th><td>	<em>int</em> <dfn class="local col7 decl" id="87err" title='err' data-type='int' data-ref="87err" data-ref-filename="87err">err</dfn> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="542">542</th><td></td></tr>
<tr><th id="543">543</th><td>	<b>if</b> (!<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>)</td></tr>
<tr><th id="544">544</th><td>		<b>goto</b> <a class="lbl" href="#88error_no_put" data-ref="88error_no_put" data-ref-filename="88error_no_put">error_no_put</a>;</td></tr>
<tr><th id="545">545</th><td></td></tr>
<tr><th id="546">546</th><td>	<a class="tu ref fn" href="#copy_from_user_state" title='copy_from_user_state' data-use='c' data-ref="copy_from_user_state" data-ref-filename="copy_from_user_state">copy_from_user_state</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>, <a class="local col3 ref" href="#83p" title='p' data-ref="83p" data-ref-filename="83p">p</a>);</td></tr>
<tr><th id="547">547</th><td></td></tr>
<tr><th id="548">548</th><td>	<b>if</b> (<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SA_EXTRA_FLAGS" title='XFRMA_SA_EXTRA_FLAGS' data-ref="XFRMA_SA_EXTRA_FLAGS" data-ref-filename="XFRMA_SA_EXTRA_FLAGS">XFRMA_SA_EXTRA_FLAGS</a>])</td></tr>
<tr><th id="549">549</th><td>		<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::extra_flags" title='xfrm_state::(anonymous struct)::extra_flags' data-ref="xfrm_state::(anonymous)::extra_flags" data-ref-filename="xfrm_state..(anonymous)..extra_flags">extra_flags</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_get_u32" title='nla_get_u32' data-ref="nla_get_u32" data-ref-filename="nla_get_u32">nla_get_u32</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SA_EXTRA_FLAGS" title='XFRMA_SA_EXTRA_FLAGS' data-ref="XFRMA_SA_EXTRA_FLAGS" data-ref-filename="XFRMA_SA_EXTRA_FLAGS">XFRMA_SA_EXTRA_FLAGS</a>]);</td></tr>
<tr><th id="550">550</th><td></td></tr>
<tr><th id="551">551</th><td>	<b>if</b> ((<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="tu ref fn" href="#attach_aead" title='attach_aead' data-use='c' data-ref="attach_aead" data-ref-filename="attach_aead">attach_aead</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>, <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>])))</td></tr>
<tr><th id="552">552</th><td>		<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="553">553</th><td>	<b>if</b> ((<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="tu ref fn" href="#attach_auth_trunc" title='attach_auth_trunc' data-use='c' data-ref="attach_auth_trunc" data-ref-filename="attach_auth_trunc">attach_auth_trunc</a>(&amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>, &amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::aalgo" title='xfrm_state::(anonymous struct)::aalgo' data-ref="xfrm_state::(anonymous)::aalgo" data-ref-filename="xfrm_state..(anonymous)..aalgo">aalgo</a>,</td></tr>
<tr><th id="554">554</th><td>				     <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>])))</td></tr>
<tr><th id="555">555</th><td>		<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="556">556</th><td>	<b>if</b> (!<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::aalgo" title='xfrm_state::(anonymous struct)::aalgo' data-ref="xfrm_state::(anonymous)::aalgo" data-ref-filename="xfrm_state..(anonymous)..aalgo">aalgo</a>) {</td></tr>
<tr><th id="557">557</th><td>		<b>if</b> ((<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="tu ref fn" href="#attach_auth" title='attach_auth' data-use='c' data-ref="attach_auth" data-ref-filename="attach_auth">attach_auth</a>(&amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>, &amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::aalgo" title='xfrm_state::(anonymous struct)::aalgo' data-ref="xfrm_state::(anonymous)::aalgo" data-ref-filename="xfrm_state..(anonymous)..aalgo">aalgo</a>,</td></tr>
<tr><th id="558">558</th><td>				       <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>])))</td></tr>
<tr><th id="559">559</th><td>			<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="560">560</th><td>	}</td></tr>
<tr><th id="561">561</th><td>	<b>if</b> ((<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="tu ref fn" href="#attach_crypt" title='attach_crypt' data-use='c' data-ref="attach_crypt" data-ref-filename="attach_crypt">attach_crypt</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>, <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>])))</td></tr>
<tr><th id="562">562</th><td>		<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="563">563</th><td>	<b>if</b> ((<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="tu ref fn" href="#attach_one_algo" title='attach_one_algo' data-use='c' data-ref="attach_one_algo" data-ref-filename="attach_one_algo">attach_one_algo</a>(&amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::calg" title='xfrm_state::calg' data-ref="xfrm_state::calg" data-ref-filename="xfrm_state..calg">calg</a>, &amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::calgo" title='xfrm_state::(anonymous struct)::calgo' data-ref="xfrm_state::(anonymous)::calgo" data-ref-filename="xfrm_state..(anonymous)..calgo">calgo</a>,</td></tr>
<tr><th id="564">564</th><td>				   <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_calg_get_byname" title='xfrm_calg_get_byname' data-ref="xfrm_calg_get_byname" data-ref-filename="xfrm_calg_get_byname">xfrm_calg_get_byname</a>,</td></tr>
<tr><th id="565">565</th><td>				   <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>])))</td></tr>
<tr><th id="566">566</th><td>		<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="567">567</th><td></td></tr>
<tr><th id="568">568</th><td>	<b>if</b> (<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ENCAP" title='XFRMA_ENCAP' data-ref="XFRMA_ENCAP" data-ref-filename="XFRMA_ENCAP">XFRMA_ENCAP</a>]) {</td></tr>
<tr><th id="569">569</th><td>		<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a> = <a class="ref fn" href="../../include/linux/string.h.html#kmemdup" title='kmemdup' data-ref="kmemdup" data-ref-filename="kmemdup">kmemdup</a>(<a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ENCAP" title='XFRMA_ENCAP' data-ref="XFRMA_ENCAP" data-ref-filename="XFRMA_ENCAP">XFRMA_ENCAP</a>]),</td></tr>
<tr><th id="570">570</th><td>				   <b>sizeof</b>(*<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>), <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="571">571</th><td>		<b>if</b> (<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="572">572</th><td>			<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="573">573</th><td>	}</td></tr>
<tr><th id="574">574</th><td></td></tr>
<tr><th id="575">575</th><td>	<b>if</b> (<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>])</td></tr>
<tr><th id="576">576</th><td>		<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::tfcpad" title='xfrm_state::tfcpad' data-ref="xfrm_state::tfcpad" data-ref-filename="xfrm_state..tfcpad">tfcpad</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_get_u32" title='nla_get_u32' data-ref="nla_get_u32" data-ref-filename="nla_get_u32">nla_get_u32</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>]);</td></tr>
<tr><th id="577">577</th><td></td></tr>
<tr><th id="578">578</th><td>	<b>if</b> (<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_COADDR" title='XFRMA_COADDR' data-ref="XFRMA_COADDR" data-ref-filename="XFRMA_COADDR">XFRMA_COADDR</a>]) {</td></tr>
<tr><th id="579">579</th><td>		<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a> = <a class="ref fn" href="../../include/linux/string.h.html#kmemdup" title='kmemdup' data-ref="kmemdup" data-ref-filename="kmemdup">kmemdup</a>(<a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_COADDR" title='XFRMA_COADDR' data-ref="XFRMA_COADDR" data-ref-filename="XFRMA_COADDR">XFRMA_COADDR</a>]),</td></tr>
<tr><th id="580">580</th><td>				    <b>sizeof</b>(*<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a>), <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="581">581</th><td>		<b>if</b> (<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="582">582</th><td>			<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="583">583</th><td>	}</td></tr>
<tr><th id="584">584</th><td></td></tr>
<tr><th id="585">585</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>, &amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::mark" title='xfrm_state::mark' data-ref="xfrm_state::mark" data-ref-filename="xfrm_state..mark">mark</a>);</td></tr>
<tr><th id="586">586</th><td></td></tr>
<tr><th id="587">587</th><td>	<b>if</b> (<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OUTPUT_MARK" title='XFRMA_OUTPUT_MARK' data-ref="XFRMA_OUTPUT_MARK" data-ref-filename="XFRMA_OUTPUT_MARK">XFRMA_OUTPUT_MARK</a>])</td></tr>
<tr><th id="588">588</th><td>		<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::output_mark" title='xfrm_state::(anonymous struct)::output_mark' data-ref="xfrm_state::(anonymous)::output_mark" data-ref-filename="xfrm_state..(anonymous)..output_mark">output_mark</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_get_u32" title='nla_get_u32' data-ref="nla_get_u32" data-ref-filename="nla_get_u32">nla_get_u32</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OUTPUT_MARK" title='XFRMA_OUTPUT_MARK' data-ref="XFRMA_OUTPUT_MARK" data-ref-filename="XFRMA_OUTPUT_MARK">XFRMA_OUTPUT_MARK</a>]);</td></tr>
<tr><th id="589">589</th><td></td></tr>
<tr><th id="590">590</th><td>	<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#__xfrm_init_state" title='__xfrm_init_state' data-ref="__xfrm_init_state" data-ref-filename="__xfrm_init_state">__xfrm_init_state</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>, <a class="enum" href="../../include/linux/stddef.h.html#false" title='false' data-ref="false" data-ref-filename="false">false</a>, <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OFFLOAD_DEV" title='XFRMA_OFFLOAD_DEV' data-ref="XFRMA_OFFLOAD_DEV" data-ref-filename="XFRMA_OFFLOAD_DEV">XFRMA_OFFLOAD_DEV</a>]);</td></tr>
<tr><th id="591">591</th><td>	<b>if</b> (<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a>)</td></tr>
<tr><th id="592">592</th><td>		<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="593">593</th><td></td></tr>
<tr><th id="594">594</th><td>	<b>if</b> (<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>]) {</td></tr>
<tr><th id="595">595</th><td>		<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_state_alloc" title='security_xfrm_state_alloc' data-ref="security_xfrm_state_alloc" data-ref-filename="security_xfrm_state_alloc">security_xfrm_state_alloc</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>,</td></tr>
<tr><th id="596">596</th><td>						<a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>]));</td></tr>
<tr><th id="597">597</th><td>		<b>if</b> (<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a>)</td></tr>
<tr><th id="598">598</th><td>			<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="599">599</th><td>	}</td></tr>
<tr><th id="600">600</th><td></td></tr>
<tr><th id="601">601</th><td>	<b>if</b> ((<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="tu ref fn" href="#xfrm_alloc_replay_state_esn" title='xfrm_alloc_replay_state_esn' data-use='c' data-ref="xfrm_alloc_replay_state_esn" data-ref-filename="xfrm_alloc_replay_state_esn">xfrm_alloc_replay_state_esn</a>(&amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>, &amp;<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::preplay_esn" title='xfrm_state::preplay_esn' data-ref="xfrm_state::preplay_esn" data-ref-filename="xfrm_state..preplay_esn">preplay_esn</a>,</td></tr>
<tr><th id="602">602</th><td>					       <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_ESN_VAL" title='XFRMA_REPLAY_ESN_VAL' data-ref="XFRMA_REPLAY_ESN_VAL" data-ref-filename="XFRMA_REPLAY_ESN_VAL">XFRMA_REPLAY_ESN_VAL</a>])))</td></tr>
<tr><th id="603">603</th><td>		<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="604">604</th><td></td></tr>
<tr><th id="605">605</th><td>	<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::seq" title='xfrm_state_walk::seq' data-ref="xfrm_state_walk::seq" data-ref-filename="xfrm_state_walk..seq">seq</a> = <a class="local col3 ref" href="#83p" title='p' data-ref="83p" data-ref-filename="83p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::seq" title='xfrm_usersa_info::seq' data-ref="xfrm_usersa_info::seq" data-ref-filename="xfrm_usersa_info..seq">seq</a>;</td></tr>
<tr><th id="606">606</th><td>	<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_maxdiff" title='xfrm_state::replay_maxdiff' data-ref="xfrm_state::replay_maxdiff" data-ref-filename="xfrm_state..replay_maxdiff">replay_maxdiff</a> = <a class="local col2 ref" href="#82net" title='net' data-ref="82net" data-ref-filename="82net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::sysctl_aevent_rseqth" title='netns_xfrm::sysctl_aevent_rseqth' data-ref="netns_xfrm::sysctl_aevent_rseqth" data-ref-filename="netns_xfrm..sysctl_aevent_rseqth">sysctl_aevent_rseqth</a>;</td></tr>
<tr><th id="607">607</th><td>	<i>/* sysctl_xfrm_aevent_etime is in 100ms units */</i></td></tr>
<tr><th id="608">608</th><td>	<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_maxage" title='xfrm_state::replay_maxage' data-ref="xfrm_state::replay_maxage" data-ref-filename="xfrm_state..replay_maxage">replay_maxage</a> = (<a class="local col2 ref" href="#82net" title='net' data-ref="82net" data-ref-filename="82net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::sysctl_aevent_etime" title='netns_xfrm::sysctl_aevent_etime' data-ref="netns_xfrm::sysctl_aevent_etime" data-ref-filename="netns_xfrm..sysctl_aevent_etime">sysctl_aevent_etime</a>*<a class="macro" href="../../include/asm-generic/param.h.html#8" title="1000" data-ref="_M/HZ">HZ</a>)/<a class="macro" href="../../include/net/xfrm.h.html#625" title="10" data-ref="_M/XFRM_AE_ETH_M">XFRM_AE_ETH_M</a>;</td></tr>
<tr><th id="609">609</th><td></td></tr>
<tr><th id="610">610</th><td>	<b>if</b> ((<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_init_replay" title='xfrm_init_replay' data-ref="xfrm_init_replay" data-ref-filename="xfrm_init_replay">xfrm_init_replay</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>)))</td></tr>
<tr><th id="611">611</th><td>		<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="612">612</th><td></td></tr>
<tr><th id="613">613</th><td>	<i>/* override default values from above */</i></td></tr>
<tr><th id="614">614</th><td>	<a class="tu ref fn" href="#xfrm_update_ae_params" title='xfrm_update_ae_params' data-use='c' data-ref="xfrm_update_ae_params" data-ref-filename="xfrm_update_ae_params">xfrm_update_ae_params</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>, <a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>, <var>0</var>);</td></tr>
<tr><th id="615">615</th><td></td></tr>
<tr><th id="616">616</th><td>	<i>/* configure the hardware if offload is requested */</i></td></tr>
<tr><th id="617">617</th><td>	<b>if</b> (<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OFFLOAD_DEV" title='XFRMA_OFFLOAD_DEV' data-ref="XFRMA_OFFLOAD_DEV" data-ref-filename="XFRMA_OFFLOAD_DEV">XFRMA_OFFLOAD_DEV</a>]) {</td></tr>
<tr><th id="618">618</th><td>		<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_dev_state_add" title='xfrm_dev_state_add' data-ref="xfrm_dev_state_add" data-ref-filename="xfrm_dev_state_add">xfrm_dev_state_add</a>(<a class="local col2 ref" href="#82net" title='net' data-ref="82net" data-ref-filename="82net">net</a>, <a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>,</td></tr>
<tr><th id="619">619</th><td>					 <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#84attrs" title='attrs' data-ref="84attrs" data-ref-filename="84attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OFFLOAD_DEV" title='XFRMA_OFFLOAD_DEV' data-ref="XFRMA_OFFLOAD_DEV" data-ref-filename="XFRMA_OFFLOAD_DEV">XFRMA_OFFLOAD_DEV</a>]));</td></tr>
<tr><th id="620">620</th><td>		<b>if</b> (<a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a>)</td></tr>
<tr><th id="621">621</th><td>			<b>goto</b> <a class="lbl" href="#89error" data-ref="89error" data-ref-filename="89error">error</a>;</td></tr>
<tr><th id="622">622</th><td>	}</td></tr>
<tr><th id="623">623</th><td></td></tr>
<tr><th id="624">624</th><td>	<b>return</b> <a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>;</td></tr>
<tr><th id="625">625</th><td></td></tr>
<tr><th id="626">626</th><td><dfn class="lbl" id="89error" data-ref="89error" data-ref-filename="89error">error</dfn>:</td></tr>
<tr><th id="627">627</th><td>	<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::state" title='xfrm_state_walk::state' data-ref="xfrm_state_walk::state" data-ref-filename="xfrm_state_walk..state">state</a> = <a class="enum" href="../../include/net/xfrm.h.html#XFRM_STATE_DEAD" title='XFRM_STATE_DEAD' data-ref="XFRM_STATE_DEAD" data-ref-filename="XFRM_STATE_DEAD">XFRM_STATE_DEAD</a>;</td></tr>
<tr><th id="628">628</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col6 ref" href="#86x" title='x' data-ref="86x" data-ref-filename="86x">x</a>);</td></tr>
<tr><th id="629">629</th><td><dfn class="lbl" id="88error_no_put" data-ref="88error_no_put" data-ref-filename="88error_no_put">error_no_put</dfn>:</td></tr>
<tr><th id="630">630</th><td>	*<a class="local col5 ref" href="#85errp" title='errp' data-ref="85errp" data-ref-filename="85errp">errp</a> = <a class="local col7 ref" href="#87err" title='err' data-ref="87err" data-ref-filename="87err">err</a>;</td></tr>
<tr><th id="631">631</th><td>	<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="632">632</th><td>}</td></tr>
<tr><th id="633">633</th><td></td></tr>
<tr><th id="634">634</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_add_sa" title='xfrm_add_sa' data-type='int xfrm_add_sa(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_add_sa" data-ref-filename="xfrm_add_sa">xfrm_add_sa</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col0 decl" id="90skb" title='skb' data-type='struct sk_buff *' data-ref="90skb" data-ref-filename="90skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col1 decl" id="91nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="91nlh" data-ref-filename="91nlh">nlh</dfn>,</td></tr>
<tr><th id="635">635</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col2 decl" id="92attrs" title='attrs' data-type='struct nlattr **' data-ref="92attrs" data-ref-filename="92attrs">attrs</dfn>)</td></tr>
<tr><th id="636">636</th><td>{</td></tr>
<tr><th id="637">637</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col3 decl" id="93net" title='net' data-type='struct net *' data-ref="93net" data-ref-filename="93net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col0 ref" href="#90skb" title='skb' data-ref="90skb" data-ref-filename="90skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="638">638</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col4 decl" id="94p" title='p' data-type='struct xfrm_usersa_info *' data-ref="94p" data-ref-filename="94p">p</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col1 ref" href="#91nlh" title='nlh' data-ref="91nlh" data-ref-filename="91nlh">nlh</a>);</td></tr>
<tr><th id="639">639</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col5 decl" id="95x" title='x' data-type='struct xfrm_state *' data-ref="95x" data-ref-filename="95x">x</dfn>;</td></tr>
<tr><th id="640">640</th><td>	<em>int</em> <dfn class="local col6 decl" id="96err" title='err' data-type='int' data-ref="96err" data-ref-filename="96err">err</dfn>;</td></tr>
<tr><th id="641">641</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col7 decl" id="97c" title='c' data-type='struct km_event' data-ref="97c" data-ref-filename="97c">c</dfn>;</td></tr>
<tr><th id="642">642</th><td></td></tr>
<tr><th id="643">643</th><td>	<a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a> = <a class="tu ref fn" href="#verify_newsa_info" title='verify_newsa_info' data-use='c' data-ref="verify_newsa_info" data-ref-filename="verify_newsa_info">verify_newsa_info</a>(<a class="local col4 ref" href="#94p" title='p' data-ref="94p" data-ref-filename="94p">p</a>, <a class="local col2 ref" href="#92attrs" title='attrs' data-ref="92attrs" data-ref-filename="92attrs">attrs</a>);</td></tr>
<tr><th id="644">644</th><td>	<b>if</b> (<a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a>)</td></tr>
<tr><th id="645">645</th><td>		<b>return</b> <a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a>;</td></tr>
<tr><th id="646">646</th><td></td></tr>
<tr><th id="647">647</th><td>	<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a> = <a class="tu ref fn" href="#xfrm_state_construct" title='xfrm_state_construct' data-use='c' data-ref="xfrm_state_construct" data-ref-filename="xfrm_state_construct">xfrm_state_construct</a>(<a class="local col3 ref" href="#93net" title='net' data-ref="93net" data-ref-filename="93net">net</a>, <a class="local col4 ref" href="#94p" title='p' data-ref="94p" data-ref-filename="94p">p</a>, <a class="local col2 ref" href="#92attrs" title='attrs' data-ref="92attrs" data-ref-filename="92attrs">attrs</a>, &amp;<a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a>);</td></tr>
<tr><th id="648">648</th><td>	<b>if</b> (!<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>)</td></tr>
<tr><th id="649">649</th><td>		<b>return</b> <a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a>;</td></tr>
<tr><th id="650">650</th><td></td></tr>
<tr><th id="651">651</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_hold" title='xfrm_state_hold' data-ref="xfrm_state_hold" data-ref-filename="xfrm_state_hold">xfrm_state_hold</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>);</td></tr>
<tr><th id="652">652</th><td>	<b>if</b> (<a class="local col1 ref" href="#91nlh" title='nlh' data-ref="91nlh" data-ref-filename="91nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#162" title="XFRM_MSG_NEWSA" data-ref="_M/XFRM_MSG_NEWSA">XFRM_MSG_NEWSA</a>)</td></tr>
<tr><th id="653">653</th><td>		<a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_add" title='xfrm_state_add' data-ref="xfrm_state_add" data-ref-filename="xfrm_state_add">xfrm_state_add</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>);</td></tr>
<tr><th id="654">654</th><td>	<b>else</b></td></tr>
<tr><th id="655">655</th><td>		<a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_update" title='xfrm_state_update' data-ref="xfrm_state_update" data-ref-filename="xfrm_state_update">xfrm_state_update</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>);</td></tr>
<tr><th id="656">656</th><td></td></tr>
<tr><th id="657">657</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_audit_state_add" title='xfrm_audit_state_add' data-ref="xfrm_audit_state_add" data-ref-filename="xfrm_audit_state_add">xfrm_audit_state_add</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>, <a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a> ? <var>0</var> : <var>1</var>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="658">658</th><td></td></tr>
<tr><th id="659">659</th><td>	<b>if</b> (<a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a> &lt; <var>0</var>) {</td></tr>
<tr><th id="660">660</th><td>		<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::state" title='xfrm_state_walk::state' data-ref="xfrm_state_walk::state" data-ref-filename="xfrm_state_walk..state">state</a> = <a class="enum" href="../../include/net/xfrm.h.html#XFRM_STATE_DEAD" title='XFRM_STATE_DEAD' data-ref="XFRM_STATE_DEAD" data-ref-filename="XFRM_STATE_DEAD">XFRM_STATE_DEAD</a>;</td></tr>
<tr><th id="661">661</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_dev_state_delete" title='xfrm_dev_state_delete' data-ref="xfrm_dev_state_delete" data-ref-filename="xfrm_dev_state_delete">xfrm_dev_state_delete</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>);</td></tr>
<tr><th id="662">662</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#__xfrm_state_put" title='__xfrm_state_put' data-ref="__xfrm_state_put" data-ref-filename="__xfrm_state_put">__xfrm_state_put</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>);</td></tr>
<tr><th id="663">663</th><td>		<b>goto</b> <a class="lbl" href="#98out" data-ref="98out" data-ref-filename="98out">out</a>;</td></tr>
<tr><th id="664">664</th><td>	}</td></tr>
<tr><th id="665">665</th><td></td></tr>
<tr><th id="666">666</th><td>	<b>if</b> (<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::state" title='xfrm_state_walk::state' data-ref="xfrm_state_walk::state" data-ref-filename="xfrm_state_walk..state">state</a> == <a class="enum" href="../../include/net/xfrm.h.html#XFRM_STATE_VOID" title='XFRM_STATE_VOID' data-ref="XFRM_STATE_VOID" data-ref-filename="XFRM_STATE_VOID">XFRM_STATE_VOID</a>)</td></tr>
<tr><th id="667">667</th><td>		<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::state" title='xfrm_state_walk::state' data-ref="xfrm_state_walk::state" data-ref-filename="xfrm_state_walk..state">state</a> = <a class="enum" href="../../include/net/xfrm.h.html#XFRM_STATE_VALID" title='XFRM_STATE_VALID' data-ref="XFRM_STATE_VALID" data-ref-filename="XFRM_STATE_VALID">XFRM_STATE_VALID</a>;</td></tr>
<tr><th id="668">668</th><td></td></tr>
<tr><th id="669">669</th><td>	<a class="local col7 ref" href="#97c" title='c' data-ref="97c" data-ref-filename="97c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col1 ref" href="#91nlh" title='nlh' data-ref="91nlh" data-ref-filename="91nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="670">670</th><td>	<a class="local col7 ref" href="#97c" title='c' data-ref="97c" data-ref-filename="97c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col1 ref" href="#91nlh" title='nlh' data-ref="91nlh" data-ref-filename="91nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="671">671</th><td>	<a class="local col7 ref" href="#97c" title='c' data-ref="97c" data-ref-filename="97c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> = <a class="local col1 ref" href="#91nlh" title='nlh' data-ref="91nlh" data-ref-filename="91nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="672">672</th><td></td></tr>
<tr><th id="673">673</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_state_notify" title='km_state_notify' data-ref="km_state_notify" data-ref-filename="km_state_notify">km_state_notify</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>, &amp;<a class="local col7 ref" href="#97c" title='c' data-ref="97c" data-ref-filename="97c">c</a>);</td></tr>
<tr><th id="674">674</th><td><dfn class="lbl" id="98out" data-ref="98out" data-ref-filename="98out">out</dfn>:</td></tr>
<tr><th id="675">675</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col5 ref" href="#95x" title='x' data-ref="95x" data-ref-filename="95x">x</a>);</td></tr>
<tr><th id="676">676</th><td>	<b>return</b> <a class="local col6 ref" href="#96err" title='err' data-ref="96err" data-ref-filename="96err">err</a>;</td></tr>
<tr><th id="677">677</th><td>}</td></tr>
<tr><th id="678">678</th><td></td></tr>
<tr><th id="679">679</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="tu decl def fn" id="xfrm_user_state_lookup" title='xfrm_user_state_lookup' data-type='struct xfrm_state * xfrm_user_state_lookup(struct net * net, struct xfrm_usersa_id * p, struct nlattr ** attrs, int * errp)' data-ref="xfrm_user_state_lookup" data-ref-filename="xfrm_user_state_lookup">xfrm_user_state_lookup</dfn>(<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col9 decl" id="99net" title='net' data-type='struct net *' data-ref="99net" data-ref-filename="99net">net</dfn>,</td></tr>
<tr><th id="680">680</th><td>						 <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id" title='xfrm_usersa_id' data-ref="xfrm_usersa_id" data-ref-filename="xfrm_usersa_id">xfrm_usersa_id</a> *<dfn class="local col0 decl" id="100p" title='p' data-type='struct xfrm_usersa_id *' data-ref="100p" data-ref-filename="100p">p</dfn>,</td></tr>
<tr><th id="681">681</th><td>						 <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col1 decl" id="101attrs" title='attrs' data-type='struct nlattr **' data-ref="101attrs" data-ref-filename="101attrs">attrs</dfn>,</td></tr>
<tr><th id="682">682</th><td>						 <em>int</em> *<dfn class="local col2 decl" id="102errp" title='errp' data-type='int *' data-ref="102errp" data-ref-filename="102errp">errp</dfn>)</td></tr>
<tr><th id="683">683</th><td>{</td></tr>
<tr><th id="684">684</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col3 decl" id="103x" title='x' data-type='struct xfrm_state *' data-ref="103x" data-ref-filename="103x">x</dfn> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="685">685</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col4 decl" id="104m" title='m' data-type='struct xfrm_mark' data-ref="104m" data-ref-filename="104m">m</dfn>;</td></tr>
<tr><th id="686">686</th><td>	<em>int</em> <dfn class="local col5 decl" id="105err" title='err' data-type='int' data-ref="105err" data-ref-filename="105err">err</dfn>;</td></tr>
<tr><th id="687">687</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col6 decl" id="106mark" title='mark' data-type='u32' data-ref="106mark" data-ref-filename="106mark">mark</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col1 ref" href="#101attrs" title='attrs' data-ref="101attrs" data-ref-filename="101attrs">attrs</a>, &amp;<a class="local col4 ref" href="#104m" title='m' data-ref="104m" data-ref-filename="104m">m</a>);</td></tr>
<tr><th id="688">688</th><td></td></tr>
<tr><th id="689">689</th><td>	<b>if</b> (<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_id_proto_match" title='xfrm_id_proto_match' data-ref="xfrm_id_proto_match" data-ref-filename="xfrm_id_proto_match">xfrm_id_proto_match</a>(<a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a>, <a class="macro" href="../../include/uapi/linux/ipsec.h.html#11" title="255" data-ref="_M/IPSEC_PROTO_ANY">IPSEC_PROTO_ANY</a>)) {</td></tr>
<tr><th id="690">690</th><td>		<a class="local col5 ref" href="#105err" title='err' data-ref="105err" data-ref-filename="105err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>;</td></tr>
<tr><th id="691">691</th><td>		<a class="local col3 ref" href="#103x" title='x' data-ref="103x" data-ref-filename="103x">x</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_lookup" title='xfrm_state_lookup' data-ref="xfrm_state_lookup" data-ref-filename="xfrm_state_lookup">xfrm_state_lookup</a>(<a class="local col9 ref" href="#99net" title='net' data-ref="99net" data-ref-filename="99net">net</a>, <a class="local col6 ref" href="#106mark" title='mark' data-ref="106mark" data-ref-filename="106mark">mark</a>, &amp;<a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>, <a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::spi" title='xfrm_usersa_id::spi' data-ref="xfrm_usersa_id::spi" data-ref-filename="xfrm_usersa_id..spi">spi</a>, <a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a>, <a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::family" title='xfrm_usersa_id::family' data-ref="xfrm_usersa_id::family" data-ref-filename="xfrm_usersa_id..family">family</a>);</td></tr>
<tr><th id="692">692</th><td>	} <b>else</b> {</td></tr>
<tr><th id="693">693</th><td>		<a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a> *<dfn class="local col7 decl" id="107saddr" title='saddr' data-type='xfrm_address_t *' data-ref="107saddr" data-ref-filename="107saddr">saddr</dfn> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="694">694</th><td></td></tr>
<tr><th id="695">695</th><td>		<a class="tu ref fn" href="#verify_one_addr" title='verify_one_addr' data-use='c' data-ref="verify_one_addr" data-ref-filename="verify_one_addr">verify_one_addr</a>(<a class="local col1 ref" href="#101attrs" title='attrs' data-ref="101attrs" data-ref-filename="101attrs">attrs</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SRCADDR" title='XFRMA_SRCADDR' data-ref="XFRMA_SRCADDR" data-ref-filename="XFRMA_SRCADDR">XFRMA_SRCADDR</a>, &amp;<a class="local col7 ref" href="#107saddr" title='saddr' data-ref="107saddr" data-ref-filename="107saddr">saddr</a>);</td></tr>
<tr><th id="696">696</th><td>		<b>if</b> (!<a class="local col7 ref" href="#107saddr" title='saddr' data-ref="107saddr" data-ref-filename="107saddr">saddr</a>) {</td></tr>
<tr><th id="697">697</th><td>			<a class="local col5 ref" href="#105err" title='err' data-ref="105err" data-ref-filename="105err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="698">698</th><td>			<b>goto</b> <a class="lbl" href="#108out" data-ref="108out" data-ref-filename="108out">out</a>;</td></tr>
<tr><th id="699">699</th><td>		}</td></tr>
<tr><th id="700">700</th><td></td></tr>
<tr><th id="701">701</th><td>		<a class="local col5 ref" href="#105err" title='err' data-ref="105err" data-ref-filename="105err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>;</td></tr>
<tr><th id="702">702</th><td>		<a class="local col3 ref" href="#103x" title='x' data-ref="103x" data-ref-filename="103x">x</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_lookup_byaddr" title='xfrm_state_lookup_byaddr' data-ref="xfrm_state_lookup_byaddr" data-ref-filename="xfrm_state_lookup_byaddr">xfrm_state_lookup_byaddr</a>(<a class="local col9 ref" href="#99net" title='net' data-ref="99net" data-ref-filename="99net">net</a>, <a class="local col6 ref" href="#106mark" title='mark' data-ref="106mark" data-ref-filename="106mark">mark</a>,</td></tr>
<tr><th id="703">703</th><td>					     &amp;<a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>, <a class="local col7 ref" href="#107saddr" title='saddr' data-ref="107saddr" data-ref-filename="107saddr">saddr</a>,</td></tr>
<tr><th id="704">704</th><td>					     <a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a>, <a class="local col0 ref" href="#100p" title='p' data-ref="100p" data-ref-filename="100p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::family" title='xfrm_usersa_id::family' data-ref="xfrm_usersa_id::family" data-ref-filename="xfrm_usersa_id..family">family</a>);</td></tr>
<tr><th id="705">705</th><td>	}</td></tr>
<tr><th id="706">706</th><td></td></tr>
<tr><th id="707">707</th><td> <dfn class="lbl" id="108out" data-ref="108out" data-ref-filename="108out">out</dfn>:</td></tr>
<tr><th id="708">708</th><td>	<b>if</b> (!<a class="local col3 ref" href="#103x" title='x' data-ref="103x" data-ref-filename="103x">x</a> &amp;&amp; <a class="local col2 ref" href="#102errp" title='errp' data-ref="102errp" data-ref-filename="102errp">errp</a>)</td></tr>
<tr><th id="709">709</th><td>		*<a class="local col2 ref" href="#102errp" title='errp' data-ref="102errp" data-ref-filename="102errp">errp</a> = <a class="local col5 ref" href="#105err" title='err' data-ref="105err" data-ref-filename="105err">err</a>;</td></tr>
<tr><th id="710">710</th><td>	<b>return</b> <a class="local col3 ref" href="#103x" title='x' data-ref="103x" data-ref-filename="103x">x</a>;</td></tr>
<tr><th id="711">711</th><td>}</td></tr>
<tr><th id="712">712</th><td></td></tr>
<tr><th id="713">713</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_del_sa" title='xfrm_del_sa' data-type='int xfrm_del_sa(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_del_sa" data-ref-filename="xfrm_del_sa">xfrm_del_sa</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col9 decl" id="109skb" title='skb' data-type='struct sk_buff *' data-ref="109skb" data-ref-filename="109skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col0 decl" id="110nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="110nlh" data-ref-filename="110nlh">nlh</dfn>,</td></tr>
<tr><th id="714">714</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col1 decl" id="111attrs" title='attrs' data-type='struct nlattr **' data-ref="111attrs" data-ref-filename="111attrs">attrs</dfn>)</td></tr>
<tr><th id="715">715</th><td>{</td></tr>
<tr><th id="716">716</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col2 decl" id="112net" title='net' data-type='struct net *' data-ref="112net" data-ref-filename="112net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col9 ref" href="#109skb" title='skb' data-ref="109skb" data-ref-filename="109skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="717">717</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col3 decl" id="113x" title='x' data-type='struct xfrm_state *' data-ref="113x" data-ref-filename="113x">x</dfn>;</td></tr>
<tr><th id="718">718</th><td>	<em>int</em> <dfn class="local col4 decl" id="114err" title='err' data-type='int' data-ref="114err" data-ref-filename="114err">err</dfn> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>;</td></tr>
<tr><th id="719">719</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col5 decl" id="115c" title='c' data-type='struct km_event' data-ref="115c" data-ref-filename="115c">c</dfn>;</td></tr>
<tr><th id="720">720</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id" title='xfrm_usersa_id' data-ref="xfrm_usersa_id" data-ref-filename="xfrm_usersa_id">xfrm_usersa_id</a> *<dfn class="local col6 decl" id="116p" title='p' data-type='struct xfrm_usersa_id *' data-ref="116p" data-ref-filename="116p">p</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col0 ref" href="#110nlh" title='nlh' data-ref="110nlh" data-ref-filename="110nlh">nlh</a>);</td></tr>
<tr><th id="721">721</th><td></td></tr>
<tr><th id="722">722</th><td>	<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a> = <a class="tu ref fn" href="#xfrm_user_state_lookup" title='xfrm_user_state_lookup' data-use='c' data-ref="xfrm_user_state_lookup" data-ref-filename="xfrm_user_state_lookup">xfrm_user_state_lookup</a>(<a class="local col2 ref" href="#112net" title='net' data-ref="112net" data-ref-filename="112net">net</a>, <a class="local col6 ref" href="#116p" title='p' data-ref="116p" data-ref-filename="116p">p</a>, <a class="local col1 ref" href="#111attrs" title='attrs' data-ref="111attrs" data-ref-filename="111attrs">attrs</a>, &amp;<a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a>);</td></tr>
<tr><th id="723">723</th><td>	<b>if</b> (<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="724">724</th><td>		<b>return</b> <a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a>;</td></tr>
<tr><th id="725">725</th><td></td></tr>
<tr><th id="726">726</th><td>	<b>if</b> ((<a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a> = <a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_state_delete" title='security_xfrm_state_delete' data-ref="security_xfrm_state_delete" data-ref-filename="security_xfrm_state_delete">security_xfrm_state_delete</a>(<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a>)) != <var>0</var>)</td></tr>
<tr><th id="727">727</th><td>		<b>goto</b> <a class="lbl" href="#117out" data-ref="117out" data-ref-filename="117out">out</a>;</td></tr>
<tr><th id="728">728</th><td></td></tr>
<tr><th id="729">729</th><td>	<b>if</b> (<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_kern" title='xfrm_state_kern' data-ref="xfrm_state_kern" data-ref-filename="xfrm_state_kern">xfrm_state_kern</a>(<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a>)) {</td></tr>
<tr><th id="730">730</th><td>		<a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#5" title="1" data-ref="_M/EPERM">EPERM</a>;</td></tr>
<tr><th id="731">731</th><td>		<b>goto</b> <a class="lbl" href="#117out" data-ref="117out" data-ref-filename="117out">out</a>;</td></tr>
<tr><th id="732">732</th><td>	}</td></tr>
<tr><th id="733">733</th><td></td></tr>
<tr><th id="734">734</th><td>	<a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_delete" title='xfrm_state_delete' data-ref="xfrm_state_delete" data-ref-filename="xfrm_state_delete">xfrm_state_delete</a>(<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a>);</td></tr>
<tr><th id="735">735</th><td></td></tr>
<tr><th id="736">736</th><td>	<b>if</b> (<a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a> &lt; <var>0</var>)</td></tr>
<tr><th id="737">737</th><td>		<b>goto</b> <a class="lbl" href="#117out" data-ref="117out" data-ref-filename="117out">out</a>;</td></tr>
<tr><th id="738">738</th><td></td></tr>
<tr><th id="739">739</th><td>	<a class="local col5 ref" href="#115c" title='c' data-ref="115c" data-ref-filename="115c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col0 ref" href="#110nlh" title='nlh' data-ref="110nlh" data-ref-filename="110nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="740">740</th><td>	<a class="local col5 ref" href="#115c" title='c' data-ref="115c" data-ref-filename="115c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col0 ref" href="#110nlh" title='nlh' data-ref="110nlh" data-ref-filename="110nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="741">741</th><td>	<a class="local col5 ref" href="#115c" title='c' data-ref="115c" data-ref-filename="115c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> = <a class="local col0 ref" href="#110nlh" title='nlh' data-ref="110nlh" data-ref-filename="110nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="742">742</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_state_notify" title='km_state_notify' data-ref="km_state_notify" data-ref-filename="km_state_notify">km_state_notify</a>(<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a>, &amp;<a class="local col5 ref" href="#115c" title='c' data-ref="115c" data-ref-filename="115c">c</a>);</td></tr>
<tr><th id="743">743</th><td></td></tr>
<tr><th id="744">744</th><td><dfn class="lbl" id="117out" data-ref="117out" data-ref-filename="117out">out</dfn>:</td></tr>
<tr><th id="745">745</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_audit_state_delete" title='xfrm_audit_state_delete' data-ref="xfrm_audit_state_delete" data-ref-filename="xfrm_audit_state_delete">xfrm_audit_state_delete</a>(<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a>, <a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a> ? <var>0</var> : <var>1</var>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="746">746</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col3 ref" href="#113x" title='x' data-ref="113x" data-ref-filename="113x">x</a>);</td></tr>
<tr><th id="747">747</th><td>	<b>return</b> <a class="local col4 ref" href="#114err" title='err' data-ref="114err" data-ref-filename="114err">err</a>;</td></tr>
<tr><th id="748">748</th><td>}</td></tr>
<tr><th id="749">749</th><td></td></tr>
<tr><th id="750">750</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="copy_to_user_state" title='copy_to_user_state' data-type='void copy_to_user_state(struct xfrm_state * x, struct xfrm_usersa_info * p)' data-ref="copy_to_user_state" data-ref-filename="copy_to_user_state">copy_to_user_state</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col8 decl" id="118x" title='x' data-type='struct xfrm_state *' data-ref="118x" data-ref-filename="118x">x</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col9 decl" id="119p" title='p' data-type='struct xfrm_usersa_info *' data-ref="119p" data-ref-filename="119p">p</dfn>)</td></tr>
<tr><th id="751">751</th><td>{</td></tr>
<tr><th id="752">752</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>));</td></tr>
<tr><th id="753">753</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;id)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;id)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;id), (&amp;x-&gt;id), __len); else __ret = __builtin_memcpy((&amp;p-&gt;id), (&amp;x-&gt;id), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>, &amp;<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>, <b>sizeof</b>(<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>));</td></tr>
<tr><th id="754">754</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;sel)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;sel)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;sel), (&amp;x-&gt;sel), __len); else __ret = __builtin_memcpy((&amp;p-&gt;sel), (&amp;x-&gt;sel), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::sel" title='xfrm_usersa_info::sel' data-ref="xfrm_usersa_info::sel" data-ref-filename="xfrm_usersa_info..sel">sel</a>, &amp;<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::sel" title='xfrm_state::sel' data-ref="xfrm_state::sel" data-ref-filename="xfrm_state..sel">sel</a>, <b>sizeof</b>(<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::sel" title='xfrm_usersa_info::sel' data-ref="xfrm_usersa_info::sel" data-ref-filename="xfrm_usersa_info..sel">sel</a>));</td></tr>
<tr><th id="755">755</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;lft)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;lft)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;lft), (&amp;x-&gt;lft), __len); else __ret = __builtin_memcpy((&amp;p-&gt;lft), (&amp;x-&gt;lft), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::lft" title='xfrm_usersa_info::lft' data-ref="xfrm_usersa_info::lft" data-ref-filename="xfrm_usersa_info..lft">lft</a>, &amp;<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lft" title='xfrm_state::lft' data-ref="xfrm_state::lft" data-ref-filename="xfrm_state..lft">lft</a>, <b>sizeof</b>(<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::lft" title='xfrm_usersa_info::lft' data-ref="xfrm_usersa_info::lft" data-ref-filename="xfrm_usersa_info..lft">lft</a>));</td></tr>
<tr><th id="756">756</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;curlft)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;curlft)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;curlft), (&amp;x-&gt;curlft), __len); else __ret = __builtin_memcpy((&amp;p-&gt;curlft), (&amp;x-&gt;curlft), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::curlft" title='xfrm_usersa_info::curlft' data-ref="xfrm_usersa_info::curlft" data-ref-filename="xfrm_usersa_info..curlft">curlft</a>, &amp;<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::curlft" title='xfrm_state::curlft' data-ref="xfrm_state::curlft" data-ref-filename="xfrm_state..curlft">curlft</a>, <b>sizeof</b>(<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::curlft" title='xfrm_usersa_info::curlft' data-ref="xfrm_usersa_info::curlft" data-ref-filename="xfrm_usersa_info..curlft">curlft</a>));</td></tr>
<tr><th id="757">757</th><td>	<a class="macro" href="../../arch/x86/include/asm/unaligned.h.html#13" title="__put_unaligned_le" data-ref="_M/put_unaligned">put_unaligned</a>(<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::stats" title='xfrm_state::stats' data-ref="xfrm_state::stats" data-ref-filename="xfrm_state..stats">stats</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_stats::replay_window" title='xfrm_stats::replay_window' data-ref="xfrm_stats::replay_window" data-ref-filename="xfrm_stats..replay_window">replay_window</a>, &amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::stats" title='xfrm_usersa_info::stats' data-ref="xfrm_usersa_info::stats" data-ref-filename="xfrm_usersa_info..stats">stats</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_stats::replay_window" title='xfrm_stats::replay_window' data-ref="xfrm_stats::replay_window" data-ref-filename="xfrm_stats..replay_window">replay_window</a>);</td></tr>
<tr><th id="758">758</th><td>	<a class="macro" href="../../arch/x86/include/asm/unaligned.h.html#13" title="__put_unaligned_le" data-ref="_M/put_unaligned">put_unaligned</a>(<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::stats" title='xfrm_state::stats' data-ref="xfrm_state::stats" data-ref-filename="xfrm_state..stats">stats</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_stats::replay" title='xfrm_stats::replay' data-ref="xfrm_stats::replay" data-ref-filename="xfrm_stats..replay">replay</a>, &amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::stats" title='xfrm_usersa_info::stats' data-ref="xfrm_usersa_info::stats" data-ref-filename="xfrm_usersa_info..stats">stats</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_stats::replay" title='xfrm_stats::replay' data-ref="xfrm_stats::replay" data-ref-filename="xfrm_stats..replay">replay</a>);</td></tr>
<tr><th id="759">759</th><td>	<a class="macro" href="../../arch/x86/include/asm/unaligned.h.html#13" title="__put_unaligned_le" data-ref="_M/put_unaligned">put_unaligned</a>(<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::stats" title='xfrm_state::stats' data-ref="xfrm_state::stats" data-ref-filename="xfrm_state..stats">stats</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_stats::integrity_failed" title='xfrm_stats::integrity_failed' data-ref="xfrm_stats::integrity_failed" data-ref-filename="xfrm_stats..integrity_failed">integrity_failed</a>, &amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::stats" title='xfrm_usersa_info::stats' data-ref="xfrm_usersa_info::stats" data-ref-filename="xfrm_usersa_info..stats">stats</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_stats::integrity_failed" title='xfrm_stats::integrity_failed' data-ref="xfrm_stats::integrity_failed" data-ref-filename="xfrm_stats..integrity_failed">integrity_failed</a>);</td></tr>
<tr><th id="760">760</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;saddr)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;saddr), (&amp;x-&gt;props.saddr), __len); else __ret = __builtin_memcpy((&amp;p-&gt;saddr), (&amp;x-&gt;props.saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::saddr" title='xfrm_usersa_info::saddr' data-ref="xfrm_usersa_info::saddr" data-ref-filename="xfrm_usersa_info..saddr">saddr</a>, &amp;<a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>, <b>sizeof</b>(<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::saddr" title='xfrm_usersa_info::saddr' data-ref="xfrm_usersa_info::saddr" data-ref-filename="xfrm_usersa_info..saddr">saddr</a>));</td></tr>
<tr><th id="761">761</th><td>	<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::mode" title='xfrm_usersa_info::mode' data-ref="xfrm_usersa_info::mode" data-ref-filename="xfrm_usersa_info..mode">mode</a> = <a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::mode" title='xfrm_state::(anonymous struct)::mode' data-ref="xfrm_state::(anonymous)::mode" data-ref-filename="xfrm_state..(anonymous)..mode">mode</a>;</td></tr>
<tr><th id="762">762</th><td>	<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::replay_window" title='xfrm_usersa_info::replay_window' data-ref="xfrm_usersa_info::replay_window" data-ref-filename="xfrm_usersa_info..replay_window">replay_window</a> = <a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::replay_window" title='xfrm_state::(anonymous struct)::replay_window' data-ref="xfrm_state::(anonymous)::replay_window" data-ref-filename="xfrm_state..(anonymous)..replay_window">replay_window</a>;</td></tr>
<tr><th id="763">763</th><td>	<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::reqid" title='xfrm_usersa_info::reqid' data-ref="xfrm_usersa_info::reqid" data-ref-filename="xfrm_usersa_info..reqid">reqid</a> = <a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::reqid" title='xfrm_state::(anonymous struct)::reqid' data-ref="xfrm_state::(anonymous)::reqid" data-ref-filename="xfrm_state..(anonymous)..reqid">reqid</a>;</td></tr>
<tr><th id="764">764</th><td>	<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::family" title='xfrm_usersa_info::family' data-ref="xfrm_usersa_info::family" data-ref-filename="xfrm_usersa_info..family">family</a> = <a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::family" title='xfrm_state::(anonymous struct)::family' data-ref="xfrm_state::(anonymous)::family" data-ref-filename="xfrm_state..(anonymous)..family">family</a>;</td></tr>
<tr><th id="765">765</th><td>	<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::flags" title='xfrm_usersa_info::flags' data-ref="xfrm_usersa_info::flags" data-ref-filename="xfrm_usersa_info..flags">flags</a> = <a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::flags" title='xfrm_state::(anonymous struct)::flags' data-ref="xfrm_state::(anonymous)::flags" data-ref-filename="xfrm_state..(anonymous)..flags">flags</a>;</td></tr>
<tr><th id="766">766</th><td>	<a class="local col9 ref" href="#119p" title='p' data-ref="119p" data-ref-filename="119p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::seq" title='xfrm_usersa_info::seq' data-ref="xfrm_usersa_info::seq" data-ref-filename="xfrm_usersa_info..seq">seq</a> = <a class="local col8 ref" href="#118x" title='x' data-ref="118x" data-ref-filename="118x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::seq" title='xfrm_state_walk::seq' data-ref="xfrm_state_walk::seq" data-ref-filename="xfrm_state_walk..seq">seq</a>;</td></tr>
<tr><th id="767">767</th><td>}</td></tr>
<tr><th id="768">768</th><td></td></tr>
<tr><th id="769">769</th><td><b>struct</b> <dfn class="type def" id="xfrm_dump_info" title='xfrm_dump_info' data-ref="xfrm_dump_info" data-ref-filename="xfrm_dump_info">xfrm_dump_info</dfn> {</td></tr>
<tr><th id="770">770</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="tu decl field" id="xfrm_dump_info::in_skb" title='xfrm_dump_info::in_skb' data-type='struct sk_buff *' data-ref="xfrm_dump_info::in_skb" data-ref-filename="xfrm_dump_info..in_skb">in_skb</dfn>;</td></tr>
<tr><th id="771">771</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="tu decl field" id="xfrm_dump_info::out_skb" title='xfrm_dump_info::out_skb' data-type='struct sk_buff *' data-ref="xfrm_dump_info::out_skb" data-ref-filename="xfrm_dump_info..out_skb">out_skb</dfn>;</td></tr>
<tr><th id="772">772</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="tu decl field" id="xfrm_dump_info::nlmsg_seq" title='xfrm_dump_info::nlmsg_seq' data-type='u32' data-ref="xfrm_dump_info::nlmsg_seq" data-ref-filename="xfrm_dump_info..nlmsg_seq">nlmsg_seq</dfn>;</td></tr>
<tr><th id="773">773</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16" data-ref-filename="u16">u16</a> <dfn class="tu decl field" id="xfrm_dump_info::nlmsg_flags" title='xfrm_dump_info::nlmsg_flags' data-type='u16' data-ref="xfrm_dump_info::nlmsg_flags" data-ref-filename="xfrm_dump_info..nlmsg_flags">nlmsg_flags</dfn>;</td></tr>
<tr><th id="774">774</th><td>};</td></tr>
<tr><th id="775">775</th><td></td></tr>
<tr><th id="776">776</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_sec_ctx" title='copy_sec_ctx' data-type='int copy_sec_ctx(struct xfrm_sec_ctx * s, struct sk_buff * skb)' data-ref="copy_sec_ctx" data-ref-filename="copy_sec_ctx">copy_sec_ctx</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx" title='xfrm_sec_ctx' data-ref="xfrm_sec_ctx" data-ref-filename="xfrm_sec_ctx">xfrm_sec_ctx</a> *<dfn class="local col0 decl" id="120s" title='s' data-type='struct xfrm_sec_ctx *' data-ref="120s" data-ref-filename="120s">s</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col1 decl" id="121skb" title='skb' data-type='struct sk_buff *' data-ref="121skb" data-ref-filename="121skb">skb</dfn>)</td></tr>
<tr><th id="777">777</th><td>{</td></tr>
<tr><th id="778">778</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a> *<dfn class="local col2 decl" id="122uctx" title='uctx' data-type='struct xfrm_user_sec_ctx *' data-ref="122uctx" data-ref-filename="122uctx">uctx</dfn>;</td></tr>
<tr><th id="779">779</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col3 decl" id="123attr" title='attr' data-type='struct nlattr *' data-ref="123attr" data-ref-filename="123attr">attr</dfn>;</td></tr>
<tr><th id="780">780</th><td>	<em>int</em> <dfn class="local col4 decl" id="124ctx_size" title='ctx_size' data-type='int' data-ref="124ctx_size" data-ref-filename="124ctx_size">ctx_size</dfn> = <b>sizeof</b>(*<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a>) + <a class="local col0 ref" href="#120s" title='s' data-ref="120s" data-ref-filename="120s">s</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_len" title='xfrm_sec_ctx::ctx_len' data-ref="xfrm_sec_ctx::ctx_len" data-ref-filename="xfrm_sec_ctx..ctx_len">ctx_len</a>;</td></tr>
<tr><th id="781">781</th><td></td></tr>
<tr><th id="782">782</th><td>	<a class="local col3 ref" href="#123attr" title='attr' data-ref="123attr" data-ref-filename="123attr">attr</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_reserve" title='nla_reserve' data-ref="nla_reserve" data-ref-filename="nla_reserve">nla_reserve</a>(<a class="local col1 ref" href="#121skb" title='skb' data-ref="121skb" data-ref-filename="121skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>, <a class="local col4 ref" href="#124ctx_size" title='ctx_size' data-ref="124ctx_size" data-ref-filename="124ctx_size">ctx_size</a>);</td></tr>
<tr><th id="783">783</th><td>	<b>if</b> (<a class="local col3 ref" href="#123attr" title='attr' data-ref="123attr" data-ref-filename="123attr">attr</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="784">784</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="785">785</th><td></td></tr>
<tr><th id="786">786</th><td>	<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col3 ref" href="#123attr" title='attr' data-ref="123attr" data-ref-filename="123attr">attr</a>);</td></tr>
<tr><th id="787">787</th><td>	<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx::exttype" title='xfrm_user_sec_ctx::exttype' data-ref="xfrm_user_sec_ctx::exttype" data-ref-filename="xfrm_user_sec_ctx..exttype">exttype</a> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>;</td></tr>
<tr><th id="788">788</th><td>	<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx::len" title='xfrm_user_sec_ctx::len' data-ref="xfrm_user_sec_ctx::len" data-ref-filename="xfrm_user_sec_ctx..len">len</a> = <a class="local col4 ref" href="#124ctx_size" title='ctx_size' data-ref="124ctx_size" data-ref-filename="124ctx_size">ctx_size</a>;</td></tr>
<tr><th id="789">789</th><td>	<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx::ctx_doi" title='xfrm_user_sec_ctx::ctx_doi' data-ref="xfrm_user_sec_ctx::ctx_doi" data-ref-filename="xfrm_user_sec_ctx..ctx_doi">ctx_doi</a> = <a class="local col0 ref" href="#120s" title='s' data-ref="120s" data-ref-filename="120s">s</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_doi" title='xfrm_sec_ctx::ctx_doi' data-ref="xfrm_sec_ctx::ctx_doi" data-ref-filename="xfrm_sec_ctx..ctx_doi">ctx_doi</a>;</td></tr>
<tr><th id="790">790</th><td>	<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx::ctx_alg" title='xfrm_user_sec_ctx::ctx_alg' data-ref="xfrm_user_sec_ctx::ctx_alg" data-ref-filename="xfrm_user_sec_ctx..ctx_alg">ctx_alg</a> = <a class="local col0 ref" href="#120s" title='s' data-ref="120s" data-ref-filename="120s">s</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_alg" title='xfrm_sec_ctx::ctx_alg' data-ref="xfrm_sec_ctx::ctx_alg" data-ref-filename="xfrm_sec_ctx..ctx_alg">ctx_alg</a>;</td></tr>
<tr><th id="791">791</th><td>	<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx::ctx_len" title='xfrm_user_sec_ctx::ctx_len' data-ref="xfrm_user_sec_ctx::ctx_len" data-ref-filename="xfrm_user_sec_ctx..ctx_len">ctx_len</a> = <a class="local col0 ref" href="#120s" title='s' data-ref="120s" data-ref-filename="120s">s</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_len" title='xfrm_sec_ctx::ctx_len' data-ref="xfrm_sec_ctx::ctx_len" data-ref-filename="xfrm_sec_ctx..ctx_len">ctx_len</a>;</td></tr>
<tr><th id="792">792</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (s-&gt;ctx_len); void *__ret; if (__builtin_constant_p(s-&gt;ctx_len) &amp;&amp; __len &gt;= 64) __ret = __memcpy((uctx + 1), (s-&gt;ctx_str), __len); else __ret = __builtin_memcpy((uctx + 1), (s-&gt;ctx_str), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col2 ref" href="#122uctx" title='uctx' data-ref="122uctx" data-ref-filename="122uctx">uctx</a> + <var>1</var>, <a class="local col0 ref" href="#120s" title='s' data-ref="120s" data-ref-filename="120s">s</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_str" title='xfrm_sec_ctx::ctx_str' data-ref="xfrm_sec_ctx::ctx_str" data-ref-filename="xfrm_sec_ctx..ctx_str">ctx_str</a>, <a class="local col0 ref" href="#120s" title='s' data-ref="120s" data-ref-filename="120s">s</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_len" title='xfrm_sec_ctx::ctx_len' data-ref="xfrm_sec_ctx::ctx_len" data-ref-filename="xfrm_sec_ctx..ctx_len">ctx_len</a>);</td></tr>
<tr><th id="793">793</th><td></td></tr>
<tr><th id="794">794</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="795">795</th><td>}</td></tr>
<tr><th id="796">796</th><td></td></tr>
<tr><th id="797">797</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_user_offload" title='copy_user_offload' data-type='int copy_user_offload(struct xfrm_state_offload * xso, struct sk_buff * skb)' data-ref="copy_user_offload" data-ref-filename="copy_user_offload">copy_user_offload</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state_offload" title='xfrm_state_offload' data-ref="xfrm_state_offload" data-ref-filename="xfrm_state_offload">xfrm_state_offload</a> *<dfn class="local col5 decl" id="125xso" title='xso' data-type='struct xfrm_state_offload *' data-ref="125xso" data-ref-filename="125xso">xso</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col6 decl" id="126skb" title='skb' data-type='struct sk_buff *' data-ref="126skb" data-ref-filename="126skb">skb</dfn>)</td></tr>
<tr><th id="798">798</th><td>{</td></tr>
<tr><th id="799">799</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_offload" title='xfrm_user_offload' data-ref="xfrm_user_offload" data-ref-filename="xfrm_user_offload">xfrm_user_offload</a> *<dfn class="local col7 decl" id="127xuo" title='xuo' data-type='struct xfrm_user_offload *' data-ref="127xuo" data-ref-filename="127xuo">xuo</dfn>;</td></tr>
<tr><th id="800">800</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col8 decl" id="128attr" title='attr' data-type='struct nlattr *' data-ref="128attr" data-ref-filename="128attr">attr</dfn>;</td></tr>
<tr><th id="801">801</th><td></td></tr>
<tr><th id="802">802</th><td>	<a class="local col8 ref" href="#128attr" title='attr' data-ref="128attr" data-ref-filename="128attr">attr</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_reserve" title='nla_reserve' data-ref="nla_reserve" data-ref-filename="nla_reserve">nla_reserve</a>(<a class="local col6 ref" href="#126skb" title='skb' data-ref="126skb" data-ref-filename="126skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OFFLOAD_DEV" title='XFRMA_OFFLOAD_DEV' data-ref="XFRMA_OFFLOAD_DEV" data-ref-filename="XFRMA_OFFLOAD_DEV">XFRMA_OFFLOAD_DEV</a>, <b>sizeof</b>(*<a class="local col7 ref" href="#127xuo" title='xuo' data-ref="127xuo" data-ref-filename="127xuo">xuo</a>));</td></tr>
<tr><th id="803">803</th><td>	<b>if</b> (<a class="local col8 ref" href="#128attr" title='attr' data-ref="128attr" data-ref-filename="128attr">attr</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="804">804</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="805">805</th><td></td></tr>
<tr><th id="806">806</th><td>	<a class="local col7 ref" href="#127xuo" title='xuo' data-ref="127xuo" data-ref-filename="127xuo">xuo</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col8 ref" href="#128attr" title='attr' data-ref="128attr" data-ref-filename="128attr">attr</a>);</td></tr>
<tr><th id="807">807</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(<a class="local col7 ref" href="#127xuo" title='xuo' data-ref="127xuo" data-ref-filename="127xuo">xuo</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col7 ref" href="#127xuo" title='xuo' data-ref="127xuo" data-ref-filename="127xuo">xuo</a>));</td></tr>
<tr><th id="808">808</th><td>	<a class="local col7 ref" href="#127xuo" title='xuo' data-ref="127xuo" data-ref-filename="127xuo">xuo</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_offload::ifindex" title='xfrm_user_offload::ifindex' data-ref="xfrm_user_offload::ifindex" data-ref-filename="xfrm_user_offload..ifindex">ifindex</a> = <a class="local col5 ref" href="#125xso" title='xso' data-ref="125xso" data-ref-filename="125xso">xso</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_offload::dev" title='xfrm_state_offload::dev' data-ref="xfrm_state_offload::dev" data-ref-filename="xfrm_state_offload..dev">dev</a>-&gt;<a class="ref field" href="../../include/linux/netdevice.h.html#net_device::ifindex" title='net_device::ifindex' data-ref="net_device::ifindex" data-ref-filename="net_device..ifindex">ifindex</a>;</td></tr>
<tr><th id="809">809</th><td>	<a class="local col7 ref" href="#127xuo" title='xuo' data-ref="127xuo" data-ref-filename="127xuo">xuo</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_offload::flags" title='xfrm_user_offload::flags' data-ref="xfrm_user_offload::flags" data-ref-filename="xfrm_user_offload..flags">flags</a> = <a class="local col5 ref" href="#125xso" title='xso' data-ref="125xso" data-ref-filename="125xso">xso</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_offload::flags" title='xfrm_state_offload::flags' data-ref="xfrm_state_offload::flags" data-ref-filename="xfrm_state_offload..flags">flags</a>;</td></tr>
<tr><th id="810">810</th><td></td></tr>
<tr><th id="811">811</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="812">812</th><td>}</td></tr>
<tr><th id="813">813</th><td></td></tr>
<tr><th id="814">814</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_to_user_auth" title='copy_to_user_auth' data-type='int copy_to_user_auth(struct xfrm_algo_auth * auth, struct sk_buff * skb)' data-ref="copy_to_user_auth" data-ref-filename="copy_to_user_auth">copy_to_user_auth</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth" title='xfrm_algo_auth' data-ref="xfrm_algo_auth" data-ref-filename="xfrm_algo_auth">xfrm_algo_auth</a> *<dfn class="local col9 decl" id="129auth" title='auth' data-type='struct xfrm_algo_auth *' data-ref="129auth" data-ref-filename="129auth">auth</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col0 decl" id="130skb" title='skb' data-type='struct sk_buff *' data-ref="130skb" data-ref-filename="130skb">skb</dfn>)</td></tr>
<tr><th id="815">815</th><td>{</td></tr>
<tr><th id="816">816</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a> *<dfn class="local col1 decl" id="131algo" title='algo' data-type='struct xfrm_algo *' data-ref="131algo" data-ref-filename="131algo">algo</dfn>;</td></tr>
<tr><th id="817">817</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col2 decl" id="132nla" title='nla' data-type='struct nlattr *' data-ref="132nla" data-ref-filename="132nla">nla</dfn>;</td></tr>
<tr><th id="818">818</th><td></td></tr>
<tr><th id="819">819</th><td>	<a class="local col2 ref" href="#132nla" title='nla' data-ref="132nla" data-ref-filename="132nla">nla</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_reserve" title='nla_reserve' data-ref="nla_reserve" data-ref-filename="nla_reserve">nla_reserve</a>(<a class="local col0 ref" href="#130skb" title='skb' data-ref="130skb" data-ref-filename="130skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>,</td></tr>
<tr><th id="820">820</th><td>			  <b>sizeof</b>(*<a class="local col1 ref" href="#131algo" title='algo' data-ref="131algo" data-ref-filename="131algo">algo</a>) + (<a class="local col9 ref" href="#129auth" title='auth' data-ref="129auth" data-ref-filename="129auth">auth</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_key_len" title='xfrm_algo_auth::alg_key_len' data-ref="xfrm_algo_auth::alg_key_len" data-ref-filename="xfrm_algo_auth..alg_key_len">alg_key_len</a> + <var>7</var>) / <var>8</var>);</td></tr>
<tr><th id="821">821</th><td>	<b>if</b> (!<a class="local col2 ref" href="#132nla" title='nla' data-ref="132nla" data-ref-filename="132nla">nla</a>)</td></tr>
<tr><th id="822">822</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="823">823</th><td></td></tr>
<tr><th id="824">824</th><td>	<a class="local col1 ref" href="#131algo" title='algo' data-ref="131algo" data-ref-filename="131algo">algo</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col2 ref" href="#132nla" title='nla' data-ref="132nla" data-ref-filename="132nla">nla</a>);</td></tr>
<tr><th id="825">825</th><td>	<a class="ref fn" href="../../include/linux/string.h.html#strncpy" title='strncpy' data-ref="strncpy" data-ref-filename="strncpy">strncpy</a>(<a class="local col1 ref" href="#131algo" title='algo' data-ref="131algo" data-ref-filename="131algo">algo</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>, <a class="local col9 ref" href="#129auth" title='auth' data-ref="129auth" data-ref-filename="129auth">auth</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_name" title='xfrm_algo_auth::alg_name' data-ref="xfrm_algo_auth::alg_name" data-ref-filename="xfrm_algo_auth..alg_name">alg_name</a>, <b>sizeof</b>(<a class="local col1 ref" href="#131algo" title='algo' data-ref="131algo" data-ref-filename="131algo">algo</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_name" title='xfrm_algo::alg_name' data-ref="xfrm_algo::alg_name" data-ref-filename="xfrm_algo..alg_name">alg_name</a>));</td></tr>
<tr><th id="826">826</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = ((auth-&gt;alg_key_len + 7) / 8); void *__ret; if (__builtin_constant_p((auth-&gt;alg_key_len + 7) / 8) &amp;&amp; __len &gt;= 64) __ret = __memcpy((algo-&gt;alg_key), (auth-&gt;alg_key), __len); else __ret = __builtin_memcpy((algo-&gt;alg_key), (auth-&gt;alg_key), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(<a class="local col1 ref" href="#131algo" title='algo' data-ref="131algo" data-ref-filename="131algo">algo</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_key" title='xfrm_algo::alg_key' data-ref="xfrm_algo::alg_key" data-ref-filename="xfrm_algo..alg_key">alg_key</a>, <a class="local col9 ref" href="#129auth" title='auth' data-ref="129auth" data-ref-filename="129auth">auth</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_key" title='xfrm_algo_auth::alg_key' data-ref="xfrm_algo_auth::alg_key" data-ref-filename="xfrm_algo_auth..alg_key">alg_key</a>, (<a class="local col9 ref" href="#129auth" title='auth' data-ref="129auth" data-ref-filename="129auth">auth</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_key_len" title='xfrm_algo_auth::alg_key_len' data-ref="xfrm_algo_auth::alg_key_len" data-ref-filename="xfrm_algo_auth..alg_key_len">alg_key_len</a> + <var>7</var>) / <var>8</var>);</td></tr>
<tr><th id="827">827</th><td>	<a class="local col1 ref" href="#131algo" title='algo' data-ref="131algo" data-ref-filename="131algo">algo</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo::alg_key_len" title='xfrm_algo::alg_key_len' data-ref="xfrm_algo::alg_key_len" data-ref-filename="xfrm_algo..alg_key_len">alg_key_len</a> = <a class="local col9 ref" href="#129auth" title='auth' data-ref="129auth" data-ref-filename="129auth">auth</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_key_len" title='xfrm_algo_auth::alg_key_len' data-ref="xfrm_algo_auth::alg_key_len" data-ref-filename="xfrm_algo_auth..alg_key_len">alg_key_len</a>;</td></tr>
<tr><th id="828">828</th><td></td></tr>
<tr><th id="829">829</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="830">830</th><td>}</td></tr>
<tr><th id="831">831</th><td></td></tr>
<tr><th id="832">832</th><td><i  data-doc="copy_to_user_state_extra">/* Don't change this without updating xfrm_sa_len! */</i></td></tr>
<tr><th id="833">833</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_to_user_state_extra" title='copy_to_user_state_extra' data-type='int copy_to_user_state_extra(struct xfrm_state * x, struct xfrm_usersa_info * p, struct sk_buff * skb)' data-ref="copy_to_user_state_extra" data-ref-filename="copy_to_user_state_extra">copy_to_user_state_extra</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col3 decl" id="133x" title='x' data-type='struct xfrm_state *' data-ref="133x" data-ref-filename="133x">x</dfn>,</td></tr>
<tr><th id="834">834</th><td>				    <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col4 decl" id="134p" title='p' data-type='struct xfrm_usersa_info *' data-ref="134p" data-ref-filename="134p">p</dfn>,</td></tr>
<tr><th id="835">835</th><td>				    <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col5 decl" id="135skb" title='skb' data-type='struct sk_buff *' data-ref="135skb" data-ref-filename="135skb">skb</dfn>)</td></tr>
<tr><th id="836">836</th><td>{</td></tr>
<tr><th id="837">837</th><td>	<em>int</em> <dfn class="local col6 decl" id="136ret" title='ret' data-type='int' data-ref="136ret" data-ref-filename="136ret">ret</dfn> = <var>0</var>;</td></tr>
<tr><th id="838">838</th><td></td></tr>
<tr><th id="839">839</th><td>	<a class="tu ref fn" href="#copy_to_user_state" title='copy_to_user_state' data-use='c' data-ref="copy_to_user_state" data-ref-filename="copy_to_user_state">copy_to_user_state</a>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>, <a class="local col4 ref" href="#134p" title='p' data-ref="134p" data-ref-filename="134p">p</a>);</td></tr>
<tr><th id="840">840</th><td></td></tr>
<tr><th id="841">841</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::extra_flags" title='xfrm_state::(anonymous struct)::extra_flags' data-ref="xfrm_state::(anonymous)::extra_flags" data-ref-filename="xfrm_state..(anonymous)..extra_flags">extra_flags</a>) {</td></tr>
<tr><th id="842">842</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_u32" title='nla_put_u32' data-ref="nla_put_u32" data-ref-filename="nla_put_u32">nla_put_u32</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SA_EXTRA_FLAGS" title='XFRMA_SA_EXTRA_FLAGS' data-ref="XFRMA_SA_EXTRA_FLAGS" data-ref-filename="XFRMA_SA_EXTRA_FLAGS">XFRMA_SA_EXTRA_FLAGS</a>,</td></tr>
<tr><th id="843">843</th><td>				  <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::extra_flags" title='xfrm_state::(anonymous struct)::extra_flags' data-ref="xfrm_state::(anonymous)::extra_flags" data-ref-filename="xfrm_state..(anonymous)..extra_flags">extra_flags</a>);</td></tr>
<tr><th id="844">844</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="845">845</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="846">846</th><td>	}</td></tr>
<tr><th id="847">847</th><td></td></tr>
<tr><th id="848">848</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a>) {</td></tr>
<tr><th id="849">849</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_COADDR" title='XFRMA_COADDR' data-ref="XFRMA_COADDR" data-ref-filename="XFRMA_COADDR">XFRMA_COADDR</a>, <b>sizeof</b>(*<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a>), <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a>);</td></tr>
<tr><th id="850">850</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="851">851</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="852">852</th><td>	}</td></tr>
<tr><th id="853">853</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lastused" title='xfrm_state::lastused' data-ref="xfrm_state::lastused" data-ref-filename="xfrm_state..lastused">lastused</a>) {</td></tr>
<tr><th id="854">854</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_u64_64bit" title='nla_put_u64_64bit' data-ref="nla_put_u64_64bit" data-ref-filename="nla_put_u64_64bit">nla_put_u64_64bit</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_LASTUSED" title='XFRMA_LASTUSED' data-ref="XFRMA_LASTUSED" data-ref-filename="XFRMA_LASTUSED">XFRMA_LASTUSED</a>, <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lastused" title='xfrm_state::lastused' data-ref="xfrm_state::lastused" data-ref-filename="xfrm_state..lastused">lastused</a>,</td></tr>
<tr><th id="855">855</th><td>					<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_PAD" title='XFRMA_PAD' data-ref="XFRMA_PAD" data-ref-filename="XFRMA_PAD">XFRMA_PAD</a>);</td></tr>
<tr><th id="856">856</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="857">857</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="858">858</th><td>	}</td></tr>
<tr><th id="859">859</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aead" title='xfrm_state::aead' data-ref="xfrm_state::aead" data-ref-filename="xfrm_state..aead">aead</a>) {</td></tr>
<tr><th id="860">860</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>, <a class="ref fn" href="../../include/net/xfrm.h.html#aead_len" title='aead_len' data-ref="aead_len" data-ref-filename="aead_len">aead_len</a>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aead" title='xfrm_state::aead' data-ref="xfrm_state::aead" data-ref-filename="xfrm_state..aead">aead</a>), <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aead" title='xfrm_state::aead' data-ref="xfrm_state::aead" data-ref-filename="xfrm_state..aead">aead</a>);</td></tr>
<tr><th id="861">861</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="862">862</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="863">863</th><td>	}</td></tr>
<tr><th id="864">864</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>) {</td></tr>
<tr><th id="865">865</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="tu ref fn" href="#copy_to_user_auth" title='copy_to_user_auth' data-use='c' data-ref="copy_to_user_auth" data-ref-filename="copy_to_user_auth">copy_to_user_auth</a>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>, <a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>);</td></tr>
<tr><th id="866">866</th><td>		<b>if</b> (!<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="867">867</th><td>			<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>,</td></tr>
<tr><th id="868">868</th><td>				      <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_auth_len" title='xfrm_alg_auth_len' data-ref="xfrm_alg_auth_len" data-ref-filename="xfrm_alg_auth_len">xfrm_alg_auth_len</a>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>), <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>);</td></tr>
<tr><th id="869">869</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="870">870</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="871">871</th><td>	}</td></tr>
<tr><th id="872">872</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::ealg" title='xfrm_state::ealg' data-ref="xfrm_state::ealg" data-ref-filename="xfrm_state..ealg">ealg</a>) {</td></tr>
<tr><th id="873">873</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>, <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_len" title='xfrm_alg_len' data-ref="xfrm_alg_len" data-ref-filename="xfrm_alg_len">xfrm_alg_len</a>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::ealg" title='xfrm_state::ealg' data-ref="xfrm_state::ealg" data-ref-filename="xfrm_state..ealg">ealg</a>), <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::ealg" title='xfrm_state::ealg' data-ref="xfrm_state::ealg" data-ref-filename="xfrm_state..ealg">ealg</a>);</td></tr>
<tr><th id="874">874</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="875">875</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="876">876</th><td>	}</td></tr>
<tr><th id="877">877</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::calg" title='xfrm_state::calg' data-ref="xfrm_state::calg" data-ref-filename="xfrm_state..calg">calg</a>) {</td></tr>
<tr><th id="878">878</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>, <b>sizeof</b>(*(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::calg" title='xfrm_state::calg' data-ref="xfrm_state::calg" data-ref-filename="xfrm_state..calg">calg</a>)), <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::calg" title='xfrm_state::calg' data-ref="xfrm_state::calg" data-ref-filename="xfrm_state..calg">calg</a>);</td></tr>
<tr><th id="879">879</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="880">880</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="881">881</th><td>	}</td></tr>
<tr><th id="882">882</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>) {</td></tr>
<tr><th id="883">883</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ENCAP" title='XFRMA_ENCAP' data-ref="XFRMA_ENCAP" data-ref-filename="XFRMA_ENCAP">XFRMA_ENCAP</a>, <b>sizeof</b>(*<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>), <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>);</td></tr>
<tr><th id="884">884</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="885">885</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="886">886</th><td>	}</td></tr>
<tr><th id="887">887</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::tfcpad" title='xfrm_state::tfcpad' data-ref="xfrm_state::tfcpad" data-ref-filename="xfrm_state..tfcpad">tfcpad</a>) {</td></tr>
<tr><th id="888">888</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_u32" title='nla_put_u32' data-ref="nla_put_u32" data-ref-filename="nla_put_u32">nla_put_u32</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>, <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::tfcpad" title='xfrm_state::tfcpad' data-ref="xfrm_state::tfcpad" data-ref-filename="xfrm_state..tfcpad">tfcpad</a>);</td></tr>
<tr><th id="889">889</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="890">890</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="891">891</th><td>	}</td></tr>
<tr><th id="892">892</th><td>	<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_put" title='xfrm_mark_put' data-ref="xfrm_mark_put" data-ref-filename="xfrm_mark_put">xfrm_mark_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, &amp;<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::mark" title='xfrm_state::mark' data-ref="xfrm_state::mark" data-ref-filename="xfrm_state..mark">mark</a>);</td></tr>
<tr><th id="893">893</th><td>	<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="894">894</th><td>		<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="895">895</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>)</td></tr>
<tr><th id="896">896</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_ESN_VAL" title='XFRMA_REPLAY_ESN_VAL' data-ref="XFRMA_REPLAY_ESN_VAL" data-ref-filename="XFRMA_REPLAY_ESN_VAL">XFRMA_REPLAY_ESN_VAL</a>,</td></tr>
<tr><th id="897">897</th><td>			      <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>),</td></tr>
<tr><th id="898">898</th><td>			      <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>);</td></tr>
<tr><th id="899">899</th><td>	<b>else</b></td></tr>
<tr><th id="900">900</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_VAL" title='XFRMA_REPLAY_VAL' data-ref="XFRMA_REPLAY_VAL" data-ref-filename="XFRMA_REPLAY_VAL">XFRMA_REPLAY_VAL</a>, <b>sizeof</b>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay" title='xfrm_state::replay' data-ref="xfrm_state::replay" data-ref-filename="xfrm_state..replay">replay</a>),</td></tr>
<tr><th id="901">901</th><td>			      &amp;<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay" title='xfrm_state::replay' data-ref="xfrm_state::replay" data-ref-filename="xfrm_state..replay">replay</a>);</td></tr>
<tr><th id="902">902</th><td>	<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="903">903</th><td>		<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="904">904</th><td>	<b>if</b>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::xso" title='xfrm_state::xso' data-ref="xfrm_state::xso" data-ref-filename="xfrm_state..xso">xso</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_offload::dev" title='xfrm_state_offload::dev' data-ref="xfrm_state_offload::dev" data-ref-filename="xfrm_state_offload..dev">dev</a>)</td></tr>
<tr><th id="905">905</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="tu ref fn" href="#copy_user_offload" title='copy_user_offload' data-use='c' data-ref="copy_user_offload" data-ref-filename="copy_user_offload">copy_user_offload</a>(&amp;<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::xso" title='xfrm_state::xso' data-ref="xfrm_state::xso" data-ref-filename="xfrm_state..xso">xso</a>, <a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>);</td></tr>
<tr><th id="906">906</th><td>	<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="907">907</th><td>		<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="908">908</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::output_mark" title='xfrm_state::(anonymous struct)::output_mark' data-ref="xfrm_state::(anonymous)::output_mark" data-ref-filename="xfrm_state..(anonymous)..output_mark">output_mark</a>) {</td></tr>
<tr><th id="909">909</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_u32" title='nla_put_u32' data-ref="nla_put_u32" data-ref-filename="nla_put_u32">nla_put_u32</a>(<a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OUTPUT_MARK" title='XFRMA_OUTPUT_MARK' data-ref="XFRMA_OUTPUT_MARK" data-ref-filename="XFRMA_OUTPUT_MARK">XFRMA_OUTPUT_MARK</a>, <a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::output_mark" title='xfrm_state::(anonymous struct)::output_mark' data-ref="xfrm_state::(anonymous)::output_mark" data-ref-filename="xfrm_state..(anonymous)..output_mark">output_mark</a>);</td></tr>
<tr><th id="910">910</th><td>		<b>if</b> (<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>)</td></tr>
<tr><th id="911">911</th><td>			<b>goto</b> <a class="lbl" href="#137out" data-ref="137out" data-ref-filename="137out">out</a>;</td></tr>
<tr><th id="912">912</th><td>	}</td></tr>
<tr><th id="913">913</th><td>	<b>if</b> (<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::security" title='xfrm_state::security' data-ref="xfrm_state::security" data-ref-filename="xfrm_state..security">security</a>)</td></tr>
<tr><th id="914">914</th><td>		<a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a> = <a class="tu ref fn" href="#copy_sec_ctx" title='copy_sec_ctx' data-use='c' data-ref="copy_sec_ctx" data-ref-filename="copy_sec_ctx">copy_sec_ctx</a>(<a class="local col3 ref" href="#133x" title='x' data-ref="133x" data-ref-filename="133x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::security" title='xfrm_state::security' data-ref="xfrm_state::security" data-ref-filename="xfrm_state..security">security</a>, <a class="local col5 ref" href="#135skb" title='skb' data-ref="135skb" data-ref-filename="135skb">skb</a>);</td></tr>
<tr><th id="915">915</th><td><dfn class="lbl" id="137out" data-ref="137out" data-ref-filename="137out">out</dfn>:</td></tr>
<tr><th id="916">916</th><td>	<b>return</b> <a class="local col6 ref" href="#136ret" title='ret' data-ref="136ret" data-ref-filename="136ret">ret</a>;</td></tr>
<tr><th id="917">917</th><td>}</td></tr>
<tr><th id="918">918</th><td></td></tr>
<tr><th id="919">919</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="dump_one_state" title='dump_one_state' data-type='int dump_one_state(struct xfrm_state * x, int count, void * ptr)' data-ref="dump_one_state" data-ref-filename="dump_one_state">dump_one_state</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col8 decl" id="138x" title='x' data-type='struct xfrm_state *' data-ref="138x" data-ref-filename="138x">x</dfn>, <em>int</em> <dfn class="local col9 decl" id="139count" title='count' data-type='int' data-ref="139count" data-ref-filename="139count">count</dfn>, <em>void</em> *<dfn class="local col0 decl" id="140ptr" title='ptr' data-type='void *' data-ref="140ptr" data-ref-filename="140ptr">ptr</dfn>)</td></tr>
<tr><th id="920">920</th><td>{</td></tr>
<tr><th id="921">921</th><td>	<b>struct</b> <a class="type" href="#xfrm_dump_info" title='xfrm_dump_info' data-ref="xfrm_dump_info" data-ref-filename="xfrm_dump_info">xfrm_dump_info</a> *<dfn class="local col1 decl" id="141sp" title='sp' data-type='struct xfrm_dump_info *' data-ref="141sp" data-ref-filename="141sp">sp</dfn> = <a class="local col0 ref" href="#140ptr" title='ptr' data-ref="140ptr" data-ref-filename="140ptr">ptr</a>;</td></tr>
<tr><th id="922">922</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="142in_skb" title='in_skb' data-type='struct sk_buff *' data-ref="142in_skb" data-ref-filename="142in_skb">in_skb</dfn> = <a class="local col1 ref" href="#141sp" title='sp' data-ref="141sp" data-ref-filename="141sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::in_skb" title='xfrm_dump_info::in_skb' data-use='r' data-ref="xfrm_dump_info::in_skb" data-ref-filename="xfrm_dump_info..in_skb">in_skb</a>;</td></tr>
<tr><th id="923">923</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="143skb" title='skb' data-type='struct sk_buff *' data-ref="143skb" data-ref-filename="143skb">skb</dfn> = <a class="local col1 ref" href="#141sp" title='sp' data-ref="141sp" data-ref-filename="141sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::out_skb" title='xfrm_dump_info::out_skb' data-use='r' data-ref="xfrm_dump_info::out_skb" data-ref-filename="xfrm_dump_info..out_skb">out_skb</a>;</td></tr>
<tr><th id="924">924</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col4 decl" id="144p" title='p' data-type='struct xfrm_usersa_info *' data-ref="144p" data-ref-filename="144p">p</dfn>;</td></tr>
<tr><th id="925">925</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col5 decl" id="145nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="145nlh" data-ref-filename="145nlh">nlh</dfn>;</td></tr>
<tr><th id="926">926</th><td>	<em>int</em> <dfn class="local col6 decl" id="146err" title='err' data-type='int' data-ref="146err" data-ref-filename="146err">err</dfn>;</td></tr>
<tr><th id="927">927</th><td></td></tr>
<tr><th id="928">928</th><td>	<a class="local col5 ref" href="#145nlh" title='nlh' data-ref="145nlh" data-ref-filename="145nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col3 ref" href="#143skb" title='skb' data-ref="143skb" data-ref-filename="143skb">skb</a>, <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((in_skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col2 ref" href="#142in_skb" title='in_skb' data-ref="142in_skb" data-ref-filename="142in_skb">in_skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>, <a class="local col1 ref" href="#141sp" title='sp' data-ref="141sp" data-ref-filename="141sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::nlmsg_seq" title='xfrm_dump_info::nlmsg_seq' data-use='r' data-ref="xfrm_dump_info::nlmsg_seq" data-ref-filename="xfrm_dump_info..nlmsg_seq">nlmsg_seq</a>,</td></tr>
<tr><th id="929">929</th><td>			<a class="macro" href="../../include/uapi/linux/xfrm.h.html#162" title="XFRM_MSG_NEWSA" data-ref="_M/XFRM_MSG_NEWSA">XFRM_MSG_NEWSA</a>, <b>sizeof</b>(*<a class="local col4 ref" href="#144p" title='p' data-ref="144p" data-ref-filename="144p">p</a>), <a class="local col1 ref" href="#141sp" title='sp' data-ref="141sp" data-ref-filename="141sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::nlmsg_flags" title='xfrm_dump_info::nlmsg_flags' data-use='r' data-ref="xfrm_dump_info::nlmsg_flags" data-ref-filename="xfrm_dump_info..nlmsg_flags">nlmsg_flags</a>);</td></tr>
<tr><th id="930">930</th><td>	<b>if</b> (<a class="local col5 ref" href="#145nlh" title='nlh' data-ref="145nlh" data-ref-filename="145nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="931">931</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="932">932</th><td></td></tr>
<tr><th id="933">933</th><td>	<a class="local col4 ref" href="#144p" title='p' data-ref="144p" data-ref-filename="144p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col5 ref" href="#145nlh" title='nlh' data-ref="145nlh" data-ref-filename="145nlh">nlh</a>);</td></tr>
<tr><th id="934">934</th><td></td></tr>
<tr><th id="935">935</th><td>	<a class="local col6 ref" href="#146err" title='err' data-ref="146err" data-ref-filename="146err">err</a> = <a class="tu ref fn" href="#copy_to_user_state_extra" title='copy_to_user_state_extra' data-use='c' data-ref="copy_to_user_state_extra" data-ref-filename="copy_to_user_state_extra">copy_to_user_state_extra</a>(<a class="local col8 ref" href="#138x" title='x' data-ref="138x" data-ref-filename="138x">x</a>, <a class="local col4 ref" href="#144p" title='p' data-ref="144p" data-ref-filename="144p">p</a>, <a class="local col3 ref" href="#143skb" title='skb' data-ref="143skb" data-ref-filename="143skb">skb</a>);</td></tr>
<tr><th id="936">936</th><td>	<b>if</b> (<a class="local col6 ref" href="#146err" title='err' data-ref="146err" data-ref-filename="146err">err</a>) {</td></tr>
<tr><th id="937">937</th><td>		<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col3 ref" href="#143skb" title='skb' data-ref="143skb" data-ref-filename="143skb">skb</a>, <a class="local col5 ref" href="#145nlh" title='nlh' data-ref="145nlh" data-ref-filename="145nlh">nlh</a>);</td></tr>
<tr><th id="938">938</th><td>		<b>return</b> <a class="local col6 ref" href="#146err" title='err' data-ref="146err" data-ref-filename="146err">err</a>;</td></tr>
<tr><th id="939">939</th><td>	}</td></tr>
<tr><th id="940">940</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col3 ref" href="#143skb" title='skb' data-ref="143skb" data-ref-filename="143skb">skb</a>, <a class="local col5 ref" href="#145nlh" title='nlh' data-ref="145nlh" data-ref-filename="145nlh">nlh</a>);</td></tr>
<tr><th id="941">941</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="942">942</th><td>}</td></tr>
<tr><th id="943">943</th><td></td></tr>
<tr><th id="944">944</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_dump_sa_done" title='xfrm_dump_sa_done' data-type='int xfrm_dump_sa_done(struct netlink_callback * cb)' data-ref="xfrm_dump_sa_done" data-ref-filename="xfrm_dump_sa_done">xfrm_dump_sa_done</dfn>(<b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *<dfn class="local col7 decl" id="147cb" title='cb' data-type='struct netlink_callback *' data-ref="147cb" data-ref-filename="147cb">cb</dfn>)</td></tr>
<tr><th id="945">945</th><td>{</td></tr>
<tr><th id="946">946</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state_walk" title='xfrm_state_walk' data-ref="xfrm_state_walk" data-ref-filename="xfrm_state_walk">xfrm_state_walk</a> *<dfn class="local col8 decl" id="148walk" title='walk' data-type='struct xfrm_state_walk *' data-ref="148walk" data-ref-filename="148walk">walk</dfn> = (<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state_walk" title='xfrm_state_walk' data-ref="xfrm_state_walk" data-ref-filename="xfrm_state_walk">xfrm_state_walk</a> *) &amp;<a class="local col7 ref" href="#147cb" title='cb' data-ref="147cb" data-ref-filename="147cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>[<var>1</var>];</td></tr>
<tr><th id="947">947</th><td>	<b>struct</b> <a class="type" href="../../include/net/sock.h.html#sock" title='sock' data-ref="sock" data-ref-filename="sock">sock</a> *<dfn class="local col9 decl" id="149sk" title='sk' data-type='struct sock *' data-ref="149sk" data-ref-filename="149sk">sk</dfn> = <a class="local col7 ref" href="#147cb" title='cb' data-ref="147cb" data-ref-filename="147cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::skb" title='netlink_callback::skb' data-ref="netlink_callback::skb" data-ref-filename="netlink_callback..skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>;</td></tr>
<tr><th id="948">948</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col0 decl" id="150net" title='net' data-type='struct net *' data-ref="150net" data-ref-filename="150net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col9 ref" href="#149sk" title='sk' data-ref="149sk" data-ref-filename="149sk">sk</a>);</td></tr>
<tr><th id="949">949</th><td></td></tr>
<tr><th id="950">950</th><td>	<b>if</b> (<a class="local col7 ref" href="#147cb" title='cb' data-ref="147cb" data-ref-filename="147cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>[<var>0</var>])</td></tr>
<tr><th id="951">951</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_walk_done" title='xfrm_state_walk_done' data-ref="xfrm_state_walk_done" data-ref-filename="xfrm_state_walk_done">xfrm_state_walk_done</a>(<a class="local col8 ref" href="#148walk" title='walk' data-ref="148walk" data-ref-filename="148walk">walk</a>, <a class="local col0 ref" href="#150net" title='net' data-ref="150net" data-ref-filename="150net">net</a>);</td></tr>
<tr><th id="952">952</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="953">953</th><td>}</td></tr>
<tr><th id="954">954</th><td></td></tr>
<tr><th id="955">955</th><td><em>static</em> <em>const</em> <b>struct</b> <a class="type" href="../../include/net/netlink.h.html#nla_policy" title='nla_policy' data-ref="nla_policy" data-ref-filename="nla_policy">nla_policy</a> <dfn class="tu decl def" id="xfrma_policy" title='xfrma_policy' data-type='const struct nla_policy [30]' data-ref="xfrma_policy" data-ref-filename="xfrma_policy">xfrma_policy</dfn>[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#311" title="(__XFRMA_MAX - 1)" data-ref="_M/XFRMA_MAX">XFRMA_MAX</a>+<var>1</var>];</td></tr>
<tr><th id="956">956</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_dump_sa" title='xfrm_dump_sa' data-type='int xfrm_dump_sa(struct sk_buff * skb, struct netlink_callback * cb)' data-ref="xfrm_dump_sa" data-ref-filename="xfrm_dump_sa">xfrm_dump_sa</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col1 decl" id="151skb" title='skb' data-type='struct sk_buff *' data-ref="151skb" data-ref-filename="151skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *<dfn class="local col2 decl" id="152cb" title='cb' data-type='struct netlink_callback *' data-ref="152cb" data-ref-filename="152cb">cb</dfn>)</td></tr>
<tr><th id="957">957</th><td>{</td></tr>
<tr><th id="958">958</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col3 decl" id="153net" title='net' data-type='struct net *' data-ref="153net" data-ref-filename="153net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col1 ref" href="#151skb" title='skb' data-ref="151skb" data-ref-filename="151skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="959">959</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state_walk" title='xfrm_state_walk' data-ref="xfrm_state_walk" data-ref-filename="xfrm_state_walk">xfrm_state_walk</a> *<dfn class="local col4 decl" id="154walk" title='walk' data-type='struct xfrm_state_walk *' data-ref="154walk" data-ref-filename="154walk">walk</dfn> = (<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state_walk" title='xfrm_state_walk' data-ref="xfrm_state_walk" data-ref-filename="xfrm_state_walk">xfrm_state_walk</a> *) &amp;<a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>[<var>1</var>];</td></tr>
<tr><th id="960">960</th><td>	<b>struct</b> <a class="type" href="#xfrm_dump_info" title='xfrm_dump_info' data-ref="xfrm_dump_info" data-ref-filename="xfrm_dump_info">xfrm_dump_info</a> <dfn class="local col5 decl" id="155info" title='info' data-type='struct xfrm_dump_info' data-ref="155info" data-ref-filename="155info">info</dfn>;</td></tr>
<tr><th id="961">961</th><td></td></tr>
<tr><th id="962">962</th><td>	<a class="macro" href="../../include/linux/build_bug.h.html#70" title="do { bool __cond = !(!(sizeof(struct xfrm_state_walk) &gt; sizeof(cb-&gt;args) - sizeof(cb-&gt;args[0]))); extern void __compiletime_assert_963(void) ; if (__cond) __compiletime_assert_963(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0)" data-ref="_M/BUILD_BUG_ON">BUILD_BUG_ON</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state_walk" title='xfrm_state_walk' data-ref="xfrm_state_walk" data-ref-filename="xfrm_state_walk">xfrm_state_walk</a>) &gt;</td></tr>
<tr><th id="963">963</th><td>		     <b>sizeof</b>(<a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>) - <b>sizeof</b>(<a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>[<var>0</var>]));</td></tr>
<tr><th id="964">964</th><td></td></tr>
<tr><th id="965">965</th><td>	<a class="local col5 ref" href="#155info" title='info' data-ref="155info" data-ref-filename="155info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::in_skb" title='xfrm_dump_info::in_skb' data-use='w' data-ref="xfrm_dump_info::in_skb" data-ref-filename="xfrm_dump_info..in_skb">in_skb</a> = <a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::skb" title='netlink_callback::skb' data-ref="netlink_callback::skb" data-ref-filename="netlink_callback..skb">skb</a>;</td></tr>
<tr><th id="966">966</th><td>	<a class="local col5 ref" href="#155info" title='info' data-ref="155info" data-ref-filename="155info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::out_skb" title='xfrm_dump_info::out_skb' data-use='w' data-ref="xfrm_dump_info::out_skb" data-ref-filename="xfrm_dump_info..out_skb">out_skb</a> = <a class="local col1 ref" href="#151skb" title='skb' data-ref="151skb" data-ref-filename="151skb">skb</a>;</td></tr>
<tr><th id="967">967</th><td>	<a class="local col5 ref" href="#155info" title='info' data-ref="155info" data-ref-filename="155info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_seq" title='xfrm_dump_info::nlmsg_seq' data-use='w' data-ref="xfrm_dump_info::nlmsg_seq" data-ref-filename="xfrm_dump_info..nlmsg_seq">nlmsg_seq</a> = <a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::nlh" title='netlink_callback::nlh' data-ref="netlink_callback::nlh" data-ref-filename="netlink_callback..nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="968">968</th><td>	<a class="local col5 ref" href="#155info" title='info' data-ref="155info" data-ref-filename="155info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_flags" title='xfrm_dump_info::nlmsg_flags' data-use='w' data-ref="xfrm_dump_info::nlmsg_flags" data-ref-filename="xfrm_dump_info..nlmsg_flags">nlmsg_flags</a> = <a class="macro" href="../../include/uapi/linux/netlink.h.html#55" title="0x02" data-ref="_M/NLM_F_MULTI">NLM_F_MULTI</a>;</td></tr>
<tr><th id="969">969</th><td></td></tr>
<tr><th id="970">970</th><td>	<b>if</b> (!<a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>[<var>0</var>]) {</td></tr>
<tr><th id="971">971</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col6 decl" id="156attrs" title='attrs' data-type='struct nlattr *[30]' data-ref="156attrs" data-ref-filename="156attrs">attrs</dfn>[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#311" title="(__XFRMA_MAX - 1)" data-ref="_M/XFRMA_MAX">XFRMA_MAX</a>+<var>1</var>];</td></tr>
<tr><th id="972">972</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_filter" title='xfrm_address_filter' data-ref="xfrm_address_filter" data-ref-filename="xfrm_address_filter">xfrm_address_filter</a> *<dfn class="local col7 decl" id="157filter" title='filter' data-type='struct xfrm_address_filter *' data-ref="157filter" data-ref-filename="157filter">filter</dfn> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="973">973</th><td>		<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col8 decl" id="158proto" title='proto' data-type='u8' data-ref="158proto" data-ref-filename="158proto">proto</dfn> = <var>0</var>;</td></tr>
<tr><th id="974">974</th><td>		<em>int</em> <dfn class="local col9 decl" id="159err" title='err' data-type='int' data-ref="159err" data-ref-filename="159err">err</dfn>;</td></tr>
<tr><th id="975">975</th><td></td></tr>
<tr><th id="976">976</th><td>		<a class="local col9 ref" href="#159err" title='err' data-ref="159err" data-ref-filename="159err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_parse" title='nlmsg_parse' data-ref="nlmsg_parse" data-ref-filename="nlmsg_parse">nlmsg_parse</a>(<a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::nlh" title='netlink_callback::nlh' data-ref="netlink_callback::nlh" data-ref-filename="netlink_callback..nlh">nlh</a>, <var>0</var>, <a class="local col6 ref" href="#156attrs" title='attrs' data-ref="156attrs" data-ref-filename="156attrs">attrs</a>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#311" title="(__XFRMA_MAX - 1)" data-ref="_M/XFRMA_MAX">XFRMA_MAX</a>, <a class="tu ref" href="#xfrma_policy" title='xfrma_policy' data-use='r' data-ref="xfrma_policy" data-ref-filename="xfrma_policy">xfrma_policy</a>,</td></tr>
<tr><th id="977">977</th><td>				  <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="978">978</th><td>		<b>if</b> (<a class="local col9 ref" href="#159err" title='err' data-ref="159err" data-ref-filename="159err">err</a> &lt; <var>0</var>)</td></tr>
<tr><th id="979">979</th><td>			<b>return</b> <a class="local col9 ref" href="#159err" title='err' data-ref="159err" data-ref-filename="159err">err</a>;</td></tr>
<tr><th id="980">980</th><td></td></tr>
<tr><th id="981">981</th><td>		<b>if</b> (<a class="local col6 ref" href="#156attrs" title='attrs' data-ref="156attrs" data-ref-filename="156attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ADDRESS_FILTER" title='XFRMA_ADDRESS_FILTER' data-ref="XFRMA_ADDRESS_FILTER" data-ref-filename="XFRMA_ADDRESS_FILTER">XFRMA_ADDRESS_FILTER</a>]) {</td></tr>
<tr><th id="982">982</th><td>			<a class="local col7 ref" href="#157filter" title='filter' data-ref="157filter" data-ref-filename="157filter">filter</a> = <a class="ref fn" href="../../include/linux/string.h.html#kmemdup" title='kmemdup' data-ref="kmemdup" data-ref-filename="kmemdup">kmemdup</a>(<a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col6 ref" href="#156attrs" title='attrs' data-ref="156attrs" data-ref-filename="156attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ADDRESS_FILTER" title='XFRMA_ADDRESS_FILTER' data-ref="XFRMA_ADDRESS_FILTER" data-ref-filename="XFRMA_ADDRESS_FILTER">XFRMA_ADDRESS_FILTER</a>]),</td></tr>
<tr><th id="983">983</th><td>					 <b>sizeof</b>(*<a class="local col7 ref" href="#157filter" title='filter' data-ref="157filter" data-ref-filename="157filter">filter</a>), <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="984">984</th><td>			<b>if</b> (<a class="local col7 ref" href="#157filter" title='filter' data-ref="157filter" data-ref-filename="157filter">filter</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="985">985</th><td>				<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="986">986</th><td>		}</td></tr>
<tr><th id="987">987</th><td></td></tr>
<tr><th id="988">988</th><td>		<b>if</b> (<a class="local col6 ref" href="#156attrs" title='attrs' data-ref="156attrs" data-ref-filename="156attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_PROTO" title='XFRMA_PROTO' data-ref="XFRMA_PROTO" data-ref-filename="XFRMA_PROTO">XFRMA_PROTO</a>])</td></tr>
<tr><th id="989">989</th><td>			<a class="local col8 ref" href="#158proto" title='proto' data-ref="158proto" data-ref-filename="158proto">proto</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_get_u8" title='nla_get_u8' data-ref="nla_get_u8" data-ref-filename="nla_get_u8">nla_get_u8</a>(<a class="local col6 ref" href="#156attrs" title='attrs' data-ref="156attrs" data-ref-filename="156attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_PROTO" title='XFRMA_PROTO' data-ref="XFRMA_PROTO" data-ref-filename="XFRMA_PROTO">XFRMA_PROTO</a>]);</td></tr>
<tr><th id="990">990</th><td></td></tr>
<tr><th id="991">991</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_walk_init" title='xfrm_state_walk_init' data-ref="xfrm_state_walk_init" data-ref-filename="xfrm_state_walk_init">xfrm_state_walk_init</a>(<a class="local col4 ref" href="#154walk" title='walk' data-ref="154walk" data-ref-filename="154walk">walk</a>, <a class="local col8 ref" href="#158proto" title='proto' data-ref="158proto" data-ref-filename="158proto">proto</a>, <a class="local col7 ref" href="#157filter" title='filter' data-ref="157filter" data-ref-filename="157filter">filter</a>);</td></tr>
<tr><th id="992">992</th><td>		<a class="local col2 ref" href="#152cb" title='cb' data-ref="152cb" data-ref-filename="152cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>[<var>0</var>] = <var>1</var>;</td></tr>
<tr><th id="993">993</th><td>	}</td></tr>
<tr><th id="994">994</th><td></td></tr>
<tr><th id="995">995</th><td>	(<em>void</em>) <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_walk" title='xfrm_state_walk' data-ref="xfrm_state_walk" data-ref-filename="xfrm_state_walk">xfrm_state_walk</a>(<a class="local col3 ref" href="#153net" title='net' data-ref="153net" data-ref-filename="153net">net</a>, <a class="local col4 ref" href="#154walk" title='walk' data-ref="154walk" data-ref-filename="154walk">walk</a>, <a class="tu ref fn" href="#dump_one_state" title='dump_one_state' data-use='r' data-ref="dump_one_state" data-ref-filename="dump_one_state">dump_one_state</a>, &amp;<a class="local col5 ref" href="#155info" title='info' data-ref="155info" data-ref-filename="155info">info</a>);</td></tr>
<tr><th id="996">996</th><td></td></tr>
<tr><th id="997">997</th><td>	<b>return</b> <a class="local col1 ref" href="#151skb" title='skb' data-ref="151skb" data-ref-filename="151skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::len" title='sk_buff::len' data-ref="sk_buff::len" data-ref-filename="sk_buff..len">len</a>;</td></tr>
<tr><th id="998">998</th><td>}</td></tr>
<tr><th id="999">999</th><td></td></tr>
<tr><th id="1000">1000</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="tu decl def fn" id="xfrm_state_netlink" title='xfrm_state_netlink' data-type='struct sk_buff * xfrm_state_netlink(struct sk_buff * in_skb, struct xfrm_state * x, u32 seq)' data-ref="xfrm_state_netlink" data-ref-filename="xfrm_state_netlink">xfrm_state_netlink</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col0 decl" id="160in_skb" title='in_skb' data-type='struct sk_buff *' data-ref="160in_skb" data-ref-filename="160in_skb">in_skb</dfn>,</td></tr>
<tr><th id="1001">1001</th><td>					  <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="161x" title='x' data-type='struct xfrm_state *' data-ref="161x" data-ref-filename="161x">x</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col2 decl" id="162seq" title='seq' data-type='u32' data-ref="162seq" data-ref-filename="162seq">seq</dfn>)</td></tr>
<tr><th id="1002">1002</th><td>{</td></tr>
<tr><th id="1003">1003</th><td>	<b>struct</b> <a class="type" href="#xfrm_dump_info" title='xfrm_dump_info' data-ref="xfrm_dump_info" data-ref-filename="xfrm_dump_info">xfrm_dump_info</a> <dfn class="local col3 decl" id="163info" title='info' data-type='struct xfrm_dump_info' data-ref="163info" data-ref-filename="163info">info</dfn>;</td></tr>
<tr><th id="1004">1004</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col4 decl" id="164skb" title='skb' data-type='struct sk_buff *' data-ref="164skb" data-ref-filename="164skb">skb</dfn>;</td></tr>
<tr><th id="1005">1005</th><td>	<em>int</em> <dfn class="local col5 decl" id="165err" title='err' data-type='int' data-ref="165err" data-ref-filename="165err">err</dfn>;</td></tr>
<tr><th id="1006">1006</th><td></td></tr>
<tr><th id="1007">1007</th><td>	<a class="local col4 ref" href="#164skb" title='skb' data-ref="164skb" data-ref-filename="164skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="macro" href="../../include/linux/netlink.h.html#167" title="(((((1UL) &lt;&lt; 12)) - ((((sizeof(struct skb_shared_info))) + ((typeof((sizeof(struct skb_shared_info))))(((1 &lt;&lt; (6)))) - 1)) &amp; ~((typeof((sizeof(struct skb_shared_info))))(((1 &lt;&lt; (6)))) - 1))) - ((int) ( ((sizeof(struct nlmsghdr))+4U-1) &amp; ~(4U-1) )))" data-ref="_M/NLMSG_DEFAULT_SIZE">NLMSG_DEFAULT_SIZE</a>, <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="1008">1008</th><td>	<b>if</b> (!<a class="local col4 ref" href="#164skb" title='skb' data-ref="164skb" data-ref-filename="164skb">skb</a>)</td></tr>
<tr><th id="1009">1009</th><td>		<b>return</b> <a class="ref fn" href="../../include/linux/err.h.html#ERR_PTR" title='ERR_PTR' data-ref="ERR_PTR" data-ref-filename="ERR_PTR">ERR_PTR</a>(-<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>);</td></tr>
<tr><th id="1010">1010</th><td></td></tr>
<tr><th id="1011">1011</th><td>	<a class="local col3 ref" href="#163info" title='info' data-ref="163info" data-ref-filename="163info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::in_skb" title='xfrm_dump_info::in_skb' data-use='w' data-ref="xfrm_dump_info::in_skb" data-ref-filename="xfrm_dump_info..in_skb">in_skb</a> = <a class="local col0 ref" href="#160in_skb" title='in_skb' data-ref="160in_skb" data-ref-filename="160in_skb">in_skb</a>;</td></tr>
<tr><th id="1012">1012</th><td>	<a class="local col3 ref" href="#163info" title='info' data-ref="163info" data-ref-filename="163info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::out_skb" title='xfrm_dump_info::out_skb' data-use='w' data-ref="xfrm_dump_info::out_skb" data-ref-filename="xfrm_dump_info..out_skb">out_skb</a> = <a class="local col4 ref" href="#164skb" title='skb' data-ref="164skb" data-ref-filename="164skb">skb</a>;</td></tr>
<tr><th id="1013">1013</th><td>	<a class="local col3 ref" href="#163info" title='info' data-ref="163info" data-ref-filename="163info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_seq" title='xfrm_dump_info::nlmsg_seq' data-use='w' data-ref="xfrm_dump_info::nlmsg_seq" data-ref-filename="xfrm_dump_info..nlmsg_seq">nlmsg_seq</a> = <a class="local col2 ref" href="#162seq" title='seq' data-ref="162seq" data-ref-filename="162seq">seq</a>;</td></tr>
<tr><th id="1014">1014</th><td>	<a class="local col3 ref" href="#163info" title='info' data-ref="163info" data-ref-filename="163info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_flags" title='xfrm_dump_info::nlmsg_flags' data-use='w' data-ref="xfrm_dump_info::nlmsg_flags" data-ref-filename="xfrm_dump_info..nlmsg_flags">nlmsg_flags</a> = <var>0</var>;</td></tr>
<tr><th id="1015">1015</th><td></td></tr>
<tr><th id="1016">1016</th><td>	<a class="local col5 ref" href="#165err" title='err' data-ref="165err" data-ref-filename="165err">err</a> = <a class="tu ref fn" href="#dump_one_state" title='dump_one_state' data-use='c' data-ref="dump_one_state" data-ref-filename="dump_one_state">dump_one_state</a>(<a class="local col1 ref" href="#161x" title='x' data-ref="161x" data-ref-filename="161x">x</a>, <var>0</var>, &amp;<a class="local col3 ref" href="#163info" title='info' data-ref="163info" data-ref-filename="163info">info</a>);</td></tr>
<tr><th id="1017">1017</th><td>	<b>if</b> (<a class="local col5 ref" href="#165err" title='err' data-ref="165err" data-ref-filename="165err">err</a>) {</td></tr>
<tr><th id="1018">1018</th><td>		<a class="ref fn" href="../../include/linux/skbuff.h.html#kfree_skb" title='kfree_skb' data-ref="kfree_skb" data-ref-filename="kfree_skb">kfree_skb</a>(<a class="local col4 ref" href="#164skb" title='skb' data-ref="164skb" data-ref-filename="164skb">skb</a>);</td></tr>
<tr><th id="1019">1019</th><td>		<b>return</b> <a class="ref fn" href="../../include/linux/err.h.html#ERR_PTR" title='ERR_PTR' data-ref="ERR_PTR" data-ref-filename="ERR_PTR">ERR_PTR</a>(<a class="local col5 ref" href="#165err" title='err' data-ref="165err" data-ref-filename="165err">err</a>);</td></tr>
<tr><th id="1020">1020</th><td>	}</td></tr>
<tr><th id="1021">1021</th><td></td></tr>
<tr><th id="1022">1022</th><td>	<b>return</b> <a class="local col4 ref" href="#164skb" title='skb' data-ref="164skb" data-ref-filename="164skb">skb</a>;</td></tr>
<tr><th id="1023">1023</th><td>}</td></tr>
<tr><th id="1024">1024</th><td></td></tr>
<tr><th id="1025">1025</th><td><i  data-doc="xfrm_nlmsg_multicast">/* A wrapper for nlmsg_multicast() checking that nlsk is still available.</i></td></tr>
<tr><th id="1026">1026</th><td><i  data-doc="xfrm_nlmsg_multicast"> * Must be called with RCU read lock.</i></td></tr>
<tr><th id="1027">1027</th><td><i  data-doc="xfrm_nlmsg_multicast"> */</i></td></tr>
<tr><th id="1028">1028</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-type='int xfrm_nlmsg_multicast(struct net * net, struct sk_buff * skb, u32 pid, unsigned int group)' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</dfn>(<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col6 decl" id="166net" title='net' data-type='struct net *' data-ref="166net" data-ref-filename="166net">net</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="167skb" title='skb' data-type='struct sk_buff *' data-ref="167skb" data-ref-filename="167skb">skb</dfn>,</td></tr>
<tr><th id="1029">1029</th><td>				       <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col8 decl" id="168pid" title='pid' data-type='u32' data-ref="168pid" data-ref-filename="168pid">pid</dfn>, <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="169group" title='group' data-type='unsigned int' data-ref="169group" data-ref-filename="169group">group</dfn>)</td></tr>
<tr><th id="1030">1030</th><td>{</td></tr>
<tr><th id="1031">1031</th><td>	<b>struct</b> <a class="type" href="../../include/net/sock.h.html#sock" title='sock' data-ref="sock" data-ref-filename="sock">sock</a> *<dfn class="local col0 decl" id="170nlsk" title='nlsk' data-type='struct sock *' data-ref="170nlsk" data-ref-filename="170nlsk">nlsk</dfn> = <a class="macro" href="../../include/linux/rcupdate.h.html#545" title="({ typeof(*(net-&gt;xfrm.nlsk)) *________p1 = (typeof(*(net-&gt;xfrm.nlsk)) *)({ union { typeof((net-&gt;xfrm.nlsk)) __val; char __c[1]; } __u; if (1) __read_once_size(&amp;((net-&gt;xfrm.nlsk)), __u.__c, sizeof((net-&gt;xfrm.nlsk))); else __read_once_size_nocheck(&amp;((net-&gt;xfrm.nlsk)), __u.__c, sizeof((net-&gt;xfrm.nlsk))); do { } while (0); __u.__val; }); do { } while (0); ; ((typeof(*(net-&gt;xfrm.nlsk)) *)(________p1)); })" data-ref="_M/rcu_dereference">rcu_dereference</a>(<a class="local col6 ref" href="#166net" title='net' data-ref="166net" data-ref-filename="166net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>);</td></tr>
<tr><th id="1032">1032</th><td></td></tr>
<tr><th id="1033">1033</th><td>	<b>if</b> (<a class="local col0 ref" href="#170nlsk" title='nlsk' data-ref="170nlsk" data-ref-filename="170nlsk">nlsk</a>)</td></tr>
<tr><th id="1034">1034</th><td>		<b>return</b> <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_multicast" title='nlmsg_multicast' data-ref="nlmsg_multicast" data-ref-filename="nlmsg_multicast">nlmsg_multicast</a>(<a class="local col0 ref" href="#170nlsk" title='nlsk' data-ref="170nlsk" data-ref-filename="170nlsk">nlsk</a>, <a class="local col7 ref" href="#167skb" title='skb' data-ref="167skb" data-ref-filename="167skb">skb</a>, <a class="local col8 ref" href="#168pid" title='pid' data-ref="168pid" data-ref-filename="168pid">pid</a>, <a class="local col9 ref" href="#169group" title='group' data-ref="169group" data-ref-filename="169group">group</a>, <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="1035">1035</th><td>	<b>else</b></td></tr>
<tr><th id="1036">1036</th><td>		<b>return</b> -<var>1</var>;</td></tr>
<tr><th id="1037">1037</th><td>}</td></tr>
<tr><th id="1038">1038</th><td></td></tr>
<tr><th id="1039">1039</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_spdinfo_msgsize" title='xfrm_spdinfo_msgsize' data-type='unsigned int xfrm_spdinfo_msgsize()' data-ref="xfrm_spdinfo_msgsize" data-ref-filename="xfrm_spdinfo_msgsize">xfrm_spdinfo_msgsize</dfn>(<em>void</em>)</td></tr>
<tr><th id="1040">1040</th><td>{</td></tr>
<tr><th id="1041">1041</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((4)+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<var>4</var>)</td></tr>
<tr><th id="1042">1042</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo" title='xfrmu_spdinfo' data-ref="xfrmu_spdinfo" data-ref-filename="xfrmu_spdinfo">xfrmu_spdinfo</a>))</td></tr>
<tr><th id="1043">1043</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhinfo" title='xfrmu_spdhinfo' data-ref="xfrmu_spdhinfo" data-ref-filename="xfrmu_spdhinfo">xfrmu_spdhinfo</a>))</td></tr>
<tr><th id="1044">1044</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh" title='xfrmu_spdhthresh' data-ref="xfrmu_spdhthresh" data-ref-filename="xfrmu_spdhthresh">xfrmu_spdhthresh</a>))</td></tr>
<tr><th id="1045">1045</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh" title='xfrmu_spdhthresh' data-ref="xfrmu_spdhthresh" data-ref-filename="xfrmu_spdhthresh">xfrmu_spdhthresh</a>));</td></tr>
<tr><th id="1046">1046</th><td>}</td></tr>
<tr><th id="1047">1047</th><td></td></tr>
<tr><th id="1048">1048</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_spdinfo" title='build_spdinfo' data-type='int build_spdinfo(struct sk_buff * skb, struct net * net, u32 portid, u32 seq, u32 flags)' data-ref="build_spdinfo" data-ref-filename="build_spdinfo">build_spdinfo</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col1 decl" id="171skb" title='skb' data-type='struct sk_buff *' data-ref="171skb" data-ref-filename="171skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col2 decl" id="172net" title='net' data-type='struct net *' data-ref="172net" data-ref-filename="172net">net</dfn>,</td></tr>
<tr><th id="1049">1049</th><td>			 <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col3 decl" id="173portid" title='portid' data-type='u32' data-ref="173portid" data-ref-filename="173portid">portid</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col4 decl" id="174seq" title='seq' data-type='u32' data-ref="174seq" data-ref-filename="174seq">seq</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col5 decl" id="175flags" title='flags' data-type='u32' data-ref="175flags" data-ref-filename="175flags">flags</dfn>)</td></tr>
<tr><th id="1050">1050</th><td>{</td></tr>
<tr><th id="1051">1051</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrmk_spdinfo" title='xfrmk_spdinfo' data-ref="xfrmk_spdinfo" data-ref-filename="xfrmk_spdinfo">xfrmk_spdinfo</a> <dfn class="local col6 decl" id="176si" title='si' data-type='struct xfrmk_spdinfo' data-ref="176si" data-ref-filename="176si">si</dfn>;</td></tr>
<tr><th id="1052">1052</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo" title='xfrmu_spdinfo' data-ref="xfrmu_spdinfo" data-ref-filename="xfrmu_spdinfo">xfrmu_spdinfo</a> <dfn class="local col7 decl" id="177spc" title='spc' data-type='struct xfrmu_spdinfo' data-ref="177spc" data-ref-filename="177spc">spc</dfn>;</td></tr>
<tr><th id="1053">1053</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhinfo" title='xfrmu_spdhinfo' data-ref="xfrmu_spdhinfo" data-ref-filename="xfrmu_spdhinfo">xfrmu_spdhinfo</a> <dfn class="local col8 decl" id="178sph" title='sph' data-type='struct xfrmu_spdhinfo' data-ref="178sph" data-ref-filename="178sph">sph</dfn>;</td></tr>
<tr><th id="1054">1054</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh" title='xfrmu_spdhthresh' data-ref="xfrmu_spdhthresh" data-ref-filename="xfrmu_spdhthresh">xfrmu_spdhthresh</a> <dfn class="local col9 decl" id="179spt4" title='spt4' data-type='struct xfrmu_spdhthresh' data-ref="179spt4" data-ref-filename="179spt4">spt4</dfn>, <dfn class="local col0 decl" id="180spt6" title='spt6' data-type='struct xfrmu_spdhthresh' data-ref="180spt6" data-ref-filename="180spt6">spt6</dfn>;</td></tr>
<tr><th id="1055">1055</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col1 decl" id="181nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="181nlh" data-ref-filename="181nlh">nlh</dfn>;</td></tr>
<tr><th id="1056">1056</th><td>	<em>int</em> <dfn class="local col2 decl" id="182err" title='err' data-type='int' data-ref="182err" data-ref-filename="182err">err</dfn>;</td></tr>
<tr><th id="1057">1057</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> *<dfn class="local col3 decl" id="183f" title='f' data-type='u32 *' data-ref="183f" data-ref-filename="183f">f</dfn>;</td></tr>
<tr><th id="1058">1058</th><td>	<em>unsigned</em> <dfn class="local col4 decl" id="184lseq" title='lseq' data-type='unsigned int' data-ref="184lseq" data-ref-filename="184lseq">lseq</dfn>;</td></tr>
<tr><th id="1059">1059</th><td></td></tr>
<tr><th id="1060">1060</th><td>	<a class="local col1 ref" href="#181nlh" title='nlh' data-ref="181nlh" data-ref-filename="181nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col1 ref" href="#171skb" title='skb' data-ref="171skb" data-ref-filename="171skb">skb</a>, <a class="local col3 ref" href="#173portid" title='portid' data-ref="173portid" data-ref-filename="173portid">portid</a>, <a class="local col4 ref" href="#174seq" title='seq' data-ref="174seq" data-ref-filename="174seq">seq</a>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#212" title="XFRM_MSG_NEWSPDINFO" data-ref="_M/XFRM_MSG_NEWSPDINFO">XFRM_MSG_NEWSPDINFO</a>, <b>sizeof</b>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a>), <var>0</var>);</td></tr>
<tr><th id="1061">1061</th><td>	<b>if</b> (<a class="local col1 ref" href="#181nlh" title='nlh' data-ref="181nlh" data-ref-filename="181nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) <i>/* shouldn't really happen ... */</i></td></tr>
<tr><th id="1062">1062</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="1063">1063</th><td></td></tr>
<tr><th id="1064">1064</th><td>	<a class="local col3 ref" href="#183f" title='f' data-ref="183f" data-ref-filename="183f">f</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col1 ref" href="#181nlh" title='nlh' data-ref="181nlh" data-ref-filename="181nlh">nlh</a>);</td></tr>
<tr><th id="1065">1065</th><td>	*<a class="local col3 ref" href="#183f" title='f' data-ref="183f" data-ref-filename="183f">f</a> = <a class="local col5 ref" href="#175flags" title='flags' data-ref="175flags" data-ref-filename="175flags">flags</a>;</td></tr>
<tr><th id="1066">1066</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_spd_getinfo" title='xfrm_spd_getinfo' data-ref="xfrm_spd_getinfo" data-ref-filename="xfrm_spd_getinfo">xfrm_spd_getinfo</a>(<a class="local col2 ref" href="#172net" title='net' data-ref="172net" data-ref-filename="172net">net</a>, &amp;<a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>);</td></tr>
<tr><th id="1067">1067</th><td>	<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo::incnt" title='xfrmu_spdinfo::incnt' data-ref="xfrmu_spdinfo::incnt" data-ref-filename="xfrmu_spdinfo..incnt">incnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::incnt" title='xfrmk_spdinfo::incnt' data-ref="xfrmk_spdinfo::incnt" data-ref-filename="xfrmk_spdinfo..incnt">incnt</a>;</td></tr>
<tr><th id="1068">1068</th><td>	<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo::outcnt" title='xfrmu_spdinfo::outcnt' data-ref="xfrmu_spdinfo::outcnt" data-ref-filename="xfrmu_spdinfo..outcnt">outcnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::outcnt" title='xfrmk_spdinfo::outcnt' data-ref="xfrmk_spdinfo::outcnt" data-ref-filename="xfrmk_spdinfo..outcnt">outcnt</a>;</td></tr>
<tr><th id="1069">1069</th><td>	<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo::fwdcnt" title='xfrmu_spdinfo::fwdcnt' data-ref="xfrmu_spdinfo::fwdcnt" data-ref-filename="xfrmu_spdinfo..fwdcnt">fwdcnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::fwdcnt" title='xfrmk_spdinfo::fwdcnt' data-ref="xfrmk_spdinfo::fwdcnt" data-ref-filename="xfrmk_spdinfo..fwdcnt">fwdcnt</a>;</td></tr>
<tr><th id="1070">1070</th><td>	<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo::inscnt" title='xfrmu_spdinfo::inscnt' data-ref="xfrmu_spdinfo::inscnt" data-ref-filename="xfrmu_spdinfo..inscnt">inscnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::inscnt" title='xfrmk_spdinfo::inscnt' data-ref="xfrmk_spdinfo::inscnt" data-ref-filename="xfrmk_spdinfo..inscnt">inscnt</a>;</td></tr>
<tr><th id="1071">1071</th><td>	<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo::outscnt" title='xfrmu_spdinfo::outscnt' data-ref="xfrmu_spdinfo::outscnt" data-ref-filename="xfrmu_spdinfo..outscnt">outscnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::outscnt" title='xfrmk_spdinfo::outscnt' data-ref="xfrmk_spdinfo::outscnt" data-ref-filename="xfrmk_spdinfo..outscnt">outscnt</a>;</td></tr>
<tr><th id="1072">1072</th><td>	<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdinfo::fwdscnt" title='xfrmu_spdinfo::fwdscnt' data-ref="xfrmu_spdinfo::fwdscnt" data-ref-filename="xfrmu_spdinfo..fwdscnt">fwdscnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::fwdscnt" title='xfrmk_spdinfo::fwdscnt' data-ref="xfrmk_spdinfo::fwdscnt" data-ref-filename="xfrmk_spdinfo..fwdscnt">fwdscnt</a>;</td></tr>
<tr><th id="1073">1073</th><td>	<a class="local col8 ref" href="#178sph" title='sph' data-ref="178sph" data-ref-filename="178sph">sph</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhinfo::spdhcnt" title='xfrmu_spdhinfo::spdhcnt' data-ref="xfrmu_spdhinfo::spdhcnt" data-ref-filename="xfrmu_spdhinfo..spdhcnt">spdhcnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::spdhcnt" title='xfrmk_spdinfo::spdhcnt' data-ref="xfrmk_spdinfo::spdhcnt" data-ref-filename="xfrmk_spdinfo..spdhcnt">spdhcnt</a>;</td></tr>
<tr><th id="1074">1074</th><td>	<a class="local col8 ref" href="#178sph" title='sph' data-ref="178sph" data-ref-filename="178sph">sph</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhinfo::spdhmcnt" title='xfrmu_spdhinfo::spdhmcnt' data-ref="xfrmu_spdhinfo::spdhmcnt" data-ref-filename="xfrmu_spdhinfo..spdhmcnt">spdhmcnt</a> = <a class="local col6 ref" href="#176si" title='si' data-ref="176si" data-ref-filename="176si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_spdinfo::spdhmcnt" title='xfrmk_spdinfo::spdhmcnt' data-ref="xfrmk_spdinfo::spdhmcnt" data-ref-filename="xfrmk_spdinfo..spdhmcnt">spdhmcnt</a>;</td></tr>
<tr><th id="1075">1075</th><td></td></tr>
<tr><th id="1076">1076</th><td>	<b>do</b> {</td></tr>
<tr><th id="1077">1077</th><td>		<a class="local col4 ref" href="#184lseq" title='lseq' data-ref="184lseq" data-ref-filename="184lseq">lseq</a> = <a class="ref fn" href="../../include/linux/seqlock.h.html#read_seqbegin" title='read_seqbegin' data-ref="read_seqbegin" data-ref-filename="read_seqbegin">read_seqbegin</a>(&amp;<a class="local col2 ref" href="#172net" title='net' data-ref="172net" data-ref-filename="172net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lock" title='xfrm_policy_hthresh::lock' data-ref="xfrm_policy_hthresh::lock" data-ref-filename="xfrm_policy_hthresh..lock">lock</a>);</td></tr>
<tr><th id="1078">1078</th><td></td></tr>
<tr><th id="1079">1079</th><td>		<a class="local col9 ref" href="#179spt4" title='spt4' data-ref="179spt4" data-ref-filename="179spt4">spt4</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::lbits" title='xfrmu_spdhthresh::lbits' data-ref="xfrmu_spdhthresh::lbits" data-ref-filename="xfrmu_spdhthresh..lbits">lbits</a> = <a class="local col2 ref" href="#172net" title='net' data-ref="172net" data-ref-filename="172net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lbits4" title='xfrm_policy_hthresh::lbits4' data-ref="xfrm_policy_hthresh::lbits4" data-ref-filename="xfrm_policy_hthresh..lbits4">lbits4</a>;</td></tr>
<tr><th id="1080">1080</th><td>		<a class="local col9 ref" href="#179spt4" title='spt4' data-ref="179spt4" data-ref-filename="179spt4">spt4</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::rbits" title='xfrmu_spdhthresh::rbits' data-ref="xfrmu_spdhthresh::rbits" data-ref-filename="xfrmu_spdhthresh..rbits">rbits</a> = <a class="local col2 ref" href="#172net" title='net' data-ref="172net" data-ref-filename="172net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::rbits4" title='xfrm_policy_hthresh::rbits4' data-ref="xfrm_policy_hthresh::rbits4" data-ref-filename="xfrm_policy_hthresh..rbits4">rbits4</a>;</td></tr>
<tr><th id="1081">1081</th><td>		<a class="local col0 ref" href="#180spt6" title='spt6' data-ref="180spt6" data-ref-filename="180spt6">spt6</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::lbits" title='xfrmu_spdhthresh::lbits' data-ref="xfrmu_spdhthresh::lbits" data-ref-filename="xfrmu_spdhthresh..lbits">lbits</a> = <a class="local col2 ref" href="#172net" title='net' data-ref="172net" data-ref-filename="172net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lbits6" title='xfrm_policy_hthresh::lbits6' data-ref="xfrm_policy_hthresh::lbits6" data-ref-filename="xfrm_policy_hthresh..lbits6">lbits6</a>;</td></tr>
<tr><th id="1082">1082</th><td>		<a class="local col0 ref" href="#180spt6" title='spt6' data-ref="180spt6" data-ref-filename="180spt6">spt6</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::rbits" title='xfrmu_spdhthresh::rbits' data-ref="xfrmu_spdhthresh::rbits" data-ref-filename="xfrmu_spdhthresh..rbits">rbits</a> = <a class="local col2 ref" href="#172net" title='net' data-ref="172net" data-ref-filename="172net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::rbits6" title='xfrm_policy_hthresh::rbits6' data-ref="xfrm_policy_hthresh::rbits6" data-ref-filename="xfrm_policy_hthresh..rbits6">rbits6</a>;</td></tr>
<tr><th id="1083">1083</th><td>	} <b>while</b> (<a class="ref fn" href="../../include/linux/seqlock.h.html#read_seqretry" title='read_seqretry' data-ref="read_seqretry" data-ref-filename="read_seqretry">read_seqretry</a>(&amp;<a class="local col2 ref" href="#172net" title='net' data-ref="172net" data-ref-filename="172net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lock" title='xfrm_policy_hthresh::lock' data-ref="xfrm_policy_hthresh::lock" data-ref-filename="xfrm_policy_hthresh..lock">lock</a>, <a class="local col4 ref" href="#184lseq" title='lseq' data-ref="184lseq" data-ref-filename="184lseq">lseq</a>));</td></tr>
<tr><th id="1084">1084</th><td></td></tr>
<tr><th id="1085">1085</th><td>	<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col1 ref" href="#171skb" title='skb' data-ref="171skb" data-ref-filename="171skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_INFO" title='XFRMA_SPD_INFO' data-ref="XFRMA_SPD_INFO" data-ref-filename="XFRMA_SPD_INFO">XFRMA_SPD_INFO</a>, <b>sizeof</b>(<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>), &amp;<a class="local col7 ref" href="#177spc" title='spc' data-ref="177spc" data-ref-filename="177spc">spc</a>);</td></tr>
<tr><th id="1086">1086</th><td>	<b>if</b> (!<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a>)</td></tr>
<tr><th id="1087">1087</th><td>		<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col1 ref" href="#171skb" title='skb' data-ref="171skb" data-ref-filename="171skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_HINFO" title='XFRMA_SPD_HINFO' data-ref="XFRMA_SPD_HINFO" data-ref-filename="XFRMA_SPD_HINFO">XFRMA_SPD_HINFO</a>, <b>sizeof</b>(<a class="local col8 ref" href="#178sph" title='sph' data-ref="178sph" data-ref-filename="178sph">sph</a>), &amp;<a class="local col8 ref" href="#178sph" title='sph' data-ref="178sph" data-ref-filename="178sph">sph</a>);</td></tr>
<tr><th id="1088">1088</th><td>	<b>if</b> (!<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a>)</td></tr>
<tr><th id="1089">1089</th><td>		<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col1 ref" href="#171skb" title='skb' data-ref="171skb" data-ref-filename="171skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV4_HTHRESH" title='XFRMA_SPD_IPV4_HTHRESH' data-ref="XFRMA_SPD_IPV4_HTHRESH" data-ref-filename="XFRMA_SPD_IPV4_HTHRESH">XFRMA_SPD_IPV4_HTHRESH</a>, <b>sizeof</b>(<a class="local col9 ref" href="#179spt4" title='spt4' data-ref="179spt4" data-ref-filename="179spt4">spt4</a>), &amp;<a class="local col9 ref" href="#179spt4" title='spt4' data-ref="179spt4" data-ref-filename="179spt4">spt4</a>);</td></tr>
<tr><th id="1090">1090</th><td>	<b>if</b> (!<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a>)</td></tr>
<tr><th id="1091">1091</th><td>		<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col1 ref" href="#171skb" title='skb' data-ref="171skb" data-ref-filename="171skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV6_HTHRESH" title='XFRMA_SPD_IPV6_HTHRESH' data-ref="XFRMA_SPD_IPV6_HTHRESH" data-ref-filename="XFRMA_SPD_IPV6_HTHRESH">XFRMA_SPD_IPV6_HTHRESH</a>, <b>sizeof</b>(<a class="local col0 ref" href="#180spt6" title='spt6' data-ref="180spt6" data-ref-filename="180spt6">spt6</a>), &amp;<a class="local col0 ref" href="#180spt6" title='spt6' data-ref="180spt6" data-ref-filename="180spt6">spt6</a>);</td></tr>
<tr><th id="1092">1092</th><td>	<b>if</b> (<a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a>) {</td></tr>
<tr><th id="1093">1093</th><td>		<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col1 ref" href="#171skb" title='skb' data-ref="171skb" data-ref-filename="171skb">skb</a>, <a class="local col1 ref" href="#181nlh" title='nlh' data-ref="181nlh" data-ref-filename="181nlh">nlh</a>);</td></tr>
<tr><th id="1094">1094</th><td>		<b>return</b> <a class="local col2 ref" href="#182err" title='err' data-ref="182err" data-ref-filename="182err">err</a>;</td></tr>
<tr><th id="1095">1095</th><td>	}</td></tr>
<tr><th id="1096">1096</th><td></td></tr>
<tr><th id="1097">1097</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col1 ref" href="#171skb" title='skb' data-ref="171skb" data-ref-filename="171skb">skb</a>, <a class="local col1 ref" href="#181nlh" title='nlh' data-ref="181nlh" data-ref-filename="181nlh">nlh</a>);</td></tr>
<tr><th id="1098">1098</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1099">1099</th><td>}</td></tr>
<tr><th id="1100">1100</th><td></td></tr>
<tr><th id="1101">1101</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_set_spdinfo" title='xfrm_set_spdinfo' data-type='int xfrm_set_spdinfo(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_set_spdinfo" data-ref-filename="xfrm_set_spdinfo">xfrm_set_spdinfo</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col5 decl" id="185skb" title='skb' data-type='struct sk_buff *' data-ref="185skb" data-ref-filename="185skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col6 decl" id="186nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="186nlh" data-ref-filename="186nlh">nlh</dfn>,</td></tr>
<tr><th id="1102">1102</th><td>			    <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col7 decl" id="187attrs" title='attrs' data-type='struct nlattr **' data-ref="187attrs" data-ref-filename="187attrs">attrs</dfn>)</td></tr>
<tr><th id="1103">1103</th><td>{</td></tr>
<tr><th id="1104">1104</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col8 decl" id="188net" title='net' data-type='struct net *' data-ref="188net" data-ref-filename="188net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col5 ref" href="#185skb" title='skb' data-ref="185skb" data-ref-filename="185skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1105">1105</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh" title='xfrmu_spdhthresh' data-ref="xfrmu_spdhthresh" data-ref-filename="xfrmu_spdhthresh">xfrmu_spdhthresh</a> *<dfn class="local col9 decl" id="189thresh4" title='thresh4' data-type='struct xfrmu_spdhthresh *' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</dfn> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1106">1106</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh" title='xfrmu_spdhthresh' data-ref="xfrmu_spdhthresh" data-ref-filename="xfrmu_spdhthresh">xfrmu_spdhthresh</a> *<dfn class="local col0 decl" id="190thresh6" title='thresh6' data-type='struct xfrmu_spdhthresh *' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</dfn> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1107">1107</th><td></td></tr>
<tr><th id="1108">1108</th><td>	<i>/* selector prefixlen thresholds to hash policies */</i></td></tr>
<tr><th id="1109">1109</th><td>	<b>if</b> (<a class="local col7 ref" href="#187attrs" title='attrs' data-ref="187attrs" data-ref-filename="187attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV4_HTHRESH" title='XFRMA_SPD_IPV4_HTHRESH' data-ref="XFRMA_SPD_IPV4_HTHRESH" data-ref-filename="XFRMA_SPD_IPV4_HTHRESH">XFRMA_SPD_IPV4_HTHRESH</a>]) {</td></tr>
<tr><th id="1110">1110</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col1 decl" id="191rta" title='rta' data-type='struct nlattr *' data-ref="191rta" data-ref-filename="191rta">rta</dfn> = <a class="local col7 ref" href="#187attrs" title='attrs' data-ref="187attrs" data-ref-filename="187attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV4_HTHRESH" title='XFRMA_SPD_IPV4_HTHRESH' data-ref="XFRMA_SPD_IPV4_HTHRESH" data-ref-filename="XFRMA_SPD_IPV4_HTHRESH">XFRMA_SPD_IPV4_HTHRESH</a>];</td></tr>
<tr><th id="1111">1111</th><td></td></tr>
<tr><th id="1112">1112</th><td>		<b>if</b> (<a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col1 ref" href="#191rta" title='rta' data-ref="191rta" data-ref-filename="191rta">rta</a>) &lt; <b>sizeof</b>(*<a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a>))</td></tr>
<tr><th id="1113">1113</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1114">1114</th><td>		<a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col1 ref" href="#191rta" title='rta' data-ref="191rta" data-ref-filename="191rta">rta</a>);</td></tr>
<tr><th id="1115">1115</th><td>		<b>if</b> (<a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::lbits" title='xfrmu_spdhthresh::lbits' data-ref="xfrmu_spdhthresh::lbits" data-ref-filename="xfrmu_spdhthresh..lbits">lbits</a> &gt; <var>32</var> || <a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::rbits" title='xfrmu_spdhthresh::rbits' data-ref="xfrmu_spdhthresh::rbits" data-ref-filename="xfrmu_spdhthresh..rbits">rbits</a> &gt; <var>32</var>)</td></tr>
<tr><th id="1116">1116</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1117">1117</th><td>	}</td></tr>
<tr><th id="1118">1118</th><td>	<b>if</b> (<a class="local col7 ref" href="#187attrs" title='attrs' data-ref="187attrs" data-ref-filename="187attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV6_HTHRESH" title='XFRMA_SPD_IPV6_HTHRESH' data-ref="XFRMA_SPD_IPV6_HTHRESH" data-ref-filename="XFRMA_SPD_IPV6_HTHRESH">XFRMA_SPD_IPV6_HTHRESH</a>]) {</td></tr>
<tr><th id="1119">1119</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col2 decl" id="192rta" title='rta' data-type='struct nlattr *' data-ref="192rta" data-ref-filename="192rta">rta</dfn> = <a class="local col7 ref" href="#187attrs" title='attrs' data-ref="187attrs" data-ref-filename="187attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV6_HTHRESH" title='XFRMA_SPD_IPV6_HTHRESH' data-ref="XFRMA_SPD_IPV6_HTHRESH" data-ref-filename="XFRMA_SPD_IPV6_HTHRESH">XFRMA_SPD_IPV6_HTHRESH</a>];</td></tr>
<tr><th id="1120">1120</th><td></td></tr>
<tr><th id="1121">1121</th><td>		<b>if</b> (<a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col2 ref" href="#192rta" title='rta' data-ref="192rta" data-ref-filename="192rta">rta</a>) &lt; <b>sizeof</b>(*<a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a>))</td></tr>
<tr><th id="1122">1122</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1123">1123</th><td>		<a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col2 ref" href="#192rta" title='rta' data-ref="192rta" data-ref-filename="192rta">rta</a>);</td></tr>
<tr><th id="1124">1124</th><td>		<b>if</b> (<a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::lbits" title='xfrmu_spdhthresh::lbits' data-ref="xfrmu_spdhthresh::lbits" data-ref-filename="xfrmu_spdhthresh..lbits">lbits</a> &gt; <var>128</var> || <a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::rbits" title='xfrmu_spdhthresh::rbits' data-ref="xfrmu_spdhthresh::rbits" data-ref-filename="xfrmu_spdhthresh..rbits">rbits</a> &gt; <var>128</var>)</td></tr>
<tr><th id="1125">1125</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1126">1126</th><td>	}</td></tr>
<tr><th id="1127">1127</th><td></td></tr>
<tr><th id="1128">1128</th><td>	<b>if</b> (<a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a> || <a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a>) {</td></tr>
<tr><th id="1129">1129</th><td>		<a class="ref fn" href="../../include/linux/seqlock.h.html#write_seqlock" title='write_seqlock' data-ref="write_seqlock" data-ref-filename="write_seqlock">write_seqlock</a>(&amp;<a class="local col8 ref" href="#188net" title='net' data-ref="188net" data-ref-filename="188net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lock" title='xfrm_policy_hthresh::lock' data-ref="xfrm_policy_hthresh::lock" data-ref-filename="xfrm_policy_hthresh..lock">lock</a>);</td></tr>
<tr><th id="1130">1130</th><td>		<b>if</b> (<a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a>) {</td></tr>
<tr><th id="1131">1131</th><td>			<a class="local col8 ref" href="#188net" title='net' data-ref="188net" data-ref-filename="188net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lbits4" title='xfrm_policy_hthresh::lbits4' data-ref="xfrm_policy_hthresh::lbits4" data-ref-filename="xfrm_policy_hthresh..lbits4">lbits4</a> = <a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::lbits" title='xfrmu_spdhthresh::lbits' data-ref="xfrmu_spdhthresh::lbits" data-ref-filename="xfrmu_spdhthresh..lbits">lbits</a>;</td></tr>
<tr><th id="1132">1132</th><td>			<a class="local col8 ref" href="#188net" title='net' data-ref="188net" data-ref-filename="188net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::rbits4" title='xfrm_policy_hthresh::rbits4' data-ref="xfrm_policy_hthresh::rbits4" data-ref-filename="xfrm_policy_hthresh..rbits4">rbits4</a> = <a class="local col9 ref" href="#189thresh4" title='thresh4' data-ref="189thresh4" data-ref-filename="189thresh4">thresh4</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::rbits" title='xfrmu_spdhthresh::rbits' data-ref="xfrmu_spdhthresh::rbits" data-ref-filename="xfrmu_spdhthresh..rbits">rbits</a>;</td></tr>
<tr><th id="1133">1133</th><td>		}</td></tr>
<tr><th id="1134">1134</th><td>		<b>if</b> (<a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a>) {</td></tr>
<tr><th id="1135">1135</th><td>			<a class="local col8 ref" href="#188net" title='net' data-ref="188net" data-ref-filename="188net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lbits6" title='xfrm_policy_hthresh::lbits6' data-ref="xfrm_policy_hthresh::lbits6" data-ref-filename="xfrm_policy_hthresh..lbits6">lbits6</a> = <a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::lbits" title='xfrmu_spdhthresh::lbits' data-ref="xfrmu_spdhthresh::lbits" data-ref-filename="xfrmu_spdhthresh..lbits">lbits</a>;</td></tr>
<tr><th id="1136">1136</th><td>			<a class="local col8 ref" href="#188net" title='net' data-ref="188net" data-ref-filename="188net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::rbits6" title='xfrm_policy_hthresh::rbits6' data-ref="xfrm_policy_hthresh::rbits6" data-ref-filename="xfrm_policy_hthresh..rbits6">rbits6</a> = <a class="local col0 ref" href="#190thresh6" title='thresh6' data-ref="190thresh6" data-ref-filename="190thresh6">thresh6</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh::rbits" title='xfrmu_spdhthresh::rbits' data-ref="xfrmu_spdhthresh::rbits" data-ref-filename="xfrmu_spdhthresh..rbits">rbits</a>;</td></tr>
<tr><th id="1137">1137</th><td>		}</td></tr>
<tr><th id="1138">1138</th><td>		<a class="ref fn" href="../../include/linux/seqlock.h.html#write_sequnlock" title='write_sequnlock' data-ref="write_sequnlock" data-ref-filename="write_sequnlock">write_sequnlock</a>(&amp;<a class="local col8 ref" href="#188net" title='net' data-ref="188net" data-ref-filename="188net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::policy_hthresh" title='netns_xfrm::policy_hthresh' data-ref="netns_xfrm::policy_hthresh" data-ref-filename="netns_xfrm..policy_hthresh">policy_hthresh</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#xfrm_policy_hthresh::lock" title='xfrm_policy_hthresh::lock' data-ref="xfrm_policy_hthresh::lock" data-ref-filename="xfrm_policy_hthresh..lock">lock</a>);</td></tr>
<tr><th id="1139">1139</th><td></td></tr>
<tr><th id="1140">1140</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_hash_rebuild" title='xfrm_policy_hash_rebuild' data-ref="xfrm_policy_hash_rebuild" data-ref-filename="xfrm_policy_hash_rebuild">xfrm_policy_hash_rebuild</a>(<a class="local col8 ref" href="#188net" title='net' data-ref="188net" data-ref-filename="188net">net</a>);</td></tr>
<tr><th id="1141">1141</th><td>	}</td></tr>
<tr><th id="1142">1142</th><td></td></tr>
<tr><th id="1143">1143</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1144">1144</th><td>}</td></tr>
<tr><th id="1145">1145</th><td></td></tr>
<tr><th id="1146">1146</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_get_spdinfo" title='xfrm_get_spdinfo' data-type='int xfrm_get_spdinfo(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_get_spdinfo" data-ref-filename="xfrm_get_spdinfo">xfrm_get_spdinfo</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="193skb" title='skb' data-type='struct sk_buff *' data-ref="193skb" data-ref-filename="193skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col4 decl" id="194nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="194nlh" data-ref-filename="194nlh">nlh</dfn>,</td></tr>
<tr><th id="1147">1147</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col5 decl" id="195attrs" title='attrs' data-type='struct nlattr **' data-ref="195attrs" data-ref-filename="195attrs">attrs</dfn>)</td></tr>
<tr><th id="1148">1148</th><td>{</td></tr>
<tr><th id="1149">1149</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col6 decl" id="196net" title='net' data-type='struct net *' data-ref="196net" data-ref-filename="196net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col3 ref" href="#193skb" title='skb' data-ref="193skb" data-ref-filename="193skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1150">1150</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="197r_skb" title='r_skb' data-type='struct sk_buff *' data-ref="197r_skb" data-ref-filename="197r_skb">r_skb</dfn>;</td></tr>
<tr><th id="1151">1151</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> *<dfn class="local col8 decl" id="198flags" title='flags' data-type='u32 *' data-ref="198flags" data-ref-filename="198flags">flags</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col4 ref" href="#194nlh" title='nlh' data-ref="194nlh" data-ref-filename="194nlh">nlh</a>);</td></tr>
<tr><th id="1152">1152</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col9 decl" id="199sportid" title='sportid' data-type='u32' data-ref="199sportid" data-ref-filename="199sportid">sportid</dfn> = <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col3 ref" href="#193skb" title='skb' data-ref="193skb" data-ref-filename="193skb">skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>;</td></tr>
<tr><th id="1153">1153</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col0 decl" id="200seq" title='seq' data-type='u32' data-ref="200seq" data-ref-filename="200seq">seq</dfn> = <a class="local col4 ref" href="#194nlh" title='nlh' data-ref="194nlh" data-ref-filename="194nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="1154">1154</th><td>	<em>int</em> <dfn class="local col1 decl" id="201err" title='err' data-type='int' data-ref="201err" data-ref-filename="201err">err</dfn>;</td></tr>
<tr><th id="1155">1155</th><td></td></tr>
<tr><th id="1156">1156</th><td>	<a class="local col7 ref" href="#197r_skb" title='r_skb' data-ref="197r_skb" data-ref-filename="197r_skb">r_skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_spdinfo_msgsize" title='xfrm_spdinfo_msgsize' data-use='c' data-ref="xfrm_spdinfo_msgsize" data-ref-filename="xfrm_spdinfo_msgsize">xfrm_spdinfo_msgsize</a>(), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="1157">1157</th><td>	<b>if</b> (<a class="local col7 ref" href="#197r_skb" title='r_skb' data-ref="197r_skb" data-ref-filename="197r_skb">r_skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1158">1158</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="1159">1159</th><td></td></tr>
<tr><th id="1160">1160</th><td>	<a class="local col1 ref" href="#201err" title='err' data-ref="201err" data-ref-filename="201err">err</a> = <a class="tu ref fn" href="#build_spdinfo" title='build_spdinfo' data-use='c' data-ref="build_spdinfo" data-ref-filename="build_spdinfo">build_spdinfo</a>(<a class="local col7 ref" href="#197r_skb" title='r_skb' data-ref="197r_skb" data-ref-filename="197r_skb">r_skb</a>, <a class="local col6 ref" href="#196net" title='net' data-ref="196net" data-ref-filename="196net">net</a>, <a class="local col9 ref" href="#199sportid" title='sportid' data-ref="199sportid" data-ref-filename="199sportid">sportid</a>, <a class="local col0 ref" href="#200seq" title='seq' data-ref="200seq" data-ref-filename="200seq">seq</a>, *<a class="local col8 ref" href="#198flags" title='flags' data-ref="198flags" data-ref-filename="198flags">flags</a>);</td></tr>
<tr><th id="1161">1161</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (1161), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (134)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col1 ref" href="#201err" title='err' data-ref="201err" data-ref-filename="201err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="1162">1162</th><td></td></tr>
<tr><th id="1163">1163</th><td>	<b>return</b> <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_unicast" title='nlmsg_unicast' data-ref="nlmsg_unicast" data-ref-filename="nlmsg_unicast">nlmsg_unicast</a>(<a class="local col6 ref" href="#196net" title='net' data-ref="196net" data-ref-filename="196net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col7 ref" href="#197r_skb" title='r_skb' data-ref="197r_skb" data-ref-filename="197r_skb">r_skb</a>, <a class="local col9 ref" href="#199sportid" title='sportid' data-ref="199sportid" data-ref-filename="199sportid">sportid</a>);</td></tr>
<tr><th id="1164">1164</th><td>}</td></tr>
<tr><th id="1165">1165</th><td></td></tr>
<tr><th id="1166">1166</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_sadinfo_msgsize" title='xfrm_sadinfo_msgsize' data-type='unsigned int xfrm_sadinfo_msgsize()' data-ref="xfrm_sadinfo_msgsize" data-ref-filename="xfrm_sadinfo_msgsize">xfrm_sadinfo_msgsize</dfn>(<em>void</em>)</td></tr>
<tr><th id="1167">1167</th><td>{</td></tr>
<tr><th id="1168">1168</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((4)+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<var>4</var>)</td></tr>
<tr><th id="1169">1169</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_sadhinfo" title='xfrmu_sadhinfo' data-ref="xfrmu_sadhinfo" data-ref-filename="xfrmu_sadhinfo">xfrmu_sadhinfo</a>))</td></tr>
<tr><th id="1170">1170</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<var>4</var>); <i>/* XFRMA_SAD_CNT */</i></td></tr>
<tr><th id="1171">1171</th><td>}</td></tr>
<tr><th id="1172">1172</th><td></td></tr>
<tr><th id="1173">1173</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_sadinfo" title='build_sadinfo' data-type='int build_sadinfo(struct sk_buff * skb, struct net * net, u32 portid, u32 seq, u32 flags)' data-ref="build_sadinfo" data-ref-filename="build_sadinfo">build_sadinfo</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="202skb" title='skb' data-type='struct sk_buff *' data-ref="202skb" data-ref-filename="202skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col3 decl" id="203net" title='net' data-type='struct net *' data-ref="203net" data-ref-filename="203net">net</dfn>,</td></tr>
<tr><th id="1174">1174</th><td>			 <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col4 decl" id="204portid" title='portid' data-type='u32' data-ref="204portid" data-ref-filename="204portid">portid</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col5 decl" id="205seq" title='seq' data-type='u32' data-ref="205seq" data-ref-filename="205seq">seq</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col6 decl" id="206flags" title='flags' data-type='u32' data-ref="206flags" data-ref-filename="206flags">flags</dfn>)</td></tr>
<tr><th id="1175">1175</th><td>{</td></tr>
<tr><th id="1176">1176</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrmk_sadinfo" title='xfrmk_sadinfo' data-ref="xfrmk_sadinfo" data-ref-filename="xfrmk_sadinfo">xfrmk_sadinfo</a> <dfn class="local col7 decl" id="207si" title='si' data-type='struct xfrmk_sadinfo' data-ref="207si" data-ref-filename="207si">si</dfn>;</td></tr>
<tr><th id="1177">1177</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_sadhinfo" title='xfrmu_sadhinfo' data-ref="xfrmu_sadhinfo" data-ref-filename="xfrmu_sadhinfo">xfrmu_sadhinfo</a> <dfn class="local col8 decl" id="208sh" title='sh' data-type='struct xfrmu_sadhinfo' data-ref="208sh" data-ref-filename="208sh">sh</dfn>;</td></tr>
<tr><th id="1178">1178</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col9 decl" id="209nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="209nlh" data-ref-filename="209nlh">nlh</dfn>;</td></tr>
<tr><th id="1179">1179</th><td>	<em>int</em> <dfn class="local col0 decl" id="210err" title='err' data-type='int' data-ref="210err" data-ref-filename="210err">err</dfn>;</td></tr>
<tr><th id="1180">1180</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> *<dfn class="local col1 decl" id="211f" title='f' data-type='u32 *' data-ref="211f" data-ref-filename="211f">f</dfn>;</td></tr>
<tr><th id="1181">1181</th><td></td></tr>
<tr><th id="1182">1182</th><td>	<a class="local col9 ref" href="#209nlh" title='nlh' data-ref="209nlh" data-ref-filename="209nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col2 ref" href="#202skb" title='skb' data-ref="202skb" data-ref-filename="202skb">skb</a>, <a class="local col4 ref" href="#204portid" title='portid' data-ref="204portid" data-ref-filename="204portid">portid</a>, <a class="local col5 ref" href="#205seq" title='seq' data-ref="205seq" data-ref-filename="205seq">seq</a>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#207" title="XFRM_MSG_NEWSADINFO" data-ref="_M/XFRM_MSG_NEWSADINFO">XFRM_MSG_NEWSADINFO</a>, <b>sizeof</b>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a>), <var>0</var>);</td></tr>
<tr><th id="1183">1183</th><td>	<b>if</b> (<a class="local col9 ref" href="#209nlh" title='nlh' data-ref="209nlh" data-ref-filename="209nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) <i>/* shouldn't really happen ... */</i></td></tr>
<tr><th id="1184">1184</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="1185">1185</th><td></td></tr>
<tr><th id="1186">1186</th><td>	<a class="local col1 ref" href="#211f" title='f' data-ref="211f" data-ref-filename="211f">f</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col9 ref" href="#209nlh" title='nlh' data-ref="209nlh" data-ref-filename="209nlh">nlh</a>);</td></tr>
<tr><th id="1187">1187</th><td>	*<a class="local col1 ref" href="#211f" title='f' data-ref="211f" data-ref-filename="211f">f</a> = <a class="local col6 ref" href="#206flags" title='flags' data-ref="206flags" data-ref-filename="206flags">flags</a>;</td></tr>
<tr><th id="1188">1188</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_sad_getinfo" title='xfrm_sad_getinfo' data-ref="xfrm_sad_getinfo" data-ref-filename="xfrm_sad_getinfo">xfrm_sad_getinfo</a>(<a class="local col3 ref" href="#203net" title='net' data-ref="203net" data-ref-filename="203net">net</a>, &amp;<a class="local col7 ref" href="#207si" title='si' data-ref="207si" data-ref-filename="207si">si</a>);</td></tr>
<tr><th id="1189">1189</th><td></td></tr>
<tr><th id="1190">1190</th><td>	<a class="local col8 ref" href="#208sh" title='sh' data-ref="208sh" data-ref-filename="208sh">sh</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_sadhinfo::sadhmcnt" title='xfrmu_sadhinfo::sadhmcnt' data-ref="xfrmu_sadhinfo::sadhmcnt" data-ref-filename="xfrmu_sadhinfo..sadhmcnt">sadhmcnt</a> = <a class="local col7 ref" href="#207si" title='si' data-ref="207si" data-ref-filename="207si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_sadinfo::sadhmcnt" title='xfrmk_sadinfo::sadhmcnt' data-ref="xfrmk_sadinfo::sadhmcnt" data-ref-filename="xfrmk_sadinfo..sadhmcnt">sadhmcnt</a>;</td></tr>
<tr><th id="1191">1191</th><td>	<a class="local col8 ref" href="#208sh" title='sh' data-ref="208sh" data-ref-filename="208sh">sh</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrmu_sadhinfo::sadhcnt" title='xfrmu_sadhinfo::sadhcnt' data-ref="xfrmu_sadhinfo::sadhcnt" data-ref-filename="xfrmu_sadhinfo..sadhcnt">sadhcnt</a> = <a class="local col7 ref" href="#207si" title='si' data-ref="207si" data-ref-filename="207si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_sadinfo::sadhcnt" title='xfrmk_sadinfo::sadhcnt' data-ref="xfrmk_sadinfo::sadhcnt" data-ref-filename="xfrmk_sadinfo..sadhcnt">sadhcnt</a>;</td></tr>
<tr><th id="1192">1192</th><td></td></tr>
<tr><th id="1193">1193</th><td>	<a class="local col0 ref" href="#210err" title='err' data-ref="210err" data-ref-filename="210err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_u32" title='nla_put_u32' data-ref="nla_put_u32" data-ref-filename="nla_put_u32">nla_put_u32</a>(<a class="local col2 ref" href="#202skb" title='skb' data-ref="202skb" data-ref-filename="202skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SAD_CNT" title='XFRMA_SAD_CNT' data-ref="XFRMA_SAD_CNT" data-ref-filename="XFRMA_SAD_CNT">XFRMA_SAD_CNT</a>, <a class="local col7 ref" href="#207si" title='si' data-ref="207si" data-ref-filename="207si">si</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrmk_sadinfo::sadcnt" title='xfrmk_sadinfo::sadcnt' data-ref="xfrmk_sadinfo::sadcnt" data-ref-filename="xfrmk_sadinfo..sadcnt">sadcnt</a>);</td></tr>
<tr><th id="1194">1194</th><td>	<b>if</b> (!<a class="local col0 ref" href="#210err" title='err' data-ref="210err" data-ref-filename="210err">err</a>)</td></tr>
<tr><th id="1195">1195</th><td>		<a class="local col0 ref" href="#210err" title='err' data-ref="210err" data-ref-filename="210err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col2 ref" href="#202skb" title='skb' data-ref="202skb" data-ref-filename="202skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SAD_HINFO" title='XFRMA_SAD_HINFO' data-ref="XFRMA_SAD_HINFO" data-ref-filename="XFRMA_SAD_HINFO">XFRMA_SAD_HINFO</a>, <b>sizeof</b>(<a class="local col8 ref" href="#208sh" title='sh' data-ref="208sh" data-ref-filename="208sh">sh</a>), &amp;<a class="local col8 ref" href="#208sh" title='sh' data-ref="208sh" data-ref-filename="208sh">sh</a>);</td></tr>
<tr><th id="1196">1196</th><td>	<b>if</b> (<a class="local col0 ref" href="#210err" title='err' data-ref="210err" data-ref-filename="210err">err</a>) {</td></tr>
<tr><th id="1197">1197</th><td>		<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col2 ref" href="#202skb" title='skb' data-ref="202skb" data-ref-filename="202skb">skb</a>, <a class="local col9 ref" href="#209nlh" title='nlh' data-ref="209nlh" data-ref-filename="209nlh">nlh</a>);</td></tr>
<tr><th id="1198">1198</th><td>		<b>return</b> <a class="local col0 ref" href="#210err" title='err' data-ref="210err" data-ref-filename="210err">err</a>;</td></tr>
<tr><th id="1199">1199</th><td>	}</td></tr>
<tr><th id="1200">1200</th><td></td></tr>
<tr><th id="1201">1201</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col2 ref" href="#202skb" title='skb' data-ref="202skb" data-ref-filename="202skb">skb</a>, <a class="local col9 ref" href="#209nlh" title='nlh' data-ref="209nlh" data-ref-filename="209nlh">nlh</a>);</td></tr>
<tr><th id="1202">1202</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1203">1203</th><td>}</td></tr>
<tr><th id="1204">1204</th><td></td></tr>
<tr><th id="1205">1205</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_get_sadinfo" title='xfrm_get_sadinfo' data-type='int xfrm_get_sadinfo(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_get_sadinfo" data-ref-filename="xfrm_get_sadinfo">xfrm_get_sadinfo</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="212skb" title='skb' data-type='struct sk_buff *' data-ref="212skb" data-ref-filename="212skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col3 decl" id="213nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="213nlh" data-ref-filename="213nlh">nlh</dfn>,</td></tr>
<tr><th id="1206">1206</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col4 decl" id="214attrs" title='attrs' data-type='struct nlattr **' data-ref="214attrs" data-ref-filename="214attrs">attrs</dfn>)</td></tr>
<tr><th id="1207">1207</th><td>{</td></tr>
<tr><th id="1208">1208</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col5 decl" id="215net" title='net' data-type='struct net *' data-ref="215net" data-ref-filename="215net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col2 ref" href="#212skb" title='skb' data-ref="212skb" data-ref-filename="212skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1209">1209</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col6 decl" id="216r_skb" title='r_skb' data-type='struct sk_buff *' data-ref="216r_skb" data-ref-filename="216r_skb">r_skb</dfn>;</td></tr>
<tr><th id="1210">1210</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> *<dfn class="local col7 decl" id="217flags" title='flags' data-type='u32 *' data-ref="217flags" data-ref-filename="217flags">flags</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col3 ref" href="#213nlh" title='nlh' data-ref="213nlh" data-ref-filename="213nlh">nlh</a>);</td></tr>
<tr><th id="1211">1211</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col8 decl" id="218sportid" title='sportid' data-type='u32' data-ref="218sportid" data-ref-filename="218sportid">sportid</dfn> = <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col2 ref" href="#212skb" title='skb' data-ref="212skb" data-ref-filename="212skb">skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>;</td></tr>
<tr><th id="1212">1212</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col9 decl" id="219seq" title='seq' data-type='u32' data-ref="219seq" data-ref-filename="219seq">seq</dfn> = <a class="local col3 ref" href="#213nlh" title='nlh' data-ref="213nlh" data-ref-filename="213nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="1213">1213</th><td>	<em>int</em> <dfn class="local col0 decl" id="220err" title='err' data-type='int' data-ref="220err" data-ref-filename="220err">err</dfn>;</td></tr>
<tr><th id="1214">1214</th><td></td></tr>
<tr><th id="1215">1215</th><td>	<a class="local col6 ref" href="#216r_skb" title='r_skb' data-ref="216r_skb" data-ref-filename="216r_skb">r_skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_sadinfo_msgsize" title='xfrm_sadinfo_msgsize' data-use='c' data-ref="xfrm_sadinfo_msgsize" data-ref-filename="xfrm_sadinfo_msgsize">xfrm_sadinfo_msgsize</a>(), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="1216">1216</th><td>	<b>if</b> (<a class="local col6 ref" href="#216r_skb" title='r_skb' data-ref="216r_skb" data-ref-filename="216r_skb">r_skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1217">1217</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="1218">1218</th><td></td></tr>
<tr><th id="1219">1219</th><td>	<a class="local col0 ref" href="#220err" title='err' data-ref="220err" data-ref-filename="220err">err</a> = <a class="tu ref fn" href="#build_sadinfo" title='build_sadinfo' data-use='c' data-ref="build_sadinfo" data-ref-filename="build_sadinfo">build_sadinfo</a>(<a class="local col6 ref" href="#216r_skb" title='r_skb' data-ref="216r_skb" data-ref-filename="216r_skb">r_skb</a>, <a class="local col5 ref" href="#215net" title='net' data-ref="215net" data-ref-filename="215net">net</a>, <a class="local col8 ref" href="#218sportid" title='sportid' data-ref="218sportid" data-ref-filename="218sportid">sportid</a>, <a class="local col9 ref" href="#219seq" title='seq' data-ref="219seq" data-ref-filename="219seq">seq</a>, *<a class="local col7 ref" href="#217flags" title='flags' data-ref="217flags" data-ref-filename="217flags">flags</a>);</td></tr>
<tr><th id="1220">1220</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (1220), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (136)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col0 ref" href="#220err" title='err' data-ref="220err" data-ref-filename="220err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="1221">1221</th><td></td></tr>
<tr><th id="1222">1222</th><td>	<b>return</b> <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_unicast" title='nlmsg_unicast' data-ref="nlmsg_unicast" data-ref-filename="nlmsg_unicast">nlmsg_unicast</a>(<a class="local col5 ref" href="#215net" title='net' data-ref="215net" data-ref-filename="215net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col6 ref" href="#216r_skb" title='r_skb' data-ref="216r_skb" data-ref-filename="216r_skb">r_skb</a>, <a class="local col8 ref" href="#218sportid" title='sportid' data-ref="218sportid" data-ref-filename="218sportid">sportid</a>);</td></tr>
<tr><th id="1223">1223</th><td>}</td></tr>
<tr><th id="1224">1224</th><td></td></tr>
<tr><th id="1225">1225</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_get_sa" title='xfrm_get_sa' data-type='int xfrm_get_sa(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_get_sa" data-ref-filename="xfrm_get_sa">xfrm_get_sa</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col1 decl" id="221skb" title='skb' data-type='struct sk_buff *' data-ref="221skb" data-ref-filename="221skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col2 decl" id="222nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="222nlh" data-ref-filename="222nlh">nlh</dfn>,</td></tr>
<tr><th id="1226">1226</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col3 decl" id="223attrs" title='attrs' data-type='struct nlattr **' data-ref="223attrs" data-ref-filename="223attrs">attrs</dfn>)</td></tr>
<tr><th id="1227">1227</th><td>{</td></tr>
<tr><th id="1228">1228</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col4 decl" id="224net" title='net' data-type='struct net *' data-ref="224net" data-ref-filename="224net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col1 ref" href="#221skb" title='skb' data-ref="221skb" data-ref-filename="221skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1229">1229</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id" title='xfrm_usersa_id' data-ref="xfrm_usersa_id" data-ref-filename="xfrm_usersa_id">xfrm_usersa_id</a> *<dfn class="local col5 decl" id="225p" title='p' data-type='struct xfrm_usersa_id *' data-ref="225p" data-ref-filename="225p">p</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col2 ref" href="#222nlh" title='nlh' data-ref="222nlh" data-ref-filename="222nlh">nlh</a>);</td></tr>
<tr><th id="1230">1230</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col6 decl" id="226x" title='x' data-type='struct xfrm_state *' data-ref="226x" data-ref-filename="226x">x</dfn>;</td></tr>
<tr><th id="1231">1231</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="227resp_skb" title='resp_skb' data-type='struct sk_buff *' data-ref="227resp_skb" data-ref-filename="227resp_skb">resp_skb</dfn>;</td></tr>
<tr><th id="1232">1232</th><td>	<em>int</em> <dfn class="local col8 decl" id="228err" title='err' data-type='int' data-ref="228err" data-ref-filename="228err">err</dfn> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>;</td></tr>
<tr><th id="1233">1233</th><td></td></tr>
<tr><th id="1234">1234</th><td>	<a class="local col6 ref" href="#226x" title='x' data-ref="226x" data-ref-filename="226x">x</a> = <a class="tu ref fn" href="#xfrm_user_state_lookup" title='xfrm_user_state_lookup' data-use='c' data-ref="xfrm_user_state_lookup" data-ref-filename="xfrm_user_state_lookup">xfrm_user_state_lookup</a>(<a class="local col4 ref" href="#224net" title='net' data-ref="224net" data-ref-filename="224net">net</a>, <a class="local col5 ref" href="#225p" title='p' data-ref="225p" data-ref-filename="225p">p</a>, <a class="local col3 ref" href="#223attrs" title='attrs' data-ref="223attrs" data-ref-filename="223attrs">attrs</a>, &amp;<a class="local col8 ref" href="#228err" title='err' data-ref="228err" data-ref-filename="228err">err</a>);</td></tr>
<tr><th id="1235">1235</th><td>	<b>if</b> (<a class="local col6 ref" href="#226x" title='x' data-ref="226x" data-ref-filename="226x">x</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1236">1236</th><td>		<b>goto</b> <a class="lbl" href="#229out_noput" data-ref="229out_noput" data-ref-filename="229out_noput">out_noput</a>;</td></tr>
<tr><th id="1237">1237</th><td></td></tr>
<tr><th id="1238">1238</th><td>	<a class="local col7 ref" href="#227resp_skb" title='resp_skb' data-ref="227resp_skb" data-ref-filename="227resp_skb">resp_skb</a> = <a class="tu ref fn" href="#xfrm_state_netlink" title='xfrm_state_netlink' data-use='c' data-ref="xfrm_state_netlink" data-ref-filename="xfrm_state_netlink">xfrm_state_netlink</a>(<a class="local col1 ref" href="#221skb" title='skb' data-ref="221skb" data-ref-filename="221skb">skb</a>, <a class="local col6 ref" href="#226x" title='x' data-ref="226x" data-ref-filename="226x">x</a>, <a class="local col2 ref" href="#222nlh" title='nlh' data-ref="222nlh" data-ref-filename="222nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>);</td></tr>
<tr><th id="1239">1239</th><td>	<b>if</b> (<a class="ref fn" href="../../include/linux/err.h.html#IS_ERR" title='IS_ERR' data-ref="IS_ERR" data-ref-filename="IS_ERR">IS_ERR</a>(<a class="local col7 ref" href="#227resp_skb" title='resp_skb' data-ref="227resp_skb" data-ref-filename="227resp_skb">resp_skb</a>)) {</td></tr>
<tr><th id="1240">1240</th><td>		<a class="local col8 ref" href="#228err" title='err' data-ref="228err" data-ref-filename="228err">err</a> = <a class="ref fn" href="../../include/linux/err.h.html#PTR_ERR" title='PTR_ERR' data-ref="PTR_ERR" data-ref-filename="PTR_ERR">PTR_ERR</a>(<a class="local col7 ref" href="#227resp_skb" title='resp_skb' data-ref="227resp_skb" data-ref-filename="227resp_skb">resp_skb</a>);</td></tr>
<tr><th id="1241">1241</th><td>	} <b>else</b> {</td></tr>
<tr><th id="1242">1242</th><td>		<a class="local col8 ref" href="#228err" title='err' data-ref="228err" data-ref-filename="228err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_unicast" title='nlmsg_unicast' data-ref="nlmsg_unicast" data-ref-filename="nlmsg_unicast">nlmsg_unicast</a>(<a class="local col4 ref" href="#224net" title='net' data-ref="224net" data-ref-filename="224net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col7 ref" href="#227resp_skb" title='resp_skb' data-ref="227resp_skb" data-ref-filename="227resp_skb">resp_skb</a>, <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col1 ref" href="#221skb" title='skb' data-ref="221skb" data-ref-filename="221skb">skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>);</td></tr>
<tr><th id="1243">1243</th><td>	}</td></tr>
<tr><th id="1244">1244</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col6 ref" href="#226x" title='x' data-ref="226x" data-ref-filename="226x">x</a>);</td></tr>
<tr><th id="1245">1245</th><td><dfn class="lbl" id="229out_noput" data-ref="229out_noput" data-ref-filename="229out_noput">out_noput</dfn>:</td></tr>
<tr><th id="1246">1246</th><td>	<b>return</b> <a class="local col8 ref" href="#228err" title='err' data-ref="228err" data-ref-filename="228err">err</a>;</td></tr>
<tr><th id="1247">1247</th><td>}</td></tr>
<tr><th id="1248">1248</th><td></td></tr>
<tr><th id="1249">1249</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_alloc_userspi" title='xfrm_alloc_userspi' data-type='int xfrm_alloc_userspi(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_alloc_userspi" data-ref-filename="xfrm_alloc_userspi">xfrm_alloc_userspi</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col0 decl" id="230skb" title='skb' data-type='struct sk_buff *' data-ref="230skb" data-ref-filename="230skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col1 decl" id="231nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="231nlh" data-ref-filename="231nlh">nlh</dfn>,</td></tr>
<tr><th id="1250">1250</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col2 decl" id="232attrs" title='attrs' data-type='struct nlattr **' data-ref="232attrs" data-ref-filename="232attrs">attrs</dfn>)</td></tr>
<tr><th id="1251">1251</th><td>{</td></tr>
<tr><th id="1252">1252</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col3 decl" id="233net" title='net' data-type='struct net *' data-ref="233net" data-ref-filename="233net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col0 ref" href="#230skb" title='skb' data-ref="230skb" data-ref-filename="230skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1253">1253</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col4 decl" id="234x" title='x' data-type='struct xfrm_state *' data-ref="234x" data-ref-filename="234x">x</dfn>;</td></tr>
<tr><th id="1254">1254</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info" title='xfrm_userspi_info' data-ref="xfrm_userspi_info" data-ref-filename="xfrm_userspi_info">xfrm_userspi_info</a> *<dfn class="local col5 decl" id="235p" title='p' data-type='struct xfrm_userspi_info *' data-ref="235p" data-ref-filename="235p">p</dfn>;</td></tr>
<tr><th id="1255">1255</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col6 decl" id="236resp_skb" title='resp_skb' data-type='struct sk_buff *' data-ref="236resp_skb" data-ref-filename="236resp_skb">resp_skb</dfn>;</td></tr>
<tr><th id="1256">1256</th><td>	<a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a> *<dfn class="local col7 decl" id="237daddr" title='daddr' data-type='xfrm_address_t *' data-ref="237daddr" data-ref-filename="237daddr">daddr</dfn>;</td></tr>
<tr><th id="1257">1257</th><td>	<em>int</em> <dfn class="local col8 decl" id="238family" title='family' data-type='int' data-ref="238family" data-ref-filename="238family">family</dfn>;</td></tr>
<tr><th id="1258">1258</th><td>	<em>int</em> <dfn class="local col9 decl" id="239err" title='err' data-type='int' data-ref="239err" data-ref-filename="239err">err</dfn>;</td></tr>
<tr><th id="1259">1259</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col0 decl" id="240mark" title='mark' data-type='u32' data-ref="240mark" data-ref-filename="240mark">mark</dfn>;</td></tr>
<tr><th id="1260">1260</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col1 decl" id="241m" title='m' data-type='struct xfrm_mark' data-ref="241m" data-ref-filename="241m">m</dfn>;</td></tr>
<tr><th id="1261">1261</th><td></td></tr>
<tr><th id="1262">1262</th><td>	<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col1 ref" href="#231nlh" title='nlh' data-ref="231nlh" data-ref-filename="231nlh">nlh</a>);</td></tr>
<tr><th id="1263">1263</th><td>	<a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#verify_spi_info" title='verify_spi_info' data-ref="verify_spi_info" data-ref-filename="verify_spi_info">verify_spi_info</a>(<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::min" title='xfrm_userspi_info::min' data-ref="xfrm_userspi_info::min" data-ref-filename="xfrm_userspi_info..min">min</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::max" title='xfrm_userspi_info::max' data-ref="xfrm_userspi_info::max" data-ref-filename="xfrm_userspi_info..max">max</a>);</td></tr>
<tr><th id="1264">1264</th><td>	<b>if</b> (<a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a>)</td></tr>
<tr><th id="1265">1265</th><td>		<b>goto</b> <a class="lbl" href="#242out_noput" data-ref="242out_noput" data-ref-filename="242out_noput">out_noput</a>;</td></tr>
<tr><th id="1266">1266</th><td></td></tr>
<tr><th id="1267">1267</th><td>	<a class="local col8 ref" href="#238family" title='family' data-ref="238family" data-ref-filename="238family">family</a> = <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::family" title='xfrm_usersa_info::family' data-ref="xfrm_usersa_info::family" data-ref-filename="xfrm_usersa_info..family">family</a>;</td></tr>
<tr><th id="1268">1268</th><td>	<a class="local col7 ref" href="#237daddr" title='daddr' data-ref="237daddr" data-ref-filename="237daddr">daddr</a> = &amp;<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::daddr" title='xfrm_id::daddr' data-ref="xfrm_id::daddr" data-ref-filename="xfrm_id..daddr">daddr</a>;</td></tr>
<tr><th id="1269">1269</th><td></td></tr>
<tr><th id="1270">1270</th><td>	<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1271">1271</th><td></td></tr>
<tr><th id="1272">1272</th><td>	<a class="local col0 ref" href="#240mark" title='mark' data-ref="240mark" data-ref-filename="240mark">mark</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col2 ref" href="#232attrs" title='attrs' data-ref="232attrs" data-ref-filename="232attrs">attrs</a>, &amp;<a class="local col1 ref" href="#241m" title='m' data-ref="241m" data-ref-filename="241m">m</a>);</td></tr>
<tr><th id="1273">1273</th><td>	<b>if</b> (<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::seq" title='xfrm_usersa_info::seq' data-ref="xfrm_usersa_info::seq" data-ref-filename="xfrm_usersa_info..seq">seq</a>) {</td></tr>
<tr><th id="1274">1274</th><td>		<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_find_acq_byseq" title='xfrm_find_acq_byseq' data-ref="xfrm_find_acq_byseq" data-ref-filename="xfrm_find_acq_byseq">xfrm_find_acq_byseq</a>(<a class="local col3 ref" href="#233net" title='net' data-ref="233net" data-ref-filename="233net">net</a>, <a class="local col0 ref" href="#240mark" title='mark' data-ref="240mark" data-ref-filename="240mark">mark</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::seq" title='xfrm_usersa_info::seq' data-ref="xfrm_usersa_info::seq" data-ref-filename="xfrm_usersa_info..seq">seq</a>);</td></tr>
<tr><th id="1275">1275</th><td>		<b>if</b> (<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a> &amp;&amp; !<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_addr_equal" title='xfrm_addr_equal' data-ref="xfrm_addr_equal" data-ref-filename="xfrm_addr_equal">xfrm_addr_equal</a>(&amp;<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::daddr" title='xfrm_id::daddr' data-ref="xfrm_id::daddr" data-ref-filename="xfrm_id..daddr">daddr</a>, <a class="local col7 ref" href="#237daddr" title='daddr' data-ref="237daddr" data-ref-filename="237daddr">daddr</a>, <a class="local col8 ref" href="#238family" title='family' data-ref="238family" data-ref-filename="238family">family</a>)) {</td></tr>
<tr><th id="1276">1276</th><td>			<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a>);</td></tr>
<tr><th id="1277">1277</th><td>			<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1278">1278</th><td>		}</td></tr>
<tr><th id="1279">1279</th><td>	}</td></tr>
<tr><th id="1280">1280</th><td></td></tr>
<tr><th id="1281">1281</th><td>	<b>if</b> (!<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a>)</td></tr>
<tr><th id="1282">1282</th><td>		<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_find_acq" title='xfrm_find_acq' data-ref="xfrm_find_acq" data-ref-filename="xfrm_find_acq">xfrm_find_acq</a>(<a class="local col3 ref" href="#233net" title='net' data-ref="233net" data-ref-filename="233net">net</a>, &amp;<a class="local col1 ref" href="#241m" title='m' data-ref="241m" data-ref-filename="241m">m</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::mode" title='xfrm_usersa_info::mode' data-ref="xfrm_usersa_info::mode" data-ref-filename="xfrm_usersa_info..mode">mode</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::reqid" title='xfrm_usersa_info::reqid' data-ref="xfrm_usersa_info::reqid" data-ref-filename="xfrm_usersa_info..reqid">reqid</a>,</td></tr>
<tr><th id="1283">1283</th><td>				  <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>, <a class="local col7 ref" href="#237daddr" title='daddr' data-ref="237daddr" data-ref-filename="237daddr">daddr</a>,</td></tr>
<tr><th id="1284">1284</th><td>				  &amp;<a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::info" title='xfrm_userspi_info::info' data-ref="xfrm_userspi_info::info" data-ref-filename="xfrm_userspi_info..info">info</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::saddr" title='xfrm_usersa_info::saddr' data-ref="xfrm_usersa_info::saddr" data-ref-filename="xfrm_usersa_info..saddr">saddr</a>, <var>1</var>,</td></tr>
<tr><th id="1285">1285</th><td>				  <a class="local col8 ref" href="#238family" title='family' data-ref="238family" data-ref-filename="238family">family</a>);</td></tr>
<tr><th id="1286">1286</th><td>	<a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#6" title="2" data-ref="_M/ENOENT">ENOENT</a>;</td></tr>
<tr><th id="1287">1287</th><td>	<b>if</b> (<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1288">1288</th><td>		<b>goto</b> <a class="lbl" href="#242out_noput" data-ref="242out_noput" data-ref-filename="242out_noput">out_noput</a>;</td></tr>
<tr><th id="1289">1289</th><td></td></tr>
<tr><th id="1290">1290</th><td>	<a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alloc_spi" title='xfrm_alloc_spi' data-ref="xfrm_alloc_spi" data-ref-filename="xfrm_alloc_spi">xfrm_alloc_spi</a>(<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::min" title='xfrm_userspi_info::min' data-ref="xfrm_userspi_info::min" data-ref-filename="xfrm_userspi_info..min">min</a>, <a class="local col5 ref" href="#235p" title='p' data-ref="235p" data-ref-filename="235p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info::max" title='xfrm_userspi_info::max' data-ref="xfrm_userspi_info::max" data-ref-filename="xfrm_userspi_info..max">max</a>);</td></tr>
<tr><th id="1291">1291</th><td>	<b>if</b> (<a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a>)</td></tr>
<tr><th id="1292">1292</th><td>		<b>goto</b> <a class="lbl" href="#243out" data-ref="243out" data-ref-filename="243out">out</a>;</td></tr>
<tr><th id="1293">1293</th><td></td></tr>
<tr><th id="1294">1294</th><td>	<a class="local col6 ref" href="#236resp_skb" title='resp_skb' data-ref="236resp_skb" data-ref-filename="236resp_skb">resp_skb</a> = <a class="tu ref fn" href="#xfrm_state_netlink" title='xfrm_state_netlink' data-use='c' data-ref="xfrm_state_netlink" data-ref-filename="xfrm_state_netlink">xfrm_state_netlink</a>(<a class="local col0 ref" href="#230skb" title='skb' data-ref="230skb" data-ref-filename="230skb">skb</a>, <a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a>, <a class="local col1 ref" href="#231nlh" title='nlh' data-ref="231nlh" data-ref-filename="231nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>);</td></tr>
<tr><th id="1295">1295</th><td>	<b>if</b> (<a class="ref fn" href="../../include/linux/err.h.html#IS_ERR" title='IS_ERR' data-ref="IS_ERR" data-ref-filename="IS_ERR">IS_ERR</a>(<a class="local col6 ref" href="#236resp_skb" title='resp_skb' data-ref="236resp_skb" data-ref-filename="236resp_skb">resp_skb</a>)) {</td></tr>
<tr><th id="1296">1296</th><td>		<a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a> = <a class="ref fn" href="../../include/linux/err.h.html#PTR_ERR" title='PTR_ERR' data-ref="PTR_ERR" data-ref-filename="PTR_ERR">PTR_ERR</a>(<a class="local col6 ref" href="#236resp_skb" title='resp_skb' data-ref="236resp_skb" data-ref-filename="236resp_skb">resp_skb</a>);</td></tr>
<tr><th id="1297">1297</th><td>		<b>goto</b> <a class="lbl" href="#243out" data-ref="243out" data-ref-filename="243out">out</a>;</td></tr>
<tr><th id="1298">1298</th><td>	}</td></tr>
<tr><th id="1299">1299</th><td></td></tr>
<tr><th id="1300">1300</th><td>	<a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_unicast" title='nlmsg_unicast' data-ref="nlmsg_unicast" data-ref-filename="nlmsg_unicast">nlmsg_unicast</a>(<a class="local col3 ref" href="#233net" title='net' data-ref="233net" data-ref-filename="233net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col6 ref" href="#236resp_skb" title='resp_skb' data-ref="236resp_skb" data-ref-filename="236resp_skb">resp_skb</a>, <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col0 ref" href="#230skb" title='skb' data-ref="230skb" data-ref-filename="230skb">skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>);</td></tr>
<tr><th id="1301">1301</th><td></td></tr>
<tr><th id="1302">1302</th><td><dfn class="lbl" id="243out" data-ref="243out" data-ref-filename="243out">out</dfn>:</td></tr>
<tr><th id="1303">1303</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col4 ref" href="#234x" title='x' data-ref="234x" data-ref-filename="234x">x</a>);</td></tr>
<tr><th id="1304">1304</th><td><dfn class="lbl" id="242out_noput" data-ref="242out_noput" data-ref-filename="242out_noput">out_noput</dfn>:</td></tr>
<tr><th id="1305">1305</th><td>	<b>return</b> <a class="local col9 ref" href="#239err" title='err' data-ref="239err" data-ref-filename="239err">err</a>;</td></tr>
<tr><th id="1306">1306</th><td>}</td></tr>
<tr><th id="1307">1307</th><td></td></tr>
<tr><th id="1308">1308</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="verify_policy_dir" title='verify_policy_dir' data-type='int verify_policy_dir(u8 dir)' data-ref="verify_policy_dir" data-ref-filename="verify_policy_dir">verify_policy_dir</dfn>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col4 decl" id="244dir" title='dir' data-type='u8' data-ref="244dir" data-ref-filename="244dir">dir</dfn>)</td></tr>
<tr><th id="1309">1309</th><td>{</td></tr>
<tr><th id="1310">1310</th><td>	<b>switch</b> (<a class="local col4 ref" href="#244dir" title='dir' data-ref="244dir" data-ref-filename="244dir">dir</a>) {</td></tr>
<tr><th id="1311">1311</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_IN" title='XFRM_POLICY_IN' data-ref="XFRM_POLICY_IN" data-ref-filename="XFRM_POLICY_IN">XFRM_POLICY_IN</a>:</td></tr>
<tr><th id="1312">1312</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_OUT" title='XFRM_POLICY_OUT' data-ref="XFRM_POLICY_OUT" data-ref-filename="XFRM_POLICY_OUT">XFRM_POLICY_OUT</a>:</td></tr>
<tr><th id="1313">1313</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_FWD" title='XFRM_POLICY_FWD' data-ref="XFRM_POLICY_FWD" data-ref-filename="XFRM_POLICY_FWD">XFRM_POLICY_FWD</a>:</td></tr>
<tr><th id="1314">1314</th><td>		<b>break</b>;</td></tr>
<tr><th id="1315">1315</th><td></td></tr>
<tr><th id="1316">1316</th><td>	<b>default</b>:</td></tr>
<tr><th id="1317">1317</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1318">1318</th><td>	}</td></tr>
<tr><th id="1319">1319</th><td></td></tr>
<tr><th id="1320">1320</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1321">1321</th><td>}</td></tr>
<tr><th id="1322">1322</th><td></td></tr>
<tr><th id="1323">1323</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="verify_policy_type" title='verify_policy_type' data-type='int verify_policy_type(u8 type)' data-ref="verify_policy_type" data-ref-filename="verify_policy_type">verify_policy_type</dfn>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col5 decl" id="245type" title='type' data-type='u8' data-ref="245type" data-ref-filename="245type">type</dfn>)</td></tr>
<tr><th id="1324">1324</th><td>{</td></tr>
<tr><th id="1325">1325</th><td>	<b>switch</b> (<a class="local col5 ref" href="#245type" title='type' data-ref="245type" data-ref-filename="245type">type</a>) {</td></tr>
<tr><th id="1326">1326</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_TYPE_MAIN" title='XFRM_POLICY_TYPE_MAIN' data-ref="XFRM_POLICY_TYPE_MAIN" data-ref-filename="XFRM_POLICY_TYPE_MAIN">XFRM_POLICY_TYPE_MAIN</a>:</td></tr>
<tr><th id="1327">1327</th><td><u>#<span data-ppcond="1327">ifdef</span> <span class="macro" data-ref="_M/CONFIG_XFRM_SUB_POLICY">CONFIG_XFRM_SUB_POLICY</span></u></td></tr>
<tr><th id="1328">1328</th><td>	<b>case</b> XFRM_POLICY_TYPE_SUB:</td></tr>
<tr><th id="1329">1329</th><td><u>#<span data-ppcond="1327">endif</span></u></td></tr>
<tr><th id="1330">1330</th><td>		<b>break</b>;</td></tr>
<tr><th id="1331">1331</th><td></td></tr>
<tr><th id="1332">1332</th><td>	<b>default</b>:</td></tr>
<tr><th id="1333">1333</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1334">1334</th><td>	}</td></tr>
<tr><th id="1335">1335</th><td></td></tr>
<tr><th id="1336">1336</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1337">1337</th><td>}</td></tr>
<tr><th id="1338">1338</th><td></td></tr>
<tr><th id="1339">1339</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="verify_newpolicy_info" title='verify_newpolicy_info' data-type='int verify_newpolicy_info(struct xfrm_userpolicy_info * p)' data-ref="verify_newpolicy_info" data-ref-filename="verify_newpolicy_info">verify_newpolicy_info</dfn>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col6 decl" id="246p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="246p" data-ref-filename="246p">p</dfn>)</td></tr>
<tr><th id="1340">1340</th><td>{</td></tr>
<tr><th id="1341">1341</th><td>	<em>int</em> <dfn class="local col7 decl" id="247ret" title='ret' data-type='int' data-ref="247ret" data-ref-filename="247ret">ret</dfn>;</td></tr>
<tr><th id="1342">1342</th><td></td></tr>
<tr><th id="1343">1343</th><td>	<b>switch</b> (<a class="local col6 ref" href="#246p" title='p' data-ref="246p" data-ref-filename="246p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::share" title='xfrm_userpolicy_info::share' data-ref="xfrm_userpolicy_info::share" data-ref-filename="xfrm_userpolicy_info..share">share</a>) {</td></tr>
<tr><th id="1344">1344</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_SHARE_ANY" title='XFRM_SHARE_ANY' data-ref="XFRM_SHARE_ANY" data-ref-filename="XFRM_SHARE_ANY">XFRM_SHARE_ANY</a>:</td></tr>
<tr><th id="1345">1345</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_SHARE_SESSION" title='XFRM_SHARE_SESSION' data-ref="XFRM_SHARE_SESSION" data-ref-filename="XFRM_SHARE_SESSION">XFRM_SHARE_SESSION</a>:</td></tr>
<tr><th id="1346">1346</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_SHARE_USER" title='XFRM_SHARE_USER' data-ref="XFRM_SHARE_USER" data-ref-filename="XFRM_SHARE_USER">XFRM_SHARE_USER</a>:</td></tr>
<tr><th id="1347">1347</th><td>	<b>case</b> <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_SHARE_UNIQUE" title='XFRM_SHARE_UNIQUE' data-ref="XFRM_SHARE_UNIQUE" data-ref-filename="XFRM_SHARE_UNIQUE">XFRM_SHARE_UNIQUE</a>:</td></tr>
<tr><th id="1348">1348</th><td>		<b>break</b>;</td></tr>
<tr><th id="1349">1349</th><td></td></tr>
<tr><th id="1350">1350</th><td>	<b>default</b>:</td></tr>
<tr><th id="1351">1351</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1352">1352</th><td>	}</td></tr>
<tr><th id="1353">1353</th><td></td></tr>
<tr><th id="1354">1354</th><td>	<b>switch</b> (<a class="local col6 ref" href="#246p" title='p' data-ref="246p" data-ref-filename="246p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::action" title='xfrm_userpolicy_info::action' data-ref="xfrm_userpolicy_info::action" data-ref-filename="xfrm_userpolicy_info..action">action</a>) {</td></tr>
<tr><th id="1355">1355</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#416" title="0" data-ref="_M/XFRM_POLICY_ALLOW">XFRM_POLICY_ALLOW</a>:</td></tr>
<tr><th id="1356">1356</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#417" title="1" data-ref="_M/XFRM_POLICY_BLOCK">XFRM_POLICY_BLOCK</a>:</td></tr>
<tr><th id="1357">1357</th><td>		<b>break</b>;</td></tr>
<tr><th id="1358">1358</th><td></td></tr>
<tr><th id="1359">1359</th><td>	<b>default</b>:</td></tr>
<tr><th id="1360">1360</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1361">1361</th><td>	}</td></tr>
<tr><th id="1362">1362</th><td></td></tr>
<tr><th id="1363">1363</th><td>	<b>switch</b> (<a class="local col6 ref" href="#246p" title='p' data-ref="246p" data-ref-filename="246p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector::family" title='xfrm_selector::family' data-ref="xfrm_selector::family" data-ref-filename="xfrm_selector..family">family</a>) {</td></tr>
<tr><th id="1364">1364</th><td>	<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#164" title="2" data-ref="_M/AF_INET">AF_INET</a>:</td></tr>
<tr><th id="1365">1365</th><td>		<b>break</b>;</td></tr>
<tr><th id="1366">1366</th><td></td></tr>
<tr><th id="1367">1367</th><td>	<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#172" title="10" data-ref="_M/AF_INET6">AF_INET6</a>:</td></tr>
<tr><th id="1368">1368</th><td><u>#<span data-ppcond="1368">if</span> <a class="macro" href="../../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../../include/generated/autoconf.h.html#77" title="1" data-ref="_M/CONFIG_IPV6">CONFIG_IPV6</a>)</u></td></tr>
<tr><th id="1369">1369</th><td>		<b>break</b>;</td></tr>
<tr><th id="1370">1370</th><td><u>#<span data-ppcond="1368">else</span></u></td></tr>
<tr><th id="1371">1371</th><td>		<b>return</b>  -EAFNOSUPPORT;</td></tr>
<tr><th id="1372">1372</th><td><u>#<span data-ppcond="1368">endif</span></u></td></tr>
<tr><th id="1373">1373</th><td></td></tr>
<tr><th id="1374">1374</th><td>	<b>default</b>:</td></tr>
<tr><th id="1375">1375</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1376">1376</th><td>	}</td></tr>
<tr><th id="1377">1377</th><td></td></tr>
<tr><th id="1378">1378</th><td>	<a class="local col7 ref" href="#247ret" title='ret' data-ref="247ret" data-ref-filename="247ret">ret</a> = <a class="tu ref fn" href="#verify_policy_dir" title='verify_policy_dir' data-use='c' data-ref="verify_policy_dir" data-ref-filename="verify_policy_dir">verify_policy_dir</a>(<a class="local col6 ref" href="#246p" title='p' data-ref="246p" data-ref-filename="246p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>);</td></tr>
<tr><th id="1379">1379</th><td>	<b>if</b> (<a class="local col7 ref" href="#247ret" title='ret' data-ref="247ret" data-ref-filename="247ret">ret</a>)</td></tr>
<tr><th id="1380">1380</th><td>		<b>return</b> <a class="local col7 ref" href="#247ret" title='ret' data-ref="247ret" data-ref-filename="247ret">ret</a>;</td></tr>
<tr><th id="1381">1381</th><td>	<b>if</b> (<a class="local col6 ref" href="#246p" title='p' data-ref="246p" data-ref-filename="246p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::index" title='xfrm_userpolicy_info::index' data-ref="xfrm_userpolicy_info::index" data-ref-filename="xfrm_userpolicy_info..index">index</a> &amp;&amp; ((<a class="local col6 ref" href="#246p" title='p' data-ref="246p" data-ref-filename="246p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::index" title='xfrm_userpolicy_info::index' data-ref="xfrm_userpolicy_info::index" data-ref-filename="xfrm_userpolicy_info..index">index</a> &amp; <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_MAX" title='XFRM_POLICY_MAX' data-ref="XFRM_POLICY_MAX" data-ref-filename="XFRM_POLICY_MAX">XFRM_POLICY_MAX</a>) != <a class="local col6 ref" href="#246p" title='p' data-ref="246p" data-ref-filename="246p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>))</td></tr>
<tr><th id="1382">1382</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1383">1383</th><td></td></tr>
<tr><th id="1384">1384</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1385">1385</th><td>}</td></tr>
<tr><th id="1386">1386</th><td></td></tr>
<tr><th id="1387">1387</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_from_user_sec_ctx" title='copy_from_user_sec_ctx' data-type='int copy_from_user_sec_ctx(struct xfrm_policy * pol, struct nlattr ** attrs)' data-ref="copy_from_user_sec_ctx" data-ref-filename="copy_from_user_sec_ctx">copy_from_user_sec_ctx</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col8 decl" id="248pol" title='pol' data-type='struct xfrm_policy *' data-ref="248pol" data-ref-filename="248pol">pol</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col9 decl" id="249attrs" title='attrs' data-type='struct nlattr **' data-ref="249attrs" data-ref-filename="249attrs">attrs</dfn>)</td></tr>
<tr><th id="1388">1388</th><td>{</td></tr>
<tr><th id="1389">1389</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col0 decl" id="250rt" title='rt' data-type='struct nlattr *' data-ref="250rt" data-ref-filename="250rt">rt</dfn> = <a class="local col9 ref" href="#249attrs" title='attrs' data-ref="249attrs" data-ref-filename="249attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>];</td></tr>
<tr><th id="1390">1390</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a> *<dfn class="local col1 decl" id="251uctx" title='uctx' data-type='struct xfrm_user_sec_ctx *' data-ref="251uctx" data-ref-filename="251uctx">uctx</dfn>;</td></tr>
<tr><th id="1391">1391</th><td></td></tr>
<tr><th id="1392">1392</th><td>	<b>if</b> (!<a class="local col0 ref" href="#250rt" title='rt' data-ref="250rt" data-ref-filename="250rt">rt</a>)</td></tr>
<tr><th id="1393">1393</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1394">1394</th><td></td></tr>
<tr><th id="1395">1395</th><td>	<a class="local col1 ref" href="#251uctx" title='uctx' data-ref="251uctx" data-ref-filename="251uctx">uctx</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col0 ref" href="#250rt" title='rt' data-ref="250rt" data-ref-filename="250rt">rt</a>);</td></tr>
<tr><th id="1396">1396</th><td>	<b>return</b> <a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_policy_alloc" title='security_xfrm_policy_alloc' data-ref="security_xfrm_policy_alloc" data-ref-filename="security_xfrm_policy_alloc">security_xfrm_policy_alloc</a>(&amp;<a class="local col8 ref" href="#248pol" title='pol' data-ref="248pol" data-ref-filename="248pol">pol</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::security" title='xfrm_policy::security' data-ref="xfrm_policy::security" data-ref-filename="xfrm_policy..security">security</a>, <a class="local col1 ref" href="#251uctx" title='uctx' data-ref="251uctx" data-ref-filename="251uctx">uctx</a>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="1397">1397</th><td>}</td></tr>
<tr><th id="1398">1398</th><td></td></tr>
<tr><th id="1399">1399</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="copy_templates" title='copy_templates' data-type='void copy_templates(struct xfrm_policy * xp, struct xfrm_user_tmpl * ut, int nr)' data-ref="copy_templates" data-ref-filename="copy_templates">copy_templates</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col2 decl" id="252xp" title='xp' data-type='struct xfrm_policy *' data-ref="252xp" data-ref-filename="252xp">xp</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> *<dfn class="local col3 decl" id="253ut" title='ut' data-type='struct xfrm_user_tmpl *' data-ref="253ut" data-ref-filename="253ut">ut</dfn>,</td></tr>
<tr><th id="1400">1400</th><td>			   <em>int</em> <dfn class="local col4 decl" id="254nr" title='nr' data-type='int' data-ref="254nr" data-ref-filename="254nr">nr</dfn>)</td></tr>
<tr><th id="1401">1401</th><td>{</td></tr>
<tr><th id="1402">1402</th><td>	<em>int</em> <dfn class="local col5 decl" id="255i" title='i' data-type='int' data-ref="255i" data-ref-filename="255i">i</dfn>;</td></tr>
<tr><th id="1403">1403</th><td></td></tr>
<tr><th id="1404">1404</th><td>	<a class="local col2 ref" href="#252xp" title='xp' data-ref="252xp" data-ref-filename="252xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a> = <a class="local col4 ref" href="#254nr" title='nr' data-ref="254nr" data-ref-filename="254nr">nr</a>;</td></tr>
<tr><th id="1405">1405</th><td>	<b>for</b> (<a class="local col5 ref" href="#255i" title='i' data-ref="255i" data-ref-filename="255i">i</a> = <var>0</var>; <a class="local col5 ref" href="#255i" title='i' data-ref="255i" data-ref-filename="255i">i</a> &lt; <a class="local col4 ref" href="#254nr" title='nr' data-ref="254nr" data-ref-filename="254nr">nr</a>; <a class="local col5 ref" href="#255i" title='i' data-ref="255i" data-ref-filename="255i">i</a>++, <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>++) {</td></tr>
<tr><th id="1406">1406</th><td>		<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_tmpl" title='xfrm_tmpl' data-ref="xfrm_tmpl" data-ref-filename="xfrm_tmpl">xfrm_tmpl</a> *<dfn class="local col6 decl" id="256t" title='t' data-type='struct xfrm_tmpl *' data-ref="256t" data-ref-filename="256t">t</dfn> = &amp;<a class="local col2 ref" href="#252xp" title='xp' data-ref="252xp" data-ref-filename="252xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_vec" title='xfrm_policy::xfrm_vec' data-ref="xfrm_policy::xfrm_vec" data-ref-filename="xfrm_policy..xfrm_vec">xfrm_vec</a>[<a class="local col5 ref" href="#255i" title='i' data-ref="255i" data-ref-filename="255i">i</a>];</td></tr>
<tr><th id="1407">1407</th><td></td></tr>
<tr><th id="1408">1408</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(struct xfrm_id)); void *__ret; if (__builtin_constant_p(sizeof(struct xfrm_id)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;t-&gt;id), (&amp;ut-&gt;id), __len); else __ret = __builtin_memcpy((&amp;t-&gt;id), (&amp;ut-&gt;id), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::id" title='xfrm_tmpl::id' data-ref="xfrm_tmpl::id" data-ref-filename="xfrm_tmpl..id">id</a>, &amp;<a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::id" title='xfrm_user_tmpl::id' data-ref="xfrm_user_tmpl::id" data-ref-filename="xfrm_user_tmpl..id">id</a>, <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_id" title='xfrm_id' data-ref="xfrm_id" data-ref-filename="xfrm_id">xfrm_id</a>));</td></tr>
<tr><th id="1409">1409</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(xfrm_address_t)); void *__ret; if (__builtin_constant_p(sizeof(xfrm_address_t)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;t-&gt;saddr), (&amp;ut-&gt;saddr), __len); else __ret = __builtin_memcpy((&amp;t-&gt;saddr), (&amp;ut-&gt;saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::saddr" title='xfrm_tmpl::saddr' data-ref="xfrm_tmpl::saddr" data-ref-filename="xfrm_tmpl..saddr">saddr</a>, &amp;<a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::saddr" title='xfrm_user_tmpl::saddr' data-ref="xfrm_user_tmpl::saddr" data-ref-filename="xfrm_user_tmpl..saddr">saddr</a>,</td></tr>
<tr><th id="1410">1410</th><td>		       <b>sizeof</b>(<a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a>));</td></tr>
<tr><th id="1411">1411</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::reqid" title='xfrm_tmpl::reqid' data-ref="xfrm_tmpl::reqid" data-ref-filename="xfrm_tmpl..reqid">reqid</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::reqid" title='xfrm_user_tmpl::reqid' data-ref="xfrm_user_tmpl::reqid" data-ref-filename="xfrm_user_tmpl..reqid">reqid</a>;</td></tr>
<tr><th id="1412">1412</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::mode" title='xfrm_tmpl::mode' data-ref="xfrm_tmpl::mode" data-ref-filename="xfrm_tmpl..mode">mode</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::mode" title='xfrm_user_tmpl::mode' data-ref="xfrm_user_tmpl::mode" data-ref-filename="xfrm_user_tmpl..mode">mode</a>;</td></tr>
<tr><th id="1413">1413</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::share" title='xfrm_tmpl::share' data-ref="xfrm_tmpl::share" data-ref-filename="xfrm_tmpl..share">share</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::share" title='xfrm_user_tmpl::share' data-ref="xfrm_user_tmpl::share" data-ref-filename="xfrm_user_tmpl..share">share</a>;</td></tr>
<tr><th id="1414">1414</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::optional" title='xfrm_tmpl::optional' data-ref="xfrm_tmpl::optional" data-ref-filename="xfrm_tmpl..optional">optional</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::optional" title='xfrm_user_tmpl::optional' data-ref="xfrm_user_tmpl::optional" data-ref-filename="xfrm_user_tmpl..optional">optional</a>;</td></tr>
<tr><th id="1415">1415</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::aalgos" title='xfrm_tmpl::aalgos' data-ref="xfrm_tmpl::aalgos" data-ref-filename="xfrm_tmpl..aalgos">aalgos</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::aalgos" title='xfrm_user_tmpl::aalgos' data-ref="xfrm_user_tmpl::aalgos" data-ref-filename="xfrm_user_tmpl..aalgos">aalgos</a>;</td></tr>
<tr><th id="1416">1416</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::ealgos" title='xfrm_tmpl::ealgos' data-ref="xfrm_tmpl::ealgos" data-ref-filename="xfrm_tmpl..ealgos">ealgos</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::ealgos" title='xfrm_user_tmpl::ealgos' data-ref="xfrm_user_tmpl::ealgos" data-ref-filename="xfrm_user_tmpl..ealgos">ealgos</a>;</td></tr>
<tr><th id="1417">1417</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::calgos" title='xfrm_tmpl::calgos' data-ref="xfrm_tmpl::calgos" data-ref-filename="xfrm_tmpl..calgos">calgos</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::calgos" title='xfrm_user_tmpl::calgos' data-ref="xfrm_user_tmpl::calgos" data-ref-filename="xfrm_user_tmpl..calgos">calgos</a>;</td></tr>
<tr><th id="1418">1418</th><td>		<i>/* If all masks are ~0, then we allow all algorithms. */</i></td></tr>
<tr><th id="1419">1419</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::allalgs" title='xfrm_tmpl::allalgs' data-ref="xfrm_tmpl::allalgs" data-ref-filename="xfrm_tmpl..allalgs">allalgs</a> = !~(<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::aalgos" title='xfrm_tmpl::aalgos' data-ref="xfrm_tmpl::aalgos" data-ref-filename="xfrm_tmpl..aalgos">aalgos</a> &amp; <a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::ealgos" title='xfrm_tmpl::ealgos' data-ref="xfrm_tmpl::ealgos" data-ref-filename="xfrm_tmpl..ealgos">ealgos</a> &amp; <a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::calgos" title='xfrm_tmpl::calgos' data-ref="xfrm_tmpl::calgos" data-ref-filename="xfrm_tmpl..calgos">calgos</a>);</td></tr>
<tr><th id="1420">1420</th><td>		<a class="local col6 ref" href="#256t" title='t' data-ref="256t" data-ref-filename="256t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::encap_family" title='xfrm_tmpl::encap_family' data-ref="xfrm_tmpl::encap_family" data-ref-filename="xfrm_tmpl..encap_family">encap_family</a> = <a class="local col3 ref" href="#253ut" title='ut' data-ref="253ut" data-ref-filename="253ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a>;</td></tr>
<tr><th id="1421">1421</th><td>	}</td></tr>
<tr><th id="1422">1422</th><td>}</td></tr>
<tr><th id="1423">1423</th><td></td></tr>
<tr><th id="1424">1424</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="validate_tmpl" title='validate_tmpl' data-type='int validate_tmpl(int nr, struct xfrm_user_tmpl * ut, u16 family)' data-ref="validate_tmpl" data-ref-filename="validate_tmpl">validate_tmpl</dfn>(<em>int</em> <dfn class="local col7 decl" id="257nr" title='nr' data-type='int' data-ref="257nr" data-ref-filename="257nr">nr</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> *<dfn class="local col8 decl" id="258ut" title='ut' data-type='struct xfrm_user_tmpl *' data-ref="258ut" data-ref-filename="258ut">ut</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16" data-ref-filename="u16">u16</a> <dfn class="local col9 decl" id="259family" title='family' data-type='u16' data-ref="259family" data-ref-filename="259family">family</dfn>)</td></tr>
<tr><th id="1425">1425</th><td>{</td></tr>
<tr><th id="1426">1426</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u16" title='u16' data-type='unsigned short' data-ref="u16" data-ref-filename="u16">u16</a> <dfn class="local col0 decl" id="260prev_family" title='prev_family' data-type='u16' data-ref="260prev_family" data-ref-filename="260prev_family">prev_family</dfn>;</td></tr>
<tr><th id="1427">1427</th><td>	<em>int</em> <dfn class="local col1 decl" id="261i" title='i' data-type='int' data-ref="261i" data-ref-filename="261i">i</dfn>;</td></tr>
<tr><th id="1428">1428</th><td></td></tr>
<tr><th id="1429">1429</th><td>	<b>if</b> (<a class="local col7 ref" href="#257nr" title='nr' data-ref="257nr" data-ref-filename="257nr">nr</a> &gt; <a class="macro" href="../../include/net/xfrm.h.html#543" title="6" data-ref="_M/XFRM_MAX_DEPTH">XFRM_MAX_DEPTH</a>)</td></tr>
<tr><th id="1430">1430</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1431">1431</th><td></td></tr>
<tr><th id="1432">1432</th><td>	<a class="local col0 ref" href="#260prev_family" title='prev_family' data-ref="260prev_family" data-ref-filename="260prev_family">prev_family</a> = <a class="local col9 ref" href="#259family" title='family' data-ref="259family" data-ref-filename="259family">family</a>;</td></tr>
<tr><th id="1433">1433</th><td></td></tr>
<tr><th id="1434">1434</th><td>	<b>for</b> (<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a> = <var>0</var>; <a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a> &lt; <a class="local col7 ref" href="#257nr" title='nr' data-ref="257nr" data-ref-filename="257nr">nr</a>; <a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>++) {</td></tr>
<tr><th id="1435">1435</th><td>		<i>/* We never validated the ut-&gt;family value, so many</i></td></tr>
<tr><th id="1436">1436</th><td><i>		 * applications simply leave it at zero.  The check was</i></td></tr>
<tr><th id="1437">1437</th><td><i>		 * never made and ut-&gt;family was ignored because all</i></td></tr>
<tr><th id="1438">1438</th><td><i>		 * templates could be assumed to have the same family as</i></td></tr>
<tr><th id="1439">1439</th><td><i>		 * the policy itself.  Now that we will have ipv4-in-ipv6</i></td></tr>
<tr><th id="1440">1440</th><td><i>		 * and ipv6-in-ipv4 tunnels, this is no longer true.</i></td></tr>
<tr><th id="1441">1441</th><td><i>		 */</i></td></tr>
<tr><th id="1442">1442</th><td>		<b>if</b> (!<a class="local col8 ref" href="#258ut" title='ut' data-ref="258ut" data-ref-filename="258ut">ut</a>[<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>].<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a>)</td></tr>
<tr><th id="1443">1443</th><td>			<a class="local col8 ref" href="#258ut" title='ut' data-ref="258ut" data-ref-filename="258ut">ut</a>[<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>].<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a> = <a class="local col9 ref" href="#259family" title='family' data-ref="259family" data-ref-filename="259family">family</a>;</td></tr>
<tr><th id="1444">1444</th><td></td></tr>
<tr><th id="1445">1445</th><td>		<b>if</b> ((<a class="local col8 ref" href="#258ut" title='ut' data-ref="258ut" data-ref-filename="258ut">ut</a>[<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>].<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::mode" title='xfrm_user_tmpl::mode' data-ref="xfrm_user_tmpl::mode" data-ref-filename="xfrm_user_tmpl..mode">mode</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#150" title="0" data-ref="_M/XFRM_MODE_TRANSPORT">XFRM_MODE_TRANSPORT</a>) &amp;&amp;</td></tr>
<tr><th id="1446">1446</th><td>		    (<a class="local col8 ref" href="#258ut" title='ut' data-ref="258ut" data-ref-filename="258ut">ut</a>[<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>].<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a> != <a class="local col0 ref" href="#260prev_family" title='prev_family' data-ref="260prev_family" data-ref-filename="260prev_family">prev_family</a>))</td></tr>
<tr><th id="1447">1447</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1448">1448</th><td></td></tr>
<tr><th id="1449">1449</th><td>		<a class="local col0 ref" href="#260prev_family" title='prev_family' data-ref="260prev_family" data-ref-filename="260prev_family">prev_family</a> = <a class="local col8 ref" href="#258ut" title='ut' data-ref="258ut" data-ref-filename="258ut">ut</a>[<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>].<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a>;</td></tr>
<tr><th id="1450">1450</th><td></td></tr>
<tr><th id="1451">1451</th><td>		<b>switch</b> (<a class="local col8 ref" href="#258ut" title='ut' data-ref="258ut" data-ref-filename="258ut">ut</a>[<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>].<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a>) {</td></tr>
<tr><th id="1452">1452</th><td>		<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#164" title="2" data-ref="_M/AF_INET">AF_INET</a>:</td></tr>
<tr><th id="1453">1453</th><td>			<b>break</b>;</td></tr>
<tr><th id="1454">1454</th><td><u>#<span data-ppcond="1454">if</span> <a class="macro" href="../../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../../include/generated/autoconf.h.html#77" title="1" data-ref="_M/CONFIG_IPV6">CONFIG_IPV6</a>)</u></td></tr>
<tr><th id="1455">1455</th><td>		<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#172" title="10" data-ref="_M/AF_INET6">AF_INET6</a>:</td></tr>
<tr><th id="1456">1456</th><td>			<b>break</b>;</td></tr>
<tr><th id="1457">1457</th><td><u>#<span data-ppcond="1454">endif</span></u></td></tr>
<tr><th id="1458">1458</th><td>		<b>default</b>:</td></tr>
<tr><th id="1459">1459</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1460">1460</th><td>		}</td></tr>
<tr><th id="1461">1461</th><td></td></tr>
<tr><th id="1462">1462</th><td>		<b>switch</b> (<a class="local col8 ref" href="#258ut" title='ut' data-ref="258ut" data-ref-filename="258ut">ut</a>[<a class="local col1 ref" href="#261i" title='i' data-ref="261i" data-ref-filename="261i">i</a>].<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::id" title='xfrm_user_tmpl::id' data-ref="xfrm_user_tmpl::id" data-ref-filename="xfrm_user_tmpl..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>) {</td></tr>
<tr><th id="1463">1463</th><td>		<b>case</b> <a class="macro" href="../../include/uapi/linux/in.h.html#60" title="IPPROTO_AH" data-ref="_M/IPPROTO_AH">IPPROTO_AH</a>:</td></tr>
<tr><th id="1464">1464</th><td>		<b>case</b> <a class="macro" href="../../include/uapi/linux/in.h.html#58" title="IPPROTO_ESP" data-ref="_M/IPPROTO_ESP">IPPROTO_ESP</a>:</td></tr>
<tr><th id="1465">1465</th><td>		<b>case</b> <a class="macro" href="../../include/uapi/linux/in.h.html#70" title="IPPROTO_COMP" data-ref="_M/IPPROTO_COMP">IPPROTO_COMP</a>:</td></tr>
<tr><th id="1466">1466</th><td><u>#<span data-ppcond="1466">if</span> <a class="macro" href="../../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../../include/generated/autoconf.h.html#77" title="1" data-ref="_M/CONFIG_IPV6">CONFIG_IPV6</a>)</u></td></tr>
<tr><th id="1467">1467</th><td>		<b>case</b> <a class="macro" href="../../include/uapi/linux/in6.h.html#133" title="43" data-ref="_M/IPPROTO_ROUTING">IPPROTO_ROUTING</a>:</td></tr>
<tr><th id="1468">1468</th><td>		<b>case</b> <a class="macro" href="../../include/uapi/linux/in6.h.html#137" title="60" data-ref="_M/IPPROTO_DSTOPTS">IPPROTO_DSTOPTS</a>:</td></tr>
<tr><th id="1469">1469</th><td><u>#<span data-ppcond="1466">endif</span></u></td></tr>
<tr><th id="1470">1470</th><td>		<b>case</b> <a class="macro" href="../../include/uapi/linux/ipsec.h.html#11" title="255" data-ref="_M/IPSEC_PROTO_ANY">IPSEC_PROTO_ANY</a>:</td></tr>
<tr><th id="1471">1471</th><td>			<b>break</b>;</td></tr>
<tr><th id="1472">1472</th><td>		<b>default</b>:</td></tr>
<tr><th id="1473">1473</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="1474">1474</th><td>		}</td></tr>
<tr><th id="1475">1475</th><td></td></tr>
<tr><th id="1476">1476</th><td>	}</td></tr>
<tr><th id="1477">1477</th><td></td></tr>
<tr><th id="1478">1478</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1479">1479</th><td>}</td></tr>
<tr><th id="1480">1480</th><td></td></tr>
<tr><th id="1481">1481</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_from_user_tmpl" title='copy_from_user_tmpl' data-type='int copy_from_user_tmpl(struct xfrm_policy * pol, struct nlattr ** attrs)' data-ref="copy_from_user_tmpl" data-ref-filename="copy_from_user_tmpl">copy_from_user_tmpl</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col2 decl" id="262pol" title='pol' data-type='struct xfrm_policy *' data-ref="262pol" data-ref-filename="262pol">pol</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col3 decl" id="263attrs" title='attrs' data-type='struct nlattr **' data-ref="263attrs" data-ref-filename="263attrs">attrs</dfn>)</td></tr>
<tr><th id="1482">1482</th><td>{</td></tr>
<tr><th id="1483">1483</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col4 decl" id="264rt" title='rt' data-type='struct nlattr *' data-ref="264rt" data-ref-filename="264rt">rt</dfn> = <a class="local col3 ref" href="#263attrs" title='attrs' data-ref="263attrs" data-ref-filename="263attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TMPL" title='XFRMA_TMPL' data-ref="XFRMA_TMPL" data-ref-filename="XFRMA_TMPL">XFRMA_TMPL</a>];</td></tr>
<tr><th id="1484">1484</th><td></td></tr>
<tr><th id="1485">1485</th><td>	<b>if</b> (!<a class="local col4 ref" href="#264rt" title='rt' data-ref="264rt" data-ref-filename="264rt">rt</a>) {</td></tr>
<tr><th id="1486">1486</th><td>		<a class="local col2 ref" href="#262pol" title='pol' data-ref="262pol" data-ref-filename="262pol">pol</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a> = <var>0</var>;</td></tr>
<tr><th id="1487">1487</th><td>	} <b>else</b> {</td></tr>
<tr><th id="1488">1488</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> *<dfn class="local col5 decl" id="265utmpl" title='utmpl' data-type='struct xfrm_user_tmpl *' data-ref="265utmpl" data-ref-filename="265utmpl">utmpl</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#264rt" title='rt' data-ref="264rt" data-ref-filename="264rt">rt</a>);</td></tr>
<tr><th id="1489">1489</th><td>		<em>int</em> <dfn class="local col6 decl" id="266nr" title='nr' data-type='int' data-ref="266nr" data-ref-filename="266nr">nr</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_len" title='nla_len' data-ref="nla_len" data-ref-filename="nla_len">nla_len</a>(<a class="local col4 ref" href="#264rt" title='rt' data-ref="264rt" data-ref-filename="264rt">rt</a>) / <b>sizeof</b>(*<a class="local col5 ref" href="#265utmpl" title='utmpl' data-ref="265utmpl" data-ref-filename="265utmpl">utmpl</a>);</td></tr>
<tr><th id="1490">1490</th><td>		<em>int</em> <dfn class="local col7 decl" id="267err" title='err' data-type='int' data-ref="267err" data-ref-filename="267err">err</dfn>;</td></tr>
<tr><th id="1491">1491</th><td></td></tr>
<tr><th id="1492">1492</th><td>		<a class="local col7 ref" href="#267err" title='err' data-ref="267err" data-ref-filename="267err">err</a> = <a class="tu ref fn" href="#validate_tmpl" title='validate_tmpl' data-use='c' data-ref="validate_tmpl" data-ref-filename="validate_tmpl">validate_tmpl</a>(<a class="local col6 ref" href="#266nr" title='nr' data-ref="266nr" data-ref-filename="266nr">nr</a>, <a class="local col5 ref" href="#265utmpl" title='utmpl' data-ref="265utmpl" data-ref-filename="265utmpl">utmpl</a>, <a class="local col2 ref" href="#262pol" title='pol' data-ref="262pol" data-ref-filename="262pol">pol</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::family" title='xfrm_policy::family' data-ref="xfrm_policy::family" data-ref-filename="xfrm_policy..family">family</a>);</td></tr>
<tr><th id="1493">1493</th><td>		<b>if</b> (<a class="local col7 ref" href="#267err" title='err' data-ref="267err" data-ref-filename="267err">err</a>)</td></tr>
<tr><th id="1494">1494</th><td>			<b>return</b> <a class="local col7 ref" href="#267err" title='err' data-ref="267err" data-ref-filename="267err">err</a>;</td></tr>
<tr><th id="1495">1495</th><td></td></tr>
<tr><th id="1496">1496</th><td>		<a class="tu ref fn" href="#copy_templates" title='copy_templates' data-use='c' data-ref="copy_templates" data-ref-filename="copy_templates">copy_templates</a>(<a class="local col2 ref" href="#262pol" title='pol' data-ref="262pol" data-ref-filename="262pol">pol</a>, <a class="local col5 ref" href="#265utmpl" title='utmpl' data-ref="265utmpl" data-ref-filename="265utmpl">utmpl</a>, <a class="local col6 ref" href="#266nr" title='nr' data-ref="266nr" data-ref-filename="266nr">nr</a>);</td></tr>
<tr><th id="1497">1497</th><td>	}</td></tr>
<tr><th id="1498">1498</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1499">1499</th><td>}</td></tr>
<tr><th id="1500">1500</th><td></td></tr>
<tr><th id="1501">1501</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_from_user_policy_type" title='copy_from_user_policy_type' data-type='int copy_from_user_policy_type(u8 * tp, struct nlattr ** attrs)' data-ref="copy_from_user_policy_type" data-ref-filename="copy_from_user_policy_type">copy_from_user_policy_type</dfn>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> *<dfn class="local col8 decl" id="268tp" title='tp' data-type='u8 *' data-ref="268tp" data-ref-filename="268tp">tp</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col9 decl" id="269attrs" title='attrs' data-type='struct nlattr **' data-ref="269attrs" data-ref-filename="269attrs">attrs</dfn>)</td></tr>
<tr><th id="1502">1502</th><td>{</td></tr>
<tr><th id="1503">1503</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col0 decl" id="270rt" title='rt' data-type='struct nlattr *' data-ref="270rt" data-ref-filename="270rt">rt</dfn> = <a class="local col9 ref" href="#269attrs" title='attrs' data-ref="269attrs" data-ref-filename="269attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_POLICY_TYPE" title='XFRMA_POLICY_TYPE' data-ref="XFRMA_POLICY_TYPE" data-ref-filename="XFRMA_POLICY_TYPE">XFRMA_POLICY_TYPE</a>];</td></tr>
<tr><th id="1504">1504</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_type" title='xfrm_userpolicy_type' data-ref="xfrm_userpolicy_type" data-ref-filename="xfrm_userpolicy_type">xfrm_userpolicy_type</a> *<dfn class="local col1 decl" id="271upt" title='upt' data-type='struct xfrm_userpolicy_type *' data-ref="271upt" data-ref-filename="271upt">upt</dfn>;</td></tr>
<tr><th id="1505">1505</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col2 decl" id="272type" title='type' data-type='u8' data-ref="272type" data-ref-filename="272type">type</dfn> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_TYPE_MAIN" title='XFRM_POLICY_TYPE_MAIN' data-ref="XFRM_POLICY_TYPE_MAIN" data-ref-filename="XFRM_POLICY_TYPE_MAIN">XFRM_POLICY_TYPE_MAIN</a>;</td></tr>
<tr><th id="1506">1506</th><td>	<em>int</em> <dfn class="local col3 decl" id="273err" title='err' data-type='int' data-ref="273err" data-ref-filename="273err">err</dfn>;</td></tr>
<tr><th id="1507">1507</th><td></td></tr>
<tr><th id="1508">1508</th><td>	<b>if</b> (<a class="local col0 ref" href="#270rt" title='rt' data-ref="270rt" data-ref-filename="270rt">rt</a>) {</td></tr>
<tr><th id="1509">1509</th><td>		<a class="local col1 ref" href="#271upt" title='upt' data-ref="271upt" data-ref-filename="271upt">upt</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col0 ref" href="#270rt" title='rt' data-ref="270rt" data-ref-filename="270rt">rt</a>);</td></tr>
<tr><th id="1510">1510</th><td>		<a class="local col2 ref" href="#272type" title='type' data-ref="272type" data-ref-filename="272type">type</a> = <a class="local col1 ref" href="#271upt" title='upt' data-ref="271upt" data-ref-filename="271upt">upt</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_type::type" title='xfrm_userpolicy_type::type' data-ref="xfrm_userpolicy_type::type" data-ref-filename="xfrm_userpolicy_type..type">type</a>;</td></tr>
<tr><th id="1511">1511</th><td>	}</td></tr>
<tr><th id="1512">1512</th><td></td></tr>
<tr><th id="1513">1513</th><td>	<a class="local col3 ref" href="#273err" title='err' data-ref="273err" data-ref-filename="273err">err</a> = <a class="tu ref fn" href="#verify_policy_type" title='verify_policy_type' data-use='c' data-ref="verify_policy_type" data-ref-filename="verify_policy_type">verify_policy_type</a>(<a class="local col2 ref" href="#272type" title='type' data-ref="272type" data-ref-filename="272type">type</a>);</td></tr>
<tr><th id="1514">1514</th><td>	<b>if</b> (<a class="local col3 ref" href="#273err" title='err' data-ref="273err" data-ref-filename="273err">err</a>)</td></tr>
<tr><th id="1515">1515</th><td>		<b>return</b> <a class="local col3 ref" href="#273err" title='err' data-ref="273err" data-ref-filename="273err">err</a>;</td></tr>
<tr><th id="1516">1516</th><td></td></tr>
<tr><th id="1517">1517</th><td>	*<a class="local col8 ref" href="#268tp" title='tp' data-ref="268tp" data-ref-filename="268tp">tp</a> = <a class="local col2 ref" href="#272type" title='type' data-ref="272type" data-ref-filename="272type">type</a>;</td></tr>
<tr><th id="1518">1518</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1519">1519</th><td>}</td></tr>
<tr><th id="1520">1520</th><td></td></tr>
<tr><th id="1521">1521</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="copy_from_user_policy" title='copy_from_user_policy' data-type='void copy_from_user_policy(struct xfrm_policy * xp, struct xfrm_userpolicy_info * p)' data-ref="copy_from_user_policy" data-ref-filename="copy_from_user_policy">copy_from_user_policy</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col4 decl" id="274xp" title='xp' data-type='struct xfrm_policy *' data-ref="274xp" data-ref-filename="274xp">xp</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col5 decl" id="275p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="275p" data-ref-filename="275p">p</dfn>)</td></tr>
<tr><th id="1522">1522</th><td>{</td></tr>
<tr><th id="1523">1523</th><td>	<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::priority" title='xfrm_policy::priority' data-ref="xfrm_policy::priority" data-ref-filename="xfrm_policy..priority">priority</a> = <a class="local col5 ref" href="#275p" title='p' data-ref="275p" data-ref-filename="275p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::priority" title='xfrm_userpolicy_info::priority' data-ref="xfrm_userpolicy_info::priority" data-ref-filename="xfrm_userpolicy_info..priority">priority</a>;</td></tr>
<tr><th id="1524">1524</th><td>	<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::index" title='xfrm_policy::index' data-ref="xfrm_policy::index" data-ref-filename="xfrm_policy..index">index</a> = <a class="local col5 ref" href="#275p" title='p' data-ref="275p" data-ref-filename="275p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::index" title='xfrm_userpolicy_info::index' data-ref="xfrm_userpolicy_info::index" data-ref-filename="xfrm_userpolicy_info..index">index</a>;</td></tr>
<tr><th id="1525">1525</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(xp-&gt;selector)); void *__ret; if (__builtin_constant_p(sizeof(xp-&gt;selector)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;xp-&gt;selector), (&amp;p-&gt;sel), __len); else __ret = __builtin_memcpy((&amp;xp-&gt;selector), (&amp;p-&gt;sel), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::selector" title='xfrm_policy::selector' data-ref="xfrm_policy::selector" data-ref-filename="xfrm_policy..selector">selector</a>, &amp;<a class="local col5 ref" href="#275p" title='p' data-ref="275p" data-ref-filename="275p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>, <b>sizeof</b>(<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::selector" title='xfrm_policy::selector' data-ref="xfrm_policy::selector" data-ref-filename="xfrm_policy..selector">selector</a>));</td></tr>
<tr><th id="1526">1526</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(xp-&gt;lft)); void *__ret; if (__builtin_constant_p(sizeof(xp-&gt;lft)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;xp-&gt;lft), (&amp;p-&gt;lft), __len); else __ret = __builtin_memcpy((&amp;xp-&gt;lft), (&amp;p-&gt;lft), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::lft" title='xfrm_policy::lft' data-ref="xfrm_policy::lft" data-ref-filename="xfrm_policy..lft">lft</a>, &amp;<a class="local col5 ref" href="#275p" title='p' data-ref="275p" data-ref-filename="275p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::lft" title='xfrm_userpolicy_info::lft' data-ref="xfrm_userpolicy_info::lft" data-ref-filename="xfrm_userpolicy_info..lft">lft</a>, <b>sizeof</b>(<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::lft" title='xfrm_policy::lft' data-ref="xfrm_policy::lft" data-ref-filename="xfrm_policy..lft">lft</a>));</td></tr>
<tr><th id="1527">1527</th><td>	<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::action" title='xfrm_policy::action' data-ref="xfrm_policy::action" data-ref-filename="xfrm_policy..action">action</a> = <a class="local col5 ref" href="#275p" title='p' data-ref="275p" data-ref-filename="275p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::action" title='xfrm_userpolicy_info::action' data-ref="xfrm_userpolicy_info::action" data-ref-filename="xfrm_userpolicy_info..action">action</a>;</td></tr>
<tr><th id="1528">1528</th><td>	<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::flags" title='xfrm_policy::flags' data-ref="xfrm_policy::flags" data-ref-filename="xfrm_policy..flags">flags</a> = <a class="local col5 ref" href="#275p" title='p' data-ref="275p" data-ref-filename="275p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::flags" title='xfrm_userpolicy_info::flags' data-ref="xfrm_userpolicy_info::flags" data-ref-filename="xfrm_userpolicy_info..flags">flags</a>;</td></tr>
<tr><th id="1529">1529</th><td>	<a class="local col4 ref" href="#274xp" title='xp' data-ref="274xp" data-ref-filename="274xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::family" title='xfrm_policy::family' data-ref="xfrm_policy::family" data-ref-filename="xfrm_policy..family">family</a> = <a class="local col5 ref" href="#275p" title='p' data-ref="275p" data-ref-filename="275p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector::family" title='xfrm_selector::family' data-ref="xfrm_selector::family" data-ref-filename="xfrm_selector..family">family</a>;</td></tr>
<tr><th id="1530">1530</th><td>	<i>/* XXX xp-&gt;share = p-&gt;share; */</i></td></tr>
<tr><th id="1531">1531</th><td>}</td></tr>
<tr><th id="1532">1532</th><td></td></tr>
<tr><th id="1533">1533</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="copy_to_user_policy" title='copy_to_user_policy' data-type='void copy_to_user_policy(struct xfrm_policy * xp, struct xfrm_userpolicy_info * p, int dir)' data-ref="copy_to_user_policy" data-ref-filename="copy_to_user_policy">copy_to_user_policy</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col6 decl" id="276xp" title='xp' data-type='struct xfrm_policy *' data-ref="276xp" data-ref-filename="276xp">xp</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col7 decl" id="277p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="277p" data-ref-filename="277p">p</dfn>, <em>int</em> <dfn class="local col8 decl" id="278dir" title='dir' data-type='int' data-ref="278dir" data-ref-filename="278dir">dir</dfn>)</td></tr>
<tr><th id="1534">1534</th><td>{</td></tr>
<tr><th id="1535">1535</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>));</td></tr>
<tr><th id="1536">1536</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;sel)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;sel)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;sel), (&amp;xp-&gt;selector), __len); else __ret = __builtin_memcpy((&amp;p-&gt;sel), (&amp;xp-&gt;selector), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>, &amp;<a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::selector" title='xfrm_policy::selector' data-ref="xfrm_policy::selector" data-ref-filename="xfrm_policy..selector">selector</a>, <b>sizeof</b>(<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>));</td></tr>
<tr><th id="1537">1537</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;lft)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;lft)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;lft), (&amp;xp-&gt;lft), __len); else __ret = __builtin_memcpy((&amp;p-&gt;lft), (&amp;xp-&gt;lft), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::lft" title='xfrm_userpolicy_info::lft' data-ref="xfrm_userpolicy_info::lft" data-ref-filename="xfrm_userpolicy_info..lft">lft</a>, &amp;<a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::lft" title='xfrm_policy::lft' data-ref="xfrm_policy::lft" data-ref-filename="xfrm_policy..lft">lft</a>, <b>sizeof</b>(<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::lft" title='xfrm_userpolicy_info::lft' data-ref="xfrm_userpolicy_info::lft" data-ref-filename="xfrm_userpolicy_info..lft">lft</a>));</td></tr>
<tr><th id="1538">1538</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(p-&gt;curlft)); void *__ret; if (__builtin_constant_p(sizeof(p-&gt;curlft)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;p-&gt;curlft), (&amp;xp-&gt;curlft), __len); else __ret = __builtin_memcpy((&amp;p-&gt;curlft), (&amp;xp-&gt;curlft), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::curlft" title='xfrm_userpolicy_info::curlft' data-ref="xfrm_userpolicy_info::curlft" data-ref-filename="xfrm_userpolicy_info..curlft">curlft</a>, &amp;<a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::curlft" title='xfrm_policy::curlft' data-ref="xfrm_policy::curlft" data-ref-filename="xfrm_policy..curlft">curlft</a>, <b>sizeof</b>(<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::curlft" title='xfrm_userpolicy_info::curlft' data-ref="xfrm_userpolicy_info::curlft" data-ref-filename="xfrm_userpolicy_info..curlft">curlft</a>));</td></tr>
<tr><th id="1539">1539</th><td>	<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::priority" title='xfrm_userpolicy_info::priority' data-ref="xfrm_userpolicy_info::priority" data-ref-filename="xfrm_userpolicy_info..priority">priority</a> = <a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::priority" title='xfrm_policy::priority' data-ref="xfrm_policy::priority" data-ref-filename="xfrm_policy..priority">priority</a>;</td></tr>
<tr><th id="1540">1540</th><td>	<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::index" title='xfrm_userpolicy_info::index' data-ref="xfrm_userpolicy_info::index" data-ref-filename="xfrm_userpolicy_info..index">index</a> = <a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::index" title='xfrm_policy::index' data-ref="xfrm_policy::index" data-ref-filename="xfrm_policy..index">index</a>;</td></tr>
<tr><th id="1541">1541</th><td>	<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector::family" title='xfrm_selector::family' data-ref="xfrm_selector::family" data-ref-filename="xfrm_selector..family">family</a> = <a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::family" title='xfrm_policy::family' data-ref="xfrm_policy::family" data-ref-filename="xfrm_policy..family">family</a>;</td></tr>
<tr><th id="1542">1542</th><td>	<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a> = <a class="local col8 ref" href="#278dir" title='dir' data-ref="278dir" data-ref-filename="278dir">dir</a>;</td></tr>
<tr><th id="1543">1543</th><td>	<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::action" title='xfrm_userpolicy_info::action' data-ref="xfrm_userpolicy_info::action" data-ref-filename="xfrm_userpolicy_info..action">action</a> = <a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::action" title='xfrm_policy::action' data-ref="xfrm_policy::action" data-ref-filename="xfrm_policy..action">action</a>;</td></tr>
<tr><th id="1544">1544</th><td>	<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::flags" title='xfrm_userpolicy_info::flags' data-ref="xfrm_userpolicy_info::flags" data-ref-filename="xfrm_userpolicy_info..flags">flags</a> = <a class="local col6 ref" href="#276xp" title='xp' data-ref="276xp" data-ref-filename="276xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::flags" title='xfrm_policy::flags' data-ref="xfrm_policy::flags" data-ref-filename="xfrm_policy..flags">flags</a>;</td></tr>
<tr><th id="1545">1545</th><td>	<a class="local col7 ref" href="#277p" title='p' data-ref="277p" data-ref-filename="277p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::share" title='xfrm_userpolicy_info::share' data-ref="xfrm_userpolicy_info::share" data-ref-filename="xfrm_userpolicy_info..share">share</a> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_SHARE_ANY" title='XFRM_SHARE_ANY' data-ref="XFRM_SHARE_ANY" data-ref-filename="XFRM_SHARE_ANY">XFRM_SHARE_ANY</a>; <i>/* XXX xp-&gt;share */</i></td></tr>
<tr><th id="1546">1546</th><td>}</td></tr>
<tr><th id="1547">1547</th><td></td></tr>
<tr><th id="1548">1548</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="tu decl def fn" id="xfrm_policy_construct" title='xfrm_policy_construct' data-type='struct xfrm_policy * xfrm_policy_construct(struct net * net, struct xfrm_userpolicy_info * p, struct nlattr ** attrs, int * errp)' data-ref="xfrm_policy_construct" data-ref-filename="xfrm_policy_construct">xfrm_policy_construct</dfn>(<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col9 decl" id="279net" title='net' data-type='struct net *' data-ref="279net" data-ref-filename="279net">net</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col0 decl" id="280p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="280p" data-ref-filename="280p">p</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col1 decl" id="281attrs" title='attrs' data-type='struct nlattr **' data-ref="281attrs" data-ref-filename="281attrs">attrs</dfn>, <em>int</em> *<dfn class="local col2 decl" id="282errp" title='errp' data-type='int *' data-ref="282errp" data-ref-filename="282errp">errp</dfn>)</td></tr>
<tr><th id="1549">1549</th><td>{</td></tr>
<tr><th id="1550">1550</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col3 decl" id="283xp" title='xp' data-type='struct xfrm_policy *' data-ref="283xp" data-ref-filename="283xp">xp</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_alloc" title='xfrm_policy_alloc' data-ref="xfrm_policy_alloc" data-ref-filename="xfrm_policy_alloc">xfrm_policy_alloc</a>(<a class="local col9 ref" href="#279net" title='net' data-ref="279net" data-ref-filename="279net">net</a>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="1551">1551</th><td>	<em>int</em> <dfn class="local col4 decl" id="284err" title='err' data-type='int' data-ref="284err" data-ref-filename="284err">err</dfn>;</td></tr>
<tr><th id="1552">1552</th><td></td></tr>
<tr><th id="1553">1553</th><td>	<b>if</b> (!<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>) {</td></tr>
<tr><th id="1554">1554</th><td>		*<a class="local col2 ref" href="#282errp" title='errp' data-ref="282errp" data-ref-filename="282errp">errp</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="1555">1555</th><td>		<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1556">1556</th><td>	}</td></tr>
<tr><th id="1557">1557</th><td></td></tr>
<tr><th id="1558">1558</th><td>	<a class="tu ref fn" href="#copy_from_user_policy" title='copy_from_user_policy' data-use='c' data-ref="copy_from_user_policy" data-ref-filename="copy_from_user_policy">copy_from_user_policy</a>(<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>, <a class="local col0 ref" href="#280p" title='p' data-ref="280p" data-ref-filename="280p">p</a>);</td></tr>
<tr><th id="1559">1559</th><td></td></tr>
<tr><th id="1560">1560</th><td>	<a class="local col4 ref" href="#284err" title='err' data-ref="284err" data-ref-filename="284err">err</a> = <a class="tu ref fn" href="#copy_from_user_policy_type" title='copy_from_user_policy_type' data-use='c' data-ref="copy_from_user_policy_type" data-ref-filename="copy_from_user_policy_type">copy_from_user_policy_type</a>(&amp;<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::type" title='xfrm_policy::type' data-ref="xfrm_policy::type" data-ref-filename="xfrm_policy..type">type</a>, <a class="local col1 ref" href="#281attrs" title='attrs' data-ref="281attrs" data-ref-filename="281attrs">attrs</a>);</td></tr>
<tr><th id="1561">1561</th><td>	<b>if</b> (<a class="local col4 ref" href="#284err" title='err' data-ref="284err" data-ref-filename="284err">err</a>)</td></tr>
<tr><th id="1562">1562</th><td>		<b>goto</b> <a class="lbl" href="#285error" data-ref="285error" data-ref-filename="285error">error</a>;</td></tr>
<tr><th id="1563">1563</th><td></td></tr>
<tr><th id="1564">1564</th><td>	<b>if</b> (!(<a class="local col4 ref" href="#284err" title='err' data-ref="284err" data-ref-filename="284err">err</a> = <a class="tu ref fn" href="#copy_from_user_tmpl" title='copy_from_user_tmpl' data-use='c' data-ref="copy_from_user_tmpl" data-ref-filename="copy_from_user_tmpl">copy_from_user_tmpl</a>(<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>, <a class="local col1 ref" href="#281attrs" title='attrs' data-ref="281attrs" data-ref-filename="281attrs">attrs</a>)))</td></tr>
<tr><th id="1565">1565</th><td>		<a class="local col4 ref" href="#284err" title='err' data-ref="284err" data-ref-filename="284err">err</a> = <a class="tu ref fn" href="#copy_from_user_sec_ctx" title='copy_from_user_sec_ctx' data-use='c' data-ref="copy_from_user_sec_ctx" data-ref-filename="copy_from_user_sec_ctx">copy_from_user_sec_ctx</a>(<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>, <a class="local col1 ref" href="#281attrs" title='attrs' data-ref="281attrs" data-ref-filename="281attrs">attrs</a>);</td></tr>
<tr><th id="1566">1566</th><td>	<b>if</b> (<a class="local col4 ref" href="#284err" title='err' data-ref="284err" data-ref-filename="284err">err</a>)</td></tr>
<tr><th id="1567">1567</th><td>		<b>goto</b> <a class="lbl" href="#285error" data-ref="285error" data-ref-filename="285error">error</a>;</td></tr>
<tr><th id="1568">1568</th><td></td></tr>
<tr><th id="1569">1569</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col1 ref" href="#281attrs" title='attrs' data-ref="281attrs" data-ref-filename="281attrs">attrs</a>, &amp;<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::mark" title='xfrm_policy::mark' data-ref="xfrm_policy::mark" data-ref-filename="xfrm_policy..mark">mark</a>);</td></tr>
<tr><th id="1570">1570</th><td></td></tr>
<tr><th id="1571">1571</th><td>	<b>return</b> <a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>;</td></tr>
<tr><th id="1572">1572</th><td> <dfn class="lbl" id="285error" data-ref="285error" data-ref-filename="285error">error</dfn>:</td></tr>
<tr><th id="1573">1573</th><td>	*<a class="local col2 ref" href="#282errp" title='errp' data-ref="282errp" data-ref-filename="282errp">errp</a> = <a class="local col4 ref" href="#284err" title='err' data-ref="284err" data-ref-filename="284err">err</a>;</td></tr>
<tr><th id="1574">1574</th><td>	<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::walk" title='xfrm_policy::walk' data-ref="xfrm_policy::walk" data-ref-filename="xfrm_policy..walk">walk</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy_walk_entry::dead" title='xfrm_policy_walk_entry::dead' data-ref="xfrm_policy_walk_entry::dead" data-ref-filename="xfrm_policy_walk_entry..dead">dead</a> = <var>1</var>;</td></tr>
<tr><th id="1575">1575</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_destroy" title='xfrm_policy_destroy' data-ref="xfrm_policy_destroy" data-ref-filename="xfrm_policy_destroy">xfrm_policy_destroy</a>(<a class="local col3 ref" href="#283xp" title='xp' data-ref="283xp" data-ref-filename="283xp">xp</a>);</td></tr>
<tr><th id="1576">1576</th><td>	<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1577">1577</th><td>}</td></tr>
<tr><th id="1578">1578</th><td></td></tr>
<tr><th id="1579">1579</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_add_policy" title='xfrm_add_policy' data-type='int xfrm_add_policy(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_add_policy" data-ref-filename="xfrm_add_policy">xfrm_add_policy</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col6 decl" id="286skb" title='skb' data-type='struct sk_buff *' data-ref="286skb" data-ref-filename="286skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col7 decl" id="287nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="287nlh" data-ref-filename="287nlh">nlh</dfn>,</td></tr>
<tr><th id="1580">1580</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col8 decl" id="288attrs" title='attrs' data-type='struct nlattr **' data-ref="288attrs" data-ref-filename="288attrs">attrs</dfn>)</td></tr>
<tr><th id="1581">1581</th><td>{</td></tr>
<tr><th id="1582">1582</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col9 decl" id="289net" title='net' data-type='struct net *' data-ref="289net" data-ref-filename="289net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col6 ref" href="#286skb" title='skb' data-ref="286skb" data-ref-filename="286skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1583">1583</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col0 decl" id="290p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="290p" data-ref-filename="290p">p</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col7 ref" href="#287nlh" title='nlh' data-ref="287nlh" data-ref-filename="287nlh">nlh</a>);</td></tr>
<tr><th id="1584">1584</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col1 decl" id="291xp" title='xp' data-type='struct xfrm_policy *' data-ref="291xp" data-ref-filename="291xp">xp</dfn>;</td></tr>
<tr><th id="1585">1585</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col2 decl" id="292c" title='c' data-type='struct km_event' data-ref="292c" data-ref-filename="292c">c</dfn>;</td></tr>
<tr><th id="1586">1586</th><td>	<em>int</em> <dfn class="local col3 decl" id="293err" title='err' data-type='int' data-ref="293err" data-ref-filename="293err">err</dfn>;</td></tr>
<tr><th id="1587">1587</th><td>	<em>int</em> <dfn class="local col4 decl" id="294excl" title='excl' data-type='int' data-ref="294excl" data-ref-filename="294excl">excl</dfn>;</td></tr>
<tr><th id="1588">1588</th><td></td></tr>
<tr><th id="1589">1589</th><td>	<a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a> = <a class="tu ref fn" href="#verify_newpolicy_info" title='verify_newpolicy_info' data-use='c' data-ref="verify_newpolicy_info" data-ref-filename="verify_newpolicy_info">verify_newpolicy_info</a>(<a class="local col0 ref" href="#290p" title='p' data-ref="290p" data-ref-filename="290p">p</a>);</td></tr>
<tr><th id="1590">1590</th><td>	<b>if</b> (<a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>)</td></tr>
<tr><th id="1591">1591</th><td>		<b>return</b> <a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>;</td></tr>
<tr><th id="1592">1592</th><td>	<a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a> = <a class="tu ref fn" href="#verify_sec_ctx_len" title='verify_sec_ctx_len' data-use='c' data-ref="verify_sec_ctx_len" data-ref-filename="verify_sec_ctx_len">verify_sec_ctx_len</a>(<a class="local col8 ref" href="#288attrs" title='attrs' data-ref="288attrs" data-ref-filename="288attrs">attrs</a>);</td></tr>
<tr><th id="1593">1593</th><td>	<b>if</b> (<a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>)</td></tr>
<tr><th id="1594">1594</th><td>		<b>return</b> <a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>;</td></tr>
<tr><th id="1595">1595</th><td></td></tr>
<tr><th id="1596">1596</th><td>	<a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a> = <a class="tu ref fn" href="#xfrm_policy_construct" title='xfrm_policy_construct' data-use='c' data-ref="xfrm_policy_construct" data-ref-filename="xfrm_policy_construct">xfrm_policy_construct</a>(<a class="local col9 ref" href="#289net" title='net' data-ref="289net" data-ref-filename="289net">net</a>, <a class="local col0 ref" href="#290p" title='p' data-ref="290p" data-ref-filename="290p">p</a>, <a class="local col8 ref" href="#288attrs" title='attrs' data-ref="288attrs" data-ref-filename="288attrs">attrs</a>, &amp;<a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>);</td></tr>
<tr><th id="1597">1597</th><td>	<b>if</b> (!<a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a>)</td></tr>
<tr><th id="1598">1598</th><td>		<b>return</b> <a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>;</td></tr>
<tr><th id="1599">1599</th><td></td></tr>
<tr><th id="1600">1600</th><td>	<i>/* shouldn't excl be based on nlh flags??</i></td></tr>
<tr><th id="1601">1601</th><td><i>	 * Aha! this is anti-netlink really i.e  more pfkey derived</i></td></tr>
<tr><th id="1602">1602</th><td><i>	 * in netlink excl is a flag and you wouldnt need</i></td></tr>
<tr><th id="1603">1603</th><td><i>	 * a type XFRM_MSG_UPDPOLICY - JHS */</i></td></tr>
<tr><th id="1604">1604</th><td>	<a class="local col4 ref" href="#294excl" title='excl' data-ref="294excl" data-ref-filename="294excl">excl</a> = <a class="local col7 ref" href="#287nlh" title='nlh' data-ref="287nlh" data-ref-filename="287nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#169" title="XFRM_MSG_NEWPOLICY" data-ref="_M/XFRM_MSG_NEWPOLICY">XFRM_MSG_NEWPOLICY</a>;</td></tr>
<tr><th id="1605">1605</th><td>	<a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_insert" title='xfrm_policy_insert' data-ref="xfrm_policy_insert" data-ref-filename="xfrm_policy_insert">xfrm_policy_insert</a>(<a class="local col0 ref" href="#290p" title='p' data-ref="290p" data-ref-filename="290p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>, <a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a>, <a class="local col4 ref" href="#294excl" title='excl' data-ref="294excl" data-ref-filename="294excl">excl</a>);</td></tr>
<tr><th id="1606">1606</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_audit_policy_add" title='xfrm_audit_policy_add' data-ref="xfrm_audit_policy_add" data-ref-filename="xfrm_audit_policy_add">xfrm_audit_policy_add</a>(<a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a>, <a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a> ? <var>0</var> : <var>1</var>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="1607">1607</th><td></td></tr>
<tr><th id="1608">1608</th><td>	<b>if</b> (<a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>) {</td></tr>
<tr><th id="1609">1609</th><td>		<a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_policy_free" title='security_xfrm_policy_free' data-ref="security_xfrm_policy_free" data-ref-filename="security_xfrm_policy_free">security_xfrm_policy_free</a>(<a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::security" title='xfrm_policy::security' data-ref="xfrm_policy::security" data-ref-filename="xfrm_policy..security">security</a>);</td></tr>
<tr><th id="1610">1610</th><td>		<a class="ref fn" href="../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree" data-ref-filename="kfree">kfree</a>(<a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a>);</td></tr>
<tr><th id="1611">1611</th><td>		<b>return</b> <a class="local col3 ref" href="#293err" title='err' data-ref="293err" data-ref-filename="293err">err</a>;</td></tr>
<tr><th id="1612">1612</th><td>	}</td></tr>
<tr><th id="1613">1613</th><td></td></tr>
<tr><th id="1614">1614</th><td>	<a class="local col2 ref" href="#292c" title='c' data-ref="292c" data-ref-filename="292c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> = <a class="local col7 ref" href="#287nlh" title='nlh' data-ref="287nlh" data-ref-filename="287nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="1615">1615</th><td>	<a class="local col2 ref" href="#292c" title='c' data-ref="292c" data-ref-filename="292c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col7 ref" href="#287nlh" title='nlh' data-ref="287nlh" data-ref-filename="287nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="1616">1616</th><td>	<a class="local col2 ref" href="#292c" title='c' data-ref="292c" data-ref-filename="292c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col7 ref" href="#287nlh" title='nlh' data-ref="287nlh" data-ref-filename="287nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="1617">1617</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_policy_notify" title='km_policy_notify' data-ref="km_policy_notify" data-ref-filename="km_policy_notify">km_policy_notify</a>(<a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a>, <a class="local col0 ref" href="#290p" title='p' data-ref="290p" data-ref-filename="290p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>, &amp;<a class="local col2 ref" href="#292c" title='c' data-ref="292c" data-ref-filename="292c">c</a>);</td></tr>
<tr><th id="1618">1618</th><td></td></tr>
<tr><th id="1619">1619</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_pol_put" title='xfrm_pol_put' data-ref="xfrm_pol_put" data-ref-filename="xfrm_pol_put">xfrm_pol_put</a>(<a class="local col1 ref" href="#291xp" title='xp' data-ref="291xp" data-ref-filename="291xp">xp</a>);</td></tr>
<tr><th id="1620">1620</th><td></td></tr>
<tr><th id="1621">1621</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1622">1622</th><td>}</td></tr>
<tr><th id="1623">1623</th><td></td></tr>
<tr><th id="1624">1624</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="copy_to_user_tmpl" title='copy_to_user_tmpl' data-type='int copy_to_user_tmpl(struct xfrm_policy * xp, struct sk_buff * skb)' data-ref="copy_to_user_tmpl" data-ref-filename="copy_to_user_tmpl">copy_to_user_tmpl</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col5 decl" id="295xp" title='xp' data-type='struct xfrm_policy *' data-ref="295xp" data-ref-filename="295xp">xp</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col6 decl" id="296skb" title='skb' data-type='struct sk_buff *' data-ref="296skb" data-ref-filename="296skb">skb</dfn>)</td></tr>
<tr><th id="1625">1625</th><td>{</td></tr>
<tr><th id="1626">1626</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> <dfn class="local col7 decl" id="297vec" title='vec' data-type='struct xfrm_user_tmpl [6]' data-ref="297vec" data-ref-filename="297vec">vec</dfn>[<a class="macro" href="../../include/net/xfrm.h.html#543" title="6" data-ref="_M/XFRM_MAX_DEPTH">XFRM_MAX_DEPTH</a>];</td></tr>
<tr><th id="1627">1627</th><td>	<em>int</em> <dfn class="local col8 decl" id="298i" title='i' data-type='int' data-ref="298i" data-ref-filename="298i">i</dfn>;</td></tr>
<tr><th id="1628">1628</th><td></td></tr>
<tr><th id="1629">1629</th><td>	<b>if</b> (<a class="local col5 ref" href="#295xp" title='xp' data-ref="295xp" data-ref-filename="295xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a> == <var>0</var>)</td></tr>
<tr><th id="1630">1630</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1631">1631</th><td></td></tr>
<tr><th id="1632">1632</th><td>	<b>for</b> (<a class="local col8 ref" href="#298i" title='i' data-ref="298i" data-ref-filename="298i">i</a> = <var>0</var>; <a class="local col8 ref" href="#298i" title='i' data-ref="298i" data-ref-filename="298i">i</a> &lt; <a class="local col5 ref" href="#295xp" title='xp' data-ref="295xp" data-ref-filename="295xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a>; <a class="local col8 ref" href="#298i" title='i' data-ref="298i" data-ref-filename="298i">i</a>++) {</td></tr>
<tr><th id="1633">1633</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> *<dfn class="local col9 decl" id="299up" title='up' data-type='struct xfrm_user_tmpl *' data-ref="299up" data-ref-filename="299up">up</dfn> = &amp;<a class="local col7 ref" href="#297vec" title='vec' data-ref="297vec" data-ref-filename="297vec">vec</a>[<a class="local col8 ref" href="#298i" title='i' data-ref="298i" data-ref-filename="298i">i</a>];</td></tr>
<tr><th id="1634">1634</th><td>		<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_tmpl" title='xfrm_tmpl' data-ref="xfrm_tmpl" data-ref-filename="xfrm_tmpl">xfrm_tmpl</a> *<dfn class="local col0 decl" id="300kp" title='kp' data-type='struct xfrm_tmpl *' data-ref="300kp" data-ref-filename="300kp">kp</dfn> = &amp;<a class="local col5 ref" href="#295xp" title='xp' data-ref="295xp" data-ref-filename="295xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_vec" title='xfrm_policy::xfrm_vec' data-ref="xfrm_policy::xfrm_vec" data-ref-filename="xfrm_policy..xfrm_vec">xfrm_vec</a>[<a class="local col8 ref" href="#298i" title='i' data-ref="298i" data-ref-filename="298i">i</a>];</td></tr>
<tr><th id="1635">1635</th><td></td></tr>
<tr><th id="1636">1636</th><td>		<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>));</td></tr>
<tr><th id="1637">1637</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(up-&gt;id)); void *__ret; if (__builtin_constant_p(sizeof(up-&gt;id)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;up-&gt;id), (&amp;kp-&gt;id), __len); else __ret = __builtin_memcpy((&amp;up-&gt;id), (&amp;kp-&gt;id), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::id" title='xfrm_user_tmpl::id' data-ref="xfrm_user_tmpl::id" data-ref-filename="xfrm_user_tmpl..id">id</a>, &amp;<a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::id" title='xfrm_tmpl::id' data-ref="xfrm_tmpl::id" data-ref-filename="xfrm_tmpl..id">id</a>, <b>sizeof</b>(<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::id" title='xfrm_user_tmpl::id' data-ref="xfrm_user_tmpl::id" data-ref-filename="xfrm_user_tmpl..id">id</a>));</td></tr>
<tr><th id="1638">1638</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::encap_family" title='xfrm_tmpl::encap_family' data-ref="xfrm_tmpl::encap_family" data-ref-filename="xfrm_tmpl..encap_family">encap_family</a>;</td></tr>
<tr><th id="1639">1639</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(up-&gt;saddr)); void *__ret; if (__builtin_constant_p(sizeof(up-&gt;saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;up-&gt;saddr), (&amp;kp-&gt;saddr), __len); else __ret = __builtin_memcpy((&amp;up-&gt;saddr), (&amp;kp-&gt;saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::saddr" title='xfrm_user_tmpl::saddr' data-ref="xfrm_user_tmpl::saddr" data-ref-filename="xfrm_user_tmpl..saddr">saddr</a>, &amp;<a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::saddr" title='xfrm_tmpl::saddr' data-ref="xfrm_tmpl::saddr" data-ref-filename="xfrm_tmpl..saddr">saddr</a>, <b>sizeof</b>(<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::saddr" title='xfrm_user_tmpl::saddr' data-ref="xfrm_user_tmpl::saddr" data-ref-filename="xfrm_user_tmpl..saddr">saddr</a>));</td></tr>
<tr><th id="1640">1640</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::reqid" title='xfrm_user_tmpl::reqid' data-ref="xfrm_user_tmpl::reqid" data-ref-filename="xfrm_user_tmpl..reqid">reqid</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::reqid" title='xfrm_tmpl::reqid' data-ref="xfrm_tmpl::reqid" data-ref-filename="xfrm_tmpl..reqid">reqid</a>;</td></tr>
<tr><th id="1641">1641</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::mode" title='xfrm_user_tmpl::mode' data-ref="xfrm_user_tmpl::mode" data-ref-filename="xfrm_user_tmpl..mode">mode</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::mode" title='xfrm_tmpl::mode' data-ref="xfrm_tmpl::mode" data-ref-filename="xfrm_tmpl..mode">mode</a>;</td></tr>
<tr><th id="1642">1642</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::share" title='xfrm_user_tmpl::share' data-ref="xfrm_user_tmpl::share" data-ref-filename="xfrm_user_tmpl..share">share</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::share" title='xfrm_tmpl::share' data-ref="xfrm_tmpl::share" data-ref-filename="xfrm_tmpl..share">share</a>;</td></tr>
<tr><th id="1643">1643</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::optional" title='xfrm_user_tmpl::optional' data-ref="xfrm_user_tmpl::optional" data-ref-filename="xfrm_user_tmpl..optional">optional</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::optional" title='xfrm_tmpl::optional' data-ref="xfrm_tmpl::optional" data-ref-filename="xfrm_tmpl..optional">optional</a>;</td></tr>
<tr><th id="1644">1644</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::aalgos" title='xfrm_user_tmpl::aalgos' data-ref="xfrm_user_tmpl::aalgos" data-ref-filename="xfrm_user_tmpl..aalgos">aalgos</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::aalgos" title='xfrm_tmpl::aalgos' data-ref="xfrm_tmpl::aalgos" data-ref-filename="xfrm_tmpl..aalgos">aalgos</a>;</td></tr>
<tr><th id="1645">1645</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::ealgos" title='xfrm_user_tmpl::ealgos' data-ref="xfrm_user_tmpl::ealgos" data-ref-filename="xfrm_user_tmpl..ealgos">ealgos</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::ealgos" title='xfrm_tmpl::ealgos' data-ref="xfrm_tmpl::ealgos" data-ref-filename="xfrm_tmpl..ealgos">ealgos</a>;</td></tr>
<tr><th id="1646">1646</th><td>		<a class="local col9 ref" href="#299up" title='up' data-ref="299up" data-ref-filename="299up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::calgos" title='xfrm_user_tmpl::calgos' data-ref="xfrm_user_tmpl::calgos" data-ref-filename="xfrm_user_tmpl..calgos">calgos</a> = <a class="local col0 ref" href="#300kp" title='kp' data-ref="300kp" data-ref-filename="300kp">kp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::calgos" title='xfrm_tmpl::calgos' data-ref="xfrm_tmpl::calgos" data-ref-filename="xfrm_tmpl..calgos">calgos</a>;</td></tr>
<tr><th id="1647">1647</th><td>	}</td></tr>
<tr><th id="1648">1648</th><td></td></tr>
<tr><th id="1649">1649</th><td>	<b>return</b> <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col6 ref" href="#296skb" title='skb' data-ref="296skb" data-ref-filename="296skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TMPL" title='XFRMA_TMPL' data-ref="XFRMA_TMPL" data-ref-filename="XFRMA_TMPL">XFRMA_TMPL</a>,</td></tr>
<tr><th id="1650">1650</th><td>		       <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a>) * <a class="local col5 ref" href="#295xp" title='xp' data-ref="295xp" data-ref-filename="295xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a>, <a class="local col7 ref" href="#297vec" title='vec' data-ref="297vec" data-ref-filename="297vec">vec</a>);</td></tr>
<tr><th id="1651">1651</th><td>}</td></tr>
<tr><th id="1652">1652</th><td></td></tr>
<tr><th id="1653">1653</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="copy_to_user_state_sec_ctx" title='copy_to_user_state_sec_ctx' data-type='int copy_to_user_state_sec_ctx(struct xfrm_state * x, struct sk_buff * skb)' data-ref="copy_to_user_state_sec_ctx" data-ref-filename="copy_to_user_state_sec_ctx">copy_to_user_state_sec_ctx</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="301x" title='x' data-type='struct xfrm_state *' data-ref="301x" data-ref-filename="301x">x</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="302skb" title='skb' data-type='struct sk_buff *' data-ref="302skb" data-ref-filename="302skb">skb</dfn>)</td></tr>
<tr><th id="1654">1654</th><td>{</td></tr>
<tr><th id="1655">1655</th><td>	<b>if</b> (<a class="local col1 ref" href="#301x" title='x' data-ref="301x" data-ref-filename="301x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::security" title='xfrm_state::security' data-ref="xfrm_state::security" data-ref-filename="xfrm_state..security">security</a>) {</td></tr>
<tr><th id="1656">1656</th><td>		<b>return</b> <a class="tu ref fn" href="#copy_sec_ctx" title='copy_sec_ctx' data-use='c' data-ref="copy_sec_ctx" data-ref-filename="copy_sec_ctx">copy_sec_ctx</a>(<a class="local col1 ref" href="#301x" title='x' data-ref="301x" data-ref-filename="301x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::security" title='xfrm_state::security' data-ref="xfrm_state::security" data-ref-filename="xfrm_state..security">security</a>, <a class="local col2 ref" href="#302skb" title='skb' data-ref="302skb" data-ref-filename="302skb">skb</a>);</td></tr>
<tr><th id="1657">1657</th><td>	}</td></tr>
<tr><th id="1658">1658</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1659">1659</th><td>}</td></tr>
<tr><th id="1660">1660</th><td></td></tr>
<tr><th id="1661">1661</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="copy_to_user_sec_ctx" title='copy_to_user_sec_ctx' data-type='int copy_to_user_sec_ctx(struct xfrm_policy * xp, struct sk_buff * skb)' data-ref="copy_to_user_sec_ctx" data-ref-filename="copy_to_user_sec_ctx">copy_to_user_sec_ctx</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col3 decl" id="303xp" title='xp' data-type='struct xfrm_policy *' data-ref="303xp" data-ref-filename="303xp">xp</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col4 decl" id="304skb" title='skb' data-type='struct sk_buff *' data-ref="304skb" data-ref-filename="304skb">skb</dfn>)</td></tr>
<tr><th id="1662">1662</th><td>{</td></tr>
<tr><th id="1663">1663</th><td>	<b>if</b> (<a class="local col3 ref" href="#303xp" title='xp' data-ref="303xp" data-ref-filename="303xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::security" title='xfrm_policy::security' data-ref="xfrm_policy::security" data-ref-filename="xfrm_policy..security">security</a>)</td></tr>
<tr><th id="1664">1664</th><td>		<b>return</b> <a class="tu ref fn" href="#copy_sec_ctx" title='copy_sec_ctx' data-use='c' data-ref="copy_sec_ctx" data-ref-filename="copy_sec_ctx">copy_sec_ctx</a>(<a class="local col3 ref" href="#303xp" title='xp' data-ref="303xp" data-ref-filename="303xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::security" title='xfrm_policy::security' data-ref="xfrm_policy::security" data-ref-filename="xfrm_policy..security">security</a>, <a class="local col4 ref" href="#304skb" title='skb' data-ref="304skb" data-ref-filename="304skb">skb</a>);</td></tr>
<tr><th id="1665">1665</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1666">1666</th><td>}</td></tr>
<tr><th id="1667">1667</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="userpolicy_type_attrsize" title='userpolicy_type_attrsize' data-type='unsigned int userpolicy_type_attrsize()' data-ref="userpolicy_type_attrsize" data-ref-filename="userpolicy_type_attrsize">userpolicy_type_attrsize</dfn>(<em>void</em>)</td></tr>
<tr><th id="1668">1668</th><td>{</td></tr>
<tr><th id="1669">1669</th><td><u>#<span data-ppcond="1669">ifdef</span> <span class="macro" data-ref="_M/CONFIG_XFRM_SUB_POLICY">CONFIG_XFRM_SUB_POLICY</span></u></td></tr>
<tr><th id="1670">1670</th><td>	<b>return</b> nla_total_size(<b>sizeof</b>(<b>struct</b> xfrm_userpolicy_type));</td></tr>
<tr><th id="1671">1671</th><td><u>#<span data-ppcond="1669">else</span></u></td></tr>
<tr><th id="1672">1672</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1673">1673</th><td><u>#<span data-ppcond="1669">endif</span></u></td></tr>
<tr><th id="1674">1674</th><td>}</td></tr>
<tr><th id="1675">1675</th><td></td></tr>
<tr><th id="1676">1676</th><td><u>#<span data-ppcond="1676">ifdef</span> <span class="macro" data-ref="_M/CONFIG_XFRM_SUB_POLICY">CONFIG_XFRM_SUB_POLICY</span></u></td></tr>
<tr><th id="1677">1677</th><td><em>static</em> <em>int</em> copy_to_user_policy_type(u8 type, <b>struct</b> sk_buff *skb)</td></tr>
<tr><th id="1678">1678</th><td>{</td></tr>
<tr><th id="1679">1679</th><td>	<b>struct</b> xfrm_userpolicy_type upt = {</td></tr>
<tr><th id="1680">1680</th><td>		.type = type,</td></tr>
<tr><th id="1681">1681</th><td>	};</td></tr>
<tr><th id="1682">1682</th><td></td></tr>
<tr><th id="1683">1683</th><td>	<b>return</b> nla_put(skb, XFRMA_POLICY_TYPE, <b>sizeof</b>(upt), &amp;upt);</td></tr>
<tr><th id="1684">1684</th><td>}</td></tr>
<tr><th id="1685">1685</th><td></td></tr>
<tr><th id="1686">1686</th><td><u>#<span data-ppcond="1676">else</span></u></td></tr>
<tr><th id="1687">1687</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>int</em> <dfn class="tu decl def fn" id="copy_to_user_policy_type" title='copy_to_user_policy_type' data-type='int copy_to_user_policy_type(u8 type, struct sk_buff * skb)' data-ref="copy_to_user_policy_type" data-ref-filename="copy_to_user_policy_type">copy_to_user_policy_type</dfn>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col5 decl" id="305type" title='type' data-type='u8' data-ref="305type" data-ref-filename="305type">type</dfn>, <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col6 decl" id="306skb" title='skb' data-type='struct sk_buff *' data-ref="306skb" data-ref-filename="306skb">skb</dfn>)</td></tr>
<tr><th id="1688">1688</th><td>{</td></tr>
<tr><th id="1689">1689</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1690">1690</th><td>}</td></tr>
<tr><th id="1691">1691</th><td><u>#<span data-ppcond="1676">endif</span></u></td></tr>
<tr><th id="1692">1692</th><td></td></tr>
<tr><th id="1693">1693</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="dump_one_policy" title='dump_one_policy' data-type='int dump_one_policy(struct xfrm_policy * xp, int dir, int count, void * ptr)' data-ref="dump_one_policy" data-ref-filename="dump_one_policy">dump_one_policy</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col7 decl" id="307xp" title='xp' data-type='struct xfrm_policy *' data-ref="307xp" data-ref-filename="307xp">xp</dfn>, <em>int</em> <dfn class="local col8 decl" id="308dir" title='dir' data-type='int' data-ref="308dir" data-ref-filename="308dir">dir</dfn>, <em>int</em> <dfn class="local col9 decl" id="309count" title='count' data-type='int' data-ref="309count" data-ref-filename="309count">count</dfn>, <em>void</em> *<dfn class="local col0 decl" id="310ptr" title='ptr' data-type='void *' data-ref="310ptr" data-ref-filename="310ptr">ptr</dfn>)</td></tr>
<tr><th id="1694">1694</th><td>{</td></tr>
<tr><th id="1695">1695</th><td>	<b>struct</b> <a class="type" href="#xfrm_dump_info" title='xfrm_dump_info' data-ref="xfrm_dump_info" data-ref-filename="xfrm_dump_info">xfrm_dump_info</a> *<dfn class="local col1 decl" id="311sp" title='sp' data-type='struct xfrm_dump_info *' data-ref="311sp" data-ref-filename="311sp">sp</dfn> = <a class="local col0 ref" href="#310ptr" title='ptr' data-ref="310ptr" data-ref-filename="310ptr">ptr</a>;</td></tr>
<tr><th id="1696">1696</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col2 decl" id="312p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="312p" data-ref-filename="312p">p</dfn>;</td></tr>
<tr><th id="1697">1697</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="313in_skb" title='in_skb' data-type='struct sk_buff *' data-ref="313in_skb" data-ref-filename="313in_skb">in_skb</dfn> = <a class="local col1 ref" href="#311sp" title='sp' data-ref="311sp" data-ref-filename="311sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::in_skb" title='xfrm_dump_info::in_skb' data-use='r' data-ref="xfrm_dump_info::in_skb" data-ref-filename="xfrm_dump_info..in_skb">in_skb</a>;</td></tr>
<tr><th id="1698">1698</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col4 decl" id="314skb" title='skb' data-type='struct sk_buff *' data-ref="314skb" data-ref-filename="314skb">skb</dfn> = <a class="local col1 ref" href="#311sp" title='sp' data-ref="311sp" data-ref-filename="311sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::out_skb" title='xfrm_dump_info::out_skb' data-use='r' data-ref="xfrm_dump_info::out_skb" data-ref-filename="xfrm_dump_info..out_skb">out_skb</a>;</td></tr>
<tr><th id="1699">1699</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col5 decl" id="315nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="315nlh" data-ref-filename="315nlh">nlh</dfn>;</td></tr>
<tr><th id="1700">1700</th><td>	<em>int</em> <dfn class="local col6 decl" id="316err" title='err' data-type='int' data-ref="316err" data-ref-filename="316err">err</dfn>;</td></tr>
<tr><th id="1701">1701</th><td></td></tr>
<tr><th id="1702">1702</th><td>	<a class="local col5 ref" href="#315nlh" title='nlh' data-ref="315nlh" data-ref-filename="315nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col4 ref" href="#314skb" title='skb' data-ref="314skb" data-ref-filename="314skb">skb</a>, <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((in_skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col3 ref" href="#313in_skb" title='in_skb' data-ref="313in_skb" data-ref-filename="313in_skb">in_skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>, <a class="local col1 ref" href="#311sp" title='sp' data-ref="311sp" data-ref-filename="311sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::nlmsg_seq" title='xfrm_dump_info::nlmsg_seq' data-use='r' data-ref="xfrm_dump_info::nlmsg_seq" data-ref-filename="xfrm_dump_info..nlmsg_seq">nlmsg_seq</a>,</td></tr>
<tr><th id="1703">1703</th><td>			<a class="macro" href="../../include/uapi/linux/xfrm.h.html#169" title="XFRM_MSG_NEWPOLICY" data-ref="_M/XFRM_MSG_NEWPOLICY">XFRM_MSG_NEWPOLICY</a>, <b>sizeof</b>(*<a class="local col2 ref" href="#312p" title='p' data-ref="312p" data-ref-filename="312p">p</a>), <a class="local col1 ref" href="#311sp" title='sp' data-ref="311sp" data-ref-filename="311sp">sp</a>-&gt;<a class="tu ref field" href="#xfrm_dump_info::nlmsg_flags" title='xfrm_dump_info::nlmsg_flags' data-use='r' data-ref="xfrm_dump_info::nlmsg_flags" data-ref-filename="xfrm_dump_info..nlmsg_flags">nlmsg_flags</a>);</td></tr>
<tr><th id="1704">1704</th><td>	<b>if</b> (<a class="local col5 ref" href="#315nlh" title='nlh' data-ref="315nlh" data-ref-filename="315nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1705">1705</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="1706">1706</th><td></td></tr>
<tr><th id="1707">1707</th><td>	<a class="local col2 ref" href="#312p" title='p' data-ref="312p" data-ref-filename="312p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col5 ref" href="#315nlh" title='nlh' data-ref="315nlh" data-ref-filename="315nlh">nlh</a>);</td></tr>
<tr><th id="1708">1708</th><td>	<a class="tu ref fn" href="#copy_to_user_policy" title='copy_to_user_policy' data-use='c' data-ref="copy_to_user_policy" data-ref-filename="copy_to_user_policy">copy_to_user_policy</a>(<a class="local col7 ref" href="#307xp" title='xp' data-ref="307xp" data-ref-filename="307xp">xp</a>, <a class="local col2 ref" href="#312p" title='p' data-ref="312p" data-ref-filename="312p">p</a>, <a class="local col8 ref" href="#308dir" title='dir' data-ref="308dir" data-ref-filename="308dir">dir</a>);</td></tr>
<tr><th id="1709">1709</th><td>	<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a> = <a class="tu ref fn" href="#copy_to_user_tmpl" title='copy_to_user_tmpl' data-use='c' data-ref="copy_to_user_tmpl" data-ref-filename="copy_to_user_tmpl">copy_to_user_tmpl</a>(<a class="local col7 ref" href="#307xp" title='xp' data-ref="307xp" data-ref-filename="307xp">xp</a>, <a class="local col4 ref" href="#314skb" title='skb' data-ref="314skb" data-ref-filename="314skb">skb</a>);</td></tr>
<tr><th id="1710">1710</th><td>	<b>if</b> (!<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a>)</td></tr>
<tr><th id="1711">1711</th><td>		<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a> = <a class="tu ref fn" href="#copy_to_user_sec_ctx" title='copy_to_user_sec_ctx' data-use='c' data-ref="copy_to_user_sec_ctx" data-ref-filename="copy_to_user_sec_ctx">copy_to_user_sec_ctx</a>(<a class="local col7 ref" href="#307xp" title='xp' data-ref="307xp" data-ref-filename="307xp">xp</a>, <a class="local col4 ref" href="#314skb" title='skb' data-ref="314skb" data-ref-filename="314skb">skb</a>);</td></tr>
<tr><th id="1712">1712</th><td>	<b>if</b> (!<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a>)</td></tr>
<tr><th id="1713">1713</th><td>		<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a> = <a class="tu ref fn" href="#copy_to_user_policy_type" title='copy_to_user_policy_type' data-use='c' data-ref="copy_to_user_policy_type" data-ref-filename="copy_to_user_policy_type">copy_to_user_policy_type</a>(<a class="local col7 ref" href="#307xp" title='xp' data-ref="307xp" data-ref-filename="307xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::type" title='xfrm_policy::type' data-ref="xfrm_policy::type" data-ref-filename="xfrm_policy..type">type</a>, <a class="local col4 ref" href="#314skb" title='skb' data-ref="314skb" data-ref-filename="314skb">skb</a>);</td></tr>
<tr><th id="1714">1714</th><td>	<b>if</b> (!<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a>)</td></tr>
<tr><th id="1715">1715</th><td>		<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_put" title='xfrm_mark_put' data-ref="xfrm_mark_put" data-ref-filename="xfrm_mark_put">xfrm_mark_put</a>(<a class="local col4 ref" href="#314skb" title='skb' data-ref="314skb" data-ref-filename="314skb">skb</a>, &amp;<a class="local col7 ref" href="#307xp" title='xp' data-ref="307xp" data-ref-filename="307xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::mark" title='xfrm_policy::mark' data-ref="xfrm_policy::mark" data-ref-filename="xfrm_policy..mark">mark</a>);</td></tr>
<tr><th id="1716">1716</th><td>	<b>if</b> (<a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a>) {</td></tr>
<tr><th id="1717">1717</th><td>		<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col4 ref" href="#314skb" title='skb' data-ref="314skb" data-ref-filename="314skb">skb</a>, <a class="local col5 ref" href="#315nlh" title='nlh' data-ref="315nlh" data-ref-filename="315nlh">nlh</a>);</td></tr>
<tr><th id="1718">1718</th><td>		<b>return</b> <a class="local col6 ref" href="#316err" title='err' data-ref="316err" data-ref-filename="316err">err</a>;</td></tr>
<tr><th id="1719">1719</th><td>	}</td></tr>
<tr><th id="1720">1720</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col4 ref" href="#314skb" title='skb' data-ref="314skb" data-ref-filename="314skb">skb</a>, <a class="local col5 ref" href="#315nlh" title='nlh' data-ref="315nlh" data-ref-filename="315nlh">nlh</a>);</td></tr>
<tr><th id="1721">1721</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1722">1722</th><td>}</td></tr>
<tr><th id="1723">1723</th><td></td></tr>
<tr><th id="1724">1724</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_dump_policy_done" title='xfrm_dump_policy_done' data-type='int xfrm_dump_policy_done(struct netlink_callback * cb)' data-ref="xfrm_dump_policy_done" data-ref-filename="xfrm_dump_policy_done">xfrm_dump_policy_done</dfn>(<b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *<dfn class="local col7 decl" id="317cb" title='cb' data-type='struct netlink_callback *' data-ref="317cb" data-ref-filename="317cb">cb</dfn>)</td></tr>
<tr><th id="1725">1725</th><td>{</td></tr>
<tr><th id="1726">1726</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy_walk" title='xfrm_policy_walk' data-ref="xfrm_policy_walk" data-ref-filename="xfrm_policy_walk">xfrm_policy_walk</a> *<dfn class="local col8 decl" id="318walk" title='walk' data-type='struct xfrm_policy_walk *' data-ref="318walk" data-ref-filename="318walk">walk</dfn> = (<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy_walk" title='xfrm_policy_walk' data-ref="xfrm_policy_walk" data-ref-filename="xfrm_policy_walk">xfrm_policy_walk</a> *)<a class="local col7 ref" href="#317cb" title='cb' data-ref="317cb" data-ref-filename="317cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>;</td></tr>
<tr><th id="1727">1727</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col9 decl" id="319net" title='net' data-type='struct net *' data-ref="319net" data-ref-filename="319net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col7 ref" href="#317cb" title='cb' data-ref="317cb" data-ref-filename="317cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::skb" title='netlink_callback::skb' data-ref="netlink_callback::skb" data-ref-filename="netlink_callback..skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1728">1728</th><td></td></tr>
<tr><th id="1729">1729</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_walk_done" title='xfrm_policy_walk_done' data-ref="xfrm_policy_walk_done" data-ref-filename="xfrm_policy_walk_done">xfrm_policy_walk_done</a>(<a class="local col8 ref" href="#318walk" title='walk' data-ref="318walk" data-ref-filename="318walk">walk</a>, <a class="local col9 ref" href="#319net" title='net' data-ref="319net" data-ref-filename="319net">net</a>);</td></tr>
<tr><th id="1730">1730</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1731">1731</th><td>}</td></tr>
<tr><th id="1732">1732</th><td></td></tr>
<tr><th id="1733">1733</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_dump_policy_start" title='xfrm_dump_policy_start' data-type='int xfrm_dump_policy_start(struct netlink_callback * cb)' data-ref="xfrm_dump_policy_start" data-ref-filename="xfrm_dump_policy_start">xfrm_dump_policy_start</dfn>(<b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *<dfn class="local col0 decl" id="320cb" title='cb' data-type='struct netlink_callback *' data-ref="320cb" data-ref-filename="320cb">cb</dfn>)</td></tr>
<tr><th id="1734">1734</th><td>{</td></tr>
<tr><th id="1735">1735</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy_walk" title='xfrm_policy_walk' data-ref="xfrm_policy_walk" data-ref-filename="xfrm_policy_walk">xfrm_policy_walk</a> *<dfn class="local col1 decl" id="321walk" title='walk' data-type='struct xfrm_policy_walk *' data-ref="321walk" data-ref-filename="321walk">walk</dfn> = (<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy_walk" title='xfrm_policy_walk' data-ref="xfrm_policy_walk" data-ref-filename="xfrm_policy_walk">xfrm_policy_walk</a> *)<a class="local col0 ref" href="#320cb" title='cb' data-ref="320cb" data-ref-filename="320cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>;</td></tr>
<tr><th id="1736">1736</th><td></td></tr>
<tr><th id="1737">1737</th><td>	<a class="macro" href="../../include/linux/build_bug.h.html#70" title="do { bool __cond = !(!(sizeof(*walk) &gt; sizeof(cb-&gt;args))); extern void __compiletime_assert_1737(void) ; if (__cond) __compiletime_assert_1737(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0)" data-ref="_M/BUILD_BUG_ON">BUILD_BUG_ON</a>(<b>sizeof</b>(*<a class="local col1 ref" href="#321walk" title='walk' data-ref="321walk" data-ref-filename="321walk">walk</a>) &gt; <b>sizeof</b>(<a class="local col0 ref" href="#320cb" title='cb' data-ref="320cb" data-ref-filename="320cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>));</td></tr>
<tr><th id="1738">1738</th><td></td></tr>
<tr><th id="1739">1739</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_walk_init" title='xfrm_policy_walk_init' data-ref="xfrm_policy_walk_init" data-ref-filename="xfrm_policy_walk_init">xfrm_policy_walk_init</a>(<a class="local col1 ref" href="#321walk" title='walk' data-ref="321walk" data-ref-filename="321walk">walk</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_TYPE_ANY" title='XFRM_POLICY_TYPE_ANY' data-ref="XFRM_POLICY_TYPE_ANY" data-ref-filename="XFRM_POLICY_TYPE_ANY">XFRM_POLICY_TYPE_ANY</a>);</td></tr>
<tr><th id="1740">1740</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1741">1741</th><td>}</td></tr>
<tr><th id="1742">1742</th><td></td></tr>
<tr><th id="1743">1743</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_dump_policy" title='xfrm_dump_policy' data-type='int xfrm_dump_policy(struct sk_buff * skb, struct netlink_callback * cb)' data-ref="xfrm_dump_policy" data-ref-filename="xfrm_dump_policy">xfrm_dump_policy</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="322skb" title='skb' data-type='struct sk_buff *' data-ref="322skb" data-ref-filename="322skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *<dfn class="local col3 decl" id="323cb" title='cb' data-type='struct netlink_callback *' data-ref="323cb" data-ref-filename="323cb">cb</dfn>)</td></tr>
<tr><th id="1744">1744</th><td>{</td></tr>
<tr><th id="1745">1745</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col4 decl" id="324net" title='net' data-type='struct net *' data-ref="324net" data-ref-filename="324net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col2 ref" href="#322skb" title='skb' data-ref="322skb" data-ref-filename="322skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1746">1746</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy_walk" title='xfrm_policy_walk' data-ref="xfrm_policy_walk" data-ref-filename="xfrm_policy_walk">xfrm_policy_walk</a> *<dfn class="local col5 decl" id="325walk" title='walk' data-type='struct xfrm_policy_walk *' data-ref="325walk" data-ref-filename="325walk">walk</dfn> = (<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy_walk" title='xfrm_policy_walk' data-ref="xfrm_policy_walk" data-ref-filename="xfrm_policy_walk">xfrm_policy_walk</a> *)<a class="local col3 ref" href="#323cb" title='cb' data-ref="323cb" data-ref-filename="323cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::args" title='netlink_callback::args' data-ref="netlink_callback::args" data-ref-filename="netlink_callback..args">args</a>;</td></tr>
<tr><th id="1747">1747</th><td>	<b>struct</b> <a class="type" href="#xfrm_dump_info" title='xfrm_dump_info' data-ref="xfrm_dump_info" data-ref-filename="xfrm_dump_info">xfrm_dump_info</a> <dfn class="local col6 decl" id="326info" title='info' data-type='struct xfrm_dump_info' data-ref="326info" data-ref-filename="326info">info</dfn>;</td></tr>
<tr><th id="1748">1748</th><td></td></tr>
<tr><th id="1749">1749</th><td>	<a class="local col6 ref" href="#326info" title='info' data-ref="326info" data-ref-filename="326info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::in_skb" title='xfrm_dump_info::in_skb' data-use='w' data-ref="xfrm_dump_info::in_skb" data-ref-filename="xfrm_dump_info..in_skb">in_skb</a> = <a class="local col3 ref" href="#323cb" title='cb' data-ref="323cb" data-ref-filename="323cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::skb" title='netlink_callback::skb' data-ref="netlink_callback::skb" data-ref-filename="netlink_callback..skb">skb</a>;</td></tr>
<tr><th id="1750">1750</th><td>	<a class="local col6 ref" href="#326info" title='info' data-ref="326info" data-ref-filename="326info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::out_skb" title='xfrm_dump_info::out_skb' data-use='w' data-ref="xfrm_dump_info::out_skb" data-ref-filename="xfrm_dump_info..out_skb">out_skb</a> = <a class="local col2 ref" href="#322skb" title='skb' data-ref="322skb" data-ref-filename="322skb">skb</a>;</td></tr>
<tr><th id="1751">1751</th><td>	<a class="local col6 ref" href="#326info" title='info' data-ref="326info" data-ref-filename="326info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_seq" title='xfrm_dump_info::nlmsg_seq' data-use='w' data-ref="xfrm_dump_info::nlmsg_seq" data-ref-filename="xfrm_dump_info..nlmsg_seq">nlmsg_seq</a> = <a class="local col3 ref" href="#323cb" title='cb' data-ref="323cb" data-ref-filename="323cb">cb</a>-&gt;<a class="ref field" href="../../include/linux/netlink.h.html#netlink_callback::nlh" title='netlink_callback::nlh' data-ref="netlink_callback::nlh" data-ref-filename="netlink_callback..nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="1752">1752</th><td>	<a class="local col6 ref" href="#326info" title='info' data-ref="326info" data-ref-filename="326info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_flags" title='xfrm_dump_info::nlmsg_flags' data-use='w' data-ref="xfrm_dump_info::nlmsg_flags" data-ref-filename="xfrm_dump_info..nlmsg_flags">nlmsg_flags</a> = <a class="macro" href="../../include/uapi/linux/netlink.h.html#55" title="0x02" data-ref="_M/NLM_F_MULTI">NLM_F_MULTI</a>;</td></tr>
<tr><th id="1753">1753</th><td></td></tr>
<tr><th id="1754">1754</th><td>	(<em>void</em>) <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_walk" title='xfrm_policy_walk' data-ref="xfrm_policy_walk" data-ref-filename="xfrm_policy_walk">xfrm_policy_walk</a>(<a class="local col4 ref" href="#324net" title='net' data-ref="324net" data-ref-filename="324net">net</a>, <a class="local col5 ref" href="#325walk" title='walk' data-ref="325walk" data-ref-filename="325walk">walk</a>, <a class="tu ref fn" href="#dump_one_policy" title='dump_one_policy' data-use='r' data-ref="dump_one_policy" data-ref-filename="dump_one_policy">dump_one_policy</a>, &amp;<a class="local col6 ref" href="#326info" title='info' data-ref="326info" data-ref-filename="326info">info</a>);</td></tr>
<tr><th id="1755">1755</th><td></td></tr>
<tr><th id="1756">1756</th><td>	<b>return</b> <a class="local col2 ref" href="#322skb" title='skb' data-ref="322skb" data-ref-filename="322skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::len" title='sk_buff::len' data-ref="sk_buff::len" data-ref-filename="sk_buff..len">len</a>;</td></tr>
<tr><th id="1757">1757</th><td>}</td></tr>
<tr><th id="1758">1758</th><td></td></tr>
<tr><th id="1759">1759</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="tu decl def fn" id="xfrm_policy_netlink" title='xfrm_policy_netlink' data-type='struct sk_buff * xfrm_policy_netlink(struct sk_buff * in_skb, struct xfrm_policy * xp, int dir, u32 seq)' data-ref="xfrm_policy_netlink" data-ref-filename="xfrm_policy_netlink">xfrm_policy_netlink</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="327in_skb" title='in_skb' data-type='struct sk_buff *' data-ref="327in_skb" data-ref-filename="327in_skb">in_skb</dfn>,</td></tr>
<tr><th id="1760">1760</th><td>					  <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col8 decl" id="328xp" title='xp' data-type='struct xfrm_policy *' data-ref="328xp" data-ref-filename="328xp">xp</dfn>,</td></tr>
<tr><th id="1761">1761</th><td>					  <em>int</em> <dfn class="local col9 decl" id="329dir" title='dir' data-type='int' data-ref="329dir" data-ref-filename="329dir">dir</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col0 decl" id="330seq" title='seq' data-type='u32' data-ref="330seq" data-ref-filename="330seq">seq</dfn>)</td></tr>
<tr><th id="1762">1762</th><td>{</td></tr>
<tr><th id="1763">1763</th><td>	<b>struct</b> <a class="type" href="#xfrm_dump_info" title='xfrm_dump_info' data-ref="xfrm_dump_info" data-ref-filename="xfrm_dump_info">xfrm_dump_info</a> <dfn class="local col1 decl" id="331info" title='info' data-type='struct xfrm_dump_info' data-ref="331info" data-ref-filename="331info">info</dfn>;</td></tr>
<tr><th id="1764">1764</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="332skb" title='skb' data-type='struct sk_buff *' data-ref="332skb" data-ref-filename="332skb">skb</dfn>;</td></tr>
<tr><th id="1765">1765</th><td>	<em>int</em> <dfn class="local col3 decl" id="333err" title='err' data-type='int' data-ref="333err" data-ref-filename="333err">err</dfn>;</td></tr>
<tr><th id="1766">1766</th><td></td></tr>
<tr><th id="1767">1767</th><td>	<a class="local col2 ref" href="#332skb" title='skb' data-ref="332skb" data-ref-filename="332skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="macro" href="../../include/linux/netlink.h.html#167" title="(((((1UL) &lt;&lt; 12)) - ((((sizeof(struct skb_shared_info))) + ((typeof((sizeof(struct skb_shared_info))))(((1 &lt;&lt; (6)))) - 1)) &amp; ~((typeof((sizeof(struct skb_shared_info))))(((1 &lt;&lt; (6)))) - 1))) - ((int) ( ((sizeof(struct nlmsghdr))+4U-1) &amp; ~(4U-1) )))" data-ref="_M/NLMSG_DEFAULT_SIZE">NLMSG_DEFAULT_SIZE</a>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="1768">1768</th><td>	<b>if</b> (!<a class="local col2 ref" href="#332skb" title='skb' data-ref="332skb" data-ref-filename="332skb">skb</a>)</td></tr>
<tr><th id="1769">1769</th><td>		<b>return</b> <a class="ref fn" href="../../include/linux/err.h.html#ERR_PTR" title='ERR_PTR' data-ref="ERR_PTR" data-ref-filename="ERR_PTR">ERR_PTR</a>(-<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>);</td></tr>
<tr><th id="1770">1770</th><td></td></tr>
<tr><th id="1771">1771</th><td>	<a class="local col1 ref" href="#331info" title='info' data-ref="331info" data-ref-filename="331info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::in_skb" title='xfrm_dump_info::in_skb' data-use='w' data-ref="xfrm_dump_info::in_skb" data-ref-filename="xfrm_dump_info..in_skb">in_skb</a> = <a class="local col7 ref" href="#327in_skb" title='in_skb' data-ref="327in_skb" data-ref-filename="327in_skb">in_skb</a>;</td></tr>
<tr><th id="1772">1772</th><td>	<a class="local col1 ref" href="#331info" title='info' data-ref="331info" data-ref-filename="331info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::out_skb" title='xfrm_dump_info::out_skb' data-use='w' data-ref="xfrm_dump_info::out_skb" data-ref-filename="xfrm_dump_info..out_skb">out_skb</a> = <a class="local col2 ref" href="#332skb" title='skb' data-ref="332skb" data-ref-filename="332skb">skb</a>;</td></tr>
<tr><th id="1773">1773</th><td>	<a class="local col1 ref" href="#331info" title='info' data-ref="331info" data-ref-filename="331info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_seq" title='xfrm_dump_info::nlmsg_seq' data-use='w' data-ref="xfrm_dump_info::nlmsg_seq" data-ref-filename="xfrm_dump_info..nlmsg_seq">nlmsg_seq</a> = <a class="local col0 ref" href="#330seq" title='seq' data-ref="330seq" data-ref-filename="330seq">seq</a>;</td></tr>
<tr><th id="1774">1774</th><td>	<a class="local col1 ref" href="#331info" title='info' data-ref="331info" data-ref-filename="331info">info</a>.<a class="tu ref field" href="#xfrm_dump_info::nlmsg_flags" title='xfrm_dump_info::nlmsg_flags' data-use='w' data-ref="xfrm_dump_info::nlmsg_flags" data-ref-filename="xfrm_dump_info..nlmsg_flags">nlmsg_flags</a> = <var>0</var>;</td></tr>
<tr><th id="1775">1775</th><td></td></tr>
<tr><th id="1776">1776</th><td>	<a class="local col3 ref" href="#333err" title='err' data-ref="333err" data-ref-filename="333err">err</a> = <a class="tu ref fn" href="#dump_one_policy" title='dump_one_policy' data-use='c' data-ref="dump_one_policy" data-ref-filename="dump_one_policy">dump_one_policy</a>(<a class="local col8 ref" href="#328xp" title='xp' data-ref="328xp" data-ref-filename="328xp">xp</a>, <a class="local col9 ref" href="#329dir" title='dir' data-ref="329dir" data-ref-filename="329dir">dir</a>, <var>0</var>, &amp;<a class="local col1 ref" href="#331info" title='info' data-ref="331info" data-ref-filename="331info">info</a>);</td></tr>
<tr><th id="1777">1777</th><td>	<b>if</b> (<a class="local col3 ref" href="#333err" title='err' data-ref="333err" data-ref-filename="333err">err</a>) {</td></tr>
<tr><th id="1778">1778</th><td>		<a class="ref fn" href="../../include/linux/skbuff.h.html#kfree_skb" title='kfree_skb' data-ref="kfree_skb" data-ref-filename="kfree_skb">kfree_skb</a>(<a class="local col2 ref" href="#332skb" title='skb' data-ref="332skb" data-ref-filename="332skb">skb</a>);</td></tr>
<tr><th id="1779">1779</th><td>		<b>return</b> <a class="ref fn" href="../../include/linux/err.h.html#ERR_PTR" title='ERR_PTR' data-ref="ERR_PTR" data-ref-filename="ERR_PTR">ERR_PTR</a>(<a class="local col3 ref" href="#333err" title='err' data-ref="333err" data-ref-filename="333err">err</a>);</td></tr>
<tr><th id="1780">1780</th><td>	}</td></tr>
<tr><th id="1781">1781</th><td></td></tr>
<tr><th id="1782">1782</th><td>	<b>return</b> <a class="local col2 ref" href="#332skb" title='skb' data-ref="332skb" data-ref-filename="332skb">skb</a>;</td></tr>
<tr><th id="1783">1783</th><td>}</td></tr>
<tr><th id="1784">1784</th><td></td></tr>
<tr><th id="1785">1785</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_get_policy" title='xfrm_get_policy' data-type='int xfrm_get_policy(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_get_policy" data-ref-filename="xfrm_get_policy">xfrm_get_policy</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col4 decl" id="334skb" title='skb' data-type='struct sk_buff *' data-ref="334skb" data-ref-filename="334skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col5 decl" id="335nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="335nlh" data-ref-filename="335nlh">nlh</dfn>,</td></tr>
<tr><th id="1786">1786</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col6 decl" id="336attrs" title='attrs' data-type='struct nlattr **' data-ref="336attrs" data-ref-filename="336attrs">attrs</dfn>)</td></tr>
<tr><th id="1787">1787</th><td>{</td></tr>
<tr><th id="1788">1788</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col7 decl" id="337net" title='net' data-type='struct net *' data-ref="337net" data-ref-filename="337net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col4 ref" href="#334skb" title='skb' data-ref="334skb" data-ref-filename="334skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1789">1789</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col8 decl" id="338xp" title='xp' data-type='struct xfrm_policy *' data-ref="338xp" data-ref-filename="338xp">xp</dfn>;</td></tr>
<tr><th id="1790">1790</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id" title='xfrm_userpolicy_id' data-ref="xfrm_userpolicy_id" data-ref-filename="xfrm_userpolicy_id">xfrm_userpolicy_id</a> *<dfn class="local col9 decl" id="339p" title='p' data-type='struct xfrm_userpolicy_id *' data-ref="339p" data-ref-filename="339p">p</dfn>;</td></tr>
<tr><th id="1791">1791</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col0 decl" id="340type" title='type' data-type='u8' data-ref="340type" data-ref-filename="340type">type</dfn> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_TYPE_MAIN" title='XFRM_POLICY_TYPE_MAIN' data-ref="XFRM_POLICY_TYPE_MAIN" data-ref-filename="XFRM_POLICY_TYPE_MAIN">XFRM_POLICY_TYPE_MAIN</a>;</td></tr>
<tr><th id="1792">1792</th><td>	<em>int</em> <dfn class="local col1 decl" id="341err" title='err' data-type='int' data-ref="341err" data-ref-filename="341err">err</dfn>;</td></tr>
<tr><th id="1793">1793</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col2 decl" id="342c" title='c' data-type='struct km_event' data-ref="342c" data-ref-filename="342c">c</dfn>;</td></tr>
<tr><th id="1794">1794</th><td>	<em>int</em> <dfn class="local col3 decl" id="343delete" title='delete' data-type='int' data-ref="343delete" data-ref-filename="343delete">delete</dfn>;</td></tr>
<tr><th id="1795">1795</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col4 decl" id="344m" title='m' data-type='struct xfrm_mark' data-ref="344m" data-ref-filename="344m">m</dfn>;</td></tr>
<tr><th id="1796">1796</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col5 decl" id="345mark" title='mark' data-type='u32' data-ref="345mark" data-ref-filename="345mark">mark</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col6 ref" href="#336attrs" title='attrs' data-ref="336attrs" data-ref-filename="336attrs">attrs</a>, &amp;<a class="local col4 ref" href="#344m" title='m' data-ref="344m" data-ref-filename="344m">m</a>);</td></tr>
<tr><th id="1797">1797</th><td></td></tr>
<tr><th id="1798">1798</th><td>	<a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col5 ref" href="#335nlh" title='nlh' data-ref="335nlh" data-ref-filename="335nlh">nlh</a>);</td></tr>
<tr><th id="1799">1799</th><td>	<a class="local col3 ref" href="#343delete" title='delete' data-ref="343delete" data-ref-filename="343delete">delete</a> = <a class="local col5 ref" href="#335nlh" title='nlh' data-ref="335nlh" data-ref-filename="335nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#171" title="XFRM_MSG_DELPOLICY" data-ref="_M/XFRM_MSG_DELPOLICY">XFRM_MSG_DELPOLICY</a>;</td></tr>
<tr><th id="1800">1800</th><td></td></tr>
<tr><th id="1801">1801</th><td>	<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> = <a class="tu ref fn" href="#copy_from_user_policy_type" title='copy_from_user_policy_type' data-use='c' data-ref="copy_from_user_policy_type" data-ref-filename="copy_from_user_policy_type">copy_from_user_policy_type</a>(&amp;<a class="local col0 ref" href="#340type" title='type' data-ref="340type" data-ref-filename="340type">type</a>, <a class="local col6 ref" href="#336attrs" title='attrs' data-ref="336attrs" data-ref-filename="336attrs">attrs</a>);</td></tr>
<tr><th id="1802">1802</th><td>	<b>if</b> (<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>)</td></tr>
<tr><th id="1803">1803</th><td>		<b>return</b> <a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>;</td></tr>
<tr><th id="1804">1804</th><td></td></tr>
<tr><th id="1805">1805</th><td>	<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> = <a class="tu ref fn" href="#verify_policy_dir" title='verify_policy_dir' data-use='c' data-ref="verify_policy_dir" data-ref-filename="verify_policy_dir">verify_policy_dir</a>(<a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::dir" title='xfrm_userpolicy_id::dir' data-ref="xfrm_userpolicy_id::dir" data-ref-filename="xfrm_userpolicy_id..dir">dir</a>);</td></tr>
<tr><th id="1806">1806</th><td>	<b>if</b> (<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>)</td></tr>
<tr><th id="1807">1807</th><td>		<b>return</b> <a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>;</td></tr>
<tr><th id="1808">1808</th><td></td></tr>
<tr><th id="1809">1809</th><td>	<b>if</b> (<a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::index" title='xfrm_userpolicy_id::index' data-ref="xfrm_userpolicy_id::index" data-ref-filename="xfrm_userpolicy_id..index">index</a>)</td></tr>
<tr><th id="1810">1810</th><td>		<a class="local col8 ref" href="#338xp" title='xp' data-ref="338xp" data-ref-filename="338xp">xp</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_byid" title='xfrm_policy_byid' data-ref="xfrm_policy_byid" data-ref-filename="xfrm_policy_byid">xfrm_policy_byid</a>(<a class="local col7 ref" href="#337net" title='net' data-ref="337net" data-ref-filename="337net">net</a>, <a class="local col5 ref" href="#345mark" title='mark' data-ref="345mark" data-ref-filename="345mark">mark</a>, <a class="local col0 ref" href="#340type" title='type' data-ref="340type" data-ref-filename="340type">type</a>, <a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::dir" title='xfrm_userpolicy_id::dir' data-ref="xfrm_userpolicy_id::dir" data-ref-filename="xfrm_userpolicy_id..dir">dir</a>, <a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::index" title='xfrm_userpolicy_id::index' data-ref="xfrm_userpolicy_id::index" data-ref-filename="xfrm_userpolicy_id..index">index</a>, <a class="local col3 ref" href="#343delete" title='delete' data-ref="343delete" data-ref-filename="343delete">delete</a>, &amp;<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>);</td></tr>
<tr><th id="1811">1811</th><td>	<b>else</b> {</td></tr>
<tr><th id="1812">1812</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col6 decl" id="346rt" title='rt' data-type='struct nlattr *' data-ref="346rt" data-ref-filename="346rt">rt</dfn> = <a class="local col6 ref" href="#336attrs" title='attrs' data-ref="336attrs" data-ref-filename="336attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>];</td></tr>
<tr><th id="1813">1813</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx" title='xfrm_sec_ctx' data-ref="xfrm_sec_ctx" data-ref-filename="xfrm_sec_ctx">xfrm_sec_ctx</a> *<dfn class="local col7 decl" id="347ctx" title='ctx' data-type='struct xfrm_sec_ctx *' data-ref="347ctx" data-ref-filename="347ctx">ctx</dfn>;</td></tr>
<tr><th id="1814">1814</th><td></td></tr>
<tr><th id="1815">1815</th><td>		<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> = <a class="tu ref fn" href="#verify_sec_ctx_len" title='verify_sec_ctx_len' data-use='c' data-ref="verify_sec_ctx_len" data-ref-filename="verify_sec_ctx_len">verify_sec_ctx_len</a>(<a class="local col6 ref" href="#336attrs" title='attrs' data-ref="336attrs" data-ref-filename="336attrs">attrs</a>);</td></tr>
<tr><th id="1816">1816</th><td>		<b>if</b> (<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>)</td></tr>
<tr><th id="1817">1817</th><td>			<b>return</b> <a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>;</td></tr>
<tr><th id="1818">1818</th><td></td></tr>
<tr><th id="1819">1819</th><td>		<a class="local col7 ref" href="#347ctx" title='ctx' data-ref="347ctx" data-ref-filename="347ctx">ctx</a> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="1820">1820</th><td>		<b>if</b> (<a class="local col6 ref" href="#346rt" title='rt' data-ref="346rt" data-ref-filename="346rt">rt</a>) {</td></tr>
<tr><th id="1821">1821</th><td>			<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a> *<dfn class="local col8 decl" id="348uctx" title='uctx' data-type='struct xfrm_user_sec_ctx *' data-ref="348uctx" data-ref-filename="348uctx">uctx</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col6 ref" href="#346rt" title='rt' data-ref="346rt" data-ref-filename="346rt">rt</a>);</td></tr>
<tr><th id="1822">1822</th><td></td></tr>
<tr><th id="1823">1823</th><td>			<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> = <a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_policy_alloc" title='security_xfrm_policy_alloc' data-ref="security_xfrm_policy_alloc" data-ref-filename="security_xfrm_policy_alloc">security_xfrm_policy_alloc</a>(&amp;<a class="local col7 ref" href="#347ctx" title='ctx' data-ref="347ctx" data-ref-filename="347ctx">ctx</a>, <a class="local col8 ref" href="#348uctx" title='uctx' data-ref="348uctx" data-ref-filename="348uctx">uctx</a>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="1824">1824</th><td>			<b>if</b> (<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>)</td></tr>
<tr><th id="1825">1825</th><td>				<b>return</b> <a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>;</td></tr>
<tr><th id="1826">1826</th><td>		}</td></tr>
<tr><th id="1827">1827</th><td>		<a class="local col8 ref" href="#338xp" title='xp' data-ref="338xp" data-ref-filename="338xp">xp</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_bysel_ctx" title='xfrm_policy_bysel_ctx' data-ref="xfrm_policy_bysel_ctx" data-ref-filename="xfrm_policy_bysel_ctx">xfrm_policy_bysel_ctx</a>(<a class="local col7 ref" href="#337net" title='net' data-ref="337net" data-ref-filename="337net">net</a>, <a class="local col5 ref" href="#345mark" title='mark' data-ref="345mark" data-ref-filename="345mark">mark</a>, <a class="local col0 ref" href="#340type" title='type' data-ref="340type" data-ref-filename="340type">type</a>, <a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::dir" title='xfrm_userpolicy_id::dir' data-ref="xfrm_userpolicy_id::dir" data-ref-filename="xfrm_userpolicy_id..dir">dir</a>, &amp;<a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::sel" title='xfrm_userpolicy_id::sel' data-ref="xfrm_userpolicy_id::sel" data-ref-filename="xfrm_userpolicy_id..sel">sel</a>,</td></tr>
<tr><th id="1828">1828</th><td>					   <a class="local col7 ref" href="#347ctx" title='ctx' data-ref="347ctx" data-ref-filename="347ctx">ctx</a>, <a class="local col3 ref" href="#343delete" title='delete' data-ref="343delete" data-ref-filename="343delete">delete</a>, &amp;<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>);</td></tr>
<tr><th id="1829">1829</th><td>		<a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_policy_free" title='security_xfrm_policy_free' data-ref="security_xfrm_policy_free" data-ref-filename="security_xfrm_policy_free">security_xfrm_policy_free</a>(<a class="local col7 ref" href="#347ctx" title='ctx' data-ref="347ctx" data-ref-filename="347ctx">ctx</a>);</td></tr>
<tr><th id="1830">1830</th><td>	}</td></tr>
<tr><th id="1831">1831</th><td>	<b>if</b> (<a class="local col8 ref" href="#338xp" title='xp' data-ref="338xp" data-ref-filename="338xp">xp</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1832">1832</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#6" title="2" data-ref="_M/ENOENT">ENOENT</a>;</td></tr>
<tr><th id="1833">1833</th><td></td></tr>
<tr><th id="1834">1834</th><td>	<b>if</b> (!<a class="local col3 ref" href="#343delete" title='delete' data-ref="343delete" data-ref-filename="343delete">delete</a>) {</td></tr>
<tr><th id="1835">1835</th><td>		<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col9 decl" id="349resp_skb" title='resp_skb' data-type='struct sk_buff *' data-ref="349resp_skb" data-ref-filename="349resp_skb">resp_skb</dfn>;</td></tr>
<tr><th id="1836">1836</th><td></td></tr>
<tr><th id="1837">1837</th><td>		<a class="local col9 ref" href="#349resp_skb" title='resp_skb' data-ref="349resp_skb" data-ref-filename="349resp_skb">resp_skb</a> = <a class="tu ref fn" href="#xfrm_policy_netlink" title='xfrm_policy_netlink' data-use='c' data-ref="xfrm_policy_netlink" data-ref-filename="xfrm_policy_netlink">xfrm_policy_netlink</a>(<a class="local col4 ref" href="#334skb" title='skb' data-ref="334skb" data-ref-filename="334skb">skb</a>, <a class="local col8 ref" href="#338xp" title='xp' data-ref="338xp" data-ref-filename="338xp">xp</a>, <a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::dir" title='xfrm_userpolicy_id::dir' data-ref="xfrm_userpolicy_id::dir" data-ref-filename="xfrm_userpolicy_id..dir">dir</a>, <a class="local col5 ref" href="#335nlh" title='nlh' data-ref="335nlh" data-ref-filename="335nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>);</td></tr>
<tr><th id="1838">1838</th><td>		<b>if</b> (<a class="ref fn" href="../../include/linux/err.h.html#IS_ERR" title='IS_ERR' data-ref="IS_ERR" data-ref-filename="IS_ERR">IS_ERR</a>(<a class="local col9 ref" href="#349resp_skb" title='resp_skb' data-ref="349resp_skb" data-ref-filename="349resp_skb">resp_skb</a>)) {</td></tr>
<tr><th id="1839">1839</th><td>			<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> = <a class="ref fn" href="../../include/linux/err.h.html#PTR_ERR" title='PTR_ERR' data-ref="PTR_ERR" data-ref-filename="PTR_ERR">PTR_ERR</a>(<a class="local col9 ref" href="#349resp_skb" title='resp_skb' data-ref="349resp_skb" data-ref-filename="349resp_skb">resp_skb</a>);</td></tr>
<tr><th id="1840">1840</th><td>		} <b>else</b> {</td></tr>
<tr><th id="1841">1841</th><td>			<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_unicast" title='nlmsg_unicast' data-ref="nlmsg_unicast" data-ref-filename="nlmsg_unicast">nlmsg_unicast</a>(<a class="local col7 ref" href="#337net" title='net' data-ref="337net" data-ref-filename="337net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col9 ref" href="#349resp_skb" title='resp_skb' data-ref="349resp_skb" data-ref-filename="349resp_skb">resp_skb</a>,</td></tr>
<tr><th id="1842">1842</th><td>					    <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col4 ref" href="#334skb" title='skb' data-ref="334skb" data-ref-filename="334skb">skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>);</td></tr>
<tr><th id="1843">1843</th><td>		}</td></tr>
<tr><th id="1844">1844</th><td>	} <b>else</b> {</td></tr>
<tr><th id="1845">1845</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_audit_policy_delete" title='xfrm_audit_policy_delete' data-ref="xfrm_audit_policy_delete" data-ref-filename="xfrm_audit_policy_delete">xfrm_audit_policy_delete</a>(<a class="local col8 ref" href="#338xp" title='xp' data-ref="338xp" data-ref-filename="338xp">xp</a>, <a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> ? <var>0</var> : <var>1</var>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="1846">1846</th><td></td></tr>
<tr><th id="1847">1847</th><td>		<b>if</b> (<a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a> != <var>0</var>)</td></tr>
<tr><th id="1848">1848</th><td>			<b>goto</b> <a class="lbl" href="#350out" data-ref="350out" data-ref-filename="350out">out</a>;</td></tr>
<tr><th id="1849">1849</th><td></td></tr>
<tr><th id="1850">1850</th><td>		<a class="local col2 ref" href="#342c" title='c' data-ref="342c" data-ref-filename="342c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::byid" title='km_event::(anonymous union)::byid' data-ref="km_event::(anonymous)::byid" data-ref-filename="km_event..(anonymous)..byid">byid</a> = <a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::index" title='xfrm_userpolicy_id::index' data-ref="xfrm_userpolicy_id::index" data-ref-filename="xfrm_userpolicy_id..index">index</a>;</td></tr>
<tr><th id="1851">1851</th><td>		<a class="local col2 ref" href="#342c" title='c' data-ref="342c" data-ref-filename="342c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> = <a class="local col5 ref" href="#335nlh" title='nlh' data-ref="335nlh" data-ref-filename="335nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="1852">1852</th><td>		<a class="local col2 ref" href="#342c" title='c' data-ref="342c" data-ref-filename="342c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col5 ref" href="#335nlh" title='nlh' data-ref="335nlh" data-ref-filename="335nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="1853">1853</th><td>		<a class="local col2 ref" href="#342c" title='c' data-ref="342c" data-ref-filename="342c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col5 ref" href="#335nlh" title='nlh' data-ref="335nlh" data-ref-filename="335nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="1854">1854</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#km_policy_notify" title='km_policy_notify' data-ref="km_policy_notify" data-ref-filename="km_policy_notify">km_policy_notify</a>(<a class="local col8 ref" href="#338xp" title='xp' data-ref="338xp" data-ref-filename="338xp">xp</a>, <a class="local col9 ref" href="#339p" title='p' data-ref="339p" data-ref-filename="339p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::dir" title='xfrm_userpolicy_id::dir' data-ref="xfrm_userpolicy_id::dir" data-ref-filename="xfrm_userpolicy_id..dir">dir</a>, &amp;<a class="local col2 ref" href="#342c" title='c' data-ref="342c" data-ref-filename="342c">c</a>);</td></tr>
<tr><th id="1855">1855</th><td>	}</td></tr>
<tr><th id="1856">1856</th><td></td></tr>
<tr><th id="1857">1857</th><td><dfn class="lbl" id="350out" data-ref="350out" data-ref-filename="350out">out</dfn>:</td></tr>
<tr><th id="1858">1858</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_pol_put" title='xfrm_pol_put' data-ref="xfrm_pol_put" data-ref-filename="xfrm_pol_put">xfrm_pol_put</a>(<a class="local col8 ref" href="#338xp" title='xp' data-ref="338xp" data-ref-filename="338xp">xp</a>);</td></tr>
<tr><th id="1859">1859</th><td>	<b>return</b> <a class="local col1 ref" href="#341err" title='err' data-ref="341err" data-ref-filename="341err">err</a>;</td></tr>
<tr><th id="1860">1860</th><td>}</td></tr>
<tr><th id="1861">1861</th><td></td></tr>
<tr><th id="1862">1862</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_flush_sa" title='xfrm_flush_sa' data-type='int xfrm_flush_sa(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_flush_sa" data-ref-filename="xfrm_flush_sa">xfrm_flush_sa</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col1 decl" id="351skb" title='skb' data-type='struct sk_buff *' data-ref="351skb" data-ref-filename="351skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col2 decl" id="352nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="352nlh" data-ref-filename="352nlh">nlh</dfn>,</td></tr>
<tr><th id="1863">1863</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col3 decl" id="353attrs" title='attrs' data-type='struct nlattr **' data-ref="353attrs" data-ref-filename="353attrs">attrs</dfn>)</td></tr>
<tr><th id="1864">1864</th><td>{</td></tr>
<tr><th id="1865">1865</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col4 decl" id="354net" title='net' data-type='struct net *' data-ref="354net" data-ref-filename="354net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col1 ref" href="#351skb" title='skb' data-ref="351skb" data-ref-filename="351skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1866">1866</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col5 decl" id="355c" title='c' data-type='struct km_event' data-ref="355c" data-ref-filename="355c">c</dfn>;</td></tr>
<tr><th id="1867">1867</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_flush" title='xfrm_usersa_flush' data-ref="xfrm_usersa_flush" data-ref-filename="xfrm_usersa_flush">xfrm_usersa_flush</a> *<dfn class="local col6 decl" id="356p" title='p' data-type='struct xfrm_usersa_flush *' data-ref="356p" data-ref-filename="356p">p</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col2 ref" href="#352nlh" title='nlh' data-ref="352nlh" data-ref-filename="352nlh">nlh</a>);</td></tr>
<tr><th id="1868">1868</th><td>	<em>int</em> <dfn class="local col7 decl" id="357err" title='err' data-type='int' data-ref="357err" data-ref-filename="357err">err</dfn>;</td></tr>
<tr><th id="1869">1869</th><td></td></tr>
<tr><th id="1870">1870</th><td>	<a class="local col7 ref" href="#357err" title='err' data-ref="357err" data-ref-filename="357err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_flush" title='xfrm_state_flush' data-ref="xfrm_state_flush" data-ref-filename="xfrm_state_flush">xfrm_state_flush</a>(<a class="local col4 ref" href="#354net" title='net' data-ref="354net" data-ref-filename="354net">net</a>, <a class="local col6 ref" href="#356p" title='p' data-ref="356p" data-ref-filename="356p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_flush::proto" title='xfrm_usersa_flush::proto' data-ref="xfrm_usersa_flush::proto" data-ref-filename="xfrm_usersa_flush..proto">proto</a>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="1871">1871</th><td>	<b>if</b> (<a class="local col7 ref" href="#357err" title='err' data-ref="357err" data-ref-filename="357err">err</a>) {</td></tr>
<tr><th id="1872">1872</th><td>		<b>if</b> (<a class="local col7 ref" href="#357err" title='err' data-ref="357err" data-ref-filename="357err">err</a> == -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>) <i>/* empty table */</i></td></tr>
<tr><th id="1873">1873</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1874">1874</th><td>		<b>return</b> <a class="local col7 ref" href="#357err" title='err' data-ref="357err" data-ref-filename="357err">err</a>;</td></tr>
<tr><th id="1875">1875</th><td>	}</td></tr>
<tr><th id="1876">1876</th><td>	<a class="local col5 ref" href="#355c" title='c' data-ref="355c" data-ref-filename="355c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::proto" title='km_event::(anonymous union)::proto' data-ref="km_event::(anonymous)::proto" data-ref-filename="km_event..(anonymous)..proto">proto</a> = <a class="local col6 ref" href="#356p" title='p' data-ref="356p" data-ref-filename="356p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_flush::proto" title='xfrm_usersa_flush::proto' data-ref="xfrm_usersa_flush::proto" data-ref-filename="xfrm_usersa_flush..proto">proto</a>;</td></tr>
<tr><th id="1877">1877</th><td>	<a class="local col5 ref" href="#355c" title='c' data-ref="355c" data-ref-filename="355c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> = <a class="local col2 ref" href="#352nlh" title='nlh' data-ref="352nlh" data-ref-filename="352nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="1878">1878</th><td>	<a class="local col5 ref" href="#355c" title='c' data-ref="355c" data-ref-filename="355c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col2 ref" href="#352nlh" title='nlh' data-ref="352nlh" data-ref-filename="352nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="1879">1879</th><td>	<a class="local col5 ref" href="#355c" title='c' data-ref="355c" data-ref-filename="355c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col2 ref" href="#352nlh" title='nlh' data-ref="352nlh" data-ref-filename="352nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="1880">1880</th><td>	<a class="local col5 ref" href="#355c" title='c' data-ref="355c" data-ref-filename="355c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::net" title='km_event::net' data-ref="km_event::net" data-ref-filename="km_event..net">net</a> = <a class="local col4 ref" href="#354net" title='net' data-ref="354net" data-ref-filename="354net">net</a>;</td></tr>
<tr><th id="1881">1881</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_state_notify" title='km_state_notify' data-ref="km_state_notify" data-ref-filename="km_state_notify">km_state_notify</a>(<a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, &amp;<a class="local col5 ref" href="#355c" title='c' data-ref="355c" data-ref-filename="355c">c</a>);</td></tr>
<tr><th id="1882">1882</th><td></td></tr>
<tr><th id="1883">1883</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1884">1884</th><td>}</td></tr>
<tr><th id="1885">1885</th><td></td></tr>
<tr><th id="1886">1886</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_aevent_msgsize" title='xfrm_aevent_msgsize' data-type='unsigned int xfrm_aevent_msgsize(struct xfrm_state * x)' data-ref="xfrm_aevent_msgsize" data-ref-filename="xfrm_aevent_msgsize">xfrm_aevent_msgsize</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col8 decl" id="358x" title='x' data-type='struct xfrm_state *' data-ref="358x" data-ref-filename="358x">x</dfn>)</td></tr>
<tr><th id="1887">1887</th><td>{</td></tr>
<tr><th id="1888">1888</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="359replay_size" title='replay_size' data-type='unsigned int' data-ref="359replay_size" data-ref-filename="359replay_size">replay_size</dfn> = <a class="local col8 ref" href="#358x" title='x' data-ref="358x" data-ref-filename="358x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a> ?</td></tr>
<tr><th id="1889">1889</th><td>			      <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col8 ref" href="#358x" title='x' data-ref="358x" data-ref-filename="358x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>) :</td></tr>
<tr><th id="1890">1890</th><td>			      <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state" title='xfrm_replay_state' data-ref="xfrm_replay_state" data-ref-filename="xfrm_replay_state">xfrm_replay_state</a>);</td></tr>
<tr><th id="1891">1891</th><td></td></tr>
<tr><th id="1892">1892</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((sizeof(struct xfrm_aevent_id))+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id" title='xfrm_aevent_id' data-ref="xfrm_aevent_id" data-ref-filename="xfrm_aevent_id">xfrm_aevent_id</a>))</td></tr>
<tr><th id="1893">1893</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="local col9 ref" href="#359replay_size" title='replay_size' data-ref="359replay_size" data-ref-filename="359replay_size">replay_size</a>)</td></tr>
<tr><th id="1894">1894</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size_64bit" title='nla_total_size_64bit' data-ref="nla_total_size_64bit" data-ref-filename="nla_total_size_64bit">nla_total_size_64bit</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur" title='xfrm_lifetime_cur' data-ref="xfrm_lifetime_cur" data-ref-filename="xfrm_lifetime_cur">xfrm_lifetime_cur</a>))</td></tr>
<tr><th id="1895">1895</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a>))</td></tr>
<tr><th id="1896">1896</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<var>4</var>) <i>/* XFRM_AE_RTHR */</i></td></tr>
<tr><th id="1897">1897</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<var>4</var>); <i>/* XFRM_AE_ETHR */</i></td></tr>
<tr><th id="1898">1898</th><td>}</td></tr>
<tr><th id="1899">1899</th><td></td></tr>
<tr><th id="1900">1900</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_aevent" title='build_aevent' data-type='int build_aevent(struct sk_buff * skb, struct xfrm_state * x, const struct km_event * c)' data-ref="build_aevent" data-ref-filename="build_aevent">build_aevent</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col0 decl" id="360skb" title='skb' data-type='struct sk_buff *' data-ref="360skb" data-ref-filename="360skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="361x" title='x' data-type='struct xfrm_state *' data-ref="361x" data-ref-filename="361x">x</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col2 decl" id="362c" title='c' data-type='const struct km_event *' data-ref="362c" data-ref-filename="362c">c</dfn>)</td></tr>
<tr><th id="1901">1901</th><td>{</td></tr>
<tr><th id="1902">1902</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id" title='xfrm_aevent_id' data-ref="xfrm_aevent_id" data-ref-filename="xfrm_aevent_id">xfrm_aevent_id</a> *<dfn class="local col3 decl" id="363id" title='id' data-type='struct xfrm_aevent_id *' data-ref="363id" data-ref-filename="363id">id</dfn>;</td></tr>
<tr><th id="1903">1903</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col4 decl" id="364nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="364nlh" data-ref-filename="364nlh">nlh</dfn>;</td></tr>
<tr><th id="1904">1904</th><td>	<em>int</em> <dfn class="local col5 decl" id="365err" title='err' data-type='int' data-ref="365err" data-ref-filename="365err">err</dfn>;</td></tr>
<tr><th id="1905">1905</th><td></td></tr>
<tr><th id="1906">1906</th><td>	<a class="local col4 ref" href="#364nlh" title='nlh' data-ref="364nlh" data-ref-filename="364nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="local col2 ref" href="#362c" title='c' data-ref="362c" data-ref-filename="362c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a>, <a class="local col2 ref" href="#362c" title='c' data-ref="362c" data-ref-filename="362c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#196" title="XFRM_MSG_NEWAE" data-ref="_M/XFRM_MSG_NEWAE">XFRM_MSG_NEWAE</a>, <b>sizeof</b>(*<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>), <var>0</var>);</td></tr>
<tr><th id="1907">1907</th><td>	<b>if</b> (<a class="local col4 ref" href="#364nlh" title='nlh' data-ref="364nlh" data-ref-filename="364nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1908">1908</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="1909">1909</th><td></td></tr>
<tr><th id="1910">1910</th><td>	<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col4 ref" href="#364nlh" title='nlh' data-ref="364nlh" data-ref-filename="364nlh">nlh</a>);</td></tr>
<tr><th id="1911">1911</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(&amp;<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>, <var>0</var>, <b>sizeof</b>(<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>));</td></tr>
<tr><th id="1912">1912</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(x-&gt;id.daddr)); void *__ret; if (__builtin_constant_p(sizeof(x-&gt;id.daddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;id-&gt;sa_id.daddr), (&amp;x-&gt;id.daddr), __len); else __ret = __builtin_memcpy((&amp;id-&gt;sa_id.daddr), (&amp;x-&gt;id.daddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>, &amp;<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::daddr" title='xfrm_id::daddr' data-ref="xfrm_id::daddr" data-ref-filename="xfrm_id..daddr">daddr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::daddr" title='xfrm_id::daddr' data-ref="xfrm_id::daddr" data-ref-filename="xfrm_id..daddr">daddr</a>));</td></tr>
<tr><th id="1913">1913</th><td>	<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::spi" title='xfrm_usersa_id::spi' data-ref="xfrm_usersa_id::spi" data-ref-filename="xfrm_usersa_id..spi">spi</a> = <a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::spi" title='xfrm_id::spi' data-ref="xfrm_id::spi" data-ref-filename="xfrm_id..spi">spi</a>;</td></tr>
<tr><th id="1914">1914</th><td>	<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::family" title='xfrm_usersa_id::family' data-ref="xfrm_usersa_id::family" data-ref-filename="xfrm_usersa_id..family">family</a> = <a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::family" title='xfrm_state::(anonymous struct)::family' data-ref="xfrm_state::(anonymous)::family" data-ref-filename="xfrm_state..(anonymous)..family">family</a>;</td></tr>
<tr><th id="1915">1915</th><td>	<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a> = <a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>;</td></tr>
<tr><th id="1916">1916</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(x-&gt;props.saddr)); void *__ret; if (__builtin_constant_p(sizeof(x-&gt;props.saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;id-&gt;saddr), (&amp;x-&gt;props.saddr), __len); else __ret = __builtin_memcpy((&amp;id-&gt;saddr), (&amp;x-&gt;props.saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::saddr" title='xfrm_aevent_id::saddr' data-ref="xfrm_aevent_id::saddr" data-ref-filename="xfrm_aevent_id..saddr">saddr</a>, &amp;<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>));</td></tr>
<tr><th id="1917">1917</th><td>	<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::reqid" title='xfrm_aevent_id::reqid' data-ref="xfrm_aevent_id::reqid" data-ref-filename="xfrm_aevent_id..reqid">reqid</a> = <a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::reqid" title='xfrm_state::(anonymous struct)::reqid' data-ref="xfrm_state::(anonymous)::reqid" data-ref-filename="xfrm_state..(anonymous)..reqid">reqid</a>;</td></tr>
<tr><th id="1918">1918</th><td>	<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::flags" title='xfrm_aevent_id::flags' data-ref="xfrm_aevent_id::flags" data-ref-filename="xfrm_aevent_id..flags">flags</a> = <a class="local col2 ref" href="#362c" title='c' data-ref="362c" data-ref-filename="362c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::aevent" title='km_event::(anonymous union)::aevent' data-ref="km_event::(anonymous)::aevent" data-ref-filename="km_event..(anonymous)..aevent">aevent</a>;</td></tr>
<tr><th id="1919">1919</th><td></td></tr>
<tr><th id="1920">1920</th><td>	<b>if</b> (<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>) {</td></tr>
<tr><th id="1921">1921</th><td>		<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_ESN_VAL" title='XFRMA_REPLAY_ESN_VAL' data-ref="XFRMA_REPLAY_ESN_VAL" data-ref-filename="XFRMA_REPLAY_ESN_VAL">XFRMA_REPLAY_ESN_VAL</a>,</td></tr>
<tr><th id="1922">1922</th><td>			      <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>),</td></tr>
<tr><th id="1923">1923</th><td>			      <a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>);</td></tr>
<tr><th id="1924">1924</th><td>	} <b>else</b> {</td></tr>
<tr><th id="1925">1925</th><td>		<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_VAL" title='XFRMA_REPLAY_VAL' data-ref="XFRMA_REPLAY_VAL" data-ref-filename="XFRMA_REPLAY_VAL">XFRMA_REPLAY_VAL</a>, <b>sizeof</b>(<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay" title='xfrm_state::replay' data-ref="xfrm_state::replay" data-ref-filename="xfrm_state..replay">replay</a>),</td></tr>
<tr><th id="1926">1926</th><td>			      &amp;<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay" title='xfrm_state::replay' data-ref="xfrm_state::replay" data-ref-filename="xfrm_state..replay">replay</a>);</td></tr>
<tr><th id="1927">1927</th><td>	}</td></tr>
<tr><th id="1928">1928</th><td>	<b>if</b> (<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a>)</td></tr>
<tr><th id="1929">1929</th><td>		<b>goto</b> <a class="lbl" href="#366out_cancel" data-ref="366out_cancel" data-ref-filename="366out_cancel">out_cancel</a>;</td></tr>
<tr><th id="1930">1930</th><td>	<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_64bit" title='nla_put_64bit' data-ref="nla_put_64bit" data-ref-filename="nla_put_64bit">nla_put_64bit</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_LTIME_VAL" title='XFRMA_LTIME_VAL' data-ref="XFRMA_LTIME_VAL" data-ref-filename="XFRMA_LTIME_VAL">XFRMA_LTIME_VAL</a>, <b>sizeof</b>(<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::curlft" title='xfrm_state::curlft' data-ref="xfrm_state::curlft" data-ref-filename="xfrm_state..curlft">curlft</a>), &amp;<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::curlft" title='xfrm_state::curlft' data-ref="xfrm_state::curlft" data-ref-filename="xfrm_state..curlft">curlft</a>,</td></tr>
<tr><th id="1931">1931</th><td>			    <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_PAD" title='XFRMA_PAD' data-ref="XFRMA_PAD" data-ref-filename="XFRMA_PAD">XFRMA_PAD</a>);</td></tr>
<tr><th id="1932">1932</th><td>	<b>if</b> (<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a>)</td></tr>
<tr><th id="1933">1933</th><td>		<b>goto</b> <a class="lbl" href="#366out_cancel" data-ref="366out_cancel" data-ref-filename="366out_cancel">out_cancel</a>;</td></tr>
<tr><th id="1934">1934</th><td></td></tr>
<tr><th id="1935">1935</th><td>	<b>if</b> (<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::flags" title='xfrm_aevent_id::flags' data-ref="xfrm_aevent_id::flags" data-ref-filename="xfrm_aevent_id..flags">flags</a> &amp; <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_AE_RTHR" title='XFRM_AE_RTHR' data-ref="XFRM_AE_RTHR" data-ref-filename="XFRM_AE_RTHR">XFRM_AE_RTHR</a>) {</td></tr>
<tr><th id="1936">1936</th><td>		<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_u32" title='nla_put_u32' data-ref="nla_put_u32" data-ref-filename="nla_put_u32">nla_put_u32</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_THRESH" title='XFRMA_REPLAY_THRESH' data-ref="XFRMA_REPLAY_THRESH" data-ref-filename="XFRMA_REPLAY_THRESH">XFRMA_REPLAY_THRESH</a>, <a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_maxdiff" title='xfrm_state::replay_maxdiff' data-ref="xfrm_state::replay_maxdiff" data-ref-filename="xfrm_state..replay_maxdiff">replay_maxdiff</a>);</td></tr>
<tr><th id="1937">1937</th><td>		<b>if</b> (<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a>)</td></tr>
<tr><th id="1938">1938</th><td>			<b>goto</b> <a class="lbl" href="#366out_cancel" data-ref="366out_cancel" data-ref-filename="366out_cancel">out_cancel</a>;</td></tr>
<tr><th id="1939">1939</th><td>	}</td></tr>
<tr><th id="1940">1940</th><td>	<b>if</b> (<a class="local col3 ref" href="#363id" title='id' data-ref="363id" data-ref-filename="363id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::flags" title='xfrm_aevent_id::flags' data-ref="xfrm_aevent_id::flags" data-ref-filename="xfrm_aevent_id..flags">flags</a> &amp; <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_AE_ETHR" title='XFRM_AE_ETHR' data-ref="XFRM_AE_ETHR" data-ref-filename="XFRM_AE_ETHR">XFRM_AE_ETHR</a>) {</td></tr>
<tr><th id="1941">1941</th><td>		<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put_u32" title='nla_put_u32' data-ref="nla_put_u32" data-ref-filename="nla_put_u32">nla_put_u32</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ETIMER_THRESH" title='XFRMA_ETIMER_THRESH' data-ref="XFRMA_ETIMER_THRESH" data-ref-filename="XFRMA_ETIMER_THRESH">XFRMA_ETIMER_THRESH</a>,</td></tr>
<tr><th id="1942">1942</th><td>				  <a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_maxage" title='xfrm_state::replay_maxage' data-ref="xfrm_state::replay_maxage" data-ref-filename="xfrm_state..replay_maxage">replay_maxage</a> * <var>10</var> / <a class="macro" href="../../include/asm-generic/param.h.html#8" title="1000" data-ref="_M/HZ">HZ</a>);</td></tr>
<tr><th id="1943">1943</th><td>		<b>if</b> (<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a>)</td></tr>
<tr><th id="1944">1944</th><td>			<b>goto</b> <a class="lbl" href="#366out_cancel" data-ref="366out_cancel" data-ref-filename="366out_cancel">out_cancel</a>;</td></tr>
<tr><th id="1945">1945</th><td>	}</td></tr>
<tr><th id="1946">1946</th><td>	<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_put" title='xfrm_mark_put' data-ref="xfrm_mark_put" data-ref-filename="xfrm_mark_put">xfrm_mark_put</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, &amp;<a class="local col1 ref" href="#361x" title='x' data-ref="361x" data-ref-filename="361x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::mark" title='xfrm_state::mark' data-ref="xfrm_state::mark" data-ref-filename="xfrm_state..mark">mark</a>);</td></tr>
<tr><th id="1947">1947</th><td>	<b>if</b> (<a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a>)</td></tr>
<tr><th id="1948">1948</th><td>		<b>goto</b> <a class="lbl" href="#366out_cancel" data-ref="366out_cancel" data-ref-filename="366out_cancel">out_cancel</a>;</td></tr>
<tr><th id="1949">1949</th><td></td></tr>
<tr><th id="1950">1950</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="local col4 ref" href="#364nlh" title='nlh' data-ref="364nlh" data-ref-filename="364nlh">nlh</a>);</td></tr>
<tr><th id="1951">1951</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="1952">1952</th><td></td></tr>
<tr><th id="1953">1953</th><td><dfn class="lbl" id="366out_cancel" data-ref="366out_cancel" data-ref-filename="366out_cancel">out_cancel</dfn>:</td></tr>
<tr><th id="1954">1954</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col0 ref" href="#360skb" title='skb' data-ref="360skb" data-ref-filename="360skb">skb</a>, <a class="local col4 ref" href="#364nlh" title='nlh' data-ref="364nlh" data-ref-filename="364nlh">nlh</a>);</td></tr>
<tr><th id="1955">1955</th><td>	<b>return</b> <a class="local col5 ref" href="#365err" title='err' data-ref="365err" data-ref-filename="365err">err</a>;</td></tr>
<tr><th id="1956">1956</th><td>}</td></tr>
<tr><th id="1957">1957</th><td></td></tr>
<tr><th id="1958">1958</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_get_ae" title='xfrm_get_ae' data-type='int xfrm_get_ae(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_get_ae" data-ref-filename="xfrm_get_ae">xfrm_get_ae</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="367skb" title='skb' data-type='struct sk_buff *' data-ref="367skb" data-ref-filename="367skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col8 decl" id="368nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="368nlh" data-ref-filename="368nlh">nlh</dfn>,</td></tr>
<tr><th id="1959">1959</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col9 decl" id="369attrs" title='attrs' data-type='struct nlattr **' data-ref="369attrs" data-ref-filename="369attrs">attrs</dfn>)</td></tr>
<tr><th id="1960">1960</th><td>{</td></tr>
<tr><th id="1961">1961</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col0 decl" id="370net" title='net' data-type='struct net *' data-ref="370net" data-ref-filename="370net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col7 ref" href="#367skb" title='skb' data-ref="367skb" data-ref-filename="367skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="1962">1962</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="371x" title='x' data-type='struct xfrm_state *' data-ref="371x" data-ref-filename="371x">x</dfn>;</td></tr>
<tr><th id="1963">1963</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="372r_skb" title='r_skb' data-type='struct sk_buff *' data-ref="372r_skb" data-ref-filename="372r_skb">r_skb</dfn>;</td></tr>
<tr><th id="1964">1964</th><td>	<em>int</em> <dfn class="local col3 decl" id="373err" title='err' data-type='int' data-ref="373err" data-ref-filename="373err">err</dfn>;</td></tr>
<tr><th id="1965">1965</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col4 decl" id="374c" title='c' data-type='struct km_event' data-ref="374c" data-ref-filename="374c">c</dfn>;</td></tr>
<tr><th id="1966">1966</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col5 decl" id="375mark" title='mark' data-type='u32' data-ref="375mark" data-ref-filename="375mark">mark</dfn>;</td></tr>
<tr><th id="1967">1967</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col6 decl" id="376m" title='m' data-type='struct xfrm_mark' data-ref="376m" data-ref-filename="376m">m</dfn>;</td></tr>
<tr><th id="1968">1968</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id" title='xfrm_aevent_id' data-ref="xfrm_aevent_id" data-ref-filename="xfrm_aevent_id">xfrm_aevent_id</a> *<dfn class="local col7 decl" id="377p" title='p' data-type='struct xfrm_aevent_id *' data-ref="377p" data-ref-filename="377p">p</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col8 ref" href="#368nlh" title='nlh' data-ref="368nlh" data-ref-filename="368nlh">nlh</a>);</td></tr>
<tr><th id="1969">1969</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id" title='xfrm_usersa_id' data-ref="xfrm_usersa_id" data-ref-filename="xfrm_usersa_id">xfrm_usersa_id</a> *<dfn class="local col8 decl" id="378id" title='id' data-type='struct xfrm_usersa_id *' data-ref="378id" data-ref-filename="378id">id</dfn> = &amp;<a class="local col7 ref" href="#377p" title='p' data-ref="377p" data-ref-filename="377p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>;</td></tr>
<tr><th id="1970">1970</th><td></td></tr>
<tr><th id="1971">1971</th><td>	<a class="local col5 ref" href="#375mark" title='mark' data-ref="375mark" data-ref-filename="375mark">mark</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col9 ref" href="#369attrs" title='attrs' data-ref="369attrs" data-ref-filename="369attrs">attrs</a>, &amp;<a class="local col6 ref" href="#376m" title='m' data-ref="376m" data-ref-filename="376m">m</a>);</td></tr>
<tr><th id="1972">1972</th><td></td></tr>
<tr><th id="1973">1973</th><td>	<a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_lookup" title='xfrm_state_lookup' data-ref="xfrm_state_lookup" data-ref-filename="xfrm_state_lookup">xfrm_state_lookup</a>(<a class="local col0 ref" href="#370net" title='net' data-ref="370net" data-ref-filename="370net">net</a>, <a class="local col5 ref" href="#375mark" title='mark' data-ref="375mark" data-ref-filename="375mark">mark</a>, &amp;<a class="local col8 ref" href="#378id" title='id' data-ref="378id" data-ref-filename="378id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>, <a class="local col8 ref" href="#378id" title='id' data-ref="378id" data-ref-filename="378id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::spi" title='xfrm_usersa_id::spi' data-ref="xfrm_usersa_id::spi" data-ref-filename="xfrm_usersa_id..spi">spi</a>, <a class="local col8 ref" href="#378id" title='id' data-ref="378id" data-ref-filename="378id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a>, <a class="local col8 ref" href="#378id" title='id' data-ref="378id" data-ref-filename="378id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::family" title='xfrm_usersa_id::family' data-ref="xfrm_usersa_id::family" data-ref-filename="xfrm_usersa_id..family">family</a>);</td></tr>
<tr><th id="1974">1974</th><td>	<b>if</b> (<a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="1975">1975</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>;</td></tr>
<tr><th id="1976">1976</th><td></td></tr>
<tr><th id="1977">1977</th><td>	<a class="local col2 ref" href="#372r_skb" title='r_skb' data-ref="372r_skb" data-ref-filename="372r_skb">r_skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_aevent_msgsize" title='xfrm_aevent_msgsize' data-use='c' data-ref="xfrm_aevent_msgsize" data-ref-filename="xfrm_aevent_msgsize">xfrm_aevent_msgsize</a>(<a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a>), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="1978">1978</th><td>	<b>if</b> (<a class="local col2 ref" href="#372r_skb" title='r_skb' data-ref="372r_skb" data-ref-filename="372r_skb">r_skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) {</td></tr>
<tr><th id="1979">1979</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a>);</td></tr>
<tr><th id="1980">1980</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="1981">1981</th><td>	}</td></tr>
<tr><th id="1982">1982</th><td></td></tr>
<tr><th id="1983">1983</th><td>	<i>/*</i></td></tr>
<tr><th id="1984">1984</th><td><i>	 * XXX: is this lock really needed - none of the other</i></td></tr>
<tr><th id="1985">1985</th><td><i>	 * gets lock (the concern is things getting updated</i></td></tr>
<tr><th id="1986">1986</th><td><i>	 * while we are still reading) - jhs</i></td></tr>
<tr><th id="1987">1987</th><td><i>	*/</i></td></tr>
<tr><th id="1988">1988</th><td>	<a class="ref fn" href="../../include/linux/spinlock.h.html#spin_lock_bh" title='spin_lock_bh' data-ref="spin_lock_bh" data-ref-filename="spin_lock_bh">spin_lock_bh</a>(&amp;<a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lock" title='xfrm_state::lock' data-ref="xfrm_state::lock" data-ref-filename="xfrm_state..lock">lock</a>);</td></tr>
<tr><th id="1989">1989</th><td>	<a class="local col4 ref" href="#374c" title='c' data-ref="374c" data-ref-filename="374c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::aevent" title='km_event::(anonymous union)::aevent' data-ref="km_event::(anonymous)::aevent" data-ref-filename="km_event..(anonymous)..aevent">aevent</a> = <a class="local col7 ref" href="#377p" title='p' data-ref="377p" data-ref-filename="377p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::flags" title='xfrm_aevent_id::flags' data-ref="xfrm_aevent_id::flags" data-ref-filename="xfrm_aevent_id..flags">flags</a>;</td></tr>
<tr><th id="1990">1990</th><td>	<a class="local col4 ref" href="#374c" title='c' data-ref="374c" data-ref-filename="374c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col8 ref" href="#368nlh" title='nlh' data-ref="368nlh" data-ref-filename="368nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="1991">1991</th><td>	<a class="local col4 ref" href="#374c" title='c' data-ref="374c" data-ref-filename="374c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col8 ref" href="#368nlh" title='nlh' data-ref="368nlh" data-ref-filename="368nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="1992">1992</th><td></td></tr>
<tr><th id="1993">1993</th><td>	<a class="local col3 ref" href="#373err" title='err' data-ref="373err" data-ref-filename="373err">err</a> = <a class="tu ref fn" href="#build_aevent" title='build_aevent' data-use='c' data-ref="build_aevent" data-ref-filename="build_aevent">build_aevent</a>(<a class="local col2 ref" href="#372r_skb" title='r_skb' data-ref="372r_skb" data-ref-filename="372r_skb">r_skb</a>, <a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a>, &amp;<a class="local col4 ref" href="#374c" title='c' data-ref="374c" data-ref-filename="374c">c</a>);</td></tr>
<tr><th id="1994">1994</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (1994), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (138)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col3 ref" href="#373err" title='err' data-ref="373err" data-ref-filename="373err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="1995">1995</th><td></td></tr>
<tr><th id="1996">1996</th><td>	<a class="local col3 ref" href="#373err" title='err' data-ref="373err" data-ref-filename="373err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_unicast" title='nlmsg_unicast' data-ref="nlmsg_unicast" data-ref-filename="nlmsg_unicast">nlmsg_unicast</a>(<a class="local col0 ref" href="#370net" title='net' data-ref="370net" data-ref-filename="370net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col2 ref" href="#372r_skb" title='r_skb' data-ref="372r_skb" data-ref-filename="372r_skb">r_skb</a>, <a class="macro" href="../../include/linux/netlink.h.html#33" title="(*(struct netlink_skb_parms*)&amp;((skb)-&gt;cb))" data-ref="_M/NETLINK_CB">NETLINK_CB</a>(<a class="local col7 ref" href="#367skb" title='skb' data-ref="367skb" data-ref-filename="367skb">skb</a>).<a class="ref field" href="../../include/linux/netlink.h.html#netlink_skb_parms::portid" title='netlink_skb_parms::portid' data-ref="netlink_skb_parms::portid" data-ref-filename="netlink_skb_parms..portid">portid</a>);</td></tr>
<tr><th id="1997">1997</th><td>	<a class="ref fn" href="../../include/linux/spinlock.h.html#spin_unlock_bh" title='spin_unlock_bh' data-ref="spin_unlock_bh" data-ref-filename="spin_unlock_bh">spin_unlock_bh</a>(&amp;<a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lock" title='xfrm_state::lock' data-ref="xfrm_state::lock" data-ref-filename="xfrm_state..lock">lock</a>);</td></tr>
<tr><th id="1998">1998</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col1 ref" href="#371x" title='x' data-ref="371x" data-ref-filename="371x">x</a>);</td></tr>
<tr><th id="1999">1999</th><td>	<b>return</b> <a class="local col3 ref" href="#373err" title='err' data-ref="373err" data-ref-filename="373err">err</a>;</td></tr>
<tr><th id="2000">2000</th><td>}</td></tr>
<tr><th id="2001">2001</th><td></td></tr>
<tr><th id="2002">2002</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_new_ae" title='xfrm_new_ae' data-type='int xfrm_new_ae(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_new_ae" data-ref-filename="xfrm_new_ae">xfrm_new_ae</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col9 decl" id="379skb" title='skb' data-type='struct sk_buff *' data-ref="379skb" data-ref-filename="379skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col0 decl" id="380nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="380nlh" data-ref-filename="380nlh">nlh</dfn>,</td></tr>
<tr><th id="2003">2003</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col1 decl" id="381attrs" title='attrs' data-type='struct nlattr **' data-ref="381attrs" data-ref-filename="381attrs">attrs</dfn>)</td></tr>
<tr><th id="2004">2004</th><td>{</td></tr>
<tr><th id="2005">2005</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col2 decl" id="382net" title='net' data-type='struct net *' data-ref="382net" data-ref-filename="382net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col9 ref" href="#379skb" title='skb' data-ref="379skb" data-ref-filename="379skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="2006">2006</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col3 decl" id="383x" title='x' data-type='struct xfrm_state *' data-ref="383x" data-ref-filename="383x">x</dfn>;</td></tr>
<tr><th id="2007">2007</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col4 decl" id="384c" title='c' data-type='struct km_event' data-ref="384c" data-ref-filename="384c">c</dfn>;</td></tr>
<tr><th id="2008">2008</th><td>	<em>int</em> <dfn class="local col5 decl" id="385err" title='err' data-type='int' data-ref="385err" data-ref-filename="385err">err</dfn> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="2009">2009</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col6 decl" id="386mark" title='mark' data-type='u32' data-ref="386mark" data-ref-filename="386mark">mark</dfn> = <var>0</var>;</td></tr>
<tr><th id="2010">2010</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col7 decl" id="387m" title='m' data-type='struct xfrm_mark' data-ref="387m" data-ref-filename="387m">m</dfn>;</td></tr>
<tr><th id="2011">2011</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id" title='xfrm_aevent_id' data-ref="xfrm_aevent_id" data-ref-filename="xfrm_aevent_id">xfrm_aevent_id</a> *<dfn class="local col8 decl" id="388p" title='p' data-type='struct xfrm_aevent_id *' data-ref="388p" data-ref-filename="388p">p</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col0 ref" href="#380nlh" title='nlh' data-ref="380nlh" data-ref-filename="380nlh">nlh</a>);</td></tr>
<tr><th id="2012">2012</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col9 decl" id="389rp" title='rp' data-type='struct nlattr *' data-ref="389rp" data-ref-filename="389rp">rp</dfn> = <a class="local col1 ref" href="#381attrs" title='attrs' data-ref="381attrs" data-ref-filename="381attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_VAL" title='XFRMA_REPLAY_VAL' data-ref="XFRMA_REPLAY_VAL" data-ref-filename="XFRMA_REPLAY_VAL">XFRMA_REPLAY_VAL</a>];</td></tr>
<tr><th id="2013">2013</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col0 decl" id="390re" title='re' data-type='struct nlattr *' data-ref="390re" data-ref-filename="390re">re</dfn> = <a class="local col1 ref" href="#381attrs" title='attrs' data-ref="381attrs" data-ref-filename="381attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_ESN_VAL" title='XFRMA_REPLAY_ESN_VAL' data-ref="XFRMA_REPLAY_ESN_VAL" data-ref-filename="XFRMA_REPLAY_ESN_VAL">XFRMA_REPLAY_ESN_VAL</a>];</td></tr>
<tr><th id="2014">2014</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col1 decl" id="391lt" title='lt' data-type='struct nlattr *' data-ref="391lt" data-ref-filename="391lt">lt</dfn> = <a class="local col1 ref" href="#381attrs" title='attrs' data-ref="381attrs" data-ref-filename="381attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_LTIME_VAL" title='XFRMA_LTIME_VAL' data-ref="XFRMA_LTIME_VAL" data-ref-filename="XFRMA_LTIME_VAL">XFRMA_LTIME_VAL</a>];</td></tr>
<tr><th id="2015">2015</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col2 decl" id="392et" title='et' data-type='struct nlattr *' data-ref="392et" data-ref-filename="392et">et</dfn> = <a class="local col1 ref" href="#381attrs" title='attrs' data-ref="381attrs" data-ref-filename="381attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ETIMER_THRESH" title='XFRMA_ETIMER_THRESH' data-ref="XFRMA_ETIMER_THRESH" data-ref-filename="XFRMA_ETIMER_THRESH">XFRMA_ETIMER_THRESH</a>];</td></tr>
<tr><th id="2016">2016</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col3 decl" id="393rt" title='rt' data-type='struct nlattr *' data-ref="393rt" data-ref-filename="393rt">rt</dfn> = <a class="local col1 ref" href="#381attrs" title='attrs' data-ref="381attrs" data-ref-filename="381attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_THRESH" title='XFRMA_REPLAY_THRESH' data-ref="XFRMA_REPLAY_THRESH" data-ref-filename="XFRMA_REPLAY_THRESH">XFRMA_REPLAY_THRESH</a>];</td></tr>
<tr><th id="2017">2017</th><td></td></tr>
<tr><th id="2018">2018</th><td>	<b>if</b> (!<a class="local col1 ref" href="#391lt" title='lt' data-ref="391lt" data-ref-filename="391lt">lt</a> &amp;&amp; !<a class="local col9 ref" href="#389rp" title='rp' data-ref="389rp" data-ref-filename="389rp">rp</a> &amp;&amp; !<a class="local col0 ref" href="#390re" title='re' data-ref="390re" data-ref-filename="390re">re</a> &amp;&amp; !<a class="local col2 ref" href="#392et" title='et' data-ref="392et" data-ref-filename="392et">et</a> &amp;&amp; !<a class="local col3 ref" href="#393rt" title='rt' data-ref="393rt" data-ref-filename="393rt">rt</a>)</td></tr>
<tr><th id="2019">2019</th><td>		<b>return</b> <a class="local col5 ref" href="#385err" title='err' data-ref="385err" data-ref-filename="385err">err</a>;</td></tr>
<tr><th id="2020">2020</th><td></td></tr>
<tr><th id="2021">2021</th><td>	<i>/* pedantic mode - thou shalt sayeth replaceth */</i></td></tr>
<tr><th id="2022">2022</th><td>	<b>if</b> (!(<a class="local col0 ref" href="#380nlh" title='nlh' data-ref="380nlh" data-ref-filename="380nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_flags" title='nlmsghdr::nlmsg_flags' data-ref="nlmsghdr::nlmsg_flags" data-ref-filename="nlmsghdr..nlmsg_flags">nlmsg_flags</a>&amp;<a class="macro" href="../../include/uapi/linux/netlink.h.html#68" title="0x100" data-ref="_M/NLM_F_REPLACE">NLM_F_REPLACE</a>))</td></tr>
<tr><th id="2023">2023</th><td>		<b>return</b> <a class="local col5 ref" href="#385err" title='err' data-ref="385err" data-ref-filename="385err">err</a>;</td></tr>
<tr><th id="2024">2024</th><td></td></tr>
<tr><th id="2025">2025</th><td>	<a class="local col6 ref" href="#386mark" title='mark' data-ref="386mark" data-ref-filename="386mark">mark</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col1 ref" href="#381attrs" title='attrs' data-ref="381attrs" data-ref-filename="381attrs">attrs</a>, &amp;<a class="local col7 ref" href="#387m" title='m' data-ref="387m" data-ref-filename="387m">m</a>);</td></tr>
<tr><th id="2026">2026</th><td></td></tr>
<tr><th id="2027">2027</th><td>	<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_lookup" title='xfrm_state_lookup' data-ref="xfrm_state_lookup" data-ref-filename="xfrm_state_lookup">xfrm_state_lookup</a>(<a class="local col2 ref" href="#382net" title='net' data-ref="382net" data-ref-filename="382net">net</a>, <a class="local col6 ref" href="#386mark" title='mark' data-ref="386mark" data-ref-filename="386mark">mark</a>, &amp;<a class="local col8 ref" href="#388p" title='p' data-ref="388p" data-ref-filename="388p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>, <a class="local col8 ref" href="#388p" title='p' data-ref="388p" data-ref-filename="388p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::spi" title='xfrm_usersa_id::spi' data-ref="xfrm_usersa_id::spi" data-ref-filename="xfrm_usersa_id..spi">spi</a>, <a class="local col8 ref" href="#388p" title='p' data-ref="388p" data-ref-filename="388p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a>, <a class="local col8 ref" href="#388p" title='p' data-ref="388p" data-ref-filename="388p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id::sa_id" title='xfrm_aevent_id::sa_id' data-ref="xfrm_aevent_id::sa_id" data-ref-filename="xfrm_aevent_id..sa_id">sa_id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::family" title='xfrm_usersa_id::family' data-ref="xfrm_usersa_id::family" data-ref-filename="xfrm_usersa_id..family">family</a>);</td></tr>
<tr><th id="2028">2028</th><td>	<b>if</b> (<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2029">2029</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>;</td></tr>
<tr><th id="2030">2030</th><td></td></tr>
<tr><th id="2031">2031</th><td>	<b>if</b> (<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::state" title='xfrm_state_walk::state' data-ref="xfrm_state_walk::state" data-ref-filename="xfrm_state_walk..state">state</a> != <a class="enum" href="../../include/net/xfrm.h.html#XFRM_STATE_VALID" title='XFRM_STATE_VALID' data-ref="XFRM_STATE_VALID" data-ref-filename="XFRM_STATE_VALID">XFRM_STATE_VALID</a>)</td></tr>
<tr><th id="2032">2032</th><td>		<b>goto</b> <a class="lbl" href="#394out" data-ref="394out" data-ref-filename="394out">out</a>;</td></tr>
<tr><th id="2033">2033</th><td></td></tr>
<tr><th id="2034">2034</th><td>	<a class="local col5 ref" href="#385err" title='err' data-ref="385err" data-ref-filename="385err">err</a> = <a class="tu ref fn" href="#xfrm_replay_verify_len" title='xfrm_replay_verify_len' data-use='c' data-ref="xfrm_replay_verify_len" data-ref-filename="xfrm_replay_verify_len">xfrm_replay_verify_len</a>(<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>, <a class="local col0 ref" href="#390re" title='re' data-ref="390re" data-ref-filename="390re">re</a>);</td></tr>
<tr><th id="2035">2035</th><td>	<b>if</b> (<a class="local col5 ref" href="#385err" title='err' data-ref="385err" data-ref-filename="385err">err</a>)</td></tr>
<tr><th id="2036">2036</th><td>		<b>goto</b> <a class="lbl" href="#394out" data-ref="394out" data-ref-filename="394out">out</a>;</td></tr>
<tr><th id="2037">2037</th><td></td></tr>
<tr><th id="2038">2038</th><td>	<a class="ref fn" href="../../include/linux/spinlock.h.html#spin_lock_bh" title='spin_lock_bh' data-ref="spin_lock_bh" data-ref-filename="spin_lock_bh">spin_lock_bh</a>(&amp;<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lock" title='xfrm_state::lock' data-ref="xfrm_state::lock" data-ref-filename="xfrm_state..lock">lock</a>);</td></tr>
<tr><th id="2039">2039</th><td>	<a class="tu ref fn" href="#xfrm_update_ae_params" title='xfrm_update_ae_params' data-use='c' data-ref="xfrm_update_ae_params" data-ref-filename="xfrm_update_ae_params">xfrm_update_ae_params</a>(<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a>, <a class="local col1 ref" href="#381attrs" title='attrs' data-ref="381attrs" data-ref-filename="381attrs">attrs</a>, <var>1</var>);</td></tr>
<tr><th id="2040">2040</th><td>	<a class="ref fn" href="../../include/linux/spinlock.h.html#spin_unlock_bh" title='spin_unlock_bh' data-ref="spin_unlock_bh" data-ref-filename="spin_unlock_bh">spin_unlock_bh</a>(&amp;<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lock" title='xfrm_state::lock' data-ref="xfrm_state::lock" data-ref-filename="xfrm_state..lock">lock</a>);</td></tr>
<tr><th id="2041">2041</th><td></td></tr>
<tr><th id="2042">2042</th><td>	<a class="local col4 ref" href="#384c" title='c' data-ref="384c" data-ref-filename="384c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> = <a class="local col0 ref" href="#380nlh" title='nlh' data-ref="380nlh" data-ref-filename="380nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="2043">2043</th><td>	<a class="local col4 ref" href="#384c" title='c' data-ref="384c" data-ref-filename="384c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col0 ref" href="#380nlh" title='nlh' data-ref="380nlh" data-ref-filename="380nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="2044">2044</th><td>	<a class="local col4 ref" href="#384c" title='c' data-ref="384c" data-ref-filename="384c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col0 ref" href="#380nlh" title='nlh' data-ref="380nlh" data-ref-filename="380nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="2045">2045</th><td>	<a class="local col4 ref" href="#384c" title='c' data-ref="384c" data-ref-filename="384c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::aevent" title='km_event::(anonymous union)::aevent' data-ref="km_event::(anonymous)::aevent" data-ref-filename="km_event..(anonymous)..aevent">aevent</a> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_AE_CU" title='XFRM_AE_CU' data-ref="XFRM_AE_CU" data-ref-filename="XFRM_AE_CU">XFRM_AE_CU</a>;</td></tr>
<tr><th id="2046">2046</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_state_notify" title='km_state_notify' data-ref="km_state_notify" data-ref-filename="km_state_notify">km_state_notify</a>(<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a>, &amp;<a class="local col4 ref" href="#384c" title='c' data-ref="384c" data-ref-filename="384c">c</a>);</td></tr>
<tr><th id="2047">2047</th><td>	<a class="local col5 ref" href="#385err" title='err' data-ref="385err" data-ref-filename="385err">err</a> = <var>0</var>;</td></tr>
<tr><th id="2048">2048</th><td><dfn class="lbl" id="394out" data-ref="394out" data-ref-filename="394out">out</dfn>:</td></tr>
<tr><th id="2049">2049</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col3 ref" href="#383x" title='x' data-ref="383x" data-ref-filename="383x">x</a>);</td></tr>
<tr><th id="2050">2050</th><td>	<b>return</b> <a class="local col5 ref" href="#385err" title='err' data-ref="385err" data-ref-filename="385err">err</a>;</td></tr>
<tr><th id="2051">2051</th><td>}</td></tr>
<tr><th id="2052">2052</th><td></td></tr>
<tr><th id="2053">2053</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_flush_policy" title='xfrm_flush_policy' data-type='int xfrm_flush_policy(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_flush_policy" data-ref-filename="xfrm_flush_policy">xfrm_flush_policy</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col5 decl" id="395skb" title='skb' data-type='struct sk_buff *' data-ref="395skb" data-ref-filename="395skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col6 decl" id="396nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="396nlh" data-ref-filename="396nlh">nlh</dfn>,</td></tr>
<tr><th id="2054">2054</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col7 decl" id="397attrs" title='attrs' data-type='struct nlattr **' data-ref="397attrs" data-ref-filename="397attrs">attrs</dfn>)</td></tr>
<tr><th id="2055">2055</th><td>{</td></tr>
<tr><th id="2056">2056</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col8 decl" id="398net" title='net' data-type='struct net *' data-ref="398net" data-ref-filename="398net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col5 ref" href="#395skb" title='skb' data-ref="395skb" data-ref-filename="395skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="2057">2057</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> <dfn class="local col9 decl" id="399c" title='c' data-type='struct km_event' data-ref="399c" data-ref-filename="399c">c</dfn>;</td></tr>
<tr><th id="2058">2058</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col0 decl" id="400type" title='type' data-type='u8' data-ref="400type" data-ref-filename="400type">type</dfn> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_TYPE_MAIN" title='XFRM_POLICY_TYPE_MAIN' data-ref="XFRM_POLICY_TYPE_MAIN" data-ref-filename="XFRM_POLICY_TYPE_MAIN">XFRM_POLICY_TYPE_MAIN</a>;</td></tr>
<tr><th id="2059">2059</th><td>	<em>int</em> <dfn class="local col1 decl" id="401err" title='err' data-type='int' data-ref="401err" data-ref-filename="401err">err</dfn>;</td></tr>
<tr><th id="2060">2060</th><td></td></tr>
<tr><th id="2061">2061</th><td>	<a class="local col1 ref" href="#401err" title='err' data-ref="401err" data-ref-filename="401err">err</a> = <a class="tu ref fn" href="#copy_from_user_policy_type" title='copy_from_user_policy_type' data-use='c' data-ref="copy_from_user_policy_type" data-ref-filename="copy_from_user_policy_type">copy_from_user_policy_type</a>(&amp;<a class="local col0 ref" href="#400type" title='type' data-ref="400type" data-ref-filename="400type">type</a>, <a class="local col7 ref" href="#397attrs" title='attrs' data-ref="397attrs" data-ref-filename="397attrs">attrs</a>);</td></tr>
<tr><th id="2062">2062</th><td>	<b>if</b> (<a class="local col1 ref" href="#401err" title='err' data-ref="401err" data-ref-filename="401err">err</a>)</td></tr>
<tr><th id="2063">2063</th><td>		<b>return</b> <a class="local col1 ref" href="#401err" title='err' data-ref="401err" data-ref-filename="401err">err</a>;</td></tr>
<tr><th id="2064">2064</th><td></td></tr>
<tr><th id="2065">2065</th><td>	<a class="local col1 ref" href="#401err" title='err' data-ref="401err" data-ref-filename="401err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_flush" title='xfrm_policy_flush' data-ref="xfrm_policy_flush" data-ref-filename="xfrm_policy_flush">xfrm_policy_flush</a>(<a class="local col8 ref" href="#398net" title='net' data-ref="398net" data-ref-filename="398net">net</a>, <a class="local col0 ref" href="#400type" title='type' data-ref="400type" data-ref-filename="400type">type</a>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="2066">2066</th><td>	<b>if</b> (<a class="local col1 ref" href="#401err" title='err' data-ref="401err" data-ref-filename="401err">err</a>) {</td></tr>
<tr><th id="2067">2067</th><td>		<b>if</b> (<a class="local col1 ref" href="#401err" title='err' data-ref="401err" data-ref-filename="401err">err</a> == -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#7" title="3" data-ref="_M/ESRCH">ESRCH</a>) <i>/* empty table */</i></td></tr>
<tr><th id="2068">2068</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2069">2069</th><td>		<b>return</b> <a class="local col1 ref" href="#401err" title='err' data-ref="401err" data-ref-filename="401err">err</a>;</td></tr>
<tr><th id="2070">2070</th><td>	}</td></tr>
<tr><th id="2071">2071</th><td></td></tr>
<tr><th id="2072">2072</th><td>	<a class="local col9 ref" href="#399c" title='c' data-ref="399c" data-ref-filename="399c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::type" title='km_event::(anonymous union)::type' data-ref="km_event::(anonymous)::type" data-ref-filename="km_event..(anonymous)..type">type</a> = <a class="local col0 ref" href="#400type" title='type' data-ref="400type" data-ref-filename="400type">type</a>;</td></tr>
<tr><th id="2073">2073</th><td>	<a class="local col9 ref" href="#399c" title='c' data-ref="399c" data-ref-filename="399c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> = <a class="local col6 ref" href="#396nlh" title='nlh' data-ref="396nlh" data-ref-filename="396nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="2074">2074</th><td>	<a class="local col9 ref" href="#399c" title='c' data-ref="399c" data-ref-filename="399c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a> = <a class="local col6 ref" href="#396nlh" title='nlh' data-ref="396nlh" data-ref-filename="396nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_seq" title='nlmsghdr::nlmsg_seq' data-ref="nlmsghdr::nlmsg_seq" data-ref-filename="nlmsghdr..nlmsg_seq">nlmsg_seq</a>;</td></tr>
<tr><th id="2075">2075</th><td>	<a class="local col9 ref" href="#399c" title='c' data-ref="399c" data-ref-filename="399c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a> = <a class="local col6 ref" href="#396nlh" title='nlh' data-ref="396nlh" data-ref-filename="396nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>;</td></tr>
<tr><th id="2076">2076</th><td>	<a class="local col9 ref" href="#399c" title='c' data-ref="399c" data-ref-filename="399c">c</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::net" title='km_event::net' data-ref="km_event::net" data-ref-filename="km_event..net">net</a> = <a class="local col8 ref" href="#398net" title='net' data-ref="398net" data-ref-filename="398net">net</a>;</td></tr>
<tr><th id="2077">2077</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_policy_notify" title='km_policy_notify' data-ref="km_policy_notify" data-ref-filename="km_policy_notify">km_policy_notify</a>(<a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>, <var>0</var>, &amp;<a class="local col9 ref" href="#399c" title='c' data-ref="399c" data-ref-filename="399c">c</a>);</td></tr>
<tr><th id="2078">2078</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2079">2079</th><td>}</td></tr>
<tr><th id="2080">2080</th><td></td></tr>
<tr><th id="2081">2081</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_add_pol_expire" title='xfrm_add_pol_expire' data-type='int xfrm_add_pol_expire(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_add_pol_expire" data-ref-filename="xfrm_add_pol_expire">xfrm_add_pol_expire</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="402skb" title='skb' data-type='struct sk_buff *' data-ref="402skb" data-ref-filename="402skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col3 decl" id="403nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="403nlh" data-ref-filename="403nlh">nlh</dfn>,</td></tr>
<tr><th id="2082">2082</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col4 decl" id="404attrs" title='attrs' data-type='struct nlattr **' data-ref="404attrs" data-ref-filename="404attrs">attrs</dfn>)</td></tr>
<tr><th id="2083">2083</th><td>{</td></tr>
<tr><th id="2084">2084</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col5 decl" id="405net" title='net' data-type='struct net *' data-ref="405net" data-ref-filename="405net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col2 ref" href="#402skb" title='skb' data-ref="402skb" data-ref-filename="402skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="2085">2085</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col6 decl" id="406xp" title='xp' data-type='struct xfrm_policy *' data-ref="406xp" data-ref-filename="406xp">xp</dfn>;</td></tr>
<tr><th id="2086">2086</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire" title='xfrm_user_polexpire' data-ref="xfrm_user_polexpire" data-ref-filename="xfrm_user_polexpire">xfrm_user_polexpire</a> *<dfn class="local col7 decl" id="407up" title='up' data-type='struct xfrm_user_polexpire *' data-ref="407up" data-ref-filename="407up">up</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col3 ref" href="#403nlh" title='nlh' data-ref="403nlh" data-ref-filename="403nlh">nlh</a>);</td></tr>
<tr><th id="2087">2087</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col8 decl" id="408p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="408p" data-ref-filename="408p">p</dfn> = &amp;<a class="local col7 ref" href="#407up" title='up' data-ref="407up" data-ref-filename="407up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire::pol" title='xfrm_user_polexpire::pol' data-ref="xfrm_user_polexpire::pol" data-ref-filename="xfrm_user_polexpire..pol">pol</a>;</td></tr>
<tr><th id="2088">2088</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col9 decl" id="409type" title='type' data-type='u8' data-ref="409type" data-ref-filename="409type">type</dfn> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_TYPE_MAIN" title='XFRM_POLICY_TYPE_MAIN' data-ref="XFRM_POLICY_TYPE_MAIN" data-ref-filename="XFRM_POLICY_TYPE_MAIN">XFRM_POLICY_TYPE_MAIN</a>;</td></tr>
<tr><th id="2089">2089</th><td>	<em>int</em> <dfn class="local col0 decl" id="410err" title='err' data-type='int' data-ref="410err" data-ref-filename="410err">err</dfn> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#6" title="2" data-ref="_M/ENOENT">ENOENT</a>;</td></tr>
<tr><th id="2090">2090</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col1 decl" id="411m" title='m' data-type='struct xfrm_mark' data-ref="411m" data-ref-filename="411m">m</dfn>;</td></tr>
<tr><th id="2091">2091</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col2 decl" id="412mark" title='mark' data-type='u32' data-ref="412mark" data-ref-filename="412mark">mark</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col4 ref" href="#404attrs" title='attrs' data-ref="404attrs" data-ref-filename="404attrs">attrs</a>, &amp;<a class="local col1 ref" href="#411m" title='m' data-ref="411m" data-ref-filename="411m">m</a>);</td></tr>
<tr><th id="2092">2092</th><td></td></tr>
<tr><th id="2093">2093</th><td>	<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a> = <a class="tu ref fn" href="#copy_from_user_policy_type" title='copy_from_user_policy_type' data-use='c' data-ref="copy_from_user_policy_type" data-ref-filename="copy_from_user_policy_type">copy_from_user_policy_type</a>(&amp;<a class="local col9 ref" href="#409type" title='type' data-ref="409type" data-ref-filename="409type">type</a>, <a class="local col4 ref" href="#404attrs" title='attrs' data-ref="404attrs" data-ref-filename="404attrs">attrs</a>);</td></tr>
<tr><th id="2094">2094</th><td>	<b>if</b> (<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>)</td></tr>
<tr><th id="2095">2095</th><td>		<b>return</b> <a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>;</td></tr>
<tr><th id="2096">2096</th><td></td></tr>
<tr><th id="2097">2097</th><td>	<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a> = <a class="tu ref fn" href="#verify_policy_dir" title='verify_policy_dir' data-use='c' data-ref="verify_policy_dir" data-ref-filename="verify_policy_dir">verify_policy_dir</a>(<a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>);</td></tr>
<tr><th id="2098">2098</th><td>	<b>if</b> (<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>)</td></tr>
<tr><th id="2099">2099</th><td>		<b>return</b> <a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>;</td></tr>
<tr><th id="2100">2100</th><td></td></tr>
<tr><th id="2101">2101</th><td>	<b>if</b> (<a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::index" title='xfrm_userpolicy_info::index' data-ref="xfrm_userpolicy_info::index" data-ref-filename="xfrm_userpolicy_info..index">index</a>)</td></tr>
<tr><th id="2102">2102</th><td>		<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_byid" title='xfrm_policy_byid' data-ref="xfrm_policy_byid" data-ref-filename="xfrm_policy_byid">xfrm_policy_byid</a>(<a class="local col5 ref" href="#405net" title='net' data-ref="405net" data-ref-filename="405net">net</a>, <a class="local col2 ref" href="#412mark" title='mark' data-ref="412mark" data-ref-filename="412mark">mark</a>, <a class="local col9 ref" href="#409type" title='type' data-ref="409type" data-ref-filename="409type">type</a>, <a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>, <a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::index" title='xfrm_userpolicy_info::index' data-ref="xfrm_userpolicy_info::index" data-ref-filename="xfrm_userpolicy_info..index">index</a>, <var>0</var>, &amp;<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>);</td></tr>
<tr><th id="2103">2103</th><td>	<b>else</b> {</td></tr>
<tr><th id="2104">2104</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col3 decl" id="413rt" title='rt' data-type='struct nlattr *' data-ref="413rt" data-ref-filename="413rt">rt</dfn> = <a class="local col4 ref" href="#404attrs" title='attrs' data-ref="404attrs" data-ref-filename="404attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>];</td></tr>
<tr><th id="2105">2105</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx" title='xfrm_sec_ctx' data-ref="xfrm_sec_ctx" data-ref-filename="xfrm_sec_ctx">xfrm_sec_ctx</a> *<dfn class="local col4 decl" id="414ctx" title='ctx' data-type='struct xfrm_sec_ctx *' data-ref="414ctx" data-ref-filename="414ctx">ctx</dfn>;</td></tr>
<tr><th id="2106">2106</th><td></td></tr>
<tr><th id="2107">2107</th><td>		<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a> = <a class="tu ref fn" href="#verify_sec_ctx_len" title='verify_sec_ctx_len' data-use='c' data-ref="verify_sec_ctx_len" data-ref-filename="verify_sec_ctx_len">verify_sec_ctx_len</a>(<a class="local col4 ref" href="#404attrs" title='attrs' data-ref="404attrs" data-ref-filename="404attrs">attrs</a>);</td></tr>
<tr><th id="2108">2108</th><td>		<b>if</b> (<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>)</td></tr>
<tr><th id="2109">2109</th><td>			<b>return</b> <a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>;</td></tr>
<tr><th id="2110">2110</th><td></td></tr>
<tr><th id="2111">2111</th><td>		<a class="local col4 ref" href="#414ctx" title='ctx' data-ref="414ctx" data-ref-filename="414ctx">ctx</a> = <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2112">2112</th><td>		<b>if</b> (<a class="local col3 ref" href="#413rt" title='rt' data-ref="413rt" data-ref-filename="413rt">rt</a>) {</td></tr>
<tr><th id="2113">2113</th><td>			<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a> *<dfn class="local col5 decl" id="415uctx" title='uctx' data-type='struct xfrm_user_sec_ctx *' data-ref="415uctx" data-ref-filename="415uctx">uctx</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col3 ref" href="#413rt" title='rt' data-ref="413rt" data-ref-filename="413rt">rt</a>);</td></tr>
<tr><th id="2114">2114</th><td></td></tr>
<tr><th id="2115">2115</th><td>			<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a> = <a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_policy_alloc" title='security_xfrm_policy_alloc' data-ref="security_xfrm_policy_alloc" data-ref-filename="security_xfrm_policy_alloc">security_xfrm_policy_alloc</a>(&amp;<a class="local col4 ref" href="#414ctx" title='ctx' data-ref="414ctx" data-ref-filename="414ctx">ctx</a>, <a class="local col5 ref" href="#415uctx" title='uctx' data-ref="415uctx" data-ref-filename="415uctx">uctx</a>, <a class="macro" href="../../include/linux/gfp.h.html#273" title="((( gfp_t)(0x400000u|0x1000000u)) | (( gfp_t)0x40u) | (( gfp_t)0x80u))" data-ref="_M/GFP_KERNEL">GFP_KERNEL</a>);</td></tr>
<tr><th id="2116">2116</th><td>			<b>if</b> (<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>)</td></tr>
<tr><th id="2117">2117</th><td>				<b>return</b> <a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>;</td></tr>
<tr><th id="2118">2118</th><td>		}</td></tr>
<tr><th id="2119">2119</th><td>		<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_bysel_ctx" title='xfrm_policy_bysel_ctx' data-ref="xfrm_policy_bysel_ctx" data-ref-filename="xfrm_policy_bysel_ctx">xfrm_policy_bysel_ctx</a>(<a class="local col5 ref" href="#405net" title='net' data-ref="405net" data-ref-filename="405net">net</a>, <a class="local col2 ref" href="#412mark" title='mark' data-ref="412mark" data-ref-filename="412mark">mark</a>, <a class="local col9 ref" href="#409type" title='type' data-ref="409type" data-ref-filename="409type">type</a>, <a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>,</td></tr>
<tr><th id="2120">2120</th><td>					   &amp;<a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>, <a class="local col4 ref" href="#414ctx" title='ctx' data-ref="414ctx" data-ref-filename="414ctx">ctx</a>, <var>0</var>, &amp;<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>);</td></tr>
<tr><th id="2121">2121</th><td>		<a class="ref fn" href="../../include/linux/security.h.html#security_xfrm_policy_free" title='security_xfrm_policy_free' data-ref="security_xfrm_policy_free" data-ref-filename="security_xfrm_policy_free">security_xfrm_policy_free</a>(<a class="local col4 ref" href="#414ctx" title='ctx' data-ref="414ctx" data-ref-filename="414ctx">ctx</a>);</td></tr>
<tr><th id="2122">2122</th><td>	}</td></tr>
<tr><th id="2123">2123</th><td>	<b>if</b> (<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2124">2124</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#6" title="2" data-ref="_M/ENOENT">ENOENT</a>;</td></tr>
<tr><th id="2125">2125</th><td></td></tr>
<tr><th id="2126">2126</th><td>	<b>if</b> (<a class="macro" href="../../include/linux/compiler.h.html#77" title="__builtin_expect(!!(xp-&gt;walk.dead), 0)" data-ref="_M/unlikely">unlikely</a>(<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::walk" title='xfrm_policy::walk' data-ref="xfrm_policy::walk" data-ref-filename="xfrm_policy..walk">walk</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy_walk_entry::dead" title='xfrm_policy_walk_entry::dead' data-ref="xfrm_policy_walk_entry::dead" data-ref-filename="xfrm_policy_walk_entry..dead">dead</a>))</td></tr>
<tr><th id="2127">2127</th><td>		<b>goto</b> <a class="lbl" href="#416out" data-ref="416out" data-ref-filename="416out">out</a>;</td></tr>
<tr><th id="2128">2128</th><td></td></tr>
<tr><th id="2129">2129</th><td>	<a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a> = <var>0</var>;</td></tr>
<tr><th id="2130">2130</th><td>	<b>if</b> (<a class="local col7 ref" href="#407up" title='up' data-ref="407up" data-ref-filename="407up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire::hard" title='xfrm_user_polexpire::hard' data-ref="xfrm_user_polexpire::hard" data-ref-filename="xfrm_user_polexpire..hard">hard</a>) {</td></tr>
<tr><th id="2131">2131</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_delete" title='xfrm_policy_delete' data-ref="xfrm_policy_delete" data-ref-filename="xfrm_policy_delete">xfrm_policy_delete</a>(<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a>, <a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>);</td></tr>
<tr><th id="2132">2132</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_audit_policy_delete" title='xfrm_audit_policy_delete' data-ref="xfrm_audit_policy_delete" data-ref-filename="xfrm_audit_policy_delete">xfrm_audit_policy_delete</a>(<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a>, <var>1</var>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="2133">2133</th><td>	}</td></tr>
<tr><th id="2134">2134</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_policy_expired" title='km_policy_expired' data-ref="km_policy_expired" data-ref-filename="km_policy_expired">km_policy_expired</a>(<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a>, <a class="local col8 ref" href="#408p" title='p' data-ref="408p" data-ref-filename="408p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>, <a class="local col7 ref" href="#407up" title='up' data-ref="407up" data-ref-filename="407up">up</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire::hard" title='xfrm_user_polexpire::hard' data-ref="xfrm_user_polexpire::hard" data-ref-filename="xfrm_user_polexpire..hard">hard</a>, <a class="local col3 ref" href="#403nlh" title='nlh' data-ref="403nlh" data-ref-filename="403nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>);</td></tr>
<tr><th id="2135">2135</th><td></td></tr>
<tr><th id="2136">2136</th><td><dfn class="lbl" id="416out" data-ref="416out" data-ref-filename="416out">out</dfn>:</td></tr>
<tr><th id="2137">2137</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_pol_put" title='xfrm_pol_put' data-ref="xfrm_pol_put" data-ref-filename="xfrm_pol_put">xfrm_pol_put</a>(<a class="local col6 ref" href="#406xp" title='xp' data-ref="406xp" data-ref-filename="406xp">xp</a>);</td></tr>
<tr><th id="2138">2138</th><td>	<b>return</b> <a class="local col0 ref" href="#410err" title='err' data-ref="410err" data-ref-filename="410err">err</a>;</td></tr>
<tr><th id="2139">2139</th><td>}</td></tr>
<tr><th id="2140">2140</th><td></td></tr>
<tr><th id="2141">2141</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_add_sa_expire" title='xfrm_add_sa_expire' data-type='int xfrm_add_sa_expire(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_add_sa_expire" data-ref-filename="xfrm_add_sa_expire">xfrm_add_sa_expire</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="417skb" title='skb' data-type='struct sk_buff *' data-ref="417skb" data-ref-filename="417skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col8 decl" id="418nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="418nlh" data-ref-filename="418nlh">nlh</dfn>,</td></tr>
<tr><th id="2142">2142</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col9 decl" id="419attrs" title='attrs' data-type='struct nlattr **' data-ref="419attrs" data-ref-filename="419attrs">attrs</dfn>)</td></tr>
<tr><th id="2143">2143</th><td>{</td></tr>
<tr><th id="2144">2144</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col0 decl" id="420net" title='net' data-type='struct net *' data-ref="420net" data-ref-filename="420net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col7 ref" href="#417skb" title='skb' data-ref="417skb" data-ref-filename="417skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="2145">2145</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="421x" title='x' data-type='struct xfrm_state *' data-ref="421x" data-ref-filename="421x">x</dfn>;</td></tr>
<tr><th id="2146">2146</th><td>	<em>int</em> <dfn class="local col2 decl" id="422err" title='err' data-type='int' data-ref="422err" data-ref-filename="422err">err</dfn>;</td></tr>
<tr><th id="2147">2147</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire" title='xfrm_user_expire' data-ref="xfrm_user_expire" data-ref-filename="xfrm_user_expire">xfrm_user_expire</a> *<dfn class="local col3 decl" id="423ue" title='ue' data-type='struct xfrm_user_expire *' data-ref="423ue" data-ref-filename="423ue">ue</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col8 ref" href="#418nlh" title='nlh' data-ref="418nlh" data-ref-filename="418nlh">nlh</a>);</td></tr>
<tr><th id="2148">2148</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col4 decl" id="424p" title='p' data-type='struct xfrm_usersa_info *' data-ref="424p" data-ref-filename="424p">p</dfn> = &amp;<a class="local col3 ref" href="#423ue" title='ue' data-ref="423ue" data-ref-filename="423ue">ue</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire::state" title='xfrm_user_expire::state' data-ref="xfrm_user_expire::state" data-ref-filename="xfrm_user_expire..state">state</a>;</td></tr>
<tr><th id="2149">2149</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col5 decl" id="425m" title='m' data-type='struct xfrm_mark' data-ref="425m" data-ref-filename="425m">m</dfn>;</td></tr>
<tr><th id="2150">2150</th><td>	<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col6 decl" id="426mark" title='mark' data-type='u32' data-ref="426mark" data-ref-filename="426mark">mark</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col9 ref" href="#419attrs" title='attrs' data-ref="419attrs" data-ref-filename="419attrs">attrs</a>, &amp;<a class="local col5 ref" href="#425m" title='m' data-ref="425m" data-ref-filename="425m">m</a>);</td></tr>
<tr><th id="2151">2151</th><td></td></tr>
<tr><th id="2152">2152</th><td>	<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_lookup" title='xfrm_state_lookup' data-ref="xfrm_state_lookup" data-ref-filename="xfrm_state_lookup">xfrm_state_lookup</a>(<a class="local col0 ref" href="#420net" title='net' data-ref="420net" data-ref-filename="420net">net</a>, <a class="local col6 ref" href="#426mark" title='mark' data-ref="426mark" data-ref-filename="426mark">mark</a>, &amp;<a class="local col4 ref" href="#424p" title='p' data-ref="424p" data-ref-filename="424p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::daddr" title='xfrm_id::daddr' data-ref="xfrm_id::daddr" data-ref-filename="xfrm_id..daddr">daddr</a>, <a class="local col4 ref" href="#424p" title='p' data-ref="424p" data-ref-filename="424p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::spi" title='xfrm_id::spi' data-ref="xfrm_id::spi" data-ref-filename="xfrm_id..spi">spi</a>, <a class="local col4 ref" href="#424p" title='p' data-ref="424p" data-ref-filename="424p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::id" title='xfrm_usersa_info::id' data-ref="xfrm_usersa_info::id" data-ref-filename="xfrm_usersa_info..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>, <a class="local col4 ref" href="#424p" title='p' data-ref="424p" data-ref-filename="424p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info::family" title='xfrm_usersa_info::family' data-ref="xfrm_usersa_info::family" data-ref-filename="xfrm_usersa_info..family">family</a>);</td></tr>
<tr><th id="2153">2153</th><td></td></tr>
<tr><th id="2154">2154</th><td>	<a class="local col2 ref" href="#422err" title='err' data-ref="422err" data-ref-filename="422err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#6" title="2" data-ref="_M/ENOENT">ENOENT</a>;</td></tr>
<tr><th id="2155">2155</th><td>	<b>if</b> (<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2156">2156</th><td>		<b>return</b> <a class="local col2 ref" href="#422err" title='err' data-ref="422err" data-ref-filename="422err">err</a>;</td></tr>
<tr><th id="2157">2157</th><td></td></tr>
<tr><th id="2158">2158</th><td>	<a class="ref fn" href="../../include/linux/spinlock.h.html#spin_lock_bh" title='spin_lock_bh' data-ref="spin_lock_bh" data-ref-filename="spin_lock_bh">spin_lock_bh</a>(&amp;<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lock" title='xfrm_state::lock' data-ref="xfrm_state::lock" data-ref-filename="xfrm_state..lock">lock</a>);</td></tr>
<tr><th id="2159">2159</th><td>	<a class="local col2 ref" href="#422err" title='err' data-ref="422err" data-ref-filename="422err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="2160">2160</th><td>	<b>if</b> (<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::state" title='xfrm_state_walk::state' data-ref="xfrm_state_walk::state" data-ref-filename="xfrm_state_walk..state">state</a> != <a class="enum" href="../../include/net/xfrm.h.html#XFRM_STATE_VALID" title='XFRM_STATE_VALID' data-ref="XFRM_STATE_VALID" data-ref-filename="XFRM_STATE_VALID">XFRM_STATE_VALID</a>)</td></tr>
<tr><th id="2161">2161</th><td>		<b>goto</b> <a class="lbl" href="#427out" data-ref="427out" data-ref-filename="427out">out</a>;</td></tr>
<tr><th id="2162">2162</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#km_state_expired" title='km_state_expired' data-ref="km_state_expired" data-ref-filename="km_state_expired">km_state_expired</a>(<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a>, <a class="local col3 ref" href="#423ue" title='ue' data-ref="423ue" data-ref-filename="423ue">ue</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire::hard" title='xfrm_user_expire::hard' data-ref="xfrm_user_expire::hard" data-ref-filename="xfrm_user_expire..hard">hard</a>, <a class="local col8 ref" href="#418nlh" title='nlh' data-ref="418nlh" data-ref-filename="418nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_pid" title='nlmsghdr::nlmsg_pid' data-ref="nlmsghdr::nlmsg_pid" data-ref-filename="nlmsghdr..nlmsg_pid">nlmsg_pid</a>);</td></tr>
<tr><th id="2163">2163</th><td></td></tr>
<tr><th id="2164">2164</th><td>	<b>if</b> (<a class="local col3 ref" href="#423ue" title='ue' data-ref="423ue" data-ref-filename="423ue">ue</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire::hard" title='xfrm_user_expire::hard' data-ref="xfrm_user_expire::hard" data-ref-filename="xfrm_user_expire..hard">hard</a>) {</td></tr>
<tr><th id="2165">2165</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#__xfrm_state_delete" title='__xfrm_state_delete' data-ref="__xfrm_state_delete" data-ref-filename="__xfrm_state_delete">__xfrm_state_delete</a>(<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a>);</td></tr>
<tr><th id="2166">2166</th><td>		<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_audit_state_delete" title='xfrm_audit_state_delete' data-ref="xfrm_audit_state_delete" data-ref-filename="xfrm_audit_state_delete">xfrm_audit_state_delete</a>(<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a>, <var>1</var>, <a class="enum" href="../../include/linux/stddef.h.html#true" title='true' data-ref="true" data-ref-filename="true">true</a>);</td></tr>
<tr><th id="2167">2167</th><td>	}</td></tr>
<tr><th id="2168">2168</th><td>	<a class="local col2 ref" href="#422err" title='err' data-ref="422err" data-ref-filename="422err">err</a> = <var>0</var>;</td></tr>
<tr><th id="2169">2169</th><td><dfn class="lbl" id="427out" data-ref="427out" data-ref-filename="427out">out</dfn>:</td></tr>
<tr><th id="2170">2170</th><td>	<a class="ref fn" href="../../include/linux/spinlock.h.html#spin_unlock_bh" title='spin_unlock_bh' data-ref="spin_unlock_bh" data-ref-filename="spin_unlock_bh">spin_unlock_bh</a>(&amp;<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::lock" title='xfrm_state::lock' data-ref="xfrm_state::lock" data-ref-filename="xfrm_state..lock">lock</a>);</td></tr>
<tr><th id="2171">2171</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_put" title='xfrm_state_put' data-ref="xfrm_state_put" data-ref-filename="xfrm_state_put">xfrm_state_put</a>(<a class="local col1 ref" href="#421x" title='x' data-ref="421x" data-ref-filename="421x">x</a>);</td></tr>
<tr><th id="2172">2172</th><td>	<b>return</b> <a class="local col2 ref" href="#422err" title='err' data-ref="422err" data-ref-filename="422err">err</a>;</td></tr>
<tr><th id="2173">2173</th><td>}</td></tr>
<tr><th id="2174">2174</th><td></td></tr>
<tr><th id="2175">2175</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_add_acquire" title='xfrm_add_acquire' data-type='int xfrm_add_acquire(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_add_acquire" data-ref-filename="xfrm_add_acquire">xfrm_add_acquire</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col8 decl" id="428skb" title='skb' data-type='struct sk_buff *' data-ref="428skb" data-ref-filename="428skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col9 decl" id="429nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="429nlh" data-ref-filename="429nlh">nlh</dfn>,</td></tr>
<tr><th id="2176">2176</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col0 decl" id="430attrs" title='attrs' data-type='struct nlattr **' data-ref="430attrs" data-ref-filename="430attrs">attrs</dfn>)</td></tr>
<tr><th id="2177">2177</th><td>{</td></tr>
<tr><th id="2178">2178</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col1 decl" id="431net" title='net' data-type='struct net *' data-ref="431net" data-ref-filename="431net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col8 ref" href="#428skb" title='skb' data-ref="428skb" data-ref-filename="428skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="2179">2179</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col2 decl" id="432xp" title='xp' data-type='struct xfrm_policy *' data-ref="432xp" data-ref-filename="432xp">xp</dfn>;</td></tr>
<tr><th id="2180">2180</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> *<dfn class="local col3 decl" id="433ut" title='ut' data-type='struct xfrm_user_tmpl *' data-ref="433ut" data-ref-filename="433ut">ut</dfn>;</td></tr>
<tr><th id="2181">2181</th><td>	<em>int</em> <dfn class="local col4 decl" id="434i" title='i' data-type='int' data-ref="434i" data-ref-filename="434i">i</dfn>;</td></tr>
<tr><th id="2182">2182</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col5 decl" id="435rt" title='rt' data-type='struct nlattr *' data-ref="435rt" data-ref-filename="435rt">rt</dfn> = <a class="local col0 ref" href="#430attrs" title='attrs' data-ref="430attrs" data-ref-filename="430attrs">attrs</a>[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TMPL" title='XFRMA_TMPL' data-ref="XFRMA_TMPL" data-ref-filename="XFRMA_TMPL">XFRMA_TMPL</a>];</td></tr>
<tr><th id="2183">2183</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a> <dfn class="local col6 decl" id="436mark" title='mark' data-type='struct xfrm_mark' data-ref="436mark" data-ref-filename="436mark">mark</dfn>;</td></tr>
<tr><th id="2184">2184</th><td></td></tr>
<tr><th id="2185">2185</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire" title='xfrm_user_acquire' data-ref="xfrm_user_acquire" data-ref-filename="xfrm_user_acquire">xfrm_user_acquire</a> *<dfn class="local col7 decl" id="437ua" title='ua' data-type='struct xfrm_user_acquire *' data-ref="437ua" data-ref-filename="437ua">ua</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col9 ref" href="#429nlh" title='nlh' data-ref="429nlh" data-ref-filename="429nlh">nlh</a>);</td></tr>
<tr><th id="2186">2186</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col8 decl" id="438x" title='x' data-type='struct xfrm_state *' data-ref="438x" data-ref-filename="438x">x</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_state_alloc" title='xfrm_state_alloc' data-ref="xfrm_state_alloc" data-ref-filename="xfrm_state_alloc">xfrm_state_alloc</a>(<a class="local col1 ref" href="#431net" title='net' data-ref="431net" data-ref-filename="431net">net</a>);</td></tr>
<tr><th id="2187">2187</th><td>	<em>int</em> <dfn class="local col9 decl" id="439err" title='err' data-type='int' data-ref="439err" data-ref-filename="439err">err</dfn> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="2188">2188</th><td></td></tr>
<tr><th id="2189">2189</th><td>	<b>if</b> (!<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>)</td></tr>
<tr><th id="2190">2190</th><td>		<b>goto</b> <a class="lbl" href="#440nomem" data-ref="440nomem" data-ref-filename="440nomem">nomem</a>;</td></tr>
<tr><th id="2191">2191</th><td></td></tr>
<tr><th id="2192">2192</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_get" title='xfrm_mark_get' data-ref="xfrm_mark_get" data-ref-filename="xfrm_mark_get">xfrm_mark_get</a>(<a class="local col0 ref" href="#430attrs" title='attrs' data-ref="430attrs" data-ref-filename="430attrs">attrs</a>, &amp;<a class="local col6 ref" href="#436mark" title='mark' data-ref="436mark" data-ref-filename="436mark">mark</a>);</td></tr>
<tr><th id="2193">2193</th><td></td></tr>
<tr><th id="2194">2194</th><td>	<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a> = <a class="tu ref fn" href="#verify_newpolicy_info" title='verify_newpolicy_info' data-use='c' data-ref="verify_newpolicy_info" data-ref-filename="verify_newpolicy_info">verify_newpolicy_info</a>(&amp;<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::policy" title='xfrm_user_acquire::policy' data-ref="xfrm_user_acquire::policy" data-ref-filename="xfrm_user_acquire..policy">policy</a>);</td></tr>
<tr><th id="2195">2195</th><td>	<b>if</b> (<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>)</td></tr>
<tr><th id="2196">2196</th><td>		<b>goto</b> <a class="lbl" href="#441free_state" data-ref="441free_state" data-ref-filename="441free_state">free_state</a>;</td></tr>
<tr><th id="2197">2197</th><td></td></tr>
<tr><th id="2198">2198</th><td>	<i>/*   build an XP */</i></td></tr>
<tr><th id="2199">2199</th><td>	<a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a> = <a class="tu ref fn" href="#xfrm_policy_construct" title='xfrm_policy_construct' data-use='c' data-ref="xfrm_policy_construct" data-ref-filename="xfrm_policy_construct">xfrm_policy_construct</a>(<a class="local col1 ref" href="#431net" title='net' data-ref="431net" data-ref-filename="431net">net</a>, &amp;<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::policy" title='xfrm_user_acquire::policy' data-ref="xfrm_user_acquire::policy" data-ref-filename="xfrm_user_acquire..policy">policy</a>, <a class="local col0 ref" href="#430attrs" title='attrs' data-ref="430attrs" data-ref-filename="430attrs">attrs</a>, &amp;<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>);</td></tr>
<tr><th id="2200">2200</th><td>	<b>if</b> (!<a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a>)</td></tr>
<tr><th id="2201">2201</th><td>		<b>goto</b> <a class="lbl" href="#441free_state" data-ref="441free_state" data-ref-filename="441free_state">free_state</a>;</td></tr>
<tr><th id="2202">2202</th><td></td></tr>
<tr><th id="2203">2203</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(ua-&gt;id)); void *__ret; if (__builtin_constant_p(sizeof(ua-&gt;id)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;id), (&amp;ua-&gt;id), __len); else __ret = __builtin_memcpy((&amp;x-&gt;id), (&amp;ua-&gt;id), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>, &amp;<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::id" title='xfrm_user_acquire::id' data-ref="xfrm_user_acquire::id" data-ref-filename="xfrm_user_acquire..id">id</a>, <b>sizeof</b>(<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::id" title='xfrm_user_acquire::id' data-ref="xfrm_user_acquire::id" data-ref-filename="xfrm_user_acquire..id">id</a>));</td></tr>
<tr><th id="2204">2204</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(ua-&gt;saddr)); void *__ret; if (__builtin_constant_p(sizeof(ua-&gt;saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;props.saddr), (&amp;ua-&gt;saddr), __len); else __ret = __builtin_memcpy((&amp;x-&gt;props.saddr), (&amp;ua-&gt;saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>, &amp;<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::saddr" title='xfrm_user_acquire::saddr' data-ref="xfrm_user_acquire::saddr" data-ref-filename="xfrm_user_acquire..saddr">saddr</a>, <b>sizeof</b>(<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::saddr" title='xfrm_user_acquire::saddr' data-ref="xfrm_user_acquire::saddr" data-ref-filename="xfrm_user_acquire..saddr">saddr</a>));</td></tr>
<tr><th id="2205">2205</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(ua-&gt;sel)); void *__ret; if (__builtin_constant_p(sizeof(ua-&gt;sel)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;sel), (&amp;ua-&gt;sel), __len); else __ret = __builtin_memcpy((&amp;x-&gt;sel), (&amp;ua-&gt;sel), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::sel" title='xfrm_state::sel' data-ref="xfrm_state::sel" data-ref-filename="xfrm_state..sel">sel</a>, &amp;<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::sel" title='xfrm_user_acquire::sel' data-ref="xfrm_user_acquire::sel" data-ref-filename="xfrm_user_acquire..sel">sel</a>, <b>sizeof</b>(<a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::sel" title='xfrm_user_acquire::sel' data-ref="xfrm_user_acquire::sel" data-ref-filename="xfrm_user_acquire..sel">sel</a>));</td></tr>
<tr><th id="2206">2206</th><td>	<a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::mark" title='xfrm_policy::mark' data-ref="xfrm_policy::mark" data-ref-filename="xfrm_policy..mark">mark</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark::m" title='xfrm_mark::m' data-ref="xfrm_mark::m" data-ref-filename="xfrm_mark..m">m</a> = <a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::mark" title='xfrm_state::mark' data-ref="xfrm_state::mark" data-ref-filename="xfrm_state..mark">mark</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark::m" title='xfrm_mark::m' data-ref="xfrm_mark::m" data-ref-filename="xfrm_mark..m">m</a> = <a class="local col6 ref" href="#436mark" title='mark' data-ref="436mark" data-ref-filename="436mark">mark</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark::m" title='xfrm_mark::m' data-ref="xfrm_mark::m" data-ref-filename="xfrm_mark..m">m</a>;</td></tr>
<tr><th id="2207">2207</th><td>	<a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::mark" title='xfrm_policy::mark' data-ref="xfrm_policy::mark" data-ref-filename="xfrm_policy..mark">mark</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark::v" title='xfrm_mark::v' data-ref="xfrm_mark::v" data-ref-filename="xfrm_mark..v">v</a> = <a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::mark" title='xfrm_state::mark' data-ref="xfrm_state::mark" data-ref-filename="xfrm_state..mark">mark</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark::v" title='xfrm_mark::v' data-ref="xfrm_mark::v" data-ref-filename="xfrm_mark..v">v</a> = <a class="local col6 ref" href="#436mark" title='mark' data-ref="436mark" data-ref-filename="436mark">mark</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark::v" title='xfrm_mark::v' data-ref="xfrm_mark::v" data-ref-filename="xfrm_mark..v">v</a>;</td></tr>
<tr><th id="2208">2208</th><td>	<a class="local col3 ref" href="#433ut" title='ut' data-ref="433ut" data-ref-filename="433ut">ut</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col5 ref" href="#435rt" title='rt' data-ref="435rt" data-ref-filename="435rt">rt</a>);</td></tr>
<tr><th id="2209">2209</th><td>	<i>/* extract the templates and for each call km_key */</i></td></tr>
<tr><th id="2210">2210</th><td>	<b>for</b> (<a class="local col4 ref" href="#434i" title='i' data-ref="434i" data-ref-filename="434i">i</a> = <var>0</var>; <a class="local col4 ref" href="#434i" title='i' data-ref="434i" data-ref-filename="434i">i</a> &lt; <a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a>; <a class="local col4 ref" href="#434i" title='i' data-ref="434i" data-ref-filename="434i">i</a>++, <a class="local col3 ref" href="#433ut" title='ut' data-ref="433ut" data-ref-filename="433ut">ut</a>++) {</td></tr>
<tr><th id="2211">2211</th><td>		<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_tmpl" title='xfrm_tmpl' data-ref="xfrm_tmpl" data-ref-filename="xfrm_tmpl">xfrm_tmpl</a> *<dfn class="local col2 decl" id="442t" title='t' data-type='struct xfrm_tmpl *' data-ref="442t" data-ref-filename="442t">t</dfn> = &amp;<a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_vec" title='xfrm_policy::xfrm_vec' data-ref="xfrm_policy::xfrm_vec" data-ref-filename="xfrm_policy..xfrm_vec">xfrm_vec</a>[<a class="local col4 ref" href="#434i" title='i' data-ref="434i" data-ref-filename="434i">i</a>];</td></tr>
<tr><th id="2212">2212</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(x-&gt;id)); void *__ret; if (__builtin_constant_p(sizeof(x-&gt;id)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;x-&gt;id), (&amp;t-&gt;id), __len); else __ret = __builtin_memcpy((&amp;x-&gt;id), (&amp;t-&gt;id), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>, &amp;<a class="local col2 ref" href="#442t" title='t' data-ref="442t" data-ref-filename="442t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::id" title='xfrm_tmpl::id' data-ref="xfrm_tmpl::id" data-ref-filename="xfrm_tmpl..id">id</a>, <b>sizeof</b>(<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>));</td></tr>
<tr><th id="2213">2213</th><td>		<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::mode" title='xfrm_state::(anonymous struct)::mode' data-ref="xfrm_state::(anonymous)::mode" data-ref-filename="xfrm_state..(anonymous)..mode">mode</a> = <a class="local col2 ref" href="#442t" title='t' data-ref="442t" data-ref-filename="442t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::mode" title='xfrm_tmpl::mode' data-ref="xfrm_tmpl::mode" data-ref-filename="xfrm_tmpl..mode">mode</a>;</td></tr>
<tr><th id="2214">2214</th><td>		<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::reqid" title='xfrm_state::(anonymous struct)::reqid' data-ref="xfrm_state::(anonymous)::reqid" data-ref-filename="xfrm_state..(anonymous)..reqid">reqid</a> = <a class="local col2 ref" href="#442t" title='t' data-ref="442t" data-ref-filename="442t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::reqid" title='xfrm_tmpl::reqid' data-ref="xfrm_tmpl::reqid" data-ref-filename="xfrm_tmpl..reqid">reqid</a>;</td></tr>
<tr><th id="2215">2215</th><td>		<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::family" title='xfrm_state::(anonymous struct)::family' data-ref="xfrm_state::(anonymous)::family" data-ref-filename="xfrm_state..(anonymous)..family">family</a> = <a class="local col3 ref" href="#433ut" title='ut' data-ref="433ut" data-ref-filename="433ut">ut</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl::family" title='xfrm_user_tmpl::family' data-ref="xfrm_user_tmpl::family" data-ref-filename="xfrm_user_tmpl..family">family</a>;</td></tr>
<tr><th id="2216">2216</th><td>		<a class="local col2 ref" href="#442t" title='t' data-ref="442t" data-ref-filename="442t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::aalgos" title='xfrm_tmpl::aalgos' data-ref="xfrm_tmpl::aalgos" data-ref-filename="xfrm_tmpl..aalgos">aalgos</a> = <a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::aalgos" title='xfrm_user_acquire::aalgos' data-ref="xfrm_user_acquire::aalgos" data-ref-filename="xfrm_user_acquire..aalgos">aalgos</a>;</td></tr>
<tr><th id="2217">2217</th><td>		<a class="local col2 ref" href="#442t" title='t' data-ref="442t" data-ref-filename="442t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::ealgos" title='xfrm_tmpl::ealgos' data-ref="xfrm_tmpl::ealgos" data-ref-filename="xfrm_tmpl..ealgos">ealgos</a> = <a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::ealgos" title='xfrm_user_acquire::ealgos' data-ref="xfrm_user_acquire::ealgos" data-ref-filename="xfrm_user_acquire..ealgos">ealgos</a>;</td></tr>
<tr><th id="2218">2218</th><td>		<a class="local col2 ref" href="#442t" title='t' data-ref="442t" data-ref-filename="442t">t</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::calgos" title='xfrm_tmpl::calgos' data-ref="xfrm_tmpl::calgos" data-ref-filename="xfrm_tmpl..calgos">calgos</a> = <a class="local col7 ref" href="#437ua" title='ua' data-ref="437ua" data-ref-filename="437ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::calgos" title='xfrm_user_acquire::calgos' data-ref="xfrm_user_acquire::calgos" data-ref-filename="xfrm_user_acquire..calgos">calgos</a>;</td></tr>
<tr><th id="2219">2219</th><td>		<a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#km_query" title='km_query' data-ref="km_query" data-ref-filename="km_query">km_query</a>(<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>, <a class="local col2 ref" href="#442t" title='t' data-ref="442t" data-ref-filename="442t">t</a>, <a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a>);</td></tr>
<tr><th id="2220">2220</th><td></td></tr>
<tr><th id="2221">2221</th><td>	}</td></tr>
<tr><th id="2222">2222</th><td></td></tr>
<tr><th id="2223">2223</th><td>	<a class="ref fn" href="../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree" data-ref-filename="kfree">kfree</a>(<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>);</td></tr>
<tr><th id="2224">2224</th><td>	<a class="ref fn" href="../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree" data-ref-filename="kfree">kfree</a>(<a class="local col2 ref" href="#432xp" title='xp' data-ref="432xp" data-ref-filename="432xp">xp</a>);</td></tr>
<tr><th id="2225">2225</th><td></td></tr>
<tr><th id="2226">2226</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2227">2227</th><td></td></tr>
<tr><th id="2228">2228</th><td><dfn class="lbl" id="441free_state" data-ref="441free_state" data-ref-filename="441free_state">free_state</dfn>:</td></tr>
<tr><th id="2229">2229</th><td>	<a class="ref fn" href="../../include/linux/slab.h.html#kfree" title='kfree' data-ref="kfree" data-ref-filename="kfree">kfree</a>(<a class="local col8 ref" href="#438x" title='x' data-ref="438x" data-ref-filename="438x">x</a>);</td></tr>
<tr><th id="2230">2230</th><td><dfn class="lbl" id="440nomem" data-ref="440nomem" data-ref-filename="440nomem">nomem</dfn>:</td></tr>
<tr><th id="2231">2231</th><td>	<b>return</b> <a class="local col9 ref" href="#439err" title='err' data-ref="439err" data-ref-filename="439err">err</a>;</td></tr>
<tr><th id="2232">2232</th><td>}</td></tr>
<tr><th id="2233">2233</th><td></td></tr>
<tr><th id="2234">2234</th><td><u>#<span data-ppcond="2234">ifdef</span> <span class="macro" data-ref="_M/CONFIG_XFRM_MIGRATE">CONFIG_XFRM_MIGRATE</span></u></td></tr>
<tr><th id="2235">2235</th><td><em>static</em> <em>int</em> copy_from_user_migrate(<b>struct</b> xfrm_migrate *ma,</td></tr>
<tr><th id="2236">2236</th><td>				  <b>struct</b> xfrm_kmaddress *k,</td></tr>
<tr><th id="2237">2237</th><td>				  <b>struct</b> nlattr **attrs, <em>int</em> *num)</td></tr>
<tr><th id="2238">2238</th><td>{</td></tr>
<tr><th id="2239">2239</th><td>	<b>struct</b> nlattr *rt = attrs[XFRMA_MIGRATE];</td></tr>
<tr><th id="2240">2240</th><td>	<b>struct</b> xfrm_user_migrate *um;</td></tr>
<tr><th id="2241">2241</th><td>	<em>int</em> i, num_migrate;</td></tr>
<tr><th id="2242">2242</th><td></td></tr>
<tr><th id="2243">2243</th><td>	<b>if</b> (k != NULL) {</td></tr>
<tr><th id="2244">2244</th><td>		<b>struct</b> xfrm_user_kmaddress *uk;</td></tr>
<tr><th id="2245">2245</th><td></td></tr>
<tr><th id="2246">2246</th><td>		uk = nla_data(attrs[XFRMA_KMADDRESS]);</td></tr>
<tr><th id="2247">2247</th><td>		memcpy(&amp;k-&gt;local, &amp;uk-&gt;local, <b>sizeof</b>(k-&gt;local));</td></tr>
<tr><th id="2248">2248</th><td>		memcpy(&amp;k-&gt;remote, &amp;uk-&gt;remote, <b>sizeof</b>(k-&gt;remote));</td></tr>
<tr><th id="2249">2249</th><td>		k-&gt;family = uk-&gt;family;</td></tr>
<tr><th id="2250">2250</th><td>		k-&gt;reserved = uk-&gt;reserved;</td></tr>
<tr><th id="2251">2251</th><td>	}</td></tr>
<tr><th id="2252">2252</th><td></td></tr>
<tr><th id="2253">2253</th><td>	um = nla_data(rt);</td></tr>
<tr><th id="2254">2254</th><td>	num_migrate = nla_len(rt) / <b>sizeof</b>(*um);</td></tr>
<tr><th id="2255">2255</th><td></td></tr>
<tr><th id="2256">2256</th><td>	<b>if</b> (num_migrate &lt;= <var>0</var> || num_migrate &gt; XFRM_MAX_DEPTH)</td></tr>
<tr><th id="2257">2257</th><td>		<b>return</b> -EINVAL;</td></tr>
<tr><th id="2258">2258</th><td></td></tr>
<tr><th id="2259">2259</th><td>	<b>for</b> (i = <var>0</var>; i &lt; num_migrate; i++, um++, ma++) {</td></tr>
<tr><th id="2260">2260</th><td>		memcpy(&amp;ma-&gt;old_daddr, &amp;um-&gt;old_daddr, <b>sizeof</b>(ma-&gt;old_daddr));</td></tr>
<tr><th id="2261">2261</th><td>		memcpy(&amp;ma-&gt;old_saddr, &amp;um-&gt;old_saddr, <b>sizeof</b>(ma-&gt;old_saddr));</td></tr>
<tr><th id="2262">2262</th><td>		memcpy(&amp;ma-&gt;new_daddr, &amp;um-&gt;new_daddr, <b>sizeof</b>(ma-&gt;new_daddr));</td></tr>
<tr><th id="2263">2263</th><td>		memcpy(&amp;ma-&gt;new_saddr, &amp;um-&gt;new_saddr, <b>sizeof</b>(ma-&gt;new_saddr));</td></tr>
<tr><th id="2264">2264</th><td></td></tr>
<tr><th id="2265">2265</th><td>		ma-&gt;proto = um-&gt;proto;</td></tr>
<tr><th id="2266">2266</th><td>		ma-&gt;mode = um-&gt;mode;</td></tr>
<tr><th id="2267">2267</th><td>		ma-&gt;reqid = um-&gt;reqid;</td></tr>
<tr><th id="2268">2268</th><td></td></tr>
<tr><th id="2269">2269</th><td>		ma-&gt;old_family = um-&gt;old_family;</td></tr>
<tr><th id="2270">2270</th><td>		ma-&gt;new_family = um-&gt;new_family;</td></tr>
<tr><th id="2271">2271</th><td>	}</td></tr>
<tr><th id="2272">2272</th><td></td></tr>
<tr><th id="2273">2273</th><td>	*num = i;</td></tr>
<tr><th id="2274">2274</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2275">2275</th><td>}</td></tr>
<tr><th id="2276">2276</th><td></td></tr>
<tr><th id="2277">2277</th><td><em>static</em> <em>int</em> xfrm_do_migrate(<b>struct</b> sk_buff *skb, <b>struct</b> nlmsghdr *nlh,</td></tr>
<tr><th id="2278">2278</th><td>			   <b>struct</b> nlattr **attrs)</td></tr>
<tr><th id="2279">2279</th><td>{</td></tr>
<tr><th id="2280">2280</th><td>	<b>struct</b> xfrm_userpolicy_id *pi = nlmsg_data(nlh);</td></tr>
<tr><th id="2281">2281</th><td>	<b>struct</b> xfrm_migrate m[XFRM_MAX_DEPTH];</td></tr>
<tr><th id="2282">2282</th><td>	<b>struct</b> xfrm_kmaddress km, *kmp;</td></tr>
<tr><th id="2283">2283</th><td>	u8 type;</td></tr>
<tr><th id="2284">2284</th><td>	<em>int</em> err;</td></tr>
<tr><th id="2285">2285</th><td>	<em>int</em> n = <var>0</var>;</td></tr>
<tr><th id="2286">2286</th><td>	<b>struct</b> net *net = sock_net(skb-&gt;sk);</td></tr>
<tr><th id="2287">2287</th><td>	<b>struct</b> xfrm_encap_tmpl  *encap = NULL;</td></tr>
<tr><th id="2288">2288</th><td></td></tr>
<tr><th id="2289">2289</th><td>	<b>if</b> (attrs[XFRMA_MIGRATE] == NULL)</td></tr>
<tr><th id="2290">2290</th><td>		<b>return</b> -EINVAL;</td></tr>
<tr><th id="2291">2291</th><td></td></tr>
<tr><th id="2292">2292</th><td>	kmp = attrs[XFRMA_KMADDRESS] ? &amp;km : NULL;</td></tr>
<tr><th id="2293">2293</th><td></td></tr>
<tr><th id="2294">2294</th><td>	err = copy_from_user_policy_type(&amp;type, attrs);</td></tr>
<tr><th id="2295">2295</th><td>	<b>if</b> (err)</td></tr>
<tr><th id="2296">2296</th><td>		<b>return</b> err;</td></tr>
<tr><th id="2297">2297</th><td></td></tr>
<tr><th id="2298">2298</th><td>	err = copy_from_user_migrate((<b>struct</b> xfrm_migrate *)m, kmp, attrs, &amp;n);</td></tr>
<tr><th id="2299">2299</th><td>	<b>if</b> (err)</td></tr>
<tr><th id="2300">2300</th><td>		<b>return</b> err;</td></tr>
<tr><th id="2301">2301</th><td></td></tr>
<tr><th id="2302">2302</th><td>	<b>if</b> (!n)</td></tr>
<tr><th id="2303">2303</th><td>		<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2304">2304</th><td></td></tr>
<tr><th id="2305">2305</th><td>	<b>if</b> (attrs[XFRMA_ENCAP]) {</td></tr>
<tr><th id="2306">2306</th><td>		encap = kmemdup(nla_data(attrs[XFRMA_ENCAP]),</td></tr>
<tr><th id="2307">2307</th><td>				<b>sizeof</b>(*encap), GFP_KERNEL);</td></tr>
<tr><th id="2308">2308</th><td>		<b>if</b> (!encap)</td></tr>
<tr><th id="2309">2309</th><td>			<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2310">2310</th><td>	}</td></tr>
<tr><th id="2311">2311</th><td></td></tr>
<tr><th id="2312">2312</th><td>	err = xfrm_migrate(&amp;pi-&gt;sel, pi-&gt;dir, type, m, n, kmp, net, encap);</td></tr>
<tr><th id="2313">2313</th><td></td></tr>
<tr><th id="2314">2314</th><td>	kfree(encap);</td></tr>
<tr><th id="2315">2315</th><td></td></tr>
<tr><th id="2316">2316</th><td>	<b>return</b> err;</td></tr>
<tr><th id="2317">2317</th><td>}</td></tr>
<tr><th id="2318">2318</th><td><u>#<span data-ppcond="2234">else</span></u></td></tr>
<tr><th id="2319">2319</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_do_migrate" title='xfrm_do_migrate' data-type='int xfrm_do_migrate(struct sk_buff * skb, struct nlmsghdr * nlh, struct nlattr ** attrs)' data-ref="xfrm_do_migrate" data-ref-filename="xfrm_do_migrate">xfrm_do_migrate</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="443skb" title='skb' data-type='struct sk_buff *' data-ref="443skb" data-ref-filename="443skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col4 decl" id="444nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="444nlh" data-ref-filename="444nlh">nlh</dfn>,</td></tr>
<tr><th id="2320">2320</th><td>			   <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **<dfn class="local col5 decl" id="445attrs" title='attrs' data-type='struct nlattr **' data-ref="445attrs" data-ref-filename="445attrs">attrs</dfn>)</td></tr>
<tr><th id="2321">2321</th><td>{</td></tr>
<tr><th id="2322">2322</th><td>	<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#75" title="92" data-ref="_M/ENOPROTOOPT">ENOPROTOOPT</a>;</td></tr>
<tr><th id="2323">2323</th><td>}</td></tr>
<tr><th id="2324">2324</th><td><u>#<span data-ppcond="2234">endif</span></u></td></tr>
<tr><th id="2325">2325</th><td></td></tr>
<tr><th id="2326">2326</th><td><u>#<span data-ppcond="2326">ifdef</span> <span class="macro" data-ref="_M/CONFIG_XFRM_MIGRATE">CONFIG_XFRM_MIGRATE</span></u></td></tr>
<tr><th id="2327">2327</th><td><em>static</em> <em>int</em> copy_to_user_migrate(<em>const</em> <b>struct</b> xfrm_migrate *m, <b>struct</b> sk_buff *skb)</td></tr>
<tr><th id="2328">2328</th><td>{</td></tr>
<tr><th id="2329">2329</th><td>	<b>struct</b> xfrm_user_migrate um;</td></tr>
<tr><th id="2330">2330</th><td></td></tr>
<tr><th id="2331">2331</th><td>	memset(&amp;um, <var>0</var>, <b>sizeof</b>(um));</td></tr>
<tr><th id="2332">2332</th><td>	um.proto = m-&gt;proto;</td></tr>
<tr><th id="2333">2333</th><td>	um.mode = m-&gt;mode;</td></tr>
<tr><th id="2334">2334</th><td>	um.reqid = m-&gt;reqid;</td></tr>
<tr><th id="2335">2335</th><td>	um.old_family = m-&gt;old_family;</td></tr>
<tr><th id="2336">2336</th><td>	memcpy(&amp;um.old_daddr, &amp;m-&gt;old_daddr, <b>sizeof</b>(um.old_daddr));</td></tr>
<tr><th id="2337">2337</th><td>	memcpy(&amp;um.old_saddr, &amp;m-&gt;old_saddr, <b>sizeof</b>(um.old_saddr));</td></tr>
<tr><th id="2338">2338</th><td>	um.new_family = m-&gt;new_family;</td></tr>
<tr><th id="2339">2339</th><td>	memcpy(&amp;um.new_daddr, &amp;m-&gt;new_daddr, <b>sizeof</b>(um.new_daddr));</td></tr>
<tr><th id="2340">2340</th><td>	memcpy(&amp;um.new_saddr, &amp;m-&gt;new_saddr, <b>sizeof</b>(um.new_saddr));</td></tr>
<tr><th id="2341">2341</th><td></td></tr>
<tr><th id="2342">2342</th><td>	<b>return</b> nla_put(skb, XFRMA_MIGRATE, <b>sizeof</b>(um), &amp;um);</td></tr>
<tr><th id="2343">2343</th><td>}</td></tr>
<tr><th id="2344">2344</th><td></td></tr>
<tr><th id="2345">2345</th><td><em>static</em> <em>int</em> copy_to_user_kmaddress(<em>const</em> <b>struct</b> xfrm_kmaddress *k, <b>struct</b> sk_buff *skb)</td></tr>
<tr><th id="2346">2346</th><td>{</td></tr>
<tr><th id="2347">2347</th><td>	<b>struct</b> xfrm_user_kmaddress uk;</td></tr>
<tr><th id="2348">2348</th><td></td></tr>
<tr><th id="2349">2349</th><td>	memset(&amp;uk, <var>0</var>, <b>sizeof</b>(uk));</td></tr>
<tr><th id="2350">2350</th><td>	uk.family = k-&gt;family;</td></tr>
<tr><th id="2351">2351</th><td>	uk.reserved = k-&gt;reserved;</td></tr>
<tr><th id="2352">2352</th><td>	memcpy(&amp;uk.local, &amp;k-&gt;local, <b>sizeof</b>(uk.local));</td></tr>
<tr><th id="2353">2353</th><td>	memcpy(&amp;uk.remote, &amp;k-&gt;remote, <b>sizeof</b>(uk.remote));</td></tr>
<tr><th id="2354">2354</th><td></td></tr>
<tr><th id="2355">2355</th><td>	<b>return</b> nla_put(skb, XFRMA_KMADDRESS, <b>sizeof</b>(uk), &amp;uk);</td></tr>
<tr><th id="2356">2356</th><td>}</td></tr>
<tr><th id="2357">2357</th><td></td></tr>
<tr><th id="2358">2358</th><td><em>static</em> <b>inline</b> <em>unsigned</em> <em>int</em> xfrm_migrate_msgsize(<em>int</em> num_migrate, <em>int</em> with_kma,</td></tr>
<tr><th id="2359">2359</th><td>						<em>int</em> with_encp)</td></tr>
<tr><th id="2360">2360</th><td>{</td></tr>
<tr><th id="2361">2361</th><td>	<b>return</b> NLMSG_ALIGN(<b>sizeof</b>(<b>struct</b> xfrm_userpolicy_id))</td></tr>
<tr><th id="2362">2362</th><td>	      + (with_kma ? nla_total_size(<b>sizeof</b>(<b>struct</b> xfrm_kmaddress)) : <var>0</var>)</td></tr>
<tr><th id="2363">2363</th><td>	      + (with_encp ? nla_total_size(<b>sizeof</b>(<b>struct</b> xfrm_encap_tmpl)) : <var>0</var>)</td></tr>
<tr><th id="2364">2364</th><td>	      + nla_total_size(<b>sizeof</b>(<b>struct</b> xfrm_user_migrate) * num_migrate)</td></tr>
<tr><th id="2365">2365</th><td>	      + userpolicy_type_attrsize();</td></tr>
<tr><th id="2366">2366</th><td>}</td></tr>
<tr><th id="2367">2367</th><td></td></tr>
<tr><th id="2368">2368</th><td><em>static</em> <em>int</em> build_migrate(<b>struct</b> sk_buff *skb, <em>const</em> <b>struct</b> xfrm_migrate *m,</td></tr>
<tr><th id="2369">2369</th><td>			 <em>int</em> num_migrate, <em>const</em> <b>struct</b> xfrm_kmaddress *k,</td></tr>
<tr><th id="2370">2370</th><td>			 <em>const</em> <b>struct</b> xfrm_selector *sel,</td></tr>
<tr><th id="2371">2371</th><td>			 <em>const</em> <b>struct</b> xfrm_encap_tmpl *encap, u8 dir, u8 type)</td></tr>
<tr><th id="2372">2372</th><td>{</td></tr>
<tr><th id="2373">2373</th><td>	<em>const</em> <b>struct</b> xfrm_migrate *mp;</td></tr>
<tr><th id="2374">2374</th><td>	<b>struct</b> xfrm_userpolicy_id *pol_id;</td></tr>
<tr><th id="2375">2375</th><td>	<b>struct</b> nlmsghdr *nlh;</td></tr>
<tr><th id="2376">2376</th><td>	<em>int</em> i, err;</td></tr>
<tr><th id="2377">2377</th><td></td></tr>
<tr><th id="2378">2378</th><td>	nlh = nlmsg_put(skb, <var>0</var>, <var>0</var>, XFRM_MSG_MIGRATE, <b>sizeof</b>(*pol_id), <var>0</var>);</td></tr>
<tr><th id="2379">2379</th><td>	<b>if</b> (nlh == NULL)</td></tr>
<tr><th id="2380">2380</th><td>		<b>return</b> -EMSGSIZE;</td></tr>
<tr><th id="2381">2381</th><td></td></tr>
<tr><th id="2382">2382</th><td>	pol_id = nlmsg_data(nlh);</td></tr>
<tr><th id="2383">2383</th><td>	<i>/* copy data from selector, dir, and type to the pol_id */</i></td></tr>
<tr><th id="2384">2384</th><td>	memset(pol_id, <var>0</var>, <b>sizeof</b>(*pol_id));</td></tr>
<tr><th id="2385">2385</th><td>	memcpy(&amp;pol_id-&gt;sel, sel, <b>sizeof</b>(pol_id-&gt;sel));</td></tr>
<tr><th id="2386">2386</th><td>	pol_id-&gt;dir = dir;</td></tr>
<tr><th id="2387">2387</th><td></td></tr>
<tr><th id="2388">2388</th><td>	<b>if</b> (k != NULL) {</td></tr>
<tr><th id="2389">2389</th><td>		err = copy_to_user_kmaddress(k, skb);</td></tr>
<tr><th id="2390">2390</th><td>		<b>if</b> (err)</td></tr>
<tr><th id="2391">2391</th><td>			<b>goto</b> out_cancel;</td></tr>
<tr><th id="2392">2392</th><td>	}</td></tr>
<tr><th id="2393">2393</th><td>	<b>if</b> (encap) {</td></tr>
<tr><th id="2394">2394</th><td>		err = nla_put(skb, XFRMA_ENCAP, <b>sizeof</b>(*encap), encap);</td></tr>
<tr><th id="2395">2395</th><td>		<b>if</b> (err)</td></tr>
<tr><th id="2396">2396</th><td>			<b>goto</b> out_cancel;</td></tr>
<tr><th id="2397">2397</th><td>	}</td></tr>
<tr><th id="2398">2398</th><td>	err = copy_to_user_policy_type(type, skb);</td></tr>
<tr><th id="2399">2399</th><td>	<b>if</b> (err)</td></tr>
<tr><th id="2400">2400</th><td>		<b>goto</b> out_cancel;</td></tr>
<tr><th id="2401">2401</th><td>	<b>for</b> (i = <var>0</var>, mp = m ; i &lt; num_migrate; i++, mp++) {</td></tr>
<tr><th id="2402">2402</th><td>		err = copy_to_user_migrate(mp, skb);</td></tr>
<tr><th id="2403">2403</th><td>		<b>if</b> (err)</td></tr>
<tr><th id="2404">2404</th><td>			<b>goto</b> out_cancel;</td></tr>
<tr><th id="2405">2405</th><td>	}</td></tr>
<tr><th id="2406">2406</th><td></td></tr>
<tr><th id="2407">2407</th><td>	nlmsg_end(skb, nlh);</td></tr>
<tr><th id="2408">2408</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2409">2409</th><td></td></tr>
<tr><th id="2410">2410</th><td>out_cancel:</td></tr>
<tr><th id="2411">2411</th><td>	nlmsg_cancel(skb, nlh);</td></tr>
<tr><th id="2412">2412</th><td>	<b>return</b> err;</td></tr>
<tr><th id="2413">2413</th><td>}</td></tr>
<tr><th id="2414">2414</th><td></td></tr>
<tr><th id="2415">2415</th><td><em>static</em> <em>int</em> xfrm_send_migrate(<em>const</em> <b>struct</b> xfrm_selector *sel, u8 dir, u8 type,</td></tr>
<tr><th id="2416">2416</th><td>			     <em>const</em> <b>struct</b> xfrm_migrate *m, <em>int</em> num_migrate,</td></tr>
<tr><th id="2417">2417</th><td>			     <em>const</em> <b>struct</b> xfrm_kmaddress *k,</td></tr>
<tr><th id="2418">2418</th><td>			     <em>const</em> <b>struct</b> xfrm_encap_tmpl *encap)</td></tr>
<tr><th id="2419">2419</th><td>{</td></tr>
<tr><th id="2420">2420</th><td>	<b>struct</b> net *net = &amp;init_net;</td></tr>
<tr><th id="2421">2421</th><td>	<b>struct</b> sk_buff *skb;</td></tr>
<tr><th id="2422">2422</th><td>	<em>int</em> err;</td></tr>
<tr><th id="2423">2423</th><td></td></tr>
<tr><th id="2424">2424</th><td>	skb = nlmsg_new(xfrm_migrate_msgsize(num_migrate, !!k, !!encap),</td></tr>
<tr><th id="2425">2425</th><td>			GFP_ATOMIC);</td></tr>
<tr><th id="2426">2426</th><td>	<b>if</b> (skb == NULL)</td></tr>
<tr><th id="2427">2427</th><td>		<b>return</b> -ENOMEM;</td></tr>
<tr><th id="2428">2428</th><td></td></tr>
<tr><th id="2429">2429</th><td>	<i>/* build migrate */</i></td></tr>
<tr><th id="2430">2430</th><td>	err = build_migrate(skb, m, num_migrate, k, sel, encap, dir, type);</td></tr>
<tr><th id="2431">2431</th><td>	BUG_ON(err &lt; <var>0</var>);</td></tr>
<tr><th id="2432">2432</th><td></td></tr>
<tr><th id="2433">2433</th><td>	<b>return</b> xfrm_nlmsg_multicast(net, skb, <var>0</var>, XFRMNLGRP_MIGRATE);</td></tr>
<tr><th id="2434">2434</th><td>}</td></tr>
<tr><th id="2435">2435</th><td><u>#<span data-ppcond="2326">else</span></u></td></tr>
<tr><th id="2436">2436</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_send_migrate" title='xfrm_send_migrate' data-type='int xfrm_send_migrate(const struct xfrm_selector * sel, u8 dir, u8 type, const struct xfrm_migrate * m, int num_migrate, const struct xfrm_kmaddress * k, const struct xfrm_encap_tmpl * encap)' data-ref="xfrm_send_migrate" data-ref-filename="xfrm_send_migrate">xfrm_send_migrate</dfn>(<em>const</em> <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector" title='xfrm_selector' data-ref="xfrm_selector" data-ref-filename="xfrm_selector">xfrm_selector</a> *<dfn class="local col6 decl" id="446sel" title='sel' data-type='const struct xfrm_selector *' data-ref="446sel" data-ref-filename="446sel">sel</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col7 decl" id="447dir" title='dir' data-type='u8' data-ref="447dir" data-ref-filename="447dir">dir</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col8 decl" id="448type" title='type' data-type='u8' data-ref="448type" data-ref-filename="448type">type</dfn>,</td></tr>
<tr><th id="2437">2437</th><td>			     <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_migrate" title='xfrm_migrate' data-ref="xfrm_migrate" data-ref-filename="xfrm_migrate">xfrm_migrate</a> *<dfn class="local col9 decl" id="449m" title='m' data-type='const struct xfrm_migrate *' data-ref="449m" data-ref-filename="449m">m</dfn>, <em>int</em> <dfn class="local col0 decl" id="450num_migrate" title='num_migrate' data-type='int' data-ref="450num_migrate" data-ref-filename="450num_migrate">num_migrate</dfn>,</td></tr>
<tr><th id="2438">2438</th><td>			     <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_kmaddress" title='xfrm_kmaddress' data-ref="xfrm_kmaddress" data-ref-filename="xfrm_kmaddress">xfrm_kmaddress</a> *<dfn class="local col1 decl" id="451k" title='k' data-type='const struct xfrm_kmaddress *' data-ref="451k" data-ref-filename="451k">k</dfn>,</td></tr>
<tr><th id="2439">2439</th><td>			     <em>const</em> <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_encap_tmpl" title='xfrm_encap_tmpl' data-ref="xfrm_encap_tmpl" data-ref-filename="xfrm_encap_tmpl">xfrm_encap_tmpl</a> *<dfn class="local col2 decl" id="452encap" title='encap' data-type='const struct xfrm_encap_tmpl *' data-ref="452encap" data-ref-filename="452encap">encap</dfn>)</td></tr>
<tr><th id="2440">2440</th><td>{</td></tr>
<tr><th id="2441">2441</th><td>	<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#75" title="92" data-ref="_M/ENOPROTOOPT">ENOPROTOOPT</a>;</td></tr>
<tr><th id="2442">2442</th><td>}</td></tr>
<tr><th id="2443">2443</th><td><u>#<span data-ppcond="2326">endif</span></u></td></tr>
<tr><th id="2444">2444</th><td></td></tr>
<tr><th id="2445">2445</th><td><u>#define <dfn class="macro" id="_M/XMSGSIZE" data-ref="_M/XMSGSIZE">XMSGSIZE</dfn>(type) sizeof(struct type)</u></td></tr>
<tr><th id="2446">2446</th><td></td></tr>
<tr><th id="2447">2447</th><td><em>static</em> <em>const</em> <em>int</em> <dfn class="tu decl def" id="xfrm_msg_min" title='xfrm_msg_min' data-type='const int [23]' data-ref="xfrm_msg_min" data-ref-filename="xfrm_msg_min">xfrm_msg_min</dfn>[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#222" title="((__XFRM_MSG_MAX - 1) + 1 - XFRM_MSG_BASE)" data-ref="_M/XFRM_NR_MSGTYPES">XFRM_NR_MSGTYPES</a>] = {</td></tr>
<tr><th id="2448">2448</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#162" title="XFRM_MSG_NEWSA" data-ref="_M/XFRM_MSG_NEWSA">XFRM_MSG_NEWSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_usersa_info)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a>),</td></tr>
<tr><th id="2449">2449</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#164" title="XFRM_MSG_DELSA" data-ref="_M/XFRM_MSG_DELSA">XFRM_MSG_DELSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_usersa_id)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id" title='xfrm_usersa_id' data-ref="xfrm_usersa_id" data-ref-filename="xfrm_usersa_id">xfrm_usersa_id</a>),</td></tr>
<tr><th id="2450">2450</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#166" title="XFRM_MSG_GETSA" data-ref="_M/XFRM_MSG_GETSA">XFRM_MSG_GETSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_usersa_id)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id" title='xfrm_usersa_id' data-ref="xfrm_usersa_id" data-ref-filename="xfrm_usersa_id">xfrm_usersa_id</a>),</td></tr>
<tr><th id="2451">2451</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#169" title="XFRM_MSG_NEWPOLICY" data-ref="_M/XFRM_MSG_NEWPOLICY">XFRM_MSG_NEWPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_userpolicy_info)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a>),</td></tr>
<tr><th id="2452">2452</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#171" title="XFRM_MSG_DELPOLICY" data-ref="_M/XFRM_MSG_DELPOLICY">XFRM_MSG_DELPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_userpolicy_id)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id" title='xfrm_userpolicy_id' data-ref="xfrm_userpolicy_id" data-ref-filename="xfrm_userpolicy_id">xfrm_userpolicy_id</a>),</td></tr>
<tr><th id="2453">2453</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#173" title="XFRM_MSG_GETPOLICY" data-ref="_M/XFRM_MSG_GETPOLICY">XFRM_MSG_GETPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_userpolicy_id)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id" title='xfrm_userpolicy_id' data-ref="xfrm_userpolicy_id" data-ref-filename="xfrm_userpolicy_id">xfrm_userpolicy_id</a>),</td></tr>
<tr><th id="2454">2454</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#176" title="XFRM_MSG_ALLOCSPI" data-ref="_M/XFRM_MSG_ALLOCSPI">XFRM_MSG_ALLOCSPI</a>    - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_userspi_info)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userspi_info" title='xfrm_userspi_info' data-ref="xfrm_userspi_info" data-ref-filename="xfrm_userspi_info">xfrm_userspi_info</a>),</td></tr>
<tr><th id="2455">2455</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#178" title="XFRM_MSG_ACQUIRE" data-ref="_M/XFRM_MSG_ACQUIRE">XFRM_MSG_ACQUIRE</a>     - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_user_acquire)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire" title='xfrm_user_acquire' data-ref="xfrm_user_acquire" data-ref-filename="xfrm_user_acquire">xfrm_user_acquire</a>),</td></tr>
<tr><th id="2456">2456</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#180" title="XFRM_MSG_EXPIRE" data-ref="_M/XFRM_MSG_EXPIRE">XFRM_MSG_EXPIRE</a>      - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_user_expire)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire" title='xfrm_user_expire' data-ref="xfrm_user_expire" data-ref-filename="xfrm_user_expire">xfrm_user_expire</a>),</td></tr>
<tr><th id="2457">2457</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#183" title="XFRM_MSG_UPDPOLICY" data-ref="_M/XFRM_MSG_UPDPOLICY">XFRM_MSG_UPDPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_userpolicy_info)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a>),</td></tr>
<tr><th id="2458">2458</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#185" title="XFRM_MSG_UPDSA" data-ref="_M/XFRM_MSG_UPDSA">XFRM_MSG_UPDSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_usersa_info)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a>),</td></tr>
<tr><th id="2459">2459</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#188" title="XFRM_MSG_POLEXPIRE" data-ref="_M/XFRM_MSG_POLEXPIRE">XFRM_MSG_POLEXPIRE</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_user_polexpire)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire" title='xfrm_user_polexpire' data-ref="xfrm_user_polexpire" data-ref-filename="xfrm_user_polexpire">xfrm_user_polexpire</a>),</td></tr>
<tr><th id="2460">2460</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#191" title="XFRM_MSG_FLUSHSA" data-ref="_M/XFRM_MSG_FLUSHSA">XFRM_MSG_FLUSHSA</a>     - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_usersa_flush)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_flush" title='xfrm_usersa_flush' data-ref="xfrm_usersa_flush" data-ref-filename="xfrm_usersa_flush">xfrm_usersa_flush</a>),</td></tr>
<tr><th id="2461">2461</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#193" title="XFRM_MSG_FLUSHPOLICY" data-ref="_M/XFRM_MSG_FLUSHPOLICY">XFRM_MSG_FLUSHPOLICY</a> - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <var>0</var>,</td></tr>
<tr><th id="2462">2462</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#196" title="XFRM_MSG_NEWAE" data-ref="_M/XFRM_MSG_NEWAE">XFRM_MSG_NEWAE</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_aevent_id)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id" title='xfrm_aevent_id' data-ref="xfrm_aevent_id" data-ref-filename="xfrm_aevent_id">xfrm_aevent_id</a>),</td></tr>
<tr><th id="2463">2463</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#198" title="XFRM_MSG_GETAE" data-ref="_M/XFRM_MSG_GETAE">XFRM_MSG_GETAE</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_aevent_id)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_aevent_id" title='xfrm_aevent_id' data-ref="xfrm_aevent_id" data-ref-filename="xfrm_aevent_id">xfrm_aevent_id</a>),</td></tr>
<tr><th id="2464">2464</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#201" title="XFRM_MSG_REPORT" data-ref="_M/XFRM_MSG_REPORT">XFRM_MSG_REPORT</a>      - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_user_report)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_report" title='xfrm_user_report' data-ref="xfrm_user_report" data-ref-filename="xfrm_user_report">xfrm_user_report</a>),</td></tr>
<tr><th id="2465">2465</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#204" title="XFRM_MSG_MIGRATE" data-ref="_M/XFRM_MSG_MIGRATE">XFRM_MSG_MIGRATE</a>     - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <a class="macro" href="#2445" title="sizeof(struct xfrm_userpolicy_id)" data-ref="_M/XMSGSIZE">XMSGSIZE</a>(<a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id" title='xfrm_userpolicy_id' data-ref="xfrm_userpolicy_id" data-ref-filename="xfrm_userpolicy_id">xfrm_userpolicy_id</a>),</td></tr>
<tr><th id="2466">2466</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#209" title="XFRM_MSG_GETSADINFO" data-ref="_M/XFRM_MSG_GETSADINFO">XFRM_MSG_GETSADINFO</a>  - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <b>sizeof</b>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a>),</td></tr>
<tr><th id="2467">2467</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#212" title="XFRM_MSG_NEWSPDINFO" data-ref="_M/XFRM_MSG_NEWSPDINFO">XFRM_MSG_NEWSPDINFO</a>  - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <b>sizeof</b>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a>),</td></tr>
<tr><th id="2468">2468</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#214" title="XFRM_MSG_GETSPDINFO" data-ref="_M/XFRM_MSG_GETSPDINFO">XFRM_MSG_GETSPDINFO</a>  - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = <b>sizeof</b>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='unsigned int' data-ref="u32" data-ref-filename="u32">u32</a>),</td></tr>
<tr><th id="2469">2469</th><td>};</td></tr>
<tr><th id="2470">2470</th><td></td></tr>
<tr><th id="2471">2471</th><td><u>#undef <a class="macro" href="#2445" data-ref="_M/XMSGSIZE">XMSGSIZE</a></u></td></tr>
<tr><th id="2472">2472</th><td></td></tr>
<tr><th id="2473">2473</th><td><em>static</em> <em>const</em> <b>struct</b> <a class="type" href="../../include/net/netlink.h.html#nla_policy" title='nla_policy' data-ref="nla_policy" data-ref-filename="nla_policy">nla_policy</a> <dfn class="tu decl def" id="xfrma_policy" title='xfrma_policy' data-type='const struct nla_policy [30]' data-ref="xfrma_policy" data-ref-filename="xfrma_policy">xfrma_policy</dfn>[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#311" title="(__XFRMA_MAX - 1)" data-ref="_M/XFRMA_MAX">XFRMA_MAX</a>+<var>1</var>] = {</td></tr>
<tr><th id="2474">2474</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SA" title='XFRMA_SA' data-ref="XFRMA_SA" data-ref-filename="XFRMA_SA">XFRMA_SA</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a>)},</td></tr>
<tr><th id="2475">2475</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_POLICY" title='XFRMA_POLICY' data-ref="XFRMA_POLICY" data-ref-filename="XFRMA_POLICY">XFRMA_POLICY</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a>)},</td></tr>
<tr><th id="2476">2476</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_LASTUSED" title='XFRMA_LASTUSED' data-ref="XFRMA_LASTUSED" data-ref-filename="XFRMA_LASTUSED">XFRMA_LASTUSED</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::type" title='nla_policy::type' data-ref="nla_policy::type" data-ref-filename="nla_policy..type">type</a> = <a class="enum" href="../../include/net/netlink.h.html#NLA_U64" title='NLA_U64' data-ref="NLA_U64" data-ref-filename="NLA_U64">NLA_U64</a>},</td></tr>
<tr><th id="2477">2477</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH_TRUNC" title='XFRMA_ALG_AUTH_TRUNC' data-ref="XFRMA_ALG_AUTH_TRUNC" data-ref-filename="XFRMA_ALG_AUTH_TRUNC">XFRMA_ALG_AUTH_TRUNC</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth" title='xfrm_algo_auth' data-ref="xfrm_algo_auth" data-ref-filename="xfrm_algo_auth">xfrm_algo_auth</a>)},</td></tr>
<tr><th id="2478">2478</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AEAD" title='XFRMA_ALG_AEAD' data-ref="XFRMA_ALG_AEAD" data-ref-filename="XFRMA_ALG_AEAD">XFRMA_ALG_AEAD</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_aead" title='xfrm_algo_aead' data-ref="xfrm_algo_aead" data-ref-filename="xfrm_algo_aead">xfrm_algo_aead</a>) },</td></tr>
<tr><th id="2479">2479</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_AUTH" title='XFRMA_ALG_AUTH' data-ref="XFRMA_ALG_AUTH" data-ref-filename="XFRMA_ALG_AUTH">XFRMA_ALG_AUTH</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a>) },</td></tr>
<tr><th id="2480">2480</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_CRYPT" title='XFRMA_ALG_CRYPT' data-ref="XFRMA_ALG_CRYPT" data-ref-filename="XFRMA_ALG_CRYPT">XFRMA_ALG_CRYPT</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a>) },</td></tr>
<tr><th id="2481">2481</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ALG_COMP" title='XFRMA_ALG_COMP' data-ref="XFRMA_ALG_COMP" data-ref-filename="XFRMA_ALG_COMP">XFRMA_ALG_COMP</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a>) },</td></tr>
<tr><th id="2482">2482</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ENCAP" title='XFRMA_ENCAP' data-ref="XFRMA_ENCAP" data-ref-filename="XFRMA_ENCAP">XFRMA_ENCAP</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_encap_tmpl" title='xfrm_encap_tmpl' data-ref="xfrm_encap_tmpl" data-ref-filename="xfrm_encap_tmpl">xfrm_encap_tmpl</a>) },</td></tr>
<tr><th id="2483">2483</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TMPL" title='XFRMA_TMPL' data-ref="XFRMA_TMPL" data-ref-filename="XFRMA_TMPL">XFRMA_TMPL</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a>) },</td></tr>
<tr><th id="2484">2484</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SEC_CTX" title='XFRMA_SEC_CTX' data-ref="XFRMA_SEC_CTX" data-ref-filename="XFRMA_SEC_CTX">XFRMA_SEC_CTX</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx" title='xfrm_sec_ctx' data-ref="xfrm_sec_ctx" data-ref-filename="xfrm_sec_ctx">xfrm_sec_ctx</a>) },</td></tr>
<tr><th id="2485">2485</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_LTIME_VAL" title='XFRMA_LTIME_VAL' data-ref="XFRMA_LTIME_VAL" data-ref-filename="XFRMA_LTIME_VAL">XFRMA_LTIME_VAL</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_lifetime_cur" title='xfrm_lifetime_cur' data-ref="xfrm_lifetime_cur" data-ref-filename="xfrm_lifetime_cur">xfrm_lifetime_cur</a>) },</td></tr>
<tr><th id="2486">2486</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_VAL" title='XFRMA_REPLAY_VAL' data-ref="XFRMA_REPLAY_VAL" data-ref-filename="XFRMA_REPLAY_VAL">XFRMA_REPLAY_VAL</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state" title='xfrm_replay_state' data-ref="xfrm_replay_state" data-ref-filename="xfrm_replay_state">xfrm_replay_state</a>) },</td></tr>
<tr><th id="2487">2487</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_THRESH" title='XFRMA_REPLAY_THRESH' data-ref="XFRMA_REPLAY_THRESH" data-ref-filename="XFRMA_REPLAY_THRESH">XFRMA_REPLAY_THRESH</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::type" title='nla_policy::type' data-ref="nla_policy::type" data-ref-filename="nla_policy..type">type</a> = <a class="enum" href="../../include/net/netlink.h.html#NLA_U32" title='NLA_U32' data-ref="NLA_U32" data-ref-filename="NLA_U32">NLA_U32</a> },</td></tr>
<tr><th id="2488">2488</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ETIMER_THRESH" title='XFRMA_ETIMER_THRESH' data-ref="XFRMA_ETIMER_THRESH" data-ref-filename="XFRMA_ETIMER_THRESH">XFRMA_ETIMER_THRESH</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::type" title='nla_policy::type' data-ref="nla_policy::type" data-ref-filename="nla_policy..type">type</a> = <a class="enum" href="../../include/net/netlink.h.html#NLA_U32" title='NLA_U32' data-ref="NLA_U32" data-ref-filename="NLA_U32">NLA_U32</a> },</td></tr>
<tr><th id="2489">2489</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SRCADDR" title='XFRMA_SRCADDR' data-ref="XFRMA_SRCADDR" data-ref-filename="XFRMA_SRCADDR">XFRMA_SRCADDR</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a>) },</td></tr>
<tr><th id="2490">2490</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_COADDR" title='XFRMA_COADDR' data-ref="XFRMA_COADDR" data-ref-filename="XFRMA_COADDR">XFRMA_COADDR</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a>) },</td></tr>
<tr><th id="2491">2491</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_POLICY_TYPE" title='XFRMA_POLICY_TYPE' data-ref="XFRMA_POLICY_TYPE" data-ref-filename="XFRMA_POLICY_TYPE">XFRMA_POLICY_TYPE</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_type" title='xfrm_userpolicy_type' data-ref="xfrm_userpolicy_type" data-ref-filename="xfrm_userpolicy_type">xfrm_userpolicy_type</a>)},</td></tr>
<tr><th id="2492">2492</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_MIGRATE" title='XFRMA_MIGRATE' data-ref="XFRMA_MIGRATE" data-ref-filename="XFRMA_MIGRATE">XFRMA_MIGRATE</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_migrate" title='xfrm_user_migrate' data-ref="xfrm_user_migrate" data-ref-filename="xfrm_user_migrate">xfrm_user_migrate</a>) },</td></tr>
<tr><th id="2493">2493</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_KMADDRESS" title='XFRMA_KMADDRESS' data-ref="XFRMA_KMADDRESS" data-ref-filename="XFRMA_KMADDRESS">XFRMA_KMADDRESS</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_kmaddress" title='xfrm_user_kmaddress' data-ref="xfrm_user_kmaddress" data-ref-filename="xfrm_user_kmaddress">xfrm_user_kmaddress</a>) },</td></tr>
<tr><th id="2494">2494</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_MARK" title='XFRMA_MARK' data-ref="XFRMA_MARK" data-ref-filename="XFRMA_MARK">XFRMA_MARK</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a>) },</td></tr>
<tr><th id="2495">2495</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_TFCPAD" title='XFRMA_TFCPAD' data-ref="XFRMA_TFCPAD" data-ref-filename="XFRMA_TFCPAD">XFRMA_TFCPAD</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::type" title='nla_policy::type' data-ref="nla_policy::type" data-ref-filename="nla_policy..type">type</a> = <a class="enum" href="../../include/net/netlink.h.html#NLA_U32" title='NLA_U32' data-ref="NLA_U32" data-ref-filename="NLA_U32">NLA_U32</a> },</td></tr>
<tr><th id="2496">2496</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_REPLAY_ESN_VAL" title='XFRMA_REPLAY_ESN_VAL' data-ref="XFRMA_REPLAY_ESN_VAL" data-ref-filename="XFRMA_REPLAY_ESN_VAL">XFRMA_REPLAY_ESN_VAL</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state_esn" title='xfrm_replay_state_esn' data-ref="xfrm_replay_state_esn" data-ref-filename="xfrm_replay_state_esn">xfrm_replay_state_esn</a>) },</td></tr>
<tr><th id="2497">2497</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SA_EXTRA_FLAGS" title='XFRMA_SA_EXTRA_FLAGS' data-ref="XFRMA_SA_EXTRA_FLAGS" data-ref-filename="XFRMA_SA_EXTRA_FLAGS">XFRMA_SA_EXTRA_FLAGS</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::type" title='nla_policy::type' data-ref="nla_policy::type" data-ref-filename="nla_policy..type">type</a> = <a class="enum" href="../../include/net/netlink.h.html#NLA_U32" title='NLA_U32' data-ref="NLA_U32" data-ref-filename="NLA_U32">NLA_U32</a> },</td></tr>
<tr><th id="2498">2498</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_PROTO" title='XFRMA_PROTO' data-ref="XFRMA_PROTO" data-ref-filename="XFRMA_PROTO">XFRMA_PROTO</a>]		= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::type" title='nla_policy::type' data-ref="nla_policy::type" data-ref-filename="nla_policy..type">type</a> = <a class="enum" href="../../include/net/netlink.h.html#NLA_U8" title='NLA_U8' data-ref="NLA_U8" data-ref-filename="NLA_U8">NLA_U8</a> },</td></tr>
<tr><th id="2499">2499</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_ADDRESS_FILTER" title='XFRMA_ADDRESS_FILTER' data-ref="XFRMA_ADDRESS_FILTER" data-ref-filename="XFRMA_ADDRESS_FILTER">XFRMA_ADDRESS_FILTER</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_filter" title='xfrm_address_filter' data-ref="xfrm_address_filter" data-ref-filename="xfrm_address_filter">xfrm_address_filter</a>) },</td></tr>
<tr><th id="2500">2500</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OFFLOAD_DEV" title='XFRMA_OFFLOAD_DEV' data-ref="XFRMA_OFFLOAD_DEV" data-ref-filename="XFRMA_OFFLOAD_DEV">XFRMA_OFFLOAD_DEV</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_offload" title='xfrm_user_offload' data-ref="xfrm_user_offload" data-ref-filename="xfrm_user_offload">xfrm_user_offload</a>) },</td></tr>
<tr><th id="2501">2501</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_OUTPUT_MARK" title='XFRMA_OUTPUT_MARK' data-ref="XFRMA_OUTPUT_MARK" data-ref-filename="XFRMA_OUTPUT_MARK">XFRMA_OUTPUT_MARK</a>]	= { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::type" title='nla_policy::type' data-ref="nla_policy::type" data-ref-filename="nla_policy..type">type</a> = <a class="enum" href="../../include/net/netlink.h.html#NLA_U32" title='NLA_U32' data-ref="NLA_U32" data-ref-filename="NLA_U32">NLA_U32</a> },</td></tr>
<tr><th id="2502">2502</th><td>};</td></tr>
<tr><th id="2503">2503</th><td></td></tr>
<tr><th id="2504">2504</th><td><em>static</em> <em>const</em> <b>struct</b> <a class="type" href="../../include/net/netlink.h.html#nla_policy" title='nla_policy' data-ref="nla_policy" data-ref-filename="nla_policy">nla_policy</a> <dfn class="tu decl def" id="xfrma_spd_policy" title='xfrma_spd_policy' data-type='const struct nla_policy [5]' data-ref="xfrma_spd_policy" data-ref-filename="xfrma_spd_policy">xfrma_spd_policy</dfn>[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#341" title="(__XFRMA_SPD_MAX - 1)" data-ref="_M/XFRMA_SPD_MAX">XFRMA_SPD_MAX</a>+<var>1</var>] = {</td></tr>
<tr><th id="2505">2505</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV4_HTHRESH" title='XFRMA_SPD_IPV4_HTHRESH' data-ref="XFRMA_SPD_IPV4_HTHRESH" data-ref-filename="XFRMA_SPD_IPV4_HTHRESH">XFRMA_SPD_IPV4_HTHRESH</a>] = { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh" title='xfrmu_spdhthresh' data-ref="xfrmu_spdhthresh" data-ref-filename="xfrmu_spdhthresh">xfrmu_spdhthresh</a>) },</td></tr>
<tr><th id="2506">2506</th><td>	[<a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SPD_IPV6_HTHRESH" title='XFRMA_SPD_IPV6_HTHRESH' data-ref="XFRMA_SPD_IPV6_HTHRESH" data-ref-filename="XFRMA_SPD_IPV6_HTHRESH">XFRMA_SPD_IPV6_HTHRESH</a>] = { .<a class="ref field" href="../../include/net/netlink.h.html#nla_policy::len" title='nla_policy::len' data-ref="nla_policy::len" data-ref-filename="nla_policy..len">len</a> = <b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrmu_spdhthresh" title='xfrmu_spdhthresh' data-ref="xfrmu_spdhthresh" data-ref-filename="xfrmu_spdhthresh">xfrmu_spdhthresh</a>) },</td></tr>
<tr><th id="2507">2507</th><td>};</td></tr>
<tr><th id="2508">2508</th><td></td></tr>
<tr><th id="2509">2509</th><td><em>static</em> <em>const</em> <b>struct</b> <dfn class="type def" id="xfrm_link" title='xfrm_link' data-ref="xfrm_link" data-ref-filename="xfrm_link"><a class="type" href="#xfrm_link" title='xfrm_link' data-ref="xfrm_link" data-ref-filename="xfrm_link">xfrm_link</a></dfn> {</td></tr>
<tr><th id="2510">2510</th><td>	<em>int</em> (*<dfn class="tu decl field" id="xfrm_link::doit" title='xfrm_link::doit' data-type='int (*)(struct sk_buff *, struct nlmsghdr *, struct nlattr **)' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</dfn>)(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> **);</td></tr>
<tr><th id="2511">2511</th><td>	<em>int</em> (*<dfn class="tu decl field" id="xfrm_link::start" title='xfrm_link::start' data-type='int (*)(struct netlink_callback *)' data-ref="xfrm_link::start" data-ref-filename="xfrm_link..start">start</dfn>)(<b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *);</td></tr>
<tr><th id="2512">2512</th><td>	<em>int</em> (*<dfn class="tu decl field" id="xfrm_link::dump" title='xfrm_link::dump' data-type='int (*)(struct sk_buff *, struct netlink_callback *)' data-ref="xfrm_link::dump" data-ref-filename="xfrm_link..dump">dump</dfn>)(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *, <b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *);</td></tr>
<tr><th id="2513">2513</th><td>	<em>int</em> (*<dfn class="tu decl field" id="xfrm_link::done" title='xfrm_link::done' data-type='int (*)(struct netlink_callback *)' data-ref="xfrm_link::done" data-ref-filename="xfrm_link..done">done</dfn>)(<b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_callback" title='netlink_callback' data-ref="netlink_callback" data-ref-filename="netlink_callback">netlink_callback</a> *);</td></tr>
<tr><th id="2514">2514</th><td>	<em>const</em> <b>struct</b> <a class="type" href="../../include/net/netlink.h.html#nla_policy" title='nla_policy' data-ref="nla_policy" data-ref-filename="nla_policy">nla_policy</a> *<dfn class="tu decl field" id="xfrm_link::nla_pol" title='xfrm_link::nla_pol' data-type='const struct nla_policy *' data-ref="xfrm_link::nla_pol" data-ref-filename="xfrm_link..nla_pol">nla_pol</dfn>;</td></tr>
<tr><th id="2515">2515</th><td>	<em>int</em> <dfn class="tu decl field" id="xfrm_link::nla_max" title='xfrm_link::nla_max' data-type='int' data-ref="xfrm_link::nla_max" data-ref-filename="xfrm_link..nla_max">nla_max</dfn>;</td></tr>
<tr><th id="2516">2516</th><td>} <dfn class="tu decl def" id="xfrm_dispatch" title='xfrm_dispatch' data-type='const struct xfrm_link [23]' data-ref="xfrm_dispatch" data-ref-filename="xfrm_dispatch">xfrm_dispatch</dfn>[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#222" title="((__XFRM_MSG_MAX - 1) + 1 - XFRM_MSG_BASE)" data-ref="_M/XFRM_NR_MSGTYPES">XFRM_NR_MSGTYPES</a>] = {</td></tr>
<tr><th id="2517">2517</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#162" title="XFRM_MSG_NEWSA" data-ref="_M/XFRM_MSG_NEWSA">XFRM_MSG_NEWSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_add_sa" title='xfrm_add_sa' data-ref="xfrm_add_sa" data-ref-filename="xfrm_add_sa">xfrm_add_sa</a>        },</td></tr>
<tr><th id="2518">2518</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#164" title="XFRM_MSG_DELSA" data-ref="_M/XFRM_MSG_DELSA">XFRM_MSG_DELSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_del_sa" title='xfrm_del_sa' data-ref="xfrm_del_sa" data-ref-filename="xfrm_del_sa">xfrm_del_sa</a>        },</td></tr>
<tr><th id="2519">2519</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#166" title="XFRM_MSG_GETSA" data-ref="_M/XFRM_MSG_GETSA">XFRM_MSG_GETSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_get_sa" title='xfrm_get_sa' data-ref="xfrm_get_sa" data-ref-filename="xfrm_get_sa">xfrm_get_sa</a>,</td></tr>
<tr><th id="2520">2520</th><td>						   .<a class="tu ref field" href="#xfrm_link::dump" title='xfrm_link::dump' data-use='w' data-ref="xfrm_link::dump" data-ref-filename="xfrm_link..dump">dump</a> = <a class="tu ref fn" href="#xfrm_dump_sa" title='xfrm_dump_sa' data-ref="xfrm_dump_sa" data-ref-filename="xfrm_dump_sa">xfrm_dump_sa</a>,</td></tr>
<tr><th id="2521">2521</th><td>						   .<a class="tu ref field" href="#xfrm_link::done" title='xfrm_link::done' data-use='w' data-ref="xfrm_link::done" data-ref-filename="xfrm_link..done">done</a> = <a class="tu ref fn" href="#xfrm_dump_sa_done" title='xfrm_dump_sa_done' data-ref="xfrm_dump_sa_done" data-ref-filename="xfrm_dump_sa_done">xfrm_dump_sa_done</a>  },</td></tr>
<tr><th id="2522">2522</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#169" title="XFRM_MSG_NEWPOLICY" data-ref="_M/XFRM_MSG_NEWPOLICY">XFRM_MSG_NEWPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_add_policy" title='xfrm_add_policy' data-ref="xfrm_add_policy" data-ref-filename="xfrm_add_policy">xfrm_add_policy</a>    },</td></tr>
<tr><th id="2523">2523</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#171" title="XFRM_MSG_DELPOLICY" data-ref="_M/XFRM_MSG_DELPOLICY">XFRM_MSG_DELPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_get_policy" title='xfrm_get_policy' data-ref="xfrm_get_policy" data-ref-filename="xfrm_get_policy">xfrm_get_policy</a>    },</td></tr>
<tr><th id="2524">2524</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#173" title="XFRM_MSG_GETPOLICY" data-ref="_M/XFRM_MSG_GETPOLICY">XFRM_MSG_GETPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_get_policy" title='xfrm_get_policy' data-ref="xfrm_get_policy" data-ref-filename="xfrm_get_policy">xfrm_get_policy</a>,</td></tr>
<tr><th id="2525">2525</th><td>						   .<a class="tu ref field" href="#xfrm_link::start" title='xfrm_link::start' data-use='w' data-ref="xfrm_link::start" data-ref-filename="xfrm_link..start">start</a> = <a class="tu ref fn" href="#xfrm_dump_policy_start" title='xfrm_dump_policy_start' data-ref="xfrm_dump_policy_start" data-ref-filename="xfrm_dump_policy_start">xfrm_dump_policy_start</a>,</td></tr>
<tr><th id="2526">2526</th><td>						   .<a class="tu ref field" href="#xfrm_link::dump" title='xfrm_link::dump' data-use='w' data-ref="xfrm_link::dump" data-ref-filename="xfrm_link..dump">dump</a> = <a class="tu ref fn" href="#xfrm_dump_policy" title='xfrm_dump_policy' data-ref="xfrm_dump_policy" data-ref-filename="xfrm_dump_policy">xfrm_dump_policy</a>,</td></tr>
<tr><th id="2527">2527</th><td>						   .<a class="tu ref field" href="#xfrm_link::done" title='xfrm_link::done' data-use='w' data-ref="xfrm_link::done" data-ref-filename="xfrm_link..done">done</a> = <a class="tu ref fn" href="#xfrm_dump_policy_done" title='xfrm_dump_policy_done' data-ref="xfrm_dump_policy_done" data-ref-filename="xfrm_dump_policy_done">xfrm_dump_policy_done</a> },</td></tr>
<tr><th id="2528">2528</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#176" title="XFRM_MSG_ALLOCSPI" data-ref="_M/XFRM_MSG_ALLOCSPI">XFRM_MSG_ALLOCSPI</a>    - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_alloc_userspi" title='xfrm_alloc_userspi' data-ref="xfrm_alloc_userspi" data-ref-filename="xfrm_alloc_userspi">xfrm_alloc_userspi</a> },</td></tr>
<tr><th id="2529">2529</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#178" title="XFRM_MSG_ACQUIRE" data-ref="_M/XFRM_MSG_ACQUIRE">XFRM_MSG_ACQUIRE</a>     - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_add_acquire" title='xfrm_add_acquire' data-ref="xfrm_add_acquire" data-ref-filename="xfrm_add_acquire">xfrm_add_acquire</a>   },</td></tr>
<tr><th id="2530">2530</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#180" title="XFRM_MSG_EXPIRE" data-ref="_M/XFRM_MSG_EXPIRE">XFRM_MSG_EXPIRE</a>      - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_add_sa_expire" title='xfrm_add_sa_expire' data-ref="xfrm_add_sa_expire" data-ref-filename="xfrm_add_sa_expire">xfrm_add_sa_expire</a> },</td></tr>
<tr><th id="2531">2531</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#183" title="XFRM_MSG_UPDPOLICY" data-ref="_M/XFRM_MSG_UPDPOLICY">XFRM_MSG_UPDPOLICY</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_add_policy" title='xfrm_add_policy' data-ref="xfrm_add_policy" data-ref-filename="xfrm_add_policy">xfrm_add_policy</a>    },</td></tr>
<tr><th id="2532">2532</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#185" title="XFRM_MSG_UPDSA" data-ref="_M/XFRM_MSG_UPDSA">XFRM_MSG_UPDSA</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_add_sa" title='xfrm_add_sa' data-ref="xfrm_add_sa" data-ref-filename="xfrm_add_sa">xfrm_add_sa</a>        },</td></tr>
<tr><th id="2533">2533</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#188" title="XFRM_MSG_POLEXPIRE" data-ref="_M/XFRM_MSG_POLEXPIRE">XFRM_MSG_POLEXPIRE</a>   - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_add_pol_expire" title='xfrm_add_pol_expire' data-ref="xfrm_add_pol_expire" data-ref-filename="xfrm_add_pol_expire">xfrm_add_pol_expire</a>},</td></tr>
<tr><th id="2534">2534</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#191" title="XFRM_MSG_FLUSHSA" data-ref="_M/XFRM_MSG_FLUSHSA">XFRM_MSG_FLUSHSA</a>     - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_flush_sa" title='xfrm_flush_sa' data-ref="xfrm_flush_sa" data-ref-filename="xfrm_flush_sa">xfrm_flush_sa</a>      },</td></tr>
<tr><th id="2535">2535</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#193" title="XFRM_MSG_FLUSHPOLICY" data-ref="_M/XFRM_MSG_FLUSHPOLICY">XFRM_MSG_FLUSHPOLICY</a> - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_flush_policy" title='xfrm_flush_policy' data-ref="xfrm_flush_policy" data-ref-filename="xfrm_flush_policy">xfrm_flush_policy</a>  },</td></tr>
<tr><th id="2536">2536</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#196" title="XFRM_MSG_NEWAE" data-ref="_M/XFRM_MSG_NEWAE">XFRM_MSG_NEWAE</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_new_ae" title='xfrm_new_ae' data-ref="xfrm_new_ae" data-ref-filename="xfrm_new_ae">xfrm_new_ae</a>  },</td></tr>
<tr><th id="2537">2537</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#198" title="XFRM_MSG_GETAE" data-ref="_M/XFRM_MSG_GETAE">XFRM_MSG_GETAE</a>       - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_get_ae" title='xfrm_get_ae' data-ref="xfrm_get_ae" data-ref-filename="xfrm_get_ae">xfrm_get_ae</a>  },</td></tr>
<tr><th id="2538">2538</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#204" title="XFRM_MSG_MIGRATE" data-ref="_M/XFRM_MSG_MIGRATE">XFRM_MSG_MIGRATE</a>     - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_do_migrate" title='xfrm_do_migrate' data-ref="xfrm_do_migrate" data-ref-filename="xfrm_do_migrate">xfrm_do_migrate</a>    },</td></tr>
<tr><th id="2539">2539</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#209" title="XFRM_MSG_GETSADINFO" data-ref="_M/XFRM_MSG_GETSADINFO">XFRM_MSG_GETSADINFO</a>  - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_get_sadinfo" title='xfrm_get_sadinfo' data-ref="xfrm_get_sadinfo" data-ref-filename="xfrm_get_sadinfo">xfrm_get_sadinfo</a>   },</td></tr>
<tr><th id="2540">2540</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#212" title="XFRM_MSG_NEWSPDINFO" data-ref="_M/XFRM_MSG_NEWSPDINFO">XFRM_MSG_NEWSPDINFO</a>  - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_set_spdinfo" title='xfrm_set_spdinfo' data-ref="xfrm_set_spdinfo" data-ref-filename="xfrm_set_spdinfo">xfrm_set_spdinfo</a>,</td></tr>
<tr><th id="2541">2541</th><td>						   .<a class="tu ref field" href="#xfrm_link::nla_pol" title='xfrm_link::nla_pol' data-use='w' data-ref="xfrm_link::nla_pol" data-ref-filename="xfrm_link..nla_pol">nla_pol</a> = <a class="tu ref" href="#xfrma_spd_policy" title='xfrma_spd_policy' data-ref="xfrma_spd_policy" data-ref-filename="xfrma_spd_policy">xfrma_spd_policy</a>,</td></tr>
<tr><th id="2542">2542</th><td>						   .<a class="tu ref field" href="#xfrm_link::nla_max" title='xfrm_link::nla_max' data-use='w' data-ref="xfrm_link::nla_max" data-ref-filename="xfrm_link..nla_max">nla_max</a> = <a class="macro" href="../../include/uapi/linux/xfrm.h.html#341" title="(__XFRMA_SPD_MAX - 1)" data-ref="_M/XFRMA_SPD_MAX">XFRMA_SPD_MAX</a> },</td></tr>
<tr><th id="2543">2543</th><td>	[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#214" title="XFRM_MSG_GETSPDINFO" data-ref="_M/XFRM_MSG_GETSPDINFO">XFRM_MSG_GETSPDINFO</a>  - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>] = { .<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='w' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> = <a class="tu ref fn" href="#xfrm_get_spdinfo" title='xfrm_get_spdinfo' data-ref="xfrm_get_spdinfo" data-ref-filename="xfrm_get_spdinfo">xfrm_get_spdinfo</a>   },</td></tr>
<tr><th id="2544">2544</th><td>};</td></tr>
<tr><th id="2545">2545</th><td></td></tr>
<tr><th id="2546">2546</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_user_rcv_msg" title='xfrm_user_rcv_msg' data-type='int xfrm_user_rcv_msg(struct sk_buff * skb, struct nlmsghdr * nlh, struct netlink_ext_ack * extack)' data-ref="xfrm_user_rcv_msg" data-ref-filename="xfrm_user_rcv_msg">xfrm_user_rcv_msg</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="453skb" title='skb' data-type='struct sk_buff *' data-ref="453skb" data-ref-filename="453skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col4 decl" id="454nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="454nlh" data-ref-filename="454nlh">nlh</dfn>,</td></tr>
<tr><th id="2547">2547</th><td>			     <b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_ext_ack" title='netlink_ext_ack' data-ref="netlink_ext_ack" data-ref-filename="netlink_ext_ack">netlink_ext_ack</a> *<dfn class="local col5 decl" id="455extack" title='extack' data-type='struct netlink_ext_ack *' data-ref="455extack" data-ref-filename="455extack">extack</dfn>)</td></tr>
<tr><th id="2548">2548</th><td>{</td></tr>
<tr><th id="2549">2549</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col6 decl" id="456net" title='net' data-type='struct net *' data-ref="456net" data-ref-filename="456net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col3 ref" href="#453skb" title='skb' data-ref="453skb" data-ref-filename="453skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="2550">2550</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col7 decl" id="457attrs" title='attrs' data-type='struct nlattr *[30]' data-ref="457attrs" data-ref-filename="457attrs">attrs</dfn>[<a class="macro" href="../../include/uapi/linux/xfrm.h.html#311" title="(__XFRMA_MAX - 1)" data-ref="_M/XFRMA_MAX">XFRMA_MAX</a>+<var>1</var>];</td></tr>
<tr><th id="2551">2551</th><td>	<em>const</em> <b>struct</b> <a class="type" href="#xfrm_link" title='xfrm_link' data-ref="xfrm_link" data-ref-filename="xfrm_link">xfrm_link</a> *<dfn class="local col8 decl" id="458link" title='link' data-type='const struct xfrm_link *' data-ref="458link" data-ref-filename="458link">link</dfn>;</td></tr>
<tr><th id="2552">2552</th><td>	<em>int</em> <dfn class="local col9 decl" id="459type" title='type' data-type='int' data-ref="459type" data-ref-filename="459type">type</dfn>, <dfn class="local col0 decl" id="460err" title='err' data-type='int' data-ref="460err" data-ref-filename="460err">err</dfn>;</td></tr>
<tr><th id="2553">2553</th><td></td></tr>
<tr><th id="2554">2554</th><td><u>#<span data-ppcond="2554">ifdef</span> <a class="macro" href="../../include/generated/autoconf.h.html#80" data-ref="_M/CONFIG_COMPAT">CONFIG_COMPAT</a></u></td></tr>
<tr><th id="2555">2555</th><td>	<b>if</b> (<a class="macro" href="../../arch/x86/include/asm/compat.h.html#332" title="in_compat_syscall" data-ref="_M/in_compat_syscall">in_compat_syscall</a>())</td></tr>
<tr><th id="2556">2556</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#78" title="95" data-ref="_M/EOPNOTSUPP">EOPNOTSUPP</a>;</td></tr>
<tr><th id="2557">2557</th><td><u>#<span data-ppcond="2554">endif</span></u></td></tr>
<tr><th id="2558">2558</th><td></td></tr>
<tr><th id="2559">2559</th><td>	<a class="local col9 ref" href="#459type" title='type' data-ref="459type" data-ref-filename="459type">type</a> = <a class="local col4 ref" href="#454nlh" title='nlh' data-ref="454nlh" data-ref-filename="454nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_type" title='nlmsghdr::nlmsg_type' data-ref="nlmsghdr::nlmsg_type" data-ref-filename="nlmsghdr..nlmsg_type">nlmsg_type</a>;</td></tr>
<tr><th id="2560">2560</th><td>	<b>if</b> (<a class="local col9 ref" href="#459type" title='type' data-ref="459type" data-ref-filename="459type">type</a> &gt; <a class="macro" href="../../include/uapi/linux/xfrm.h.html#220" title="(__XFRM_MSG_MAX - 1)" data-ref="_M/XFRM_MSG_MAX">XFRM_MSG_MAX</a>)</td></tr>
<tr><th id="2561">2561</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="2562">2562</th><td></td></tr>
<tr><th id="2563">2563</th><td>	<a class="local col9 ref" href="#459type" title='type' data-ref="459type" data-ref-filename="459type">type</a> -= <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>;</td></tr>
<tr><th id="2564">2564</th><td>	<a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a> = &amp;<a class="tu ref" href="#xfrm_dispatch" title='xfrm_dispatch' data-use='a' data-ref="xfrm_dispatch" data-ref-filename="xfrm_dispatch">xfrm_dispatch</a>[<a class="local col9 ref" href="#459type" title='type' data-ref="459type" data-ref-filename="459type">type</a>];</td></tr>
<tr><th id="2565">2565</th><td></td></tr>
<tr><th id="2566">2566</th><td>	<i>/* All operations require privileges, even GET */</i></td></tr>
<tr><th id="2567">2567</th><td>	<b>if</b> (!<a class="ref fn" href="../../include/linux/netlink.h.html#netlink_net_capable" title='netlink_net_capable' data-ref="netlink_net_capable" data-ref-filename="netlink_net_capable">netlink_net_capable</a>(<a class="local col3 ref" href="#453skb" title='skb' data-ref="453skb" data-ref-filename="453skb">skb</a>, <a class="macro" href="../../include/uapi/linux/capability.h.html#203" title="12" data-ref="_M/CAP_NET_ADMIN">CAP_NET_ADMIN</a>))</td></tr>
<tr><th id="2568">2568</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#5" title="1" data-ref="_M/EPERM">EPERM</a>;</td></tr>
<tr><th id="2569">2569</th><td></td></tr>
<tr><th id="2570">2570</th><td>	<b>if</b> ((<a class="local col9 ref" href="#459type" title='type' data-ref="459type" data-ref-filename="459type">type</a> == (<a class="macro" href="../../include/uapi/linux/xfrm.h.html#166" title="XFRM_MSG_GETSA" data-ref="_M/XFRM_MSG_GETSA">XFRM_MSG_GETSA</a> - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>) ||</td></tr>
<tr><th id="2571">2571</th><td>	     <a class="local col9 ref" href="#459type" title='type' data-ref="459type" data-ref-filename="459type">type</a> == (<a class="macro" href="../../include/uapi/linux/xfrm.h.html#173" title="XFRM_MSG_GETPOLICY" data-ref="_M/XFRM_MSG_GETPOLICY">XFRM_MSG_GETPOLICY</a> - <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_MSG_BASE" title='XFRM_MSG_BASE' data-ref="XFRM_MSG_BASE" data-ref-filename="XFRM_MSG_BASE">XFRM_MSG_BASE</a>)) &amp;&amp;</td></tr>
<tr><th id="2572">2572</th><td>	    (<a class="local col4 ref" href="#454nlh" title='nlh' data-ref="454nlh" data-ref-filename="454nlh">nlh</a>-&gt;<a class="ref field" href="../../include/uapi/linux/netlink.h.html#nlmsghdr::nlmsg_flags" title='nlmsghdr::nlmsg_flags' data-ref="nlmsghdr::nlmsg_flags" data-ref-filename="nlmsghdr..nlmsg_flags">nlmsg_flags</a> &amp; <a class="macro" href="../../include/uapi/linux/netlink.h.html#65" title="(0x100|0x200)" data-ref="_M/NLM_F_DUMP">NLM_F_DUMP</a>)) {</td></tr>
<tr><th id="2573">2573</th><td>		<b>if</b> (<a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::dump" title='xfrm_link::dump' data-use='r' data-ref="xfrm_link::dump" data-ref-filename="xfrm_link..dump">dump</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2574">2574</th><td>			<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="2575">2575</th><td></td></tr>
<tr><th id="2576">2576</th><td>		{</td></tr>
<tr><th id="2577">2577</th><td>			<b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_dump_control" title='netlink_dump_control' data-ref="netlink_dump_control" data-ref-filename="netlink_dump_control">netlink_dump_control</a> <dfn class="local col1 decl" id="461c" title='c' data-type='struct netlink_dump_control' data-ref="461c" data-ref-filename="461c">c</dfn> = {</td></tr>
<tr><th id="2578">2578</th><td>				.<a class="ref field" href="../../include/linux/netlink.h.html#netlink_dump_control::start" title='netlink_dump_control::start' data-ref="netlink_dump_control::start" data-ref-filename="netlink_dump_control..start">start</a> = <a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::start" title='xfrm_link::start' data-use='r' data-ref="xfrm_link::start" data-ref-filename="xfrm_link..start">start</a>,</td></tr>
<tr><th id="2579">2579</th><td>				.<a class="ref field" href="../../include/linux/netlink.h.html#netlink_dump_control::dump" title='netlink_dump_control::dump' data-ref="netlink_dump_control::dump" data-ref-filename="netlink_dump_control..dump">dump</a> = <a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::dump" title='xfrm_link::dump' data-use='r' data-ref="xfrm_link::dump" data-ref-filename="xfrm_link..dump">dump</a>,</td></tr>
<tr><th id="2580">2580</th><td>				.<a class="ref field" href="../../include/linux/netlink.h.html#netlink_dump_control::done" title='netlink_dump_control::done' data-ref="netlink_dump_control::done" data-ref-filename="netlink_dump_control..done">done</a> = <a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::done" title='xfrm_link::done' data-use='r' data-ref="xfrm_link::done" data-ref-filename="xfrm_link..done">done</a>,</td></tr>
<tr><th id="2581">2581</th><td>			};</td></tr>
<tr><th id="2582">2582</th><td>			<b>return</b> <a class="ref fn" href="../../include/linux/netlink.h.html#netlink_dump_start" title='netlink_dump_start' data-ref="netlink_dump_start" data-ref-filename="netlink_dump_start">netlink_dump_start</a>(<a class="local col6 ref" href="#456net" title='net' data-ref="456net" data-ref-filename="456net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col3 ref" href="#453skb" title='skb' data-ref="453skb" data-ref-filename="453skb">skb</a>, <a class="local col4 ref" href="#454nlh" title='nlh' data-ref="454nlh" data-ref-filename="454nlh">nlh</a>, &amp;<a class="local col1 ref" href="#461c" title='c' data-ref="461c" data-ref-filename="461c">c</a>);</td></tr>
<tr><th id="2583">2583</th><td>		}</td></tr>
<tr><th id="2584">2584</th><td>	}</td></tr>
<tr><th id="2585">2585</th><td></td></tr>
<tr><th id="2586">2586</th><td>	<a class="local col0 ref" href="#460err" title='err' data-ref="460err" data-ref-filename="460err">err</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_parse" title='nlmsg_parse' data-ref="nlmsg_parse" data-ref-filename="nlmsg_parse">nlmsg_parse</a>(<a class="local col4 ref" href="#454nlh" title='nlh' data-ref="454nlh" data-ref-filename="454nlh">nlh</a>, <a class="tu ref" href="#xfrm_msg_min" title='xfrm_msg_min' data-use='r' data-ref="xfrm_msg_min" data-ref-filename="xfrm_msg_min">xfrm_msg_min</a>[<a class="local col9 ref" href="#459type" title='type' data-ref="459type" data-ref-filename="459type">type</a>], <a class="local col7 ref" href="#457attrs" title='attrs' data-ref="457attrs" data-ref-filename="457attrs">attrs</a>,</td></tr>
<tr><th id="2587">2587</th><td>			  <a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::nla_max" title='xfrm_link::nla_max' data-use='r' data-ref="xfrm_link::nla_max" data-ref-filename="xfrm_link..nla_max">nla_max</a> ? : <a class="macro" href="../../include/uapi/linux/xfrm.h.html#311" title="(__XFRMA_MAX - 1)" data-ref="_M/XFRMA_MAX">XFRMA_MAX</a>,</td></tr>
<tr><th id="2588">2588</th><td>			  <a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::nla_pol" title='xfrm_link::nla_pol' data-use='r' data-ref="xfrm_link::nla_pol" data-ref-filename="xfrm_link..nla_pol">nla_pol</a> ? : <a class="tu ref" href="#xfrma_policy" title='xfrma_policy' data-use='r' data-ref="xfrma_policy" data-ref-filename="xfrma_policy">xfrma_policy</a>, <a class="local col5 ref" href="#455extack" title='extack' data-ref="455extack" data-ref-filename="455extack">extack</a>);</td></tr>
<tr><th id="2589">2589</th><td>	<b>if</b> (<a class="local col0 ref" href="#460err" title='err' data-ref="460err" data-ref-filename="460err">err</a> &lt; <var>0</var>)</td></tr>
<tr><th id="2590">2590</th><td>		<b>return</b> <a class="local col0 ref" href="#460err" title='err' data-ref="460err" data-ref-filename="460err">err</a>;</td></tr>
<tr><th id="2591">2591</th><td></td></tr>
<tr><th id="2592">2592</th><td>	<b>if</b> (<a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='r' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2593">2593</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="2594">2594</th><td></td></tr>
<tr><th id="2595">2595</th><td>	<b>return</b> <a class="local col8 ref" href="#458link" title='link' data-ref="458link" data-ref-filename="458link">link</a>-&gt;<a class="tu ref field" href="#xfrm_link::doit" title='xfrm_link::doit' data-use='r' data-ref="xfrm_link::doit" data-ref-filename="xfrm_link..doit">doit</a>(<a class="local col3 ref" href="#453skb" title='skb' data-ref="453skb" data-ref-filename="453skb">skb</a>, <a class="local col4 ref" href="#454nlh" title='nlh' data-ref="454nlh" data-ref-filename="454nlh">nlh</a>, <a class="local col7 ref" href="#457attrs" title='attrs' data-ref="457attrs" data-ref-filename="457attrs">attrs</a>);</td></tr>
<tr><th id="2596">2596</th><td>}</td></tr>
<tr><th id="2597">2597</th><td></td></tr>
<tr><th id="2598">2598</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="xfrm_netlink_rcv" title='xfrm_netlink_rcv' data-type='void xfrm_netlink_rcv(struct sk_buff * skb)' data-ref="xfrm_netlink_rcv" data-ref-filename="xfrm_netlink_rcv">xfrm_netlink_rcv</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col2 decl" id="462skb" title='skb' data-type='struct sk_buff *' data-ref="462skb" data-ref-filename="462skb">skb</dfn>)</td></tr>
<tr><th id="2599">2599</th><td>{</td></tr>
<tr><th id="2600">2600</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col3 decl" id="463net" title='net' data-type='struct net *' data-ref="463net" data-ref-filename="463net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col2 ref" href="#462skb" title='skb' data-ref="462skb" data-ref-filename="462skb">skb</a>-&gt;<a class="ref field" href="../../include/linux/skbuff.h.html#sk_buff::sk" title='sk_buff::sk' data-ref="sk_buff::sk" data-ref-filename="sk_buff..sk">sk</a>);</td></tr>
<tr><th id="2601">2601</th><td></td></tr>
<tr><th id="2602">2602</th><td>	<a class="ref fn" href="../../include/linux/mutex.h.html#mutex_lock" title='mutex_lock' data-ref="mutex_lock" data-ref-filename="mutex_lock">mutex_lock</a>(&amp;<a class="local col3 ref" href="#463net" title='net' data-ref="463net" data-ref-filename="463net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::xfrm_cfg_mutex" title='netns_xfrm::xfrm_cfg_mutex' data-ref="netns_xfrm::xfrm_cfg_mutex" data-ref-filename="netns_xfrm..xfrm_cfg_mutex">xfrm_cfg_mutex</a>);</td></tr>
<tr><th id="2603">2603</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#netlink_rcv_skb" title='netlink_rcv_skb' data-ref="netlink_rcv_skb" data-ref-filename="netlink_rcv_skb">netlink_rcv_skb</a>(<a class="local col2 ref" href="#462skb" title='skb' data-ref="462skb" data-ref-filename="462skb">skb</a>, &amp;<a class="tu ref fn" href="#xfrm_user_rcv_msg" title='xfrm_user_rcv_msg' data-use='a' data-ref="xfrm_user_rcv_msg" data-ref-filename="xfrm_user_rcv_msg">xfrm_user_rcv_msg</a>);</td></tr>
<tr><th id="2604">2604</th><td>	<a class="ref fn" href="../../include/linux/mutex.h.html#mutex_unlock" title='mutex_unlock' data-ref="mutex_unlock" data-ref-filename="mutex_unlock">mutex_unlock</a>(&amp;<a class="local col3 ref" href="#463net" title='net' data-ref="463net" data-ref-filename="463net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::xfrm_cfg_mutex" title='netns_xfrm::xfrm_cfg_mutex' data-ref="netns_xfrm::xfrm_cfg_mutex" data-ref-filename="netns_xfrm..xfrm_cfg_mutex">xfrm_cfg_mutex</a>);</td></tr>
<tr><th id="2605">2605</th><td>}</td></tr>
<tr><th id="2606">2606</th><td></td></tr>
<tr><th id="2607">2607</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_expire_msgsize" title='xfrm_expire_msgsize' data-type='unsigned int xfrm_expire_msgsize()' data-ref="xfrm_expire_msgsize" data-ref-filename="xfrm_expire_msgsize">xfrm_expire_msgsize</dfn>(<em>void</em>)</td></tr>
<tr><th id="2608">2608</th><td>{</td></tr>
<tr><th id="2609">2609</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((sizeof(struct xfrm_user_expire))+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire" title='xfrm_user_expire' data-ref="xfrm_user_expire" data-ref-filename="xfrm_user_expire">xfrm_user_expire</a>))</td></tr>
<tr><th id="2610">2610</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a>));</td></tr>
<tr><th id="2611">2611</th><td>}</td></tr>
<tr><th id="2612">2612</th><td></td></tr>
<tr><th id="2613">2613</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_expire" title='build_expire' data-type='int build_expire(struct sk_buff * skb, struct xfrm_state * x, const struct km_event * c)' data-ref="build_expire" data-ref-filename="build_expire">build_expire</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col4 decl" id="464skb" title='skb' data-type='struct sk_buff *' data-ref="464skb" data-ref-filename="464skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col5 decl" id="465x" title='x' data-type='struct xfrm_state *' data-ref="465x" data-ref-filename="465x">x</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col6 decl" id="466c" title='c' data-type='const struct km_event *' data-ref="466c" data-ref-filename="466c">c</dfn>)</td></tr>
<tr><th id="2614">2614</th><td>{</td></tr>
<tr><th id="2615">2615</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire" title='xfrm_user_expire' data-ref="xfrm_user_expire" data-ref-filename="xfrm_user_expire">xfrm_user_expire</a> *<dfn class="local col7 decl" id="467ue" title='ue' data-type='struct xfrm_user_expire *' data-ref="467ue" data-ref-filename="467ue">ue</dfn>;</td></tr>
<tr><th id="2616">2616</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col8 decl" id="468nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="468nlh" data-ref-filename="468nlh">nlh</dfn>;</td></tr>
<tr><th id="2617">2617</th><td>	<em>int</em> <dfn class="local col9 decl" id="469err" title='err' data-type='int' data-ref="469err" data-ref-filename="469err">err</dfn>;</td></tr>
<tr><th id="2618">2618</th><td></td></tr>
<tr><th id="2619">2619</th><td>	<a class="local col8 ref" href="#468nlh" title='nlh' data-ref="468nlh" data-ref-filename="468nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col4 ref" href="#464skb" title='skb' data-ref="464skb" data-ref-filename="464skb">skb</a>, <a class="local col6 ref" href="#466c" title='c' data-ref="466c" data-ref-filename="466c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#180" title="XFRM_MSG_EXPIRE" data-ref="_M/XFRM_MSG_EXPIRE">XFRM_MSG_EXPIRE</a>, <b>sizeof</b>(*<a class="local col7 ref" href="#467ue" title='ue' data-ref="467ue" data-ref-filename="467ue">ue</a>), <var>0</var>);</td></tr>
<tr><th id="2620">2620</th><td>	<b>if</b> (<a class="local col8 ref" href="#468nlh" title='nlh' data-ref="468nlh" data-ref-filename="468nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2621">2621</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="2622">2622</th><td></td></tr>
<tr><th id="2623">2623</th><td>	<a class="local col7 ref" href="#467ue" title='ue' data-ref="467ue" data-ref-filename="467ue">ue</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col8 ref" href="#468nlh" title='nlh' data-ref="468nlh" data-ref-filename="468nlh">nlh</a>);</td></tr>
<tr><th id="2624">2624</th><td>	<a class="tu ref fn" href="#copy_to_user_state" title='copy_to_user_state' data-use='c' data-ref="copy_to_user_state" data-ref-filename="copy_to_user_state">copy_to_user_state</a>(<a class="local col5 ref" href="#465x" title='x' data-ref="465x" data-ref-filename="465x">x</a>, &amp;<a class="local col7 ref" href="#467ue" title='ue' data-ref="467ue" data-ref-filename="467ue">ue</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire::state" title='xfrm_user_expire::state' data-ref="xfrm_user_expire::state" data-ref-filename="xfrm_user_expire..state">state</a>);</td></tr>
<tr><th id="2625">2625</th><td>	<a class="local col7 ref" href="#467ue" title='ue' data-ref="467ue" data-ref-filename="467ue">ue</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire::hard" title='xfrm_user_expire::hard' data-ref="xfrm_user_expire::hard" data-ref-filename="xfrm_user_expire..hard">hard</a> = (<a class="local col6 ref" href="#466c" title='c' data-ref="466c" data-ref-filename="466c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::hard" title='km_event::(anonymous union)::hard' data-ref="km_event::(anonymous)::hard" data-ref-filename="km_event..(anonymous)..hard">hard</a> != <var>0</var>) ? <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="2626">2626</th><td>	<i>/* clear the padding bytes */</i></td></tr>
<tr><th id="2627">2627</th><td>	<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(&amp;<a class="local col7 ref" href="#467ue" title='ue' data-ref="467ue" data-ref-filename="467ue">ue</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire::hard" title='xfrm_user_expire::hard' data-ref="xfrm_user_expire::hard" data-ref-filename="xfrm_user_expire..hard">hard</a> + <var>1</var>, <var>0</var>, <b>sizeof</b>(*<a class="local col7 ref" href="#467ue" title='ue' data-ref="467ue" data-ref-filename="467ue">ue</a>) - <a class="macro" href="../../include/linux/stddef.h.html#28" title="(__builtin_offsetof(typeof(*ue), hard) + sizeof(((typeof(*ue) *)0)-&gt;hard))" data-ref="_M/offsetofend">offsetofend</a>(<b>typeof</b>(*<a class="local col7 ref" href="#467ue" title='ue' data-ref="467ue" data-ref-filename="467ue">ue</a>), <a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_expire::hard" title='xfrm_user_expire::hard' data-ref="xfrm_user_expire::hard" data-ref-filename="xfrm_user_expire..hard">hard</a>));</td></tr>
<tr><th id="2628">2628</th><td></td></tr>
<tr><th id="2629">2629</th><td>	<a class="local col9 ref" href="#469err" title='err' data-ref="469err" data-ref-filename="469err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_put" title='xfrm_mark_put' data-ref="xfrm_mark_put" data-ref-filename="xfrm_mark_put">xfrm_mark_put</a>(<a class="local col4 ref" href="#464skb" title='skb' data-ref="464skb" data-ref-filename="464skb">skb</a>, &amp;<a class="local col5 ref" href="#465x" title='x' data-ref="465x" data-ref-filename="465x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::mark" title='xfrm_state::mark' data-ref="xfrm_state::mark" data-ref-filename="xfrm_state..mark">mark</a>);</td></tr>
<tr><th id="2630">2630</th><td>	<b>if</b> (<a class="local col9 ref" href="#469err" title='err' data-ref="469err" data-ref-filename="469err">err</a>)</td></tr>
<tr><th id="2631">2631</th><td>		<b>return</b> <a class="local col9 ref" href="#469err" title='err' data-ref="469err" data-ref-filename="469err">err</a>;</td></tr>
<tr><th id="2632">2632</th><td></td></tr>
<tr><th id="2633">2633</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col4 ref" href="#464skb" title='skb' data-ref="464skb" data-ref-filename="464skb">skb</a>, <a class="local col8 ref" href="#468nlh" title='nlh' data-ref="468nlh" data-ref-filename="468nlh">nlh</a>);</td></tr>
<tr><th id="2634">2634</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2635">2635</th><td>}</td></tr>
<tr><th id="2636">2636</th><td></td></tr>
<tr><th id="2637">2637</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_exp_state_notify" title='xfrm_exp_state_notify' data-type='int xfrm_exp_state_notify(struct xfrm_state * x, const struct km_event * c)' data-ref="xfrm_exp_state_notify" data-ref-filename="xfrm_exp_state_notify">xfrm_exp_state_notify</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col0 decl" id="470x" title='x' data-type='struct xfrm_state *' data-ref="470x" data-ref-filename="470x">x</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col1 decl" id="471c" title='c' data-type='const struct km_event *' data-ref="471c" data-ref-filename="471c">c</dfn>)</td></tr>
<tr><th id="2638">2638</th><td>{</td></tr>
<tr><th id="2639">2639</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col2 decl" id="472net" title='net' data-type='struct net *' data-ref="472net" data-ref-filename="472net">net</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xs_net" title='xs_net' data-ref="xs_net" data-ref-filename="xs_net">xs_net</a>(<a class="local col0 ref" href="#470x" title='x' data-ref="470x" data-ref-filename="470x">x</a>);</td></tr>
<tr><th id="2640">2640</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="473skb" title='skb' data-type='struct sk_buff *' data-ref="473skb" data-ref-filename="473skb">skb</dfn>;</td></tr>
<tr><th id="2641">2641</th><td></td></tr>
<tr><th id="2642">2642</th><td>	<a class="local col3 ref" href="#473skb" title='skb' data-ref="473skb" data-ref-filename="473skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_expire_msgsize" title='xfrm_expire_msgsize' data-use='c' data-ref="xfrm_expire_msgsize" data-ref-filename="xfrm_expire_msgsize">xfrm_expire_msgsize</a>(), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="2643">2643</th><td>	<b>if</b> (<a class="local col3 ref" href="#473skb" title='skb' data-ref="473skb" data-ref-filename="473skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2644">2644</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="2645">2645</th><td></td></tr>
<tr><th id="2646">2646</th><td>	<b>if</b> (<a class="tu ref fn" href="#build_expire" title='build_expire' data-use='c' data-ref="build_expire" data-ref-filename="build_expire">build_expire</a>(<a class="local col3 ref" href="#473skb" title='skb' data-ref="473skb" data-ref-filename="473skb">skb</a>, <a class="local col0 ref" href="#470x" title='x' data-ref="470x" data-ref-filename="470x">x</a>, <a class="local col1 ref" href="#471c" title='c' data-ref="471c" data-ref-filename="471c">c</a>) &lt; <var>0</var>) {</td></tr>
<tr><th id="2647">2647</th><td>		<a class="ref fn" href="../../include/linux/skbuff.h.html#kfree_skb" title='kfree_skb' data-ref="kfree_skb" data-ref-filename="kfree_skb">kfree_skb</a>(<a class="local col3 ref" href="#473skb" title='skb' data-ref="473skb" data-ref-filename="473skb">skb</a>);</td></tr>
<tr><th id="2648">2648</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="2649">2649</th><td>	}</td></tr>
<tr><th id="2650">2650</th><td></td></tr>
<tr><th id="2651">2651</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col2 ref" href="#472net" title='net' data-ref="472net" data-ref-filename="472net">net</a>, <a class="local col3 ref" href="#473skb" title='skb' data-ref="473skb" data-ref-filename="473skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#522" title="XFRMNLGRP_EXPIRE" data-ref="_M/XFRMNLGRP_EXPIRE">XFRMNLGRP_EXPIRE</a>);</td></tr>
<tr><th id="2652">2652</th><td>}</td></tr>
<tr><th id="2653">2653</th><td></td></tr>
<tr><th id="2654">2654</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_aevent_state_notify" title='xfrm_aevent_state_notify' data-type='int xfrm_aevent_state_notify(struct xfrm_state * x, const struct km_event * c)' data-ref="xfrm_aevent_state_notify" data-ref-filename="xfrm_aevent_state_notify">xfrm_aevent_state_notify</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col4 decl" id="474x" title='x' data-type='struct xfrm_state *' data-ref="474x" data-ref-filename="474x">x</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col5 decl" id="475c" title='c' data-type='const struct km_event *' data-ref="475c" data-ref-filename="475c">c</dfn>)</td></tr>
<tr><th id="2655">2655</th><td>{</td></tr>
<tr><th id="2656">2656</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col6 decl" id="476net" title='net' data-type='struct net *' data-ref="476net" data-ref-filename="476net">net</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xs_net" title='xs_net' data-ref="xs_net" data-ref-filename="xs_net">xs_net</a>(<a class="local col4 ref" href="#474x" title='x' data-ref="474x" data-ref-filename="474x">x</a>);</td></tr>
<tr><th id="2657">2657</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="477skb" title='skb' data-type='struct sk_buff *' data-ref="477skb" data-ref-filename="477skb">skb</dfn>;</td></tr>
<tr><th id="2658">2658</th><td>	<em>int</em> <dfn class="local col8 decl" id="478err" title='err' data-type='int' data-ref="478err" data-ref-filename="478err">err</dfn>;</td></tr>
<tr><th id="2659">2659</th><td></td></tr>
<tr><th id="2660">2660</th><td>	<a class="local col7 ref" href="#477skb" title='skb' data-ref="477skb" data-ref-filename="477skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_aevent_msgsize" title='xfrm_aevent_msgsize' data-use='c' data-ref="xfrm_aevent_msgsize" data-ref-filename="xfrm_aevent_msgsize">xfrm_aevent_msgsize</a>(<a class="local col4 ref" href="#474x" title='x' data-ref="474x" data-ref-filename="474x">x</a>), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="2661">2661</th><td>	<b>if</b> (<a class="local col7 ref" href="#477skb" title='skb' data-ref="477skb" data-ref-filename="477skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2662">2662</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="2663">2663</th><td></td></tr>
<tr><th id="2664">2664</th><td>	<a class="local col8 ref" href="#478err" title='err' data-ref="478err" data-ref-filename="478err">err</a> = <a class="tu ref fn" href="#build_aevent" title='build_aevent' data-use='c' data-ref="build_aevent" data-ref-filename="build_aevent">build_aevent</a>(<a class="local col7 ref" href="#477skb" title='skb' data-ref="477skb" data-ref-filename="477skb">skb</a>, <a class="local col4 ref" href="#474x" title='x' data-ref="474x" data-ref-filename="474x">x</a>, <a class="local col5 ref" href="#475c" title='c' data-ref="475c" data-ref-filename="475c">c</a>);</td></tr>
<tr><th id="2665">2665</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (2665), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (140)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col8 ref" href="#478err" title='err' data-ref="478err" data-ref-filename="478err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="2666">2666</th><td></td></tr>
<tr><th id="2667">2667</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col6 ref" href="#476net" title='net' data-ref="476net" data-ref-filename="476net">net</a>, <a class="local col7 ref" href="#477skb" title='skb' data-ref="477skb" data-ref-filename="477skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#528" title="XFRMNLGRP_AEVENTS" data-ref="_M/XFRMNLGRP_AEVENTS">XFRMNLGRP_AEVENTS</a>);</td></tr>
<tr><th id="2668">2668</th><td>}</td></tr>
<tr><th id="2669">2669</th><td></td></tr>
<tr><th id="2670">2670</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_notify_sa_flush" title='xfrm_notify_sa_flush' data-type='int xfrm_notify_sa_flush(const struct km_event * c)' data-ref="xfrm_notify_sa_flush" data-ref-filename="xfrm_notify_sa_flush">xfrm_notify_sa_flush</dfn>(<em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col9 decl" id="479c" title='c' data-type='const struct km_event *' data-ref="479c" data-ref-filename="479c">c</dfn>)</td></tr>
<tr><th id="2671">2671</th><td>{</td></tr>
<tr><th id="2672">2672</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col0 decl" id="480net" title='net' data-type='struct net *' data-ref="480net" data-ref-filename="480net">net</dfn> = <a class="local col9 ref" href="#479c" title='c' data-ref="479c" data-ref-filename="479c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::net" title='km_event::net' data-ref="km_event::net" data-ref-filename="km_event..net">net</a>;</td></tr>
<tr><th id="2673">2673</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_flush" title='xfrm_usersa_flush' data-ref="xfrm_usersa_flush" data-ref-filename="xfrm_usersa_flush">xfrm_usersa_flush</a> *<dfn class="local col1 decl" id="481p" title='p' data-type='struct xfrm_usersa_flush *' data-ref="481p" data-ref-filename="481p">p</dfn>;</td></tr>
<tr><th id="2674">2674</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col2 decl" id="482nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="482nlh" data-ref-filename="482nlh">nlh</dfn>;</td></tr>
<tr><th id="2675">2675</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="483skb" title='skb' data-type='struct sk_buff *' data-ref="483skb" data-ref-filename="483skb">skb</dfn>;</td></tr>
<tr><th id="2676">2676</th><td>	<em>int</em> <dfn class="local col4 decl" id="484len" title='len' data-type='int' data-ref="484len" data-ref-filename="484len">len</dfn> = <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((sizeof(struct xfrm_usersa_flush))+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_flush" title='xfrm_usersa_flush' data-ref="xfrm_usersa_flush" data-ref-filename="xfrm_usersa_flush">xfrm_usersa_flush</a>));</td></tr>
<tr><th id="2677">2677</th><td></td></tr>
<tr><th id="2678">2678</th><td>	<a class="local col3 ref" href="#483skb" title='skb' data-ref="483skb" data-ref-filename="483skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="local col4 ref" href="#484len" title='len' data-ref="484len" data-ref-filename="484len">len</a>, <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="2679">2679</th><td>	<b>if</b> (<a class="local col3 ref" href="#483skb" title='skb' data-ref="483skb" data-ref-filename="483skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2680">2680</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="2681">2681</th><td></td></tr>
<tr><th id="2682">2682</th><td>	<a class="local col2 ref" href="#482nlh" title='nlh' data-ref="482nlh" data-ref-filename="482nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col3 ref" href="#483skb" title='skb' data-ref="483skb" data-ref-filename="483skb">skb</a>, <a class="local col9 ref" href="#479c" title='c' data-ref="479c" data-ref-filename="479c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a>, <a class="local col9 ref" href="#479c" title='c' data-ref="479c" data-ref-filename="479c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#191" title="XFRM_MSG_FLUSHSA" data-ref="_M/XFRM_MSG_FLUSHSA">XFRM_MSG_FLUSHSA</a>, <b>sizeof</b>(*<a class="local col1 ref" href="#481p" title='p' data-ref="481p" data-ref-filename="481p">p</a>), <var>0</var>);</td></tr>
<tr><th id="2683">2683</th><td>	<b>if</b> (<a class="local col2 ref" href="#482nlh" title='nlh' data-ref="482nlh" data-ref-filename="482nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) {</td></tr>
<tr><th id="2684">2684</th><td>		<a class="ref fn" href="../../include/linux/skbuff.h.html#kfree_skb" title='kfree_skb' data-ref="kfree_skb" data-ref-filename="kfree_skb">kfree_skb</a>(<a class="local col3 ref" href="#483skb" title='skb' data-ref="483skb" data-ref-filename="483skb">skb</a>);</td></tr>
<tr><th id="2685">2685</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="2686">2686</th><td>	}</td></tr>
<tr><th id="2687">2687</th><td></td></tr>
<tr><th id="2688">2688</th><td>	<a class="local col1 ref" href="#481p" title='p' data-ref="481p" data-ref-filename="481p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col2 ref" href="#482nlh" title='nlh' data-ref="482nlh" data-ref-filename="482nlh">nlh</a>);</td></tr>
<tr><th id="2689">2689</th><td>	<a class="local col1 ref" href="#481p" title='p' data-ref="481p" data-ref-filename="481p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_flush::proto" title='xfrm_usersa_flush::proto' data-ref="xfrm_usersa_flush::proto" data-ref-filename="xfrm_usersa_flush..proto">proto</a> = <a class="local col9 ref" href="#479c" title='c' data-ref="479c" data-ref-filename="479c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::proto" title='km_event::(anonymous union)::proto' data-ref="km_event::(anonymous)::proto" data-ref-filename="km_event..(anonymous)..proto">proto</a>;</td></tr>
<tr><th id="2690">2690</th><td></td></tr>
<tr><th id="2691">2691</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col3 ref" href="#483skb" title='skb' data-ref="483skb" data-ref-filename="483skb">skb</a>, <a class="local col2 ref" href="#482nlh" title='nlh' data-ref="482nlh" data-ref-filename="482nlh">nlh</a>);</td></tr>
<tr><th id="2692">2692</th><td></td></tr>
<tr><th id="2693">2693</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col0 ref" href="#480net" title='net' data-ref="480net" data-ref-filename="480net">net</a>, <a class="local col3 ref" href="#483skb" title='skb' data-ref="483skb" data-ref-filename="483skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#524" title="XFRMNLGRP_SA" data-ref="_M/XFRMNLGRP_SA">XFRMNLGRP_SA</a>);</td></tr>
<tr><th id="2694">2694</th><td>}</td></tr>
<tr><th id="2695">2695</th><td></td></tr>
<tr><th id="2696">2696</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_sa_len" title='xfrm_sa_len' data-type='unsigned int xfrm_sa_len(struct xfrm_state * x)' data-ref="xfrm_sa_len" data-ref-filename="xfrm_sa_len">xfrm_sa_len</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col5 decl" id="485x" title='x' data-type='struct xfrm_state *' data-ref="485x" data-ref-filename="485x">x</dfn>)</td></tr>
<tr><th id="2697">2697</th><td>{</td></tr>
<tr><th id="2698">2698</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col6 decl" id="486l" title='l' data-type='unsigned int' data-ref="486l" data-ref-filename="486l">l</dfn> = <var>0</var>;</td></tr>
<tr><th id="2699">2699</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aead" title='xfrm_state::aead' data-ref="xfrm_state::aead" data-ref-filename="xfrm_state..aead">aead</a>)</td></tr>
<tr><th id="2700">2700</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="ref fn" href="../../include/net/xfrm.h.html#aead_len" title='aead_len' data-ref="aead_len" data-ref-filename="aead_len">aead_len</a>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aead" title='xfrm_state::aead' data-ref="xfrm_state::aead" data-ref-filename="xfrm_state..aead">aead</a>));</td></tr>
<tr><th id="2701">2701</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>) {</td></tr>
<tr><th id="2702">2702</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo" title='xfrm_algo' data-ref="xfrm_algo" data-ref-filename="xfrm_algo">xfrm_algo</a>) +</td></tr>
<tr><th id="2703">2703</th><td>				    (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_algo_auth::alg_key_len" title='xfrm_algo_auth::alg_key_len' data-ref="xfrm_algo_auth::alg_key_len" data-ref-filename="xfrm_algo_auth..alg_key_len">alg_key_len</a> + <var>7</var>) / <var>8</var>);</td></tr>
<tr><th id="2704">2704</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_auth_len" title='xfrm_alg_auth_len' data-ref="xfrm_alg_auth_len" data-ref-filename="xfrm_alg_auth_len">xfrm_alg_auth_len</a>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::aalg" title='xfrm_state::aalg' data-ref="xfrm_state::aalg" data-ref-filename="xfrm_state..aalg">aalg</a>));</td></tr>
<tr><th id="2705">2705</th><td>	}</td></tr>
<tr><th id="2706">2706</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::ealg" title='xfrm_state::ealg' data-ref="xfrm_state::ealg" data-ref-filename="xfrm_state..ealg">ealg</a>)</td></tr>
<tr><th id="2707">2707</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_alg_len" title='xfrm_alg_len' data-ref="xfrm_alg_len" data-ref-filename="xfrm_alg_len">xfrm_alg_len</a>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::ealg" title='xfrm_state::ealg' data-ref="xfrm_state::ealg" data-ref-filename="xfrm_state..ealg">ealg</a>));</td></tr>
<tr><th id="2708">2708</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::calg" title='xfrm_state::calg' data-ref="xfrm_state::calg" data-ref-filename="xfrm_state..calg">calg</a>)</td></tr>
<tr><th id="2709">2709</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(*<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::calg" title='xfrm_state::calg' data-ref="xfrm_state::calg" data-ref-filename="xfrm_state..calg">calg</a>));</td></tr>
<tr><th id="2710">2710</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>)</td></tr>
<tr><th id="2711">2711</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(*<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>));</td></tr>
<tr><th id="2712">2712</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::tfcpad" title='xfrm_state::tfcpad' data-ref="xfrm_state::tfcpad" data-ref-filename="xfrm_state..tfcpad">tfcpad</a>)</td></tr>
<tr><th id="2713">2713</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::tfcpad" title='xfrm_state::tfcpad' data-ref="xfrm_state::tfcpad" data-ref-filename="xfrm_state..tfcpad">tfcpad</a>));</td></tr>
<tr><th id="2714">2714</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>)</td></tr>
<tr><th id="2715">2715</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_replay_state_esn_len" title='xfrm_replay_state_esn_len' data-ref="xfrm_replay_state_esn_len" data-ref-filename="xfrm_replay_state_esn_len">xfrm_replay_state_esn_len</a>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::replay_esn" title='xfrm_state::replay_esn' data-ref="xfrm_state::replay_esn" data-ref-filename="xfrm_state..replay_esn">replay_esn</a>));</td></tr>
<tr><th id="2716">2716</th><td>	<b>else</b></td></tr>
<tr><th id="2717">2717</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_replay_state" title='xfrm_replay_state' data-ref="xfrm_replay_state" data-ref-filename="xfrm_replay_state">xfrm_replay_state</a>));</td></tr>
<tr><th id="2718">2718</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::security" title='xfrm_state::security' data-ref="xfrm_state::security" data-ref-filename="xfrm_state..security">security</a>)</td></tr>
<tr><th id="2719">2719</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_sec_ctx" title='xfrm_user_sec_ctx' data-ref="xfrm_user_sec_ctx" data-ref-filename="xfrm_user_sec_ctx">xfrm_user_sec_ctx</a>) +</td></tr>
<tr><th id="2720">2720</th><td>				    <a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::security" title='xfrm_state::security' data-ref="xfrm_state::security" data-ref-filename="xfrm_state..security">security</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_sec_ctx::ctx_len" title='xfrm_sec_ctx::ctx_len' data-ref="xfrm_sec_ctx::ctx_len" data-ref-filename="xfrm_sec_ctx..ctx_len">ctx_len</a>);</td></tr>
<tr><th id="2721">2721</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a>)</td></tr>
<tr><th id="2722">2722</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(*<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::coaddr" title='xfrm_state::coaddr' data-ref="xfrm_state::coaddr" data-ref-filename="xfrm_state..coaddr">coaddr</a>));</td></tr>
<tr><th id="2723">2723</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::extra_flags" title='xfrm_state::(anonymous struct)::extra_flags' data-ref="xfrm_state::(anonymous)::extra_flags" data-ref-filename="xfrm_state..(anonymous)..extra_flags">extra_flags</a>)</td></tr>
<tr><th id="2724">2724</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::extra_flags" title='xfrm_state::(anonymous struct)::extra_flags' data-ref="xfrm_state::(anonymous)::extra_flags" data-ref-filename="xfrm_state..(anonymous)..extra_flags">extra_flags</a>));</td></tr>
<tr><th id="2725">2725</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::xso" title='xfrm_state::xso' data-ref="xfrm_state::xso" data-ref-filename="xfrm_state..xso">xso</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_offload::dev" title='xfrm_state_offload::dev' data-ref="xfrm_state_offload::dev" data-ref-filename="xfrm_state_offload..dev">dev</a>)</td></tr>
<tr><th id="2726">2726</th><td>		 <a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::xso" title='xfrm_state::xso' data-ref="xfrm_state::xso" data-ref-filename="xfrm_state..xso">xso</a>));</td></tr>
<tr><th id="2727">2727</th><td>	<b>if</b> (<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::output_mark" title='xfrm_state::(anonymous struct)::output_mark' data-ref="xfrm_state::(anonymous)::output_mark" data-ref-filename="xfrm_state..(anonymous)..output_mark">output_mark</a>)</td></tr>
<tr><th id="2728">2728</th><td>		<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<a class="local col5 ref" href="#485x" title='x' data-ref="485x" data-ref-filename="485x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::output_mark" title='xfrm_state::(anonymous struct)::output_mark' data-ref="xfrm_state::(anonymous)::output_mark" data-ref-filename="xfrm_state..(anonymous)..output_mark">output_mark</a>));</td></tr>
<tr><th id="2729">2729</th><td></td></tr>
<tr><th id="2730">2730</th><td>	<i>/* Must count x-&gt;lastused as it may become non-zero behind our back. */</i></td></tr>
<tr><th id="2731">2731</th><td>	<a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size_64bit" title='nla_total_size_64bit' data-ref="nla_total_size_64bit" data-ref-filename="nla_total_size_64bit">nla_total_size_64bit</a>(<b>sizeof</b>(<a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u64" title='u64' data-type='unsigned long long' data-ref="u64" data-ref-filename="u64">u64</a>));</td></tr>
<tr><th id="2732">2732</th><td></td></tr>
<tr><th id="2733">2733</th><td>	<b>return</b> <a class="local col6 ref" href="#486l" title='l' data-ref="486l" data-ref-filename="486l">l</a>;</td></tr>
<tr><th id="2734">2734</th><td>}</td></tr>
<tr><th id="2735">2735</th><td></td></tr>
<tr><th id="2736">2736</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_notify_sa" title='xfrm_notify_sa' data-type='int xfrm_notify_sa(struct xfrm_state * x, const struct km_event * c)' data-ref="xfrm_notify_sa" data-ref-filename="xfrm_notify_sa">xfrm_notify_sa</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col7 decl" id="487x" title='x' data-type='struct xfrm_state *' data-ref="487x" data-ref-filename="487x">x</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col8 decl" id="488c" title='c' data-type='const struct km_event *' data-ref="488c" data-ref-filename="488c">c</dfn>)</td></tr>
<tr><th id="2737">2737</th><td>{</td></tr>
<tr><th id="2738">2738</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col9 decl" id="489net" title='net' data-type='struct net *' data-ref="489net" data-ref-filename="489net">net</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xs_net" title='xs_net' data-ref="xs_net" data-ref-filename="xs_net">xs_net</a>(<a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>);</td></tr>
<tr><th id="2739">2739</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_info" title='xfrm_usersa_info' data-ref="xfrm_usersa_info" data-ref-filename="xfrm_usersa_info">xfrm_usersa_info</a> *<dfn class="local col0 decl" id="490p" title='p' data-type='struct xfrm_usersa_info *' data-ref="490p" data-ref-filename="490p">p</dfn>;</td></tr>
<tr><th id="2740">2740</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id" title='xfrm_usersa_id' data-ref="xfrm_usersa_id" data-ref-filename="xfrm_usersa_id">xfrm_usersa_id</a> *<dfn class="local col1 decl" id="491id" title='id' data-type='struct xfrm_usersa_id *' data-ref="491id" data-ref-filename="491id">id</dfn>;</td></tr>
<tr><th id="2741">2741</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col2 decl" id="492nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="492nlh" data-ref-filename="492nlh">nlh</dfn>;</td></tr>
<tr><th id="2742">2742</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="493skb" title='skb' data-type='struct sk_buff *' data-ref="493skb" data-ref-filename="493skb">skb</dfn>;</td></tr>
<tr><th id="2743">2743</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col4 decl" id="494len" title='len' data-type='unsigned int' data-ref="494len" data-ref-filename="494len">len</dfn> = <a class="tu ref fn" href="#xfrm_sa_len" title='xfrm_sa_len' data-use='c' data-ref="xfrm_sa_len" data-ref-filename="xfrm_sa_len">xfrm_sa_len</a>(<a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>);</td></tr>
<tr><th id="2744">2744</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="495headlen" title='headlen' data-type='unsigned int' data-ref="495headlen" data-ref-filename="495headlen">headlen</dfn>;</td></tr>
<tr><th id="2745">2745</th><td>	<em>int</em> <dfn class="local col6 decl" id="496err" title='err' data-type='int' data-ref="496err" data-ref-filename="496err">err</dfn>;</td></tr>
<tr><th id="2746">2746</th><td></td></tr>
<tr><th id="2747">2747</th><td>	<a class="local col5 ref" href="#495headlen" title='headlen' data-ref="495headlen" data-ref-filename="495headlen">headlen</a> = <b>sizeof</b>(*<a class="local col0 ref" href="#490p" title='p' data-ref="490p" data-ref-filename="490p">p</a>);</td></tr>
<tr><th id="2748">2748</th><td>	<b>if</b> (<a class="local col8 ref" href="#488c" title='c' data-ref="488c" data-ref-filename="488c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#164" title="XFRM_MSG_DELSA" data-ref="_M/XFRM_MSG_DELSA">XFRM_MSG_DELSA</a>) {</td></tr>
<tr><th id="2749">2749</th><td>		<a class="local col4 ref" href="#494len" title='len' data-ref="494len" data-ref-filename="494len">len</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="local col5 ref" href="#495headlen" title='headlen' data-ref="495headlen" data-ref-filename="495headlen">headlen</a>);</td></tr>
<tr><th id="2750">2750</th><td>		<a class="local col5 ref" href="#495headlen" title='headlen' data-ref="495headlen" data-ref-filename="495headlen">headlen</a> = <b>sizeof</b>(*<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>);</td></tr>
<tr><th id="2751">2751</th><td>		<a class="local col4 ref" href="#494len" title='len' data-ref="494len" data-ref-filename="494len">len</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a>));</td></tr>
<tr><th id="2752">2752</th><td>	}</td></tr>
<tr><th id="2753">2753</th><td>	<a class="local col4 ref" href="#494len" title='len' data-ref="494len" data-ref-filename="494len">len</a> += <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((headlen)+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<a class="local col5 ref" href="#495headlen" title='headlen' data-ref="495headlen" data-ref-filename="495headlen">headlen</a>);</td></tr>
<tr><th id="2754">2754</th><td></td></tr>
<tr><th id="2755">2755</th><td>	<a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="local col4 ref" href="#494len" title='len' data-ref="494len" data-ref-filename="494len">len</a>, <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="2756">2756</th><td>	<b>if</b> (<a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2757">2757</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="2758">2758</th><td></td></tr>
<tr><th id="2759">2759</th><td>	<a class="local col2 ref" href="#492nlh" title='nlh' data-ref="492nlh" data-ref-filename="492nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a>, <a class="local col8 ref" href="#488c" title='c' data-ref="488c" data-ref-filename="488c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a>, <a class="local col8 ref" href="#488c" title='c' data-ref="488c" data-ref-filename="488c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a>, <a class="local col8 ref" href="#488c" title='c' data-ref="488c" data-ref-filename="488c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a>, <a class="local col5 ref" href="#495headlen" title='headlen' data-ref="495headlen" data-ref-filename="495headlen">headlen</a>, <var>0</var>);</td></tr>
<tr><th id="2760">2760</th><td>	<a class="local col6 ref" href="#496err" title='err' data-ref="496err" data-ref-filename="496err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="2761">2761</th><td>	<b>if</b> (<a class="local col2 ref" href="#492nlh" title='nlh' data-ref="492nlh" data-ref-filename="492nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2762">2762</th><td>		<b>goto</b> <a class="lbl" href="#497out_free_skb" data-ref="497out_free_skb" data-ref-filename="497out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="2763">2763</th><td></td></tr>
<tr><th id="2764">2764</th><td>	<a class="local col0 ref" href="#490p" title='p' data-ref="490p" data-ref-filename="490p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col2 ref" href="#492nlh" title='nlh' data-ref="492nlh" data-ref-filename="492nlh">nlh</a>);</td></tr>
<tr><th id="2765">2765</th><td>	<b>if</b> (<a class="local col8 ref" href="#488c" title='c' data-ref="488c" data-ref-filename="488c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#164" title="XFRM_MSG_DELSA" data-ref="_M/XFRM_MSG_DELSA">XFRM_MSG_DELSA</a>) {</td></tr>
<tr><th id="2766">2766</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col8 decl" id="498attr" title='attr' data-type='struct nlattr *' data-ref="498attr" data-ref-filename="498attr">attr</dfn>;</td></tr>
<tr><th id="2767">2767</th><td></td></tr>
<tr><th id="2768">2768</th><td>		<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col2 ref" href="#492nlh" title='nlh' data-ref="492nlh" data-ref-filename="492nlh">nlh</a>);</td></tr>
<tr><th id="2769">2769</th><td>		<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>));</td></tr>
<tr><th id="2770">2770</th><td>		<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(id-&gt;daddr)); void *__ret; if (__builtin_constant_p(sizeof(id-&gt;daddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;id-&gt;daddr), (&amp;x-&gt;id.daddr), __len); else __ret = __builtin_memcpy((&amp;id-&gt;daddr), (&amp;x-&gt;id.daddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>, &amp;<a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::daddr" title='xfrm_id::daddr' data-ref="xfrm_id::daddr" data-ref-filename="xfrm_id..daddr">daddr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>));</td></tr>
<tr><th id="2771">2771</th><td>		<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::spi" title='xfrm_usersa_id::spi' data-ref="xfrm_usersa_id::spi" data-ref-filename="xfrm_usersa_id..spi">spi</a> = <a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::spi" title='xfrm_id::spi' data-ref="xfrm_id::spi" data-ref-filename="xfrm_id..spi">spi</a>;</td></tr>
<tr><th id="2772">2772</th><td>		<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::family" title='xfrm_usersa_id::family' data-ref="xfrm_usersa_id::family" data-ref-filename="xfrm_usersa_id..family">family</a> = <a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::family" title='xfrm_state::(anonymous struct)::family' data-ref="xfrm_state::(anonymous)::family" data-ref-filename="xfrm_state..(anonymous)..family">family</a>;</td></tr>
<tr><th id="2773">2773</th><td>		<a class="local col1 ref" href="#491id" title='id' data-ref="491id" data-ref-filename="491id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a> = <a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>;</td></tr>
<tr><th id="2774">2774</th><td></td></tr>
<tr><th id="2775">2775</th><td>		<a class="local col8 ref" href="#498attr" title='attr' data-ref="498attr" data-ref-filename="498attr">attr</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_reserve" title='nla_reserve' data-ref="nla_reserve" data-ref-filename="nla_reserve">nla_reserve</a>(<a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_SA" title='XFRMA_SA' data-ref="XFRMA_SA" data-ref-filename="XFRMA_SA">XFRMA_SA</a>, <b>sizeof</b>(*<a class="local col0 ref" href="#490p" title='p' data-ref="490p" data-ref-filename="490p">p</a>));</td></tr>
<tr><th id="2776">2776</th><td>		<a class="local col6 ref" href="#496err" title='err' data-ref="496err" data-ref-filename="496err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="2777">2777</th><td>		<b>if</b> (<a class="local col8 ref" href="#498attr" title='attr' data-ref="498attr" data-ref-filename="498attr">attr</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2778">2778</th><td>			<b>goto</b> <a class="lbl" href="#497out_free_skb" data-ref="497out_free_skb" data-ref-filename="497out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="2779">2779</th><td></td></tr>
<tr><th id="2780">2780</th><td>		<a class="local col0 ref" href="#490p" title='p' data-ref="490p" data-ref-filename="490p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col8 ref" href="#498attr" title='attr' data-ref="498attr" data-ref-filename="498attr">attr</a>);</td></tr>
<tr><th id="2781">2781</th><td>	}</td></tr>
<tr><th id="2782">2782</th><td>	<a class="local col6 ref" href="#496err" title='err' data-ref="496err" data-ref-filename="496err">err</a> = <a class="tu ref fn" href="#copy_to_user_state_extra" title='copy_to_user_state_extra' data-use='c' data-ref="copy_to_user_state_extra" data-ref-filename="copy_to_user_state_extra">copy_to_user_state_extra</a>(<a class="local col7 ref" href="#487x" title='x' data-ref="487x" data-ref-filename="487x">x</a>, <a class="local col0 ref" href="#490p" title='p' data-ref="490p" data-ref-filename="490p">p</a>, <a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a>);</td></tr>
<tr><th id="2783">2783</th><td>	<b>if</b> (<a class="local col6 ref" href="#496err" title='err' data-ref="496err" data-ref-filename="496err">err</a>)</td></tr>
<tr><th id="2784">2784</th><td>		<b>goto</b> <a class="lbl" href="#497out_free_skb" data-ref="497out_free_skb" data-ref-filename="497out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="2785">2785</th><td></td></tr>
<tr><th id="2786">2786</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a>, <a class="local col2 ref" href="#492nlh" title='nlh' data-ref="492nlh" data-ref-filename="492nlh">nlh</a>);</td></tr>
<tr><th id="2787">2787</th><td></td></tr>
<tr><th id="2788">2788</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col9 ref" href="#489net" title='net' data-ref="489net" data-ref-filename="489net">net</a>, <a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#524" title="XFRMNLGRP_SA" data-ref="_M/XFRMNLGRP_SA">XFRMNLGRP_SA</a>);</td></tr>
<tr><th id="2789">2789</th><td></td></tr>
<tr><th id="2790">2790</th><td><dfn class="lbl" id="497out_free_skb" data-ref="497out_free_skb" data-ref-filename="497out_free_skb">out_free_skb</dfn>:</td></tr>
<tr><th id="2791">2791</th><td>	<a class="ref fn" href="../../include/linux/skbuff.h.html#kfree_skb" title='kfree_skb' data-ref="kfree_skb" data-ref-filename="kfree_skb">kfree_skb</a>(<a class="local col3 ref" href="#493skb" title='skb' data-ref="493skb" data-ref-filename="493skb">skb</a>);</td></tr>
<tr><th id="2792">2792</th><td>	<b>return</b> <a class="local col6 ref" href="#496err" title='err' data-ref="496err" data-ref-filename="496err">err</a>;</td></tr>
<tr><th id="2793">2793</th><td>}</td></tr>
<tr><th id="2794">2794</th><td></td></tr>
<tr><th id="2795">2795</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_send_state_notify" title='xfrm_send_state_notify' data-type='int xfrm_send_state_notify(struct xfrm_state * x, const struct km_event * c)' data-ref="xfrm_send_state_notify" data-ref-filename="xfrm_send_state_notify">xfrm_send_state_notify</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col9 decl" id="499x" title='x' data-type='struct xfrm_state *' data-ref="499x" data-ref-filename="499x">x</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col0 decl" id="500c" title='c' data-type='const struct km_event *' data-ref="500c" data-ref-filename="500c">c</dfn>)</td></tr>
<tr><th id="2796">2796</th><td>{</td></tr>
<tr><th id="2797">2797</th><td></td></tr>
<tr><th id="2798">2798</th><td>	<b>switch</b> (<a class="local col0 ref" href="#500c" title='c' data-ref="500c" data-ref-filename="500c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a>) {</td></tr>
<tr><th id="2799">2799</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#180" title="XFRM_MSG_EXPIRE" data-ref="_M/XFRM_MSG_EXPIRE">XFRM_MSG_EXPIRE</a>:</td></tr>
<tr><th id="2800">2800</th><td>		<b>return</b> <a class="tu ref fn" href="#xfrm_exp_state_notify" title='xfrm_exp_state_notify' data-use='c' data-ref="xfrm_exp_state_notify" data-ref-filename="xfrm_exp_state_notify">xfrm_exp_state_notify</a>(<a class="local col9 ref" href="#499x" title='x' data-ref="499x" data-ref-filename="499x">x</a>, <a class="local col0 ref" href="#500c" title='c' data-ref="500c" data-ref-filename="500c">c</a>);</td></tr>
<tr><th id="2801">2801</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#196" title="XFRM_MSG_NEWAE" data-ref="_M/XFRM_MSG_NEWAE">XFRM_MSG_NEWAE</a>:</td></tr>
<tr><th id="2802">2802</th><td>		<b>return</b> <a class="tu ref fn" href="#xfrm_aevent_state_notify" title='xfrm_aevent_state_notify' data-use='c' data-ref="xfrm_aevent_state_notify" data-ref-filename="xfrm_aevent_state_notify">xfrm_aevent_state_notify</a>(<a class="local col9 ref" href="#499x" title='x' data-ref="499x" data-ref-filename="499x">x</a>, <a class="local col0 ref" href="#500c" title='c' data-ref="500c" data-ref-filename="500c">c</a>);</td></tr>
<tr><th id="2803">2803</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#164" title="XFRM_MSG_DELSA" data-ref="_M/XFRM_MSG_DELSA">XFRM_MSG_DELSA</a>:</td></tr>
<tr><th id="2804">2804</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#185" title="XFRM_MSG_UPDSA" data-ref="_M/XFRM_MSG_UPDSA">XFRM_MSG_UPDSA</a>:</td></tr>
<tr><th id="2805">2805</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#162" title="XFRM_MSG_NEWSA" data-ref="_M/XFRM_MSG_NEWSA">XFRM_MSG_NEWSA</a>:</td></tr>
<tr><th id="2806">2806</th><td>		<b>return</b> <a class="tu ref fn" href="#xfrm_notify_sa" title='xfrm_notify_sa' data-use='c' data-ref="xfrm_notify_sa" data-ref-filename="xfrm_notify_sa">xfrm_notify_sa</a>(<a class="local col9 ref" href="#499x" title='x' data-ref="499x" data-ref-filename="499x">x</a>, <a class="local col0 ref" href="#500c" title='c' data-ref="500c" data-ref-filename="500c">c</a>);</td></tr>
<tr><th id="2807">2807</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#191" title="XFRM_MSG_FLUSHSA" data-ref="_M/XFRM_MSG_FLUSHSA">XFRM_MSG_FLUSHSA</a>:</td></tr>
<tr><th id="2808">2808</th><td>		<b>return</b> <a class="tu ref fn" href="#xfrm_notify_sa_flush" title='xfrm_notify_sa_flush' data-use='c' data-ref="xfrm_notify_sa_flush" data-ref-filename="xfrm_notify_sa_flush">xfrm_notify_sa_flush</a>(<a class="local col0 ref" href="#500c" title='c' data-ref="500c" data-ref-filename="500c">c</a>);</td></tr>
<tr><th id="2809">2809</th><td>	<b>default</b>:</td></tr>
<tr><th id="2810">2810</th><td>		<a class="ref fn" href="../../include/linux/printk.h.html#printk" title='printk' data-ref="printk" data-ref-filename="printk">printk</a>(<a class="macro" href="../../include/linux/kern_levels.h.html#13" title="&quot;\001&quot; &quot;5&quot;" data-ref="_M/KERN_NOTICE">KERN_NOTICE</a> <q>"xfrm_user: Unknown SA event %d\n"</q>,</td></tr>
<tr><th id="2811">2811</th><td>		       <a class="local col0 ref" href="#500c" title='c' data-ref="500c" data-ref-filename="500c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a>);</td></tr>
<tr><th id="2812">2812</th><td>		<b>break</b>;</td></tr>
<tr><th id="2813">2813</th><td>	}</td></tr>
<tr><th id="2814">2814</th><td></td></tr>
<tr><th id="2815">2815</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2816">2816</th><td></td></tr>
<tr><th id="2817">2817</th><td>}</td></tr>
<tr><th id="2818">2818</th><td></td></tr>
<tr><th id="2819">2819</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_acquire_msgsize" title='xfrm_acquire_msgsize' data-type='unsigned int xfrm_acquire_msgsize(struct xfrm_state * x, struct xfrm_policy * xp)' data-ref="xfrm_acquire_msgsize" data-ref-filename="xfrm_acquire_msgsize">xfrm_acquire_msgsize</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="501x" title='x' data-type='struct xfrm_state *' data-ref="501x" data-ref-filename="501x">x</dfn>,</td></tr>
<tr><th id="2820">2820</th><td>						<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col2 decl" id="502xp" title='xp' data-type='struct xfrm_policy *' data-ref="502xp" data-ref-filename="502xp">xp</dfn>)</td></tr>
<tr><th id="2821">2821</th><td>{</td></tr>
<tr><th id="2822">2822</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((sizeof(struct xfrm_user_acquire))+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire" title='xfrm_user_acquire' data-ref="xfrm_user_acquire" data-ref-filename="xfrm_user_acquire">xfrm_user_acquire</a>))</td></tr>
<tr><th id="2823">2823</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a>) * <a class="local col2 ref" href="#502xp" title='xp' data-ref="502xp" data-ref-filename="502xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a>)</td></tr>
<tr><th id="2824">2824</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a>))</td></tr>
<tr><th id="2825">2825</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="tu ref fn" href="#xfrm_user_sec_ctx_size" title='xfrm_user_sec_ctx_size' data-use='c' data-ref="xfrm_user_sec_ctx_size" data-ref-filename="xfrm_user_sec_ctx_size">xfrm_user_sec_ctx_size</a>(<a class="local col1 ref" href="#501x" title='x' data-ref="501x" data-ref-filename="501x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::security" title='xfrm_state::security' data-ref="xfrm_state::security" data-ref-filename="xfrm_state..security">security</a>))</td></tr>
<tr><th id="2826">2826</th><td>	       + <a class="tu ref fn" href="#userpolicy_type_attrsize" title='userpolicy_type_attrsize' data-use='c' data-ref="userpolicy_type_attrsize" data-ref-filename="userpolicy_type_attrsize">userpolicy_type_attrsize</a>();</td></tr>
<tr><th id="2827">2827</th><td>}</td></tr>
<tr><th id="2828">2828</th><td></td></tr>
<tr><th id="2829">2829</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_acquire" title='build_acquire' data-type='int build_acquire(struct sk_buff * skb, struct xfrm_state * x, struct xfrm_tmpl * xt, struct xfrm_policy * xp)' data-ref="build_acquire" data-ref-filename="build_acquire">build_acquire</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col3 decl" id="503skb" title='skb' data-type='struct sk_buff *' data-ref="503skb" data-ref-filename="503skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col4 decl" id="504x" title='x' data-type='struct xfrm_state *' data-ref="504x" data-ref-filename="504x">x</dfn>,</td></tr>
<tr><th id="2830">2830</th><td>			 <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_tmpl" title='xfrm_tmpl' data-ref="xfrm_tmpl" data-ref-filename="xfrm_tmpl">xfrm_tmpl</a> *<dfn class="local col5 decl" id="505xt" title='xt' data-type='struct xfrm_tmpl *' data-ref="505xt" data-ref-filename="505xt">xt</dfn>, <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col6 decl" id="506xp" title='xp' data-type='struct xfrm_policy *' data-ref="506xp" data-ref-filename="506xp">xp</dfn>)</td></tr>
<tr><th id="2831">2831</th><td>{</td></tr>
<tr><th id="2832">2832</th><td>	<a class="typedef" href="../../include/uapi/asm-generic/int-ll64.h.html#__u32" title='__u32' data-type='unsigned int' data-ref="__u32" data-ref-filename="__u32">__u32</a> <dfn class="local col7 decl" id="507seq" title='seq' data-type='__u32' data-ref="507seq" data-ref-filename="507seq">seq</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_get_acqseq" title='xfrm_get_acqseq' data-ref="xfrm_get_acqseq" data-ref-filename="xfrm_get_acqseq">xfrm_get_acqseq</a>();</td></tr>
<tr><th id="2833">2833</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire" title='xfrm_user_acquire' data-ref="xfrm_user_acquire" data-ref-filename="xfrm_user_acquire">xfrm_user_acquire</a> *<dfn class="local col8 decl" id="508ua" title='ua' data-type='struct xfrm_user_acquire *' data-ref="508ua" data-ref-filename="508ua">ua</dfn>;</td></tr>
<tr><th id="2834">2834</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col9 decl" id="509nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="509nlh" data-ref-filename="509nlh">nlh</dfn>;</td></tr>
<tr><th id="2835">2835</th><td>	<em>int</em> <dfn class="local col0 decl" id="510err" title='err' data-type='int' data-ref="510err" data-ref-filename="510err">err</dfn>;</td></tr>
<tr><th id="2836">2836</th><td></td></tr>
<tr><th id="2837">2837</th><td>	<a class="local col9 ref" href="#509nlh" title='nlh' data-ref="509nlh" data-ref-filename="509nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col3 ref" href="#503skb" title='skb' data-ref="503skb" data-ref-filename="503skb">skb</a>, <var>0</var>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#178" title="XFRM_MSG_ACQUIRE" data-ref="_M/XFRM_MSG_ACQUIRE">XFRM_MSG_ACQUIRE</a>, <b>sizeof</b>(*<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>), <var>0</var>);</td></tr>
<tr><th id="2838">2838</th><td>	<b>if</b> (<a class="local col9 ref" href="#509nlh" title='nlh' data-ref="509nlh" data-ref-filename="509nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2839">2839</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="2840">2840</th><td></td></tr>
<tr><th id="2841">2841</th><td>	<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col9 ref" href="#509nlh" title='nlh' data-ref="509nlh" data-ref-filename="509nlh">nlh</a>);</td></tr>
<tr><th id="2842">2842</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(ua-&gt;id)); void *__ret; if (__builtin_constant_p(sizeof(ua-&gt;id)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;ua-&gt;id), (&amp;x-&gt;id), __len); else __ret = __builtin_memcpy((&amp;ua-&gt;id), (&amp;x-&gt;id), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::id" title='xfrm_user_acquire::id' data-ref="xfrm_user_acquire::id" data-ref-filename="xfrm_user_acquire..id">id</a>, &amp;<a class="local col4 ref" href="#504x" title='x' data-ref="504x" data-ref-filename="504x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>, <b>sizeof</b>(<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::id" title='xfrm_user_acquire::id' data-ref="xfrm_user_acquire::id" data-ref-filename="xfrm_user_acquire..id">id</a>));</td></tr>
<tr><th id="2843">2843</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(ua-&gt;saddr)); void *__ret; if (__builtin_constant_p(sizeof(ua-&gt;saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;ua-&gt;saddr), (&amp;x-&gt;props.saddr), __len); else __ret = __builtin_memcpy((&amp;ua-&gt;saddr), (&amp;x-&gt;props.saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::saddr" title='xfrm_user_acquire::saddr' data-ref="xfrm_user_acquire::saddr" data-ref-filename="xfrm_user_acquire..saddr">saddr</a>, &amp;<a class="local col4 ref" href="#504x" title='x' data-ref="504x" data-ref-filename="504x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>, <b>sizeof</b>(<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::saddr" title='xfrm_user_acquire::saddr' data-ref="xfrm_user_acquire::saddr" data-ref-filename="xfrm_user_acquire..saddr">saddr</a>));</td></tr>
<tr><th id="2844">2844</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(ua-&gt;sel)); void *__ret; if (__builtin_constant_p(sizeof(ua-&gt;sel)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;ua-&gt;sel), (&amp;x-&gt;sel), __len); else __ret = __builtin_memcpy((&amp;ua-&gt;sel), (&amp;x-&gt;sel), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::sel" title='xfrm_user_acquire::sel' data-ref="xfrm_user_acquire::sel" data-ref-filename="xfrm_user_acquire..sel">sel</a>, &amp;<a class="local col4 ref" href="#504x" title='x' data-ref="504x" data-ref-filename="504x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::sel" title='xfrm_state::sel' data-ref="xfrm_state::sel" data-ref-filename="xfrm_state..sel">sel</a>, <b>sizeof</b>(<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::sel" title='xfrm_user_acquire::sel' data-ref="xfrm_user_acquire::sel" data-ref-filename="xfrm_user_acquire..sel">sel</a>));</td></tr>
<tr><th id="2845">2845</th><td>	<a class="tu ref fn" href="#copy_to_user_policy" title='copy_to_user_policy' data-use='c' data-ref="copy_to_user_policy" data-ref-filename="copy_to_user_policy">copy_to_user_policy</a>(<a class="local col6 ref" href="#506xp" title='xp' data-ref="506xp" data-ref-filename="506xp">xp</a>, &amp;<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::policy" title='xfrm_user_acquire::policy' data-ref="xfrm_user_acquire::policy" data-ref-filename="xfrm_user_acquire..policy">policy</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_OUT" title='XFRM_POLICY_OUT' data-ref="XFRM_POLICY_OUT" data-ref-filename="XFRM_POLICY_OUT">XFRM_POLICY_OUT</a>);</td></tr>
<tr><th id="2846">2846</th><td>	<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::aalgos" title='xfrm_user_acquire::aalgos' data-ref="xfrm_user_acquire::aalgos" data-ref-filename="xfrm_user_acquire..aalgos">aalgos</a> = <a class="local col5 ref" href="#505xt" title='xt' data-ref="505xt" data-ref-filename="505xt">xt</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::aalgos" title='xfrm_tmpl::aalgos' data-ref="xfrm_tmpl::aalgos" data-ref-filename="xfrm_tmpl..aalgos">aalgos</a>;</td></tr>
<tr><th id="2847">2847</th><td>	<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::ealgos" title='xfrm_user_acquire::ealgos' data-ref="xfrm_user_acquire::ealgos" data-ref-filename="xfrm_user_acquire..ealgos">ealgos</a> = <a class="local col5 ref" href="#505xt" title='xt' data-ref="505xt" data-ref-filename="505xt">xt</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::ealgos" title='xfrm_tmpl::ealgos' data-ref="xfrm_tmpl::ealgos" data-ref-filename="xfrm_tmpl..ealgos">ealgos</a>;</td></tr>
<tr><th id="2848">2848</th><td>	<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::calgos" title='xfrm_user_acquire::calgos' data-ref="xfrm_user_acquire::calgos" data-ref-filename="xfrm_user_acquire..calgos">calgos</a> = <a class="local col5 ref" href="#505xt" title='xt' data-ref="505xt" data-ref-filename="505xt">xt</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_tmpl::calgos" title='xfrm_tmpl::calgos' data-ref="xfrm_tmpl::calgos" data-ref-filename="xfrm_tmpl..calgos">calgos</a>;</td></tr>
<tr><th id="2849">2849</th><td>	<a class="local col8 ref" href="#508ua" title='ua' data-ref="508ua" data-ref-filename="508ua">ua</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_acquire::seq" title='xfrm_user_acquire::seq' data-ref="xfrm_user_acquire::seq" data-ref-filename="xfrm_user_acquire..seq">seq</a> = <a class="local col4 ref" href="#504x" title='x' data-ref="504x" data-ref-filename="504x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::km" title='xfrm_state::km' data-ref="xfrm_state::km" data-ref-filename="xfrm_state..km">km</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state_walk::seq" title='xfrm_state_walk::seq' data-ref="xfrm_state_walk::seq" data-ref-filename="xfrm_state_walk..seq">seq</a> = <a class="local col7 ref" href="#507seq" title='seq' data-ref="507seq" data-ref-filename="507seq">seq</a>;</td></tr>
<tr><th id="2850">2850</th><td></td></tr>
<tr><th id="2851">2851</th><td>	<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a> = <a class="tu ref fn" href="#copy_to_user_tmpl" title='copy_to_user_tmpl' data-use='c' data-ref="copy_to_user_tmpl" data-ref-filename="copy_to_user_tmpl">copy_to_user_tmpl</a>(<a class="local col6 ref" href="#506xp" title='xp' data-ref="506xp" data-ref-filename="506xp">xp</a>, <a class="local col3 ref" href="#503skb" title='skb' data-ref="503skb" data-ref-filename="503skb">skb</a>);</td></tr>
<tr><th id="2852">2852</th><td>	<b>if</b> (!<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a>)</td></tr>
<tr><th id="2853">2853</th><td>		<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a> = <a class="tu ref fn" href="#copy_to_user_state_sec_ctx" title='copy_to_user_state_sec_ctx' data-use='c' data-ref="copy_to_user_state_sec_ctx" data-ref-filename="copy_to_user_state_sec_ctx">copy_to_user_state_sec_ctx</a>(<a class="local col4 ref" href="#504x" title='x' data-ref="504x" data-ref-filename="504x">x</a>, <a class="local col3 ref" href="#503skb" title='skb' data-ref="503skb" data-ref-filename="503skb">skb</a>);</td></tr>
<tr><th id="2854">2854</th><td>	<b>if</b> (!<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a>)</td></tr>
<tr><th id="2855">2855</th><td>		<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a> = <a class="tu ref fn" href="#copy_to_user_policy_type" title='copy_to_user_policy_type' data-use='c' data-ref="copy_to_user_policy_type" data-ref-filename="copy_to_user_policy_type">copy_to_user_policy_type</a>(<a class="local col6 ref" href="#506xp" title='xp' data-ref="506xp" data-ref-filename="506xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::type" title='xfrm_policy::type' data-ref="xfrm_policy::type" data-ref-filename="xfrm_policy..type">type</a>, <a class="local col3 ref" href="#503skb" title='skb' data-ref="503skb" data-ref-filename="503skb">skb</a>);</td></tr>
<tr><th id="2856">2856</th><td>	<b>if</b> (!<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a>)</td></tr>
<tr><th id="2857">2857</th><td>		<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_put" title='xfrm_mark_put' data-ref="xfrm_mark_put" data-ref-filename="xfrm_mark_put">xfrm_mark_put</a>(<a class="local col3 ref" href="#503skb" title='skb' data-ref="503skb" data-ref-filename="503skb">skb</a>, &amp;<a class="local col6 ref" href="#506xp" title='xp' data-ref="506xp" data-ref-filename="506xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::mark" title='xfrm_policy::mark' data-ref="xfrm_policy::mark" data-ref-filename="xfrm_policy..mark">mark</a>);</td></tr>
<tr><th id="2858">2858</th><td>	<b>if</b> (<a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a>) {</td></tr>
<tr><th id="2859">2859</th><td>		<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col3 ref" href="#503skb" title='skb' data-ref="503skb" data-ref-filename="503skb">skb</a>, <a class="local col9 ref" href="#509nlh" title='nlh' data-ref="509nlh" data-ref-filename="509nlh">nlh</a>);</td></tr>
<tr><th id="2860">2860</th><td>		<b>return</b> <a class="local col0 ref" href="#510err" title='err' data-ref="510err" data-ref-filename="510err">err</a>;</td></tr>
<tr><th id="2861">2861</th><td>	}</td></tr>
<tr><th id="2862">2862</th><td></td></tr>
<tr><th id="2863">2863</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col3 ref" href="#503skb" title='skb' data-ref="503skb" data-ref-filename="503skb">skb</a>, <a class="local col9 ref" href="#509nlh" title='nlh' data-ref="509nlh" data-ref-filename="509nlh">nlh</a>);</td></tr>
<tr><th id="2864">2864</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2865">2865</th><td>}</td></tr>
<tr><th id="2866">2866</th><td></td></tr>
<tr><th id="2867">2867</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_send_acquire" title='xfrm_send_acquire' data-type='int xfrm_send_acquire(struct xfrm_state * x, struct xfrm_tmpl * xt, struct xfrm_policy * xp)' data-ref="xfrm_send_acquire" data-ref-filename="xfrm_send_acquire">xfrm_send_acquire</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col1 decl" id="511x" title='x' data-type='struct xfrm_state *' data-ref="511x" data-ref-filename="511x">x</dfn>, <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_tmpl" title='xfrm_tmpl' data-ref="xfrm_tmpl" data-ref-filename="xfrm_tmpl">xfrm_tmpl</a> *<dfn class="local col2 decl" id="512xt" title='xt' data-type='struct xfrm_tmpl *' data-ref="512xt" data-ref-filename="512xt">xt</dfn>,</td></tr>
<tr><th id="2868">2868</th><td>			     <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col3 decl" id="513xp" title='xp' data-type='struct xfrm_policy *' data-ref="513xp" data-ref-filename="513xp">xp</dfn>)</td></tr>
<tr><th id="2869">2869</th><td>{</td></tr>
<tr><th id="2870">2870</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col4 decl" id="514net" title='net' data-type='struct net *' data-ref="514net" data-ref-filename="514net">net</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xs_net" title='xs_net' data-ref="xs_net" data-ref-filename="xs_net">xs_net</a>(<a class="local col1 ref" href="#511x" title='x' data-ref="511x" data-ref-filename="511x">x</a>);</td></tr>
<tr><th id="2871">2871</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col5 decl" id="515skb" title='skb' data-type='struct sk_buff *' data-ref="515skb" data-ref-filename="515skb">skb</dfn>;</td></tr>
<tr><th id="2872">2872</th><td>	<em>int</em> <dfn class="local col6 decl" id="516err" title='err' data-type='int' data-ref="516err" data-ref-filename="516err">err</dfn>;</td></tr>
<tr><th id="2873">2873</th><td></td></tr>
<tr><th id="2874">2874</th><td>	<a class="local col5 ref" href="#515skb" title='skb' data-ref="515skb" data-ref-filename="515skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_acquire_msgsize" title='xfrm_acquire_msgsize' data-use='c' data-ref="xfrm_acquire_msgsize" data-ref-filename="xfrm_acquire_msgsize">xfrm_acquire_msgsize</a>(<a class="local col1 ref" href="#511x" title='x' data-ref="511x" data-ref-filename="511x">x</a>, <a class="local col3 ref" href="#513xp" title='xp' data-ref="513xp" data-ref-filename="513xp">xp</a>), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="2875">2875</th><td>	<b>if</b> (<a class="local col5 ref" href="#515skb" title='skb' data-ref="515skb" data-ref-filename="515skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2876">2876</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="2877">2877</th><td></td></tr>
<tr><th id="2878">2878</th><td>	<a class="local col6 ref" href="#516err" title='err' data-ref="516err" data-ref-filename="516err">err</a> = <a class="tu ref fn" href="#build_acquire" title='build_acquire' data-use='c' data-ref="build_acquire" data-ref-filename="build_acquire">build_acquire</a>(<a class="local col5 ref" href="#515skb" title='skb' data-ref="515skb" data-ref-filename="515skb">skb</a>, <a class="local col1 ref" href="#511x" title='x' data-ref="511x" data-ref-filename="511x">x</a>, <a class="local col2 ref" href="#512xt" title='xt' data-ref="512xt" data-ref-filename="512xt">xt</a>, <a class="local col3 ref" href="#513xp" title='xp' data-ref="513xp" data-ref-filename="513xp">xp</a>);</td></tr>
<tr><th id="2879">2879</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (2879), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (142)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col6 ref" href="#516err" title='err' data-ref="516err" data-ref-filename="516err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="2880">2880</th><td></td></tr>
<tr><th id="2881">2881</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col4 ref" href="#514net" title='net' data-ref="514net" data-ref-filename="514net">net</a>, <a class="local col5 ref" href="#515skb" title='skb' data-ref="515skb" data-ref-filename="515skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#520" title="XFRMNLGRP_ACQUIRE" data-ref="_M/XFRMNLGRP_ACQUIRE">XFRMNLGRP_ACQUIRE</a>);</td></tr>
<tr><th id="2882">2882</th><td>}</td></tr>
<tr><th id="2883">2883</th><td></td></tr>
<tr><th id="2884">2884</th><td><i  data-doc="xfrm_compile_policy">/* User gives us xfrm_user_policy_info followed by an array of 0</i></td></tr>
<tr><th id="2885">2885</th><td><i  data-doc="xfrm_compile_policy"> * or more templates.</i></td></tr>
<tr><th id="2886">2886</th><td><i  data-doc="xfrm_compile_policy"> */</i></td></tr>
<tr><th id="2887">2887</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="tu decl def fn" id="xfrm_compile_policy" title='xfrm_compile_policy' data-type='struct xfrm_policy * xfrm_compile_policy(struct sock * sk, int opt, u8 * data, int len, int * dir)' data-ref="xfrm_compile_policy" data-ref-filename="xfrm_compile_policy">xfrm_compile_policy</dfn>(<b>struct</b> <a class="type" href="../../include/net/sock.h.html#sock" title='sock' data-ref="sock" data-ref-filename="sock">sock</a> *<dfn class="local col7 decl" id="517sk" title='sk' data-type='struct sock *' data-ref="517sk" data-ref-filename="517sk">sk</dfn>, <em>int</em> <dfn class="local col8 decl" id="518opt" title='opt' data-type='int' data-ref="518opt" data-ref-filename="518opt">opt</dfn>,</td></tr>
<tr><th id="2888">2888</th><td>					       <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> *<dfn class="local col9 decl" id="519data" title='data' data-type='u8 *' data-ref="519data" data-ref-filename="519data">data</dfn>, <em>int</em> <dfn class="local col0 decl" id="520len" title='len' data-type='int' data-ref="520len" data-ref-filename="520len">len</dfn>, <em>int</em> *<dfn class="local col1 decl" id="521dir" title='dir' data-type='int *' data-ref="521dir" data-ref-filename="521dir">dir</dfn>)</td></tr>
<tr><th id="2889">2889</th><td>{</td></tr>
<tr><th id="2890">2890</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col2 decl" id="522net" title='net' data-type='struct net *' data-ref="522net" data-ref-filename="522net">net</dfn> = <a class="ref fn" href="../../include/net/sock.h.html#sock_net" title='sock_net' data-ref="sock_net" data-ref-filename="sock_net">sock_net</a>(<a class="local col7 ref" href="#517sk" title='sk' data-ref="517sk" data-ref-filename="517sk">sk</a>);</td></tr>
<tr><th id="2891">2891</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col3 decl" id="523p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="523p" data-ref-filename="523p">p</dfn> = (<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *)<a class="local col9 ref" href="#519data" title='data' data-ref="519data" data-ref-filename="519data">data</a>;</td></tr>
<tr><th id="2892">2892</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> *<dfn class="local col4 decl" id="524ut" title='ut' data-type='struct xfrm_user_tmpl *' data-ref="524ut" data-ref-filename="524ut">ut</dfn> = (<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a> *) (<a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a> + <var>1</var>);</td></tr>
<tr><th id="2893">2893</th><td>	<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col5 decl" id="525xp" title='xp' data-type='struct xfrm_policy *' data-ref="525xp" data-ref-filename="525xp">xp</dfn>;</td></tr>
<tr><th id="2894">2894</th><td>	<em>int</em> <dfn class="local col6 decl" id="526nr" title='nr' data-type='int' data-ref="526nr" data-ref-filename="526nr">nr</dfn>;</td></tr>
<tr><th id="2895">2895</th><td></td></tr>
<tr><th id="2896">2896</th><td>	<b>switch</b> (<a class="local col7 ref" href="#517sk" title='sk' data-ref="517sk" data-ref-filename="517sk">sk</a>-&gt;<a class="macro" href="../../include/net/sock.h.html#338" title="__sk_common.skc_family" data-ref="_M/sk_family">sk_family</a>) {</td></tr>
<tr><th id="2897">2897</th><td>	<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#164" title="2" data-ref="_M/AF_INET">AF_INET</a>:</td></tr>
<tr><th id="2898">2898</th><td>		<b>if</b> (<a class="local col8 ref" href="#518opt" title='opt' data-ref="518opt" data-ref-filename="518opt">opt</a> != <a class="macro" href="../../include/uapi/linux/in.h.html#106" title="17" data-ref="_M/IP_XFRM_POLICY">IP_XFRM_POLICY</a>) {</td></tr>
<tr><th id="2899">2899</th><td>			*<a class="local col1 ref" href="#521dir" title='dir' data-ref="521dir" data-ref-filename="521dir">dir</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#78" title="95" data-ref="_M/EOPNOTSUPP">EOPNOTSUPP</a>;</td></tr>
<tr><th id="2900">2900</th><td>			<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2901">2901</th><td>		}</td></tr>
<tr><th id="2902">2902</th><td>		<b>break</b>;</td></tr>
<tr><th id="2903">2903</th><td><u>#<span data-ppcond="2903">if</span> <a class="macro" href="../../include/linux/kconfig.h.html#71" title="1" data-ref="_M/IS_ENABLED">IS_ENABLED</a>(<a class="macro" href="../../include/generated/autoconf.h.html#77" title="1" data-ref="_M/CONFIG_IPV6">CONFIG_IPV6</a>)</u></td></tr>
<tr><th id="2904">2904</th><td>	<b>case</b> <a class="macro" href="../../include/linux/socket.h.html#172" title="10" data-ref="_M/AF_INET6">AF_INET6</a>:</td></tr>
<tr><th id="2905">2905</th><td>		<b>if</b> (<a class="local col8 ref" href="#518opt" title='opt' data-ref="518opt" data-ref-filename="518opt">opt</a> != <a class="macro" href="../../include/uapi/linux/in6.h.html#200" title="35" data-ref="_M/IPV6_XFRM_POLICY">IPV6_XFRM_POLICY</a>) {</td></tr>
<tr><th id="2906">2906</th><td>			*<a class="local col1 ref" href="#521dir" title='dir' data-ref="521dir" data-ref-filename="521dir">dir</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#78" title="95" data-ref="_M/EOPNOTSUPP">EOPNOTSUPP</a>;</td></tr>
<tr><th id="2907">2907</th><td>			<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2908">2908</th><td>		}</td></tr>
<tr><th id="2909">2909</th><td>		<b>break</b>;</td></tr>
<tr><th id="2910">2910</th><td><u>#<span data-ppcond="2903">endif</span></u></td></tr>
<tr><th id="2911">2911</th><td>	<b>default</b>:</td></tr>
<tr><th id="2912">2912</th><td>		*<a class="local col1 ref" href="#521dir" title='dir' data-ref="521dir" data-ref-filename="521dir">dir</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="2913">2913</th><td>		<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2914">2914</th><td>	}</td></tr>
<tr><th id="2915">2915</th><td></td></tr>
<tr><th id="2916">2916</th><td>	*<a class="local col1 ref" href="#521dir" title='dir' data-ref="521dir" data-ref-filename="521dir">dir</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="2917">2917</th><td></td></tr>
<tr><th id="2918">2918</th><td>	<b>if</b> (<a class="local col0 ref" href="#520len" title='len' data-ref="520len" data-ref-filename="520len">len</a> &lt; <b>sizeof</b>(*<a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a>) ||</td></tr>
<tr><th id="2919">2919</th><td>	    <a class="tu ref fn" href="#verify_newpolicy_info" title='verify_newpolicy_info' data-use='c' data-ref="verify_newpolicy_info" data-ref-filename="verify_newpolicy_info">verify_newpolicy_info</a>(<a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a>))</td></tr>
<tr><th id="2920">2920</th><td>		<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2921">2921</th><td></td></tr>
<tr><th id="2922">2922</th><td>	<a class="local col6 ref" href="#526nr" title='nr' data-ref="526nr" data-ref-filename="526nr">nr</a> = ((<a class="local col0 ref" href="#520len" title='len' data-ref="520len" data-ref-filename="520len">len</a> - <b>sizeof</b>(*<a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a>)) / <b>sizeof</b>(*<a class="local col4 ref" href="#524ut" title='ut' data-ref="524ut" data-ref-filename="524ut">ut</a>));</td></tr>
<tr><th id="2923">2923</th><td>	<b>if</b> (<a class="tu ref fn" href="#validate_tmpl" title='validate_tmpl' data-use='c' data-ref="validate_tmpl" data-ref-filename="validate_tmpl">validate_tmpl</a>(<a class="local col6 ref" href="#526nr" title='nr' data-ref="526nr" data-ref-filename="526nr">nr</a>, <a class="local col4 ref" href="#524ut" title='ut' data-ref="524ut" data-ref-filename="524ut">ut</a>, <a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::sel" title='xfrm_userpolicy_info::sel' data-ref="xfrm_userpolicy_info::sel" data-ref-filename="xfrm_userpolicy_info..sel">sel</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector::family" title='xfrm_selector::family' data-ref="xfrm_selector::family" data-ref-filename="xfrm_selector..family">family</a>))</td></tr>
<tr><th id="2924">2924</th><td>		<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2925">2925</th><td></td></tr>
<tr><th id="2926">2926</th><td>	<b>if</b> (<a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a> &gt; <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_OUT" title='XFRM_POLICY_OUT' data-ref="XFRM_POLICY_OUT" data-ref-filename="XFRM_POLICY_OUT">XFRM_POLICY_OUT</a>)</td></tr>
<tr><th id="2927">2927</th><td>		<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2928">2928</th><td></td></tr>
<tr><th id="2929">2929</th><td>	<a class="local col5 ref" href="#525xp" title='xp' data-ref="525xp" data-ref-filename="525xp">xp</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_policy_alloc" title='xfrm_policy_alloc' data-ref="xfrm_policy_alloc" data-ref-filename="xfrm_policy_alloc">xfrm_policy_alloc</a>(<a class="local col2 ref" href="#522net" title='net' data-ref="522net" data-ref-filename="522net">net</a>, <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="2930">2930</th><td>	<b>if</b> (<a class="local col5 ref" href="#525xp" title='xp' data-ref="525xp" data-ref-filename="525xp">xp</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>) {</td></tr>
<tr><th id="2931">2931</th><td>		*<a class="local col1 ref" href="#521dir" title='dir' data-ref="521dir" data-ref-filename="521dir">dir</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#88" title="105" data-ref="_M/ENOBUFS">ENOBUFS</a>;</td></tr>
<tr><th id="2932">2932</th><td>		<b>return</b> <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>;</td></tr>
<tr><th id="2933">2933</th><td>	}</td></tr>
<tr><th id="2934">2934</th><td></td></tr>
<tr><th id="2935">2935</th><td>	<a class="tu ref fn" href="#copy_from_user_policy" title='copy_from_user_policy' data-use='c' data-ref="copy_from_user_policy" data-ref-filename="copy_from_user_policy">copy_from_user_policy</a>(<a class="local col5 ref" href="#525xp" title='xp' data-ref="525xp" data-ref-filename="525xp">xp</a>, <a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a>);</td></tr>
<tr><th id="2936">2936</th><td>	<a class="local col5 ref" href="#525xp" title='xp' data-ref="525xp" data-ref-filename="525xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::type" title='xfrm_policy::type' data-ref="xfrm_policy::type" data-ref-filename="xfrm_policy..type">type</a> = <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRM_POLICY_TYPE_MAIN" title='XFRM_POLICY_TYPE_MAIN' data-ref="XFRM_POLICY_TYPE_MAIN" data-ref-filename="XFRM_POLICY_TYPE_MAIN">XFRM_POLICY_TYPE_MAIN</a>;</td></tr>
<tr><th id="2937">2937</th><td>	<a class="tu ref fn" href="#copy_templates" title='copy_templates' data-use='c' data-ref="copy_templates" data-ref-filename="copy_templates">copy_templates</a>(<a class="local col5 ref" href="#525xp" title='xp' data-ref="525xp" data-ref-filename="525xp">xp</a>, <a class="local col4 ref" href="#524ut" title='ut' data-ref="524ut" data-ref-filename="524ut">ut</a>, <a class="local col6 ref" href="#526nr" title='nr' data-ref="526nr" data-ref-filename="526nr">nr</a>);</td></tr>
<tr><th id="2938">2938</th><td></td></tr>
<tr><th id="2939">2939</th><td>	*<a class="local col1 ref" href="#521dir" title='dir' data-ref="521dir" data-ref-filename="521dir">dir</a> = <a class="local col3 ref" href="#523p" title='p' data-ref="523p" data-ref-filename="523p">p</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info::dir" title='xfrm_userpolicy_info::dir' data-ref="xfrm_userpolicy_info::dir" data-ref-filename="xfrm_userpolicy_info..dir">dir</a>;</td></tr>
<tr><th id="2940">2940</th><td></td></tr>
<tr><th id="2941">2941</th><td>	<b>return</b> <a class="local col5 ref" href="#525xp" title='xp' data-ref="525xp" data-ref-filename="525xp">xp</a>;</td></tr>
<tr><th id="2942">2942</th><td>}</td></tr>
<tr><th id="2943">2943</th><td></td></tr>
<tr><th id="2944">2944</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_polexpire_msgsize" title='xfrm_polexpire_msgsize' data-type='unsigned int xfrm_polexpire_msgsize(struct xfrm_policy * xp)' data-ref="xfrm_polexpire_msgsize" data-ref-filename="xfrm_polexpire_msgsize">xfrm_polexpire_msgsize</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col7 decl" id="527xp" title='xp' data-type='struct xfrm_policy *' data-ref="527xp" data-ref-filename="527xp">xp</dfn>)</td></tr>
<tr><th id="2945">2945</th><td>{</td></tr>
<tr><th id="2946">2946</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((sizeof(struct xfrm_user_polexpire))+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire" title='xfrm_user_polexpire' data-ref="xfrm_user_polexpire" data-ref-filename="xfrm_user_polexpire">xfrm_user_polexpire</a>))</td></tr>
<tr><th id="2947">2947</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a>) * <a class="local col7 ref" href="#527xp" title='xp' data-ref="527xp" data-ref-filename="527xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a>)</td></tr>
<tr><th id="2948">2948</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="tu ref fn" href="#xfrm_user_sec_ctx_size" title='xfrm_user_sec_ctx_size' data-use='c' data-ref="xfrm_user_sec_ctx_size" data-ref-filename="xfrm_user_sec_ctx_size">xfrm_user_sec_ctx_size</a>(<a class="local col7 ref" href="#527xp" title='xp' data-ref="527xp" data-ref-filename="527xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::security" title='xfrm_policy::security' data-ref="xfrm_policy::security" data-ref-filename="xfrm_policy..security">security</a>))</td></tr>
<tr><th id="2949">2949</th><td>	       + <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a>))</td></tr>
<tr><th id="2950">2950</th><td>	       + <a class="tu ref fn" href="#userpolicy_type_attrsize" title='userpolicy_type_attrsize' data-use='c' data-ref="userpolicy_type_attrsize" data-ref-filename="userpolicy_type_attrsize">userpolicy_type_attrsize</a>();</td></tr>
<tr><th id="2951">2951</th><td>}</td></tr>
<tr><th id="2952">2952</th><td></td></tr>
<tr><th id="2953">2953</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_polexpire" title='build_polexpire' data-type='int build_polexpire(struct sk_buff * skb, struct xfrm_policy * xp, int dir, const struct km_event * c)' data-ref="build_polexpire" data-ref-filename="build_polexpire">build_polexpire</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col8 decl" id="528skb" title='skb' data-type='struct sk_buff *' data-ref="528skb" data-ref-filename="528skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col9 decl" id="529xp" title='xp' data-type='struct xfrm_policy *' data-ref="529xp" data-ref-filename="529xp">xp</dfn>,</td></tr>
<tr><th id="2954">2954</th><td>			   <em>int</em> <dfn class="local col0 decl" id="530dir" title='dir' data-type='int' data-ref="530dir" data-ref-filename="530dir">dir</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col1 decl" id="531c" title='c' data-type='const struct km_event *' data-ref="531c" data-ref-filename="531c">c</dfn>)</td></tr>
<tr><th id="2955">2955</th><td>{</td></tr>
<tr><th id="2956">2956</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire" title='xfrm_user_polexpire' data-ref="xfrm_user_polexpire" data-ref-filename="xfrm_user_polexpire">xfrm_user_polexpire</a> *<dfn class="local col2 decl" id="532upe" title='upe' data-type='struct xfrm_user_polexpire *' data-ref="532upe" data-ref-filename="532upe">upe</dfn>;</td></tr>
<tr><th id="2957">2957</th><td>	<em>int</em> <dfn class="local col3 decl" id="533hard" title='hard' data-type='int' data-ref="533hard" data-ref-filename="533hard">hard</dfn> = <a class="local col1 ref" href="#531c" title='c' data-ref="531c" data-ref-filename="531c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::hard" title='km_event::(anonymous union)::hard' data-ref="km_event::(anonymous)::hard" data-ref-filename="km_event..(anonymous)..hard">hard</a>;</td></tr>
<tr><th id="2958">2958</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col4 decl" id="534nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="534nlh" data-ref-filename="534nlh">nlh</dfn>;</td></tr>
<tr><th id="2959">2959</th><td>	<em>int</em> <dfn class="local col5 decl" id="535err" title='err' data-type='int' data-ref="535err" data-ref-filename="535err">err</dfn>;</td></tr>
<tr><th id="2960">2960</th><td></td></tr>
<tr><th id="2961">2961</th><td>	<a class="local col4 ref" href="#534nlh" title='nlh' data-ref="534nlh" data-ref-filename="534nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col8 ref" href="#528skb" title='skb' data-ref="528skb" data-ref-filename="528skb">skb</a>, <a class="local col1 ref" href="#531c" title='c' data-ref="531c" data-ref-filename="531c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#188" title="XFRM_MSG_POLEXPIRE" data-ref="_M/XFRM_MSG_POLEXPIRE">XFRM_MSG_POLEXPIRE</a>, <b>sizeof</b>(*<a class="local col2 ref" href="#532upe" title='upe' data-ref="532upe" data-ref-filename="532upe">upe</a>), <var>0</var>);</td></tr>
<tr><th id="2962">2962</th><td>	<b>if</b> (<a class="local col4 ref" href="#534nlh" title='nlh' data-ref="534nlh" data-ref-filename="534nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2963">2963</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="2964">2964</th><td></td></tr>
<tr><th id="2965">2965</th><td>	<a class="local col2 ref" href="#532upe" title='upe' data-ref="532upe" data-ref-filename="532upe">upe</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col4 ref" href="#534nlh" title='nlh' data-ref="534nlh" data-ref-filename="534nlh">nlh</a>);</td></tr>
<tr><th id="2966">2966</th><td>	<a class="tu ref fn" href="#copy_to_user_policy" title='copy_to_user_policy' data-use='c' data-ref="copy_to_user_policy" data-ref-filename="copy_to_user_policy">copy_to_user_policy</a>(<a class="local col9 ref" href="#529xp" title='xp' data-ref="529xp" data-ref-filename="529xp">xp</a>, &amp;<a class="local col2 ref" href="#532upe" title='upe' data-ref="532upe" data-ref-filename="532upe">upe</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire::pol" title='xfrm_user_polexpire::pol' data-ref="xfrm_user_polexpire::pol" data-ref-filename="xfrm_user_polexpire..pol">pol</a>, <a class="local col0 ref" href="#530dir" title='dir' data-ref="530dir" data-ref-filename="530dir">dir</a>);</td></tr>
<tr><th id="2967">2967</th><td>	<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a> = <a class="tu ref fn" href="#copy_to_user_tmpl" title='copy_to_user_tmpl' data-use='c' data-ref="copy_to_user_tmpl" data-ref-filename="copy_to_user_tmpl">copy_to_user_tmpl</a>(<a class="local col9 ref" href="#529xp" title='xp' data-ref="529xp" data-ref-filename="529xp">xp</a>, <a class="local col8 ref" href="#528skb" title='skb' data-ref="528skb" data-ref-filename="528skb">skb</a>);</td></tr>
<tr><th id="2968">2968</th><td>	<b>if</b> (!<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a>)</td></tr>
<tr><th id="2969">2969</th><td>		<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a> = <a class="tu ref fn" href="#copy_to_user_sec_ctx" title='copy_to_user_sec_ctx' data-use='c' data-ref="copy_to_user_sec_ctx" data-ref-filename="copy_to_user_sec_ctx">copy_to_user_sec_ctx</a>(<a class="local col9 ref" href="#529xp" title='xp' data-ref="529xp" data-ref-filename="529xp">xp</a>, <a class="local col8 ref" href="#528skb" title='skb' data-ref="528skb" data-ref-filename="528skb">skb</a>);</td></tr>
<tr><th id="2970">2970</th><td>	<b>if</b> (!<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a>)</td></tr>
<tr><th id="2971">2971</th><td>		<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a> = <a class="tu ref fn" href="#copy_to_user_policy_type" title='copy_to_user_policy_type' data-use='c' data-ref="copy_to_user_policy_type" data-ref-filename="copy_to_user_policy_type">copy_to_user_policy_type</a>(<a class="local col9 ref" href="#529xp" title='xp' data-ref="529xp" data-ref-filename="529xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::type" title='xfrm_policy::type' data-ref="xfrm_policy::type" data-ref-filename="xfrm_policy..type">type</a>, <a class="local col8 ref" href="#528skb" title='skb' data-ref="528skb" data-ref-filename="528skb">skb</a>);</td></tr>
<tr><th id="2972">2972</th><td>	<b>if</b> (!<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a>)</td></tr>
<tr><th id="2973">2973</th><td>		<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_put" title='xfrm_mark_put' data-ref="xfrm_mark_put" data-ref-filename="xfrm_mark_put">xfrm_mark_put</a>(<a class="local col8 ref" href="#528skb" title='skb' data-ref="528skb" data-ref-filename="528skb">skb</a>, &amp;<a class="local col9 ref" href="#529xp" title='xp' data-ref="529xp" data-ref-filename="529xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::mark" title='xfrm_policy::mark' data-ref="xfrm_policy::mark" data-ref-filename="xfrm_policy..mark">mark</a>);</td></tr>
<tr><th id="2974">2974</th><td>	<b>if</b> (<a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a>) {</td></tr>
<tr><th id="2975">2975</th><td>		<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col8 ref" href="#528skb" title='skb' data-ref="528skb" data-ref-filename="528skb">skb</a>, <a class="local col4 ref" href="#534nlh" title='nlh' data-ref="534nlh" data-ref-filename="534nlh">nlh</a>);</td></tr>
<tr><th id="2976">2976</th><td>		<b>return</b> <a class="local col5 ref" href="#535err" title='err' data-ref="535err" data-ref-filename="535err">err</a>;</td></tr>
<tr><th id="2977">2977</th><td>	}</td></tr>
<tr><th id="2978">2978</th><td>	<a class="local col2 ref" href="#532upe" title='upe' data-ref="532upe" data-ref-filename="532upe">upe</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_polexpire::hard" title='xfrm_user_polexpire::hard' data-ref="xfrm_user_polexpire::hard" data-ref-filename="xfrm_user_polexpire..hard">hard</a> = !!<a class="local col3 ref" href="#533hard" title='hard' data-ref="533hard" data-ref-filename="533hard">hard</a>;</td></tr>
<tr><th id="2979">2979</th><td></td></tr>
<tr><th id="2980">2980</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col8 ref" href="#528skb" title='skb' data-ref="528skb" data-ref-filename="528skb">skb</a>, <a class="local col4 ref" href="#534nlh" title='nlh' data-ref="534nlh" data-ref-filename="534nlh">nlh</a>);</td></tr>
<tr><th id="2981">2981</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="2982">2982</th><td>}</td></tr>
<tr><th id="2983">2983</th><td></td></tr>
<tr><th id="2984">2984</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_exp_policy_notify" title='xfrm_exp_policy_notify' data-type='int xfrm_exp_policy_notify(struct xfrm_policy * xp, int dir, const struct km_event * c)' data-ref="xfrm_exp_policy_notify" data-ref-filename="xfrm_exp_policy_notify">xfrm_exp_policy_notify</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col6 decl" id="536xp" title='xp' data-type='struct xfrm_policy *' data-ref="536xp" data-ref-filename="536xp">xp</dfn>, <em>int</em> <dfn class="local col7 decl" id="537dir" title='dir' data-type='int' data-ref="537dir" data-ref-filename="537dir">dir</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col8 decl" id="538c" title='c' data-type='const struct km_event *' data-ref="538c" data-ref-filename="538c">c</dfn>)</td></tr>
<tr><th id="2985">2985</th><td>{</td></tr>
<tr><th id="2986">2986</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col9 decl" id="539net" title='net' data-type='struct net *' data-ref="539net" data-ref-filename="539net">net</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xp_net" title='xp_net' data-ref="xp_net" data-ref-filename="xp_net">xp_net</a>(<a class="local col6 ref" href="#536xp" title='xp' data-ref="536xp" data-ref-filename="536xp">xp</a>);</td></tr>
<tr><th id="2987">2987</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col0 decl" id="540skb" title='skb' data-type='struct sk_buff *' data-ref="540skb" data-ref-filename="540skb">skb</dfn>;</td></tr>
<tr><th id="2988">2988</th><td>	<em>int</em> <dfn class="local col1 decl" id="541err" title='err' data-type='int' data-ref="541err" data-ref-filename="541err">err</dfn>;</td></tr>
<tr><th id="2989">2989</th><td></td></tr>
<tr><th id="2990">2990</th><td>	<a class="local col0 ref" href="#540skb" title='skb' data-ref="540skb" data-ref-filename="540skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_polexpire_msgsize" title='xfrm_polexpire_msgsize' data-use='c' data-ref="xfrm_polexpire_msgsize" data-ref-filename="xfrm_polexpire_msgsize">xfrm_polexpire_msgsize</a>(<a class="local col6 ref" href="#536xp" title='xp' data-ref="536xp" data-ref-filename="536xp">xp</a>), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="2991">2991</th><td>	<b>if</b> (<a class="local col0 ref" href="#540skb" title='skb' data-ref="540skb" data-ref-filename="540skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="2992">2992</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="2993">2993</th><td></td></tr>
<tr><th id="2994">2994</th><td>	<a class="local col1 ref" href="#541err" title='err' data-ref="541err" data-ref-filename="541err">err</a> = <a class="tu ref fn" href="#build_polexpire" title='build_polexpire' data-use='c' data-ref="build_polexpire" data-ref-filename="build_polexpire">build_polexpire</a>(<a class="local col0 ref" href="#540skb" title='skb' data-ref="540skb" data-ref-filename="540skb">skb</a>, <a class="local col6 ref" href="#536xp" title='xp' data-ref="536xp" data-ref-filename="536xp">xp</a>, <a class="local col7 ref" href="#537dir" title='dir' data-ref="537dir" data-ref-filename="537dir">dir</a>, <a class="local col8 ref" href="#538c" title='c' data-ref="538c" data-ref-filename="538c">c</a>);</td></tr>
<tr><th id="2995">2995</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (2995), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (144)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col1 ref" href="#541err" title='err' data-ref="541err" data-ref-filename="541err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="2996">2996</th><td></td></tr>
<tr><th id="2997">2997</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col9 ref" href="#539net" title='net' data-ref="539net" data-ref-filename="539net">net</a>, <a class="local col0 ref" href="#540skb" title='skb' data-ref="540skb" data-ref-filename="540skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#522" title="XFRMNLGRP_EXPIRE" data-ref="_M/XFRMNLGRP_EXPIRE">XFRMNLGRP_EXPIRE</a>);</td></tr>
<tr><th id="2998">2998</th><td>}</td></tr>
<tr><th id="2999">2999</th><td></td></tr>
<tr><th id="3000">3000</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_notify_policy" title='xfrm_notify_policy' data-type='int xfrm_notify_policy(struct xfrm_policy * xp, int dir, const struct km_event * c)' data-ref="xfrm_notify_policy" data-ref-filename="xfrm_notify_policy">xfrm_notify_policy</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col2 decl" id="542xp" title='xp' data-type='struct xfrm_policy *' data-ref="542xp" data-ref-filename="542xp">xp</dfn>, <em>int</em> <dfn class="local col3 decl" id="543dir" title='dir' data-type='int' data-ref="543dir" data-ref-filename="543dir">dir</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col4 decl" id="544c" title='c' data-type='const struct km_event *' data-ref="544c" data-ref-filename="544c">c</dfn>)</td></tr>
<tr><th id="3001">3001</th><td>{</td></tr>
<tr><th id="3002">3002</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col5 decl" id="545len" title='len' data-type='unsigned int' data-ref="545len" data-ref-filename="545len">len</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_tmpl" title='xfrm_user_tmpl' data-ref="xfrm_user_tmpl" data-ref-filename="xfrm_user_tmpl">xfrm_user_tmpl</a>) * <a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::xfrm_nr" title='xfrm_policy::xfrm_nr' data-ref="xfrm_policy::xfrm_nr" data-ref-filename="xfrm_policy..xfrm_nr">xfrm_nr</a>);</td></tr>
<tr><th id="3003">3003</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col6 decl" id="546net" title='net' data-type='struct net *' data-ref="546net" data-ref-filename="546net">net</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xp_net" title='xp_net' data-ref="xp_net" data-ref-filename="xp_net">xp_net</a>(<a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>);</td></tr>
<tr><th id="3004">3004</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_info" title='xfrm_userpolicy_info' data-ref="xfrm_userpolicy_info" data-ref-filename="xfrm_userpolicy_info">xfrm_userpolicy_info</a> *<dfn class="local col7 decl" id="547p" title='p' data-type='struct xfrm_userpolicy_info *' data-ref="547p" data-ref-filename="547p">p</dfn>;</td></tr>
<tr><th id="3005">3005</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id" title='xfrm_userpolicy_id' data-ref="xfrm_userpolicy_id" data-ref-filename="xfrm_userpolicy_id">xfrm_userpolicy_id</a> *<dfn class="local col8 decl" id="548id" title='id' data-type='struct xfrm_userpolicy_id *' data-ref="548id" data-ref-filename="548id">id</dfn>;</td></tr>
<tr><th id="3006">3006</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col9 decl" id="549nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="549nlh" data-ref-filename="549nlh">nlh</dfn>;</td></tr>
<tr><th id="3007">3007</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col0 decl" id="550skb" title='skb' data-type='struct sk_buff *' data-ref="550skb" data-ref-filename="550skb">skb</dfn>;</td></tr>
<tr><th id="3008">3008</th><td>	<em>unsigned</em> <em>int</em> <dfn class="local col1 decl" id="551headlen" title='headlen' data-type='unsigned int' data-ref="551headlen" data-ref-filename="551headlen">headlen</dfn>;</td></tr>
<tr><th id="3009">3009</th><td>	<em>int</em> <dfn class="local col2 decl" id="552err" title='err' data-type='int' data-ref="552err" data-ref-filename="552err">err</dfn>;</td></tr>
<tr><th id="3010">3010</th><td></td></tr>
<tr><th id="3011">3011</th><td>	<a class="local col1 ref" href="#551headlen" title='headlen' data-ref="551headlen" data-ref-filename="551headlen">headlen</a> = <b>sizeof</b>(*<a class="local col7 ref" href="#547p" title='p' data-ref="547p" data-ref-filename="547p">p</a>);</td></tr>
<tr><th id="3012">3012</th><td>	<b>if</b> (<a class="local col4 ref" href="#544c" title='c' data-ref="544c" data-ref-filename="544c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#171" title="XFRM_MSG_DELPOLICY" data-ref="_M/XFRM_MSG_DELPOLICY">XFRM_MSG_DELPOLICY</a>) {</td></tr>
<tr><th id="3013">3013</th><td>		<a class="local col5 ref" href="#545len" title='len' data-ref="545len" data-ref-filename="545len">len</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<a class="local col1 ref" href="#551headlen" title='headlen' data-ref="551headlen" data-ref-filename="551headlen">headlen</a>);</td></tr>
<tr><th id="3014">3014</th><td>		<a class="local col1 ref" href="#551headlen" title='headlen' data-ref="551headlen" data-ref-filename="551headlen">headlen</a> = <b>sizeof</b>(*<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a>);</td></tr>
<tr><th id="3015">3015</th><td>	}</td></tr>
<tr><th id="3016">3016</th><td>	<a class="local col5 ref" href="#545len" title='len' data-ref="545len" data-ref-filename="545len">len</a> += <a class="tu ref fn" href="#userpolicy_type_attrsize" title='userpolicy_type_attrsize' data-use='c' data-ref="userpolicy_type_attrsize" data-ref-filename="userpolicy_type_attrsize">userpolicy_type_attrsize</a>();</td></tr>
<tr><th id="3017">3017</th><td>	<a class="local col5 ref" href="#545len" title='len' data-ref="545len" data-ref-filename="545len">len</a> += <a class="ref fn" href="../../include/net/netlink.h.html#nla_total_size" title='nla_total_size' data-ref="nla_total_size" data-ref-filename="nla_total_size">nla_total_size</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_mark" title='xfrm_mark' data-ref="xfrm_mark" data-ref-filename="xfrm_mark">xfrm_mark</a>));</td></tr>
<tr><th id="3018">3018</th><td>	<a class="local col5 ref" href="#545len" title='len' data-ref="545len" data-ref-filename="545len">len</a> += <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((headlen)+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<a class="local col1 ref" href="#551headlen" title='headlen' data-ref="551headlen" data-ref-filename="551headlen">headlen</a>);</td></tr>
<tr><th id="3019">3019</th><td></td></tr>
<tr><th id="3020">3020</th><td>	<a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="local col5 ref" href="#545len" title='len' data-ref="545len" data-ref-filename="545len">len</a>, <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="3021">3021</th><td>	<b>if</b> (<a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3022">3022</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="3023">3023</th><td></td></tr>
<tr><th id="3024">3024</th><td>	<a class="local col9 ref" href="#549nlh" title='nlh' data-ref="549nlh" data-ref-filename="549nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>, <a class="local col4 ref" href="#544c" title='c' data-ref="544c" data-ref-filename="544c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a>, <a class="local col4 ref" href="#544c" title='c' data-ref="544c" data-ref-filename="544c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a>, <a class="local col4 ref" href="#544c" title='c' data-ref="544c" data-ref-filename="544c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a>, <a class="local col1 ref" href="#551headlen" title='headlen' data-ref="551headlen" data-ref-filename="551headlen">headlen</a>, <var>0</var>);</td></tr>
<tr><th id="3025">3025</th><td>	<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="3026">3026</th><td>	<b>if</b> (<a class="local col9 ref" href="#549nlh" title='nlh' data-ref="549nlh" data-ref-filename="549nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3027">3027</th><td>		<b>goto</b> <a class="lbl" href="#553out_free_skb" data-ref="553out_free_skb" data-ref-filename="553out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="3028">3028</th><td></td></tr>
<tr><th id="3029">3029</th><td>	<a class="local col7 ref" href="#547p" title='p' data-ref="547p" data-ref-filename="547p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col9 ref" href="#549nlh" title='nlh' data-ref="549nlh" data-ref-filename="549nlh">nlh</a>);</td></tr>
<tr><th id="3030">3030</th><td>	<b>if</b> (<a class="local col4 ref" href="#544c" title='c' data-ref="544c" data-ref-filename="544c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a> == <a class="macro" href="../../include/uapi/linux/xfrm.h.html#171" title="XFRM_MSG_DELPOLICY" data-ref="_M/XFRM_MSG_DELPOLICY">XFRM_MSG_DELPOLICY</a>) {</td></tr>
<tr><th id="3031">3031</th><td>		<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlattr" title='nlattr' data-ref="nlattr" data-ref-filename="nlattr">nlattr</a> *<dfn class="local col4 decl" id="554attr" title='attr' data-type='struct nlattr *' data-ref="554attr" data-ref-filename="554attr">attr</dfn>;</td></tr>
<tr><th id="3032">3032</th><td></td></tr>
<tr><th id="3033">3033</th><td>		<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col9 ref" href="#549nlh" title='nlh' data-ref="549nlh" data-ref-filename="549nlh">nlh</a>);</td></tr>
<tr><th id="3034">3034</th><td>		<a class="ref fn" href="../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a>, <var>0</var>, <b>sizeof</b>(*<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a>));</td></tr>
<tr><th id="3035">3035</th><td>		<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::dir" title='xfrm_userpolicy_id::dir' data-ref="xfrm_userpolicy_id::dir" data-ref-filename="xfrm_userpolicy_id..dir">dir</a> = <a class="local col3 ref" href="#543dir" title='dir' data-ref="543dir" data-ref-filename="543dir">dir</a>;</td></tr>
<tr><th id="3036">3036</th><td>		<b>if</b> (<a class="local col4 ref" href="#544c" title='c' data-ref="544c" data-ref-filename="544c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::byid" title='km_event::(anonymous union)::byid' data-ref="km_event::(anonymous)::byid" data-ref-filename="km_event..(anonymous)..byid">byid</a>)</td></tr>
<tr><th id="3037">3037</th><td>			<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::index" title='xfrm_userpolicy_id::index' data-ref="xfrm_userpolicy_id::index" data-ref-filename="xfrm_userpolicy_id..index">index</a> = <a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::index" title='xfrm_policy::index' data-ref="xfrm_policy::index" data-ref-filename="xfrm_policy..index">index</a>;</td></tr>
<tr><th id="3038">3038</th><td>		<b>else</b></td></tr>
<tr><th id="3039">3039</th><td>			<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(id-&gt;sel)); void *__ret; if (__builtin_constant_p(sizeof(id-&gt;sel)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;id-&gt;sel), (&amp;xp-&gt;selector), __len); else __ret = __builtin_memcpy((&amp;id-&gt;sel), (&amp;xp-&gt;selector), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::sel" title='xfrm_userpolicy_id::sel' data-ref="xfrm_userpolicy_id::sel" data-ref-filename="xfrm_userpolicy_id..sel">sel</a>, &amp;<a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::selector" title='xfrm_policy::selector' data-ref="xfrm_policy::selector" data-ref-filename="xfrm_policy..selector">selector</a>, <b>sizeof</b>(<a class="local col8 ref" href="#548id" title='id' data-ref="548id" data-ref-filename="548id">id</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_userpolicy_id::sel" title='xfrm_userpolicy_id::sel' data-ref="xfrm_userpolicy_id::sel" data-ref-filename="xfrm_userpolicy_id..sel">sel</a>));</td></tr>
<tr><th id="3040">3040</th><td></td></tr>
<tr><th id="3041">3041</th><td>		<a class="local col4 ref" href="#554attr" title='attr' data-ref="554attr" data-ref-filename="554attr">attr</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_reserve" title='nla_reserve' data-ref="nla_reserve" data-ref-filename="nla_reserve">nla_reserve</a>(<a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_POLICY" title='XFRMA_POLICY' data-ref="XFRMA_POLICY" data-ref-filename="XFRMA_POLICY">XFRMA_POLICY</a>, <b>sizeof</b>(*<a class="local col7 ref" href="#547p" title='p' data-ref="547p" data-ref-filename="547p">p</a>));</td></tr>
<tr><th id="3042">3042</th><td>		<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="3043">3043</th><td>		<b>if</b> (<a class="local col4 ref" href="#554attr" title='attr' data-ref="554attr" data-ref-filename="554attr">attr</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3044">3044</th><td>			<b>goto</b> <a class="lbl" href="#553out_free_skb" data-ref="553out_free_skb" data-ref-filename="553out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="3045">3045</th><td></td></tr>
<tr><th id="3046">3046</th><td>		<a class="local col7 ref" href="#547p" title='p' data-ref="547p" data-ref-filename="547p">p</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_data" title='nla_data' data-ref="nla_data" data-ref-filename="nla_data">nla_data</a>(<a class="local col4 ref" href="#554attr" title='attr' data-ref="554attr" data-ref-filename="554attr">attr</a>);</td></tr>
<tr><th id="3047">3047</th><td>	}</td></tr>
<tr><th id="3048">3048</th><td></td></tr>
<tr><th id="3049">3049</th><td>	<a class="tu ref fn" href="#copy_to_user_policy" title='copy_to_user_policy' data-use='c' data-ref="copy_to_user_policy" data-ref-filename="copy_to_user_policy">copy_to_user_policy</a>(<a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>, <a class="local col7 ref" href="#547p" title='p' data-ref="547p" data-ref-filename="547p">p</a>, <a class="local col3 ref" href="#543dir" title='dir' data-ref="543dir" data-ref-filename="543dir">dir</a>);</td></tr>
<tr><th id="3050">3050</th><td>	<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a> = <a class="tu ref fn" href="#copy_to_user_tmpl" title='copy_to_user_tmpl' data-use='c' data-ref="copy_to_user_tmpl" data-ref-filename="copy_to_user_tmpl">copy_to_user_tmpl</a>(<a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>, <a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>);</td></tr>
<tr><th id="3051">3051</th><td>	<b>if</b> (!<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a>)</td></tr>
<tr><th id="3052">3052</th><td>		<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a> = <a class="tu ref fn" href="#copy_to_user_policy_type" title='copy_to_user_policy_type' data-use='c' data-ref="copy_to_user_policy_type" data-ref-filename="copy_to_user_policy_type">copy_to_user_policy_type</a>(<a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::type" title='xfrm_policy::type' data-ref="xfrm_policy::type" data-ref-filename="xfrm_policy..type">type</a>, <a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>);</td></tr>
<tr><th id="3053">3053</th><td>	<b>if</b> (!<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a>)</td></tr>
<tr><th id="3054">3054</th><td>		<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_mark_put" title='xfrm_mark_put' data-ref="xfrm_mark_put" data-ref-filename="xfrm_mark_put">xfrm_mark_put</a>(<a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>, &amp;<a class="local col2 ref" href="#542xp" title='xp' data-ref="542xp" data-ref-filename="542xp">xp</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_policy::mark" title='xfrm_policy::mark' data-ref="xfrm_policy::mark" data-ref-filename="xfrm_policy..mark">mark</a>);</td></tr>
<tr><th id="3055">3055</th><td>	<b>if</b> (<a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a>)</td></tr>
<tr><th id="3056">3056</th><td>		<b>goto</b> <a class="lbl" href="#553out_free_skb" data-ref="553out_free_skb" data-ref-filename="553out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="3057">3057</th><td></td></tr>
<tr><th id="3058">3058</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>, <a class="local col9 ref" href="#549nlh" title='nlh' data-ref="549nlh" data-ref-filename="549nlh">nlh</a>);</td></tr>
<tr><th id="3059">3059</th><td></td></tr>
<tr><th id="3060">3060</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col6 ref" href="#546net" title='net' data-ref="546net" data-ref-filename="546net">net</a>, <a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#526" title="XFRMNLGRP_POLICY" data-ref="_M/XFRMNLGRP_POLICY">XFRMNLGRP_POLICY</a>);</td></tr>
<tr><th id="3061">3061</th><td></td></tr>
<tr><th id="3062">3062</th><td><dfn class="lbl" id="553out_free_skb" data-ref="553out_free_skb" data-ref-filename="553out_free_skb">out_free_skb</dfn>:</td></tr>
<tr><th id="3063">3063</th><td>	<a class="ref fn" href="../../include/linux/skbuff.h.html#kfree_skb" title='kfree_skb' data-ref="kfree_skb" data-ref-filename="kfree_skb">kfree_skb</a>(<a class="local col0 ref" href="#550skb" title='skb' data-ref="550skb" data-ref-filename="550skb">skb</a>);</td></tr>
<tr><th id="3064">3064</th><td>	<b>return</b> <a class="local col2 ref" href="#552err" title='err' data-ref="552err" data-ref-filename="552err">err</a>;</td></tr>
<tr><th id="3065">3065</th><td>}</td></tr>
<tr><th id="3066">3066</th><td></td></tr>
<tr><th id="3067">3067</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_notify_policy_flush" title='xfrm_notify_policy_flush' data-type='int xfrm_notify_policy_flush(const struct km_event * c)' data-ref="xfrm_notify_policy_flush" data-ref-filename="xfrm_notify_policy_flush">xfrm_notify_policy_flush</dfn>(<em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col5 decl" id="555c" title='c' data-type='const struct km_event *' data-ref="555c" data-ref-filename="555c">c</dfn>)</td></tr>
<tr><th id="3068">3068</th><td>{</td></tr>
<tr><th id="3069">3069</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col6 decl" id="556net" title='net' data-type='struct net *' data-ref="556net" data-ref-filename="556net">net</dfn> = <a class="local col5 ref" href="#555c" title='c' data-ref="555c" data-ref-filename="555c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::net" title='km_event::net' data-ref="km_event::net" data-ref-filename="km_event..net">net</a>;</td></tr>
<tr><th id="3070">3070</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col7 decl" id="557nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="557nlh" data-ref-filename="557nlh">nlh</dfn>;</td></tr>
<tr><th id="3071">3071</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col8 decl" id="558skb" title='skb' data-type='struct sk_buff *' data-ref="558skb" data-ref-filename="558skb">skb</dfn>;</td></tr>
<tr><th id="3072">3072</th><td>	<em>int</em> <dfn class="local col9 decl" id="559err" title='err' data-type='int' data-ref="559err" data-ref-filename="559err">err</dfn>;</td></tr>
<tr><th id="3073">3073</th><td></td></tr>
<tr><th id="3074">3074</th><td>	<a class="local col8 ref" href="#558skb" title='skb' data-ref="558skb" data-ref-filename="558skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#userpolicy_type_attrsize" title='userpolicy_type_attrsize' data-use='c' data-ref="userpolicy_type_attrsize" data-ref-filename="userpolicy_type_attrsize">userpolicy_type_attrsize</a>(), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="3075">3075</th><td>	<b>if</b> (<a class="local col8 ref" href="#558skb" title='skb' data-ref="558skb" data-ref-filename="558skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3076">3076</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="3077">3077</th><td></td></tr>
<tr><th id="3078">3078</th><td>	<a class="local col7 ref" href="#557nlh" title='nlh' data-ref="557nlh" data-ref-filename="557nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col8 ref" href="#558skb" title='skb' data-ref="558skb" data-ref-filename="558skb">skb</a>, <a class="local col5 ref" href="#555c" title='c' data-ref="555c" data-ref-filename="555c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::portid" title='km_event::portid' data-ref="km_event::portid" data-ref-filename="km_event..portid">portid</a>, <a class="local col5 ref" href="#555c" title='c' data-ref="555c" data-ref-filename="555c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::seq" title='km_event::seq' data-ref="km_event::seq" data-ref-filename="km_event..seq">seq</a>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#193" title="XFRM_MSG_FLUSHPOLICY" data-ref="_M/XFRM_MSG_FLUSHPOLICY">XFRM_MSG_FLUSHPOLICY</a>, <var>0</var>, <var>0</var>);</td></tr>
<tr><th id="3079">3079</th><td>	<a class="local col9 ref" href="#559err" title='err' data-ref="559err" data-ref-filename="559err">err</a> = -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="3080">3080</th><td>	<b>if</b> (<a class="local col7 ref" href="#557nlh" title='nlh' data-ref="557nlh" data-ref-filename="557nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3081">3081</th><td>		<b>goto</b> <a class="lbl" href="#560out_free_skb" data-ref="560out_free_skb" data-ref-filename="560out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="3082">3082</th><td>	<a class="local col9 ref" href="#559err" title='err' data-ref="559err" data-ref-filename="559err">err</a> = <a class="tu ref fn" href="#copy_to_user_policy_type" title='copy_to_user_policy_type' data-use='c' data-ref="copy_to_user_policy_type" data-ref-filename="copy_to_user_policy_type">copy_to_user_policy_type</a>(<a class="local col5 ref" href="#555c" title='c' data-ref="555c" data-ref-filename="555c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::data" title='km_event::data' data-ref="km_event::data" data-ref-filename="km_event..data">data</a>.<a class="ref field" href="../../include/net/xfrm.h.html#km_event::(anonymous)::type" title='km_event::(anonymous union)::type' data-ref="km_event::(anonymous)::type" data-ref-filename="km_event..(anonymous)..type">type</a>, <a class="local col8 ref" href="#558skb" title='skb' data-ref="558skb" data-ref-filename="558skb">skb</a>);</td></tr>
<tr><th id="3083">3083</th><td>	<b>if</b> (<a class="local col9 ref" href="#559err" title='err' data-ref="559err" data-ref-filename="559err">err</a>)</td></tr>
<tr><th id="3084">3084</th><td>		<b>goto</b> <a class="lbl" href="#560out_free_skb" data-ref="560out_free_skb" data-ref-filename="560out_free_skb">out_free_skb</a>;</td></tr>
<tr><th id="3085">3085</th><td></td></tr>
<tr><th id="3086">3086</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col8 ref" href="#558skb" title='skb' data-ref="558skb" data-ref-filename="558skb">skb</a>, <a class="local col7 ref" href="#557nlh" title='nlh' data-ref="557nlh" data-ref-filename="557nlh">nlh</a>);</td></tr>
<tr><th id="3087">3087</th><td></td></tr>
<tr><th id="3088">3088</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col6 ref" href="#556net" title='net' data-ref="556net" data-ref-filename="556net">net</a>, <a class="local col8 ref" href="#558skb" title='skb' data-ref="558skb" data-ref-filename="558skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#526" title="XFRMNLGRP_POLICY" data-ref="_M/XFRMNLGRP_POLICY">XFRMNLGRP_POLICY</a>);</td></tr>
<tr><th id="3089">3089</th><td></td></tr>
<tr><th id="3090">3090</th><td><dfn class="lbl" id="560out_free_skb" data-ref="560out_free_skb" data-ref-filename="560out_free_skb">out_free_skb</dfn>:</td></tr>
<tr><th id="3091">3091</th><td>	<a class="ref fn" href="../../include/linux/skbuff.h.html#kfree_skb" title='kfree_skb' data-ref="kfree_skb" data-ref-filename="kfree_skb">kfree_skb</a>(<a class="local col8 ref" href="#558skb" title='skb' data-ref="558skb" data-ref-filename="558skb">skb</a>);</td></tr>
<tr><th id="3092">3092</th><td>	<b>return</b> <a class="local col9 ref" href="#559err" title='err' data-ref="559err" data-ref-filename="559err">err</a>;</td></tr>
<tr><th id="3093">3093</th><td>}</td></tr>
<tr><th id="3094">3094</th><td></td></tr>
<tr><th id="3095">3095</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_send_policy_notify" title='xfrm_send_policy_notify' data-type='int xfrm_send_policy_notify(struct xfrm_policy * xp, int dir, const struct km_event * c)' data-ref="xfrm_send_policy_notify" data-ref-filename="xfrm_send_policy_notify">xfrm_send_policy_notify</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_policy" title='xfrm_policy' data-ref="xfrm_policy" data-ref-filename="xfrm_policy">xfrm_policy</a> *<dfn class="local col1 decl" id="561xp" title='xp' data-type='struct xfrm_policy *' data-ref="561xp" data-ref-filename="561xp">xp</dfn>, <em>int</em> <dfn class="local col2 decl" id="562dir" title='dir' data-type='int' data-ref="562dir" data-ref-filename="562dir">dir</dfn>, <em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col3 decl" id="563c" title='c' data-type='const struct km_event *' data-ref="563c" data-ref-filename="563c">c</dfn>)</td></tr>
<tr><th id="3096">3096</th><td>{</td></tr>
<tr><th id="3097">3097</th><td></td></tr>
<tr><th id="3098">3098</th><td>	<b>switch</b> (<a class="local col3 ref" href="#563c" title='c' data-ref="563c" data-ref-filename="563c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a>) {</td></tr>
<tr><th id="3099">3099</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#169" title="XFRM_MSG_NEWPOLICY" data-ref="_M/XFRM_MSG_NEWPOLICY">XFRM_MSG_NEWPOLICY</a>:</td></tr>
<tr><th id="3100">3100</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#183" title="XFRM_MSG_UPDPOLICY" data-ref="_M/XFRM_MSG_UPDPOLICY">XFRM_MSG_UPDPOLICY</a>:</td></tr>
<tr><th id="3101">3101</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#171" title="XFRM_MSG_DELPOLICY" data-ref="_M/XFRM_MSG_DELPOLICY">XFRM_MSG_DELPOLICY</a>:</td></tr>
<tr><th id="3102">3102</th><td>		<b>return</b> <a class="tu ref fn" href="#xfrm_notify_policy" title='xfrm_notify_policy' data-use='c' data-ref="xfrm_notify_policy" data-ref-filename="xfrm_notify_policy">xfrm_notify_policy</a>(<a class="local col1 ref" href="#561xp" title='xp' data-ref="561xp" data-ref-filename="561xp">xp</a>, <a class="local col2 ref" href="#562dir" title='dir' data-ref="562dir" data-ref-filename="562dir">dir</a>, <a class="local col3 ref" href="#563c" title='c' data-ref="563c" data-ref-filename="563c">c</a>);</td></tr>
<tr><th id="3103">3103</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#193" title="XFRM_MSG_FLUSHPOLICY" data-ref="_M/XFRM_MSG_FLUSHPOLICY">XFRM_MSG_FLUSHPOLICY</a>:</td></tr>
<tr><th id="3104">3104</th><td>		<b>return</b> <a class="tu ref fn" href="#xfrm_notify_policy_flush" title='xfrm_notify_policy_flush' data-use='c' data-ref="xfrm_notify_policy_flush" data-ref-filename="xfrm_notify_policy_flush">xfrm_notify_policy_flush</a>(<a class="local col3 ref" href="#563c" title='c' data-ref="563c" data-ref-filename="563c">c</a>);</td></tr>
<tr><th id="3105">3105</th><td>	<b>case</b> <a class="macro" href="../../include/uapi/linux/xfrm.h.html#188" title="XFRM_MSG_POLEXPIRE" data-ref="_M/XFRM_MSG_POLEXPIRE">XFRM_MSG_POLEXPIRE</a>:</td></tr>
<tr><th id="3106">3106</th><td>		<b>return</b> <a class="tu ref fn" href="#xfrm_exp_policy_notify" title='xfrm_exp_policy_notify' data-use='c' data-ref="xfrm_exp_policy_notify" data-ref-filename="xfrm_exp_policy_notify">xfrm_exp_policy_notify</a>(<a class="local col1 ref" href="#561xp" title='xp' data-ref="561xp" data-ref-filename="561xp">xp</a>, <a class="local col2 ref" href="#562dir" title='dir' data-ref="562dir" data-ref-filename="562dir">dir</a>, <a class="local col3 ref" href="#563c" title='c' data-ref="563c" data-ref-filename="563c">c</a>);</td></tr>
<tr><th id="3107">3107</th><td>	<b>default</b>:</td></tr>
<tr><th id="3108">3108</th><td>		<a class="ref fn" href="../../include/linux/printk.h.html#printk" title='printk' data-ref="printk" data-ref-filename="printk">printk</a>(<a class="macro" href="../../include/linux/kern_levels.h.html#13" title="&quot;\001&quot; &quot;5&quot;" data-ref="_M/KERN_NOTICE">KERN_NOTICE</a> <q>"xfrm_user: Unknown Policy event %d\n"</q>,</td></tr>
<tr><th id="3109">3109</th><td>		       <a class="local col3 ref" href="#563c" title='c' data-ref="563c" data-ref-filename="563c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::event" title='km_event::event' data-ref="km_event::event" data-ref-filename="km_event..event">event</a>);</td></tr>
<tr><th id="3110">3110</th><td>	}</td></tr>
<tr><th id="3111">3111</th><td></td></tr>
<tr><th id="3112">3112</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3113">3113</th><td></td></tr>
<tr><th id="3114">3114</th><td>}</td></tr>
<tr><th id="3115">3115</th><td></td></tr>
<tr><th id="3116">3116</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_report_msgsize" title='xfrm_report_msgsize' data-type='unsigned int xfrm_report_msgsize()' data-ref="xfrm_report_msgsize" data-ref-filename="xfrm_report_msgsize">xfrm_report_msgsize</dfn>(<em>void</em>)</td></tr>
<tr><th id="3117">3117</th><td>{</td></tr>
<tr><th id="3118">3118</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((sizeof(struct xfrm_user_report))+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_report" title='xfrm_user_report' data-ref="xfrm_user_report" data-ref-filename="xfrm_user_report">xfrm_user_report</a>));</td></tr>
<tr><th id="3119">3119</th><td>}</td></tr>
<tr><th id="3120">3120</th><td></td></tr>
<tr><th id="3121">3121</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_report" title='build_report' data-type='int build_report(struct sk_buff * skb, u8 proto, struct xfrm_selector * sel, xfrm_address_t * addr)' data-ref="build_report" data-ref-filename="build_report">build_report</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col4 decl" id="564skb" title='skb' data-type='struct sk_buff *' data-ref="564skb" data-ref-filename="564skb">skb</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col5 decl" id="565proto" title='proto' data-type='u8' data-ref="565proto" data-ref-filename="565proto">proto</dfn>,</td></tr>
<tr><th id="3122">3122</th><td>			<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector" title='xfrm_selector' data-ref="xfrm_selector" data-ref-filename="xfrm_selector">xfrm_selector</a> *<dfn class="local col6 decl" id="566sel" title='sel' data-type='struct xfrm_selector *' data-ref="566sel" data-ref-filename="566sel">sel</dfn>, <a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a> *<dfn class="local col7 decl" id="567addr" title='addr' data-type='xfrm_address_t *' data-ref="567addr" data-ref-filename="567addr">addr</dfn>)</td></tr>
<tr><th id="3123">3123</th><td>{</td></tr>
<tr><th id="3124">3124</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_report" title='xfrm_user_report' data-ref="xfrm_user_report" data-ref-filename="xfrm_user_report">xfrm_user_report</a> *<dfn class="local col8 decl" id="568ur" title='ur' data-type='struct xfrm_user_report *' data-ref="568ur" data-ref-filename="568ur">ur</dfn>;</td></tr>
<tr><th id="3125">3125</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col9 decl" id="569nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="569nlh" data-ref-filename="569nlh">nlh</dfn>;</td></tr>
<tr><th id="3126">3126</th><td></td></tr>
<tr><th id="3127">3127</th><td>	<a class="local col9 ref" href="#569nlh" title='nlh' data-ref="569nlh" data-ref-filename="569nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col4 ref" href="#564skb" title='skb' data-ref="564skb" data-ref-filename="564skb">skb</a>, <var>0</var>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#201" title="XFRM_MSG_REPORT" data-ref="_M/XFRM_MSG_REPORT">XFRM_MSG_REPORT</a>, <b>sizeof</b>(*<a class="local col8 ref" href="#568ur" title='ur' data-ref="568ur" data-ref-filename="568ur">ur</a>), <var>0</var>);</td></tr>
<tr><th id="3128">3128</th><td>	<b>if</b> (<a class="local col9 ref" href="#569nlh" title='nlh' data-ref="569nlh" data-ref-filename="569nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3129">3129</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="3130">3130</th><td></td></tr>
<tr><th id="3131">3131</th><td>	<a class="local col8 ref" href="#568ur" title='ur' data-ref="568ur" data-ref-filename="568ur">ur</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col9 ref" href="#569nlh" title='nlh' data-ref="569nlh" data-ref-filename="569nlh">nlh</a>);</td></tr>
<tr><th id="3132">3132</th><td>	<a class="local col8 ref" href="#568ur" title='ur' data-ref="568ur" data-ref-filename="568ur">ur</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_report::proto" title='xfrm_user_report::proto' data-ref="xfrm_user_report::proto" data-ref-filename="xfrm_user_report..proto">proto</a> = <a class="local col5 ref" href="#565proto" title='proto' data-ref="565proto" data-ref-filename="565proto">proto</a>;</td></tr>
<tr><th id="3133">3133</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(ur-&gt;sel)); void *__ret; if (__builtin_constant_p(sizeof(ur-&gt;sel)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;ur-&gt;sel), (sel), __len); else __ret = __builtin_memcpy((&amp;ur-&gt;sel), (sel), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col8 ref" href="#568ur" title='ur' data-ref="568ur" data-ref-filename="568ur">ur</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_report::sel" title='xfrm_user_report::sel' data-ref="xfrm_user_report::sel" data-ref-filename="xfrm_user_report..sel">sel</a>, <a class="local col6 ref" href="#566sel" title='sel' data-ref="566sel" data-ref-filename="566sel">sel</a>, <b>sizeof</b>(<a class="local col8 ref" href="#568ur" title='ur' data-ref="568ur" data-ref-filename="568ur">ur</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_report::sel" title='xfrm_user_report::sel' data-ref="xfrm_user_report::sel" data-ref-filename="xfrm_user_report..sel">sel</a>));</td></tr>
<tr><th id="3134">3134</th><td></td></tr>
<tr><th id="3135">3135</th><td>	<b>if</b> (<a class="local col7 ref" href="#567addr" title='addr' data-ref="567addr" data-ref-filename="567addr">addr</a>) {</td></tr>
<tr><th id="3136">3136</th><td>		<em>int</em> <dfn class="local col0 decl" id="570err" title='err' data-type='int' data-ref="570err" data-ref-filename="570err">err</dfn> = <a class="ref fn" href="../../include/net/netlink.h.html#nla_put" title='nla_put' data-ref="nla_put" data-ref-filename="nla_put">nla_put</a>(<a class="local col4 ref" href="#564skb" title='skb' data-ref="564skb" data-ref-filename="564skb">skb</a>, <a class="enum" href="../../include/uapi/linux/xfrm.h.html#XFRMA_COADDR" title='XFRMA_COADDR' data-ref="XFRMA_COADDR" data-ref-filename="XFRMA_COADDR">XFRMA_COADDR</a>, <b>sizeof</b>(*<a class="local col7 ref" href="#567addr" title='addr' data-ref="567addr" data-ref-filename="567addr">addr</a>), <a class="local col7 ref" href="#567addr" title='addr' data-ref="567addr" data-ref-filename="567addr">addr</a>);</td></tr>
<tr><th id="3137">3137</th><td>		<b>if</b> (<a class="local col0 ref" href="#570err" title='err' data-ref="570err" data-ref-filename="570err">err</a>) {</td></tr>
<tr><th id="3138">3138</th><td>			<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_cancel" title='nlmsg_cancel' data-ref="nlmsg_cancel" data-ref-filename="nlmsg_cancel">nlmsg_cancel</a>(<a class="local col4 ref" href="#564skb" title='skb' data-ref="564skb" data-ref-filename="564skb">skb</a>, <a class="local col9 ref" href="#569nlh" title='nlh' data-ref="569nlh" data-ref-filename="569nlh">nlh</a>);</td></tr>
<tr><th id="3139">3139</th><td>			<b>return</b> <a class="local col0 ref" href="#570err" title='err' data-ref="570err" data-ref-filename="570err">err</a>;</td></tr>
<tr><th id="3140">3140</th><td>		}</td></tr>
<tr><th id="3141">3141</th><td>	}</td></tr>
<tr><th id="3142">3142</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col4 ref" href="#564skb" title='skb' data-ref="564skb" data-ref-filename="564skb">skb</a>, <a class="local col9 ref" href="#569nlh" title='nlh' data-ref="569nlh" data-ref-filename="569nlh">nlh</a>);</td></tr>
<tr><th id="3143">3143</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3144">3144</th><td>}</td></tr>
<tr><th id="3145">3145</th><td></td></tr>
<tr><th id="3146">3146</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_send_report" title='xfrm_send_report' data-type='int xfrm_send_report(struct net * net, u8 proto, struct xfrm_selector * sel, xfrm_address_t * addr)' data-ref="xfrm_send_report" data-ref-filename="xfrm_send_report">xfrm_send_report</dfn>(<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col1 decl" id="571net" title='net' data-type='struct net *' data-ref="571net" data-ref-filename="571net">net</dfn>, <a class="typedef" href="../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='unsigned char' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col2 decl" id="572proto" title='proto' data-type='u8' data-ref="572proto" data-ref-filename="572proto">proto</dfn>,</td></tr>
<tr><th id="3147">3147</th><td>			    <b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_selector" title='xfrm_selector' data-ref="xfrm_selector" data-ref-filename="xfrm_selector">xfrm_selector</a> *<dfn class="local col3 decl" id="573sel" title='sel' data-type='struct xfrm_selector *' data-ref="573sel" data-ref-filename="573sel">sel</dfn>, <a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a> *<dfn class="local col4 decl" id="574addr" title='addr' data-type='xfrm_address_t *' data-ref="574addr" data-ref-filename="574addr">addr</dfn>)</td></tr>
<tr><th id="3148">3148</th><td>{</td></tr>
<tr><th id="3149">3149</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col5 decl" id="575skb" title='skb' data-type='struct sk_buff *' data-ref="575skb" data-ref-filename="575skb">skb</dfn>;</td></tr>
<tr><th id="3150">3150</th><td>	<em>int</em> <dfn class="local col6 decl" id="576err" title='err' data-type='int' data-ref="576err" data-ref-filename="576err">err</dfn>;</td></tr>
<tr><th id="3151">3151</th><td></td></tr>
<tr><th id="3152">3152</th><td>	<a class="local col5 ref" href="#575skb" title='skb' data-ref="575skb" data-ref-filename="575skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_report_msgsize" title='xfrm_report_msgsize' data-use='c' data-ref="xfrm_report_msgsize" data-ref-filename="xfrm_report_msgsize">xfrm_report_msgsize</a>(), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="3153">3153</th><td>	<b>if</b> (<a class="local col5 ref" href="#575skb" title='skb' data-ref="575skb" data-ref-filename="575skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3154">3154</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="3155">3155</th><td></td></tr>
<tr><th id="3156">3156</th><td>	<a class="local col6 ref" href="#576err" title='err' data-ref="576err" data-ref-filename="576err">err</a> = <a class="tu ref fn" href="#build_report" title='build_report' data-use='c' data-ref="build_report" data-ref-filename="build_report">build_report</a>(<a class="local col5 ref" href="#575skb" title='skb' data-ref="575skb" data-ref-filename="575skb">skb</a>, <a class="local col2 ref" href="#572proto" title='proto' data-ref="572proto" data-ref-filename="572proto">proto</a>, <a class="local col3 ref" href="#573sel" title='sel' data-ref="573sel" data-ref-filename="573sel">sel</a>, <a class="local col4 ref" href="#574addr" title='addr' data-ref="574addr" data-ref-filename="574addr">addr</a>);</td></tr>
<tr><th id="3157">3157</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (3157), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (146)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col6 ref" href="#576err" title='err' data-ref="576err" data-ref-filename="576err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="3158">3158</th><td></td></tr>
<tr><th id="3159">3159</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col1 ref" href="#571net" title='net' data-ref="571net" data-ref-filename="571net">net</a>, <a class="local col5 ref" href="#575skb" title='skb' data-ref="575skb" data-ref-filename="575skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#530" title="XFRMNLGRP_REPORT" data-ref="_M/XFRMNLGRP_REPORT">XFRMNLGRP_REPORT</a>);</td></tr>
<tr><th id="3160">3160</th><td>}</td></tr>
<tr><th id="3161">3161</th><td></td></tr>
<tr><th id="3162">3162</th><td><em>static</em> <a class="macro" href="../../include/linux/compiler-gcc.h.html#83" title="inline __attribute__((unused)) __attribute__((no_instrument_function))" data-ref="_M/inline"><b>inline</b></a> <em>unsigned</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_mapping_msgsize" title='xfrm_mapping_msgsize' data-type='unsigned int xfrm_mapping_msgsize()' data-ref="xfrm_mapping_msgsize" data-ref-filename="xfrm_mapping_msgsize">xfrm_mapping_msgsize</dfn>(<em>void</em>)</td></tr>
<tr><th id="3163">3163</th><td>{</td></tr>
<tr><th id="3164">3164</th><td>	<b>return</b> <a class="macro" href="../../include/uapi/linux/netlink.h.html#90" title="( ((sizeof(struct xfrm_user_mapping))+4U-1) &amp; ~(4U-1) )" data-ref="_M/NLMSG_ALIGN">NLMSG_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping" title='xfrm_user_mapping' data-ref="xfrm_user_mapping" data-ref-filename="xfrm_user_mapping">xfrm_user_mapping</a>));</td></tr>
<tr><th id="3165">3165</th><td>}</td></tr>
<tr><th id="3166">3166</th><td></td></tr>
<tr><th id="3167">3167</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="build_mapping" title='build_mapping' data-type='int build_mapping(struct sk_buff * skb, struct xfrm_state * x, xfrm_address_t * new_saddr, __be16 new_sport)' data-ref="build_mapping" data-ref-filename="build_mapping">build_mapping</dfn>(<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="577skb" title='skb' data-type='struct sk_buff *' data-ref="577skb" data-ref-filename="577skb">skb</dfn>, <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col8 decl" id="578x" title='x' data-type='struct xfrm_state *' data-ref="578x" data-ref-filename="578x">x</dfn>,</td></tr>
<tr><th id="3168">3168</th><td>			 <a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a> *<dfn class="local col9 decl" id="579new_saddr" title='new_saddr' data-type='xfrm_address_t *' data-ref="579new_saddr" data-ref-filename="579new_saddr">new_saddr</dfn>, <a class="typedef" href="../../include/uapi/linux/types.h.html#__be16" title='__be16' data-type='__u16' data-ref="__be16" data-ref-filename="__be16">__be16</a> <dfn class="local col0 decl" id="580new_sport" title='new_sport' data-type='__be16' data-ref="580new_sport" data-ref-filename="580new_sport">new_sport</dfn>)</td></tr>
<tr><th id="3169">3169</th><td>{</td></tr>
<tr><th id="3170">3170</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping" title='xfrm_user_mapping' data-ref="xfrm_user_mapping" data-ref-filename="xfrm_user_mapping">xfrm_user_mapping</a> *<dfn class="local col1 decl" id="581um" title='um' data-type='struct xfrm_user_mapping *' data-ref="581um" data-ref-filename="581um">um</dfn>;</td></tr>
<tr><th id="3171">3171</th><td>	<b>struct</b> <a class="type" href="../../include/uapi/linux/netlink.h.html#nlmsghdr" title='nlmsghdr' data-ref="nlmsghdr" data-ref-filename="nlmsghdr">nlmsghdr</a> *<dfn class="local col2 decl" id="582nlh" title='nlh' data-type='struct nlmsghdr *' data-ref="582nlh" data-ref-filename="582nlh">nlh</dfn>;</td></tr>
<tr><th id="3172">3172</th><td></td></tr>
<tr><th id="3173">3173</th><td>	<a class="local col2 ref" href="#582nlh" title='nlh' data-ref="582nlh" data-ref-filename="582nlh">nlh</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_put" title='nlmsg_put' data-ref="nlmsg_put" data-ref-filename="nlmsg_put">nlmsg_put</a>(<a class="local col7 ref" href="#577skb" title='skb' data-ref="577skb" data-ref-filename="577skb">skb</a>, <var>0</var>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#217" title="XFRM_MSG_MAPPING" data-ref="_M/XFRM_MSG_MAPPING">XFRM_MSG_MAPPING</a>, <b>sizeof</b>(*<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>), <var>0</var>);</td></tr>
<tr><th id="3174">3174</th><td>	<b>if</b> (<a class="local col2 ref" href="#582nlh" title='nlh' data-ref="582nlh" data-ref-filename="582nlh">nlh</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3175">3175</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno.h.html#73" title="90" data-ref="_M/EMSGSIZE">EMSGSIZE</a>;</td></tr>
<tr><th id="3176">3176</th><td></td></tr>
<tr><th id="3177">3177</th><td>	<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_data" title='nlmsg_data' data-ref="nlmsg_data" data-ref-filename="nlmsg_data">nlmsg_data</a>(<a class="local col2 ref" href="#582nlh" title='nlh' data-ref="582nlh" data-ref-filename="582nlh">nlh</a>);</td></tr>
<tr><th id="3178">3178</th><td></td></tr>
<tr><th id="3179">3179</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(um-&gt;id.daddr)); void *__ret; if (__builtin_constant_p(sizeof(um-&gt;id.daddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;um-&gt;id.daddr), (&amp;x-&gt;id.daddr), __len); else __ret = __builtin_memcpy((&amp;um-&gt;id.daddr), (&amp;x-&gt;id.daddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::id" title='xfrm_user_mapping::id' data-ref="xfrm_user_mapping::id" data-ref-filename="xfrm_user_mapping..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>, &amp;<a class="local col8 ref" href="#578x" title='x' data-ref="578x" data-ref-filename="578x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::daddr" title='xfrm_id::daddr' data-ref="xfrm_id::daddr" data-ref-filename="xfrm_id..daddr">daddr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::id" title='xfrm_user_mapping::id' data-ref="xfrm_user_mapping::id" data-ref-filename="xfrm_user_mapping..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::daddr" title='xfrm_usersa_id::daddr' data-ref="xfrm_usersa_id::daddr" data-ref-filename="xfrm_usersa_id..daddr">daddr</a>));</td></tr>
<tr><th id="3180">3180</th><td>	<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::id" title='xfrm_user_mapping::id' data-ref="xfrm_user_mapping::id" data-ref-filename="xfrm_user_mapping..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::spi" title='xfrm_usersa_id::spi' data-ref="xfrm_usersa_id::spi" data-ref-filename="xfrm_usersa_id..spi">spi</a> = <a class="local col8 ref" href="#578x" title='x' data-ref="578x" data-ref-filename="578x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::spi" title='xfrm_id::spi' data-ref="xfrm_id::spi" data-ref-filename="xfrm_id..spi">spi</a>;</td></tr>
<tr><th id="3181">3181</th><td>	<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::id" title='xfrm_user_mapping::id' data-ref="xfrm_user_mapping::id" data-ref-filename="xfrm_user_mapping..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::family" title='xfrm_usersa_id::family' data-ref="xfrm_usersa_id::family" data-ref-filename="xfrm_usersa_id..family">family</a> = <a class="local col8 ref" href="#578x" title='x' data-ref="578x" data-ref-filename="578x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::family" title='xfrm_state::(anonymous struct)::family' data-ref="xfrm_state::(anonymous)::family" data-ref-filename="xfrm_state..(anonymous)..family">family</a>;</td></tr>
<tr><th id="3182">3182</th><td>	<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::id" title='xfrm_user_mapping::id' data-ref="xfrm_user_mapping::id" data-ref-filename="xfrm_user_mapping..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_usersa_id::proto" title='xfrm_usersa_id::proto' data-ref="xfrm_usersa_id::proto" data-ref-filename="xfrm_usersa_id..proto">proto</a> = <a class="local col8 ref" href="#578x" title='x' data-ref="578x" data-ref-filename="578x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a>;</td></tr>
<tr><th id="3183">3183</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(um-&gt;new_saddr)); void *__ret; if (__builtin_constant_p(sizeof(um-&gt;new_saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;um-&gt;new_saddr), (new_saddr), __len); else __ret = __builtin_memcpy((&amp;um-&gt;new_saddr), (new_saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::new_saddr" title='xfrm_user_mapping::new_saddr' data-ref="xfrm_user_mapping::new_saddr" data-ref-filename="xfrm_user_mapping..new_saddr">new_saddr</a>, <a class="local col9 ref" href="#579new_saddr" title='new_saddr' data-ref="579new_saddr" data-ref-filename="579new_saddr">new_saddr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::new_saddr" title='xfrm_user_mapping::new_saddr' data-ref="xfrm_user_mapping::new_saddr" data-ref-filename="xfrm_user_mapping..new_saddr">new_saddr</a>));</td></tr>
<tr><th id="3184">3184</th><td>	<a class="macro" href="../../arch/x86/include/asm/string_64.h.html#37" title="({ size_t __len = (sizeof(um-&gt;old_saddr)); void *__ret; if (__builtin_constant_p(sizeof(um-&gt;old_saddr)) &amp;&amp; __len &gt;= 64) __ret = __memcpy((&amp;um-&gt;old_saddr), (&amp;x-&gt;props.saddr), __len); else __ret = __builtin_memcpy((&amp;um-&gt;old_saddr), (&amp;x-&gt;props.saddr), __len); __ret; })" data-ref="_M/memcpy">memcpy</a>(&amp;<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::old_saddr" title='xfrm_user_mapping::old_saddr' data-ref="xfrm_user_mapping::old_saddr" data-ref-filename="xfrm_user_mapping..old_saddr">old_saddr</a>, &amp;<a class="local col8 ref" href="#578x" title='x' data-ref="578x" data-ref-filename="578x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::saddr" title='xfrm_state::(anonymous struct)::saddr' data-ref="xfrm_state::(anonymous)::saddr" data-ref-filename="xfrm_state..(anonymous)..saddr">saddr</a>, <b>sizeof</b>(<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::old_saddr" title='xfrm_user_mapping::old_saddr' data-ref="xfrm_user_mapping::old_saddr" data-ref-filename="xfrm_user_mapping..old_saddr">old_saddr</a>));</td></tr>
<tr><th id="3185">3185</th><td>	<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::new_sport" title='xfrm_user_mapping::new_sport' data-ref="xfrm_user_mapping::new_sport" data-ref-filename="xfrm_user_mapping..new_sport">new_sport</a> = <a class="local col0 ref" href="#580new_sport" title='new_sport' data-ref="580new_sport" data-ref-filename="580new_sport">new_sport</a>;</td></tr>
<tr><th id="3186">3186</th><td>	<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::old_sport" title='xfrm_user_mapping::old_sport' data-ref="xfrm_user_mapping::old_sport" data-ref-filename="xfrm_user_mapping..old_sport">old_sport</a> = <a class="local col8 ref" href="#578x" title='x' data-ref="578x" data-ref-filename="578x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_encap_tmpl::encap_sport" title='xfrm_encap_tmpl::encap_sport' data-ref="xfrm_encap_tmpl::encap_sport" data-ref-filename="xfrm_encap_tmpl..encap_sport">encap_sport</a>;</td></tr>
<tr><th id="3187">3187</th><td>	<a class="local col1 ref" href="#581um" title='um' data-ref="581um" data-ref-filename="581um">um</a>-&gt;<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_user_mapping::reqid" title='xfrm_user_mapping::reqid' data-ref="xfrm_user_mapping::reqid" data-ref-filename="xfrm_user_mapping..reqid">reqid</a> = <a class="local col8 ref" href="#578x" title='x' data-ref="578x" data-ref-filename="578x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::props" title='xfrm_state::props' data-ref="xfrm_state::props" data-ref-filename="xfrm_state..props">props</a>.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::(anonymous)::reqid" title='xfrm_state::(anonymous struct)::reqid' data-ref="xfrm_state::(anonymous)::reqid" data-ref-filename="xfrm_state..(anonymous)..reqid">reqid</a>;</td></tr>
<tr><th id="3188">3188</th><td></td></tr>
<tr><th id="3189">3189</th><td>	<a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_end" title='nlmsg_end' data-ref="nlmsg_end" data-ref-filename="nlmsg_end">nlmsg_end</a>(<a class="local col7 ref" href="#577skb" title='skb' data-ref="577skb" data-ref-filename="577skb">skb</a>, <a class="local col2 ref" href="#582nlh" title='nlh' data-ref="582nlh" data-ref-filename="582nlh">nlh</a>);</td></tr>
<tr><th id="3190">3190</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3191">3191</th><td>}</td></tr>
<tr><th id="3192">3192</th><td></td></tr>
<tr><th id="3193">3193</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="xfrm_send_mapping" title='xfrm_send_mapping' data-type='int xfrm_send_mapping(struct xfrm_state * x, xfrm_address_t * ipaddr, __be16 sport)' data-ref="xfrm_send_mapping" data-ref-filename="xfrm_send_mapping">xfrm_send_mapping</dfn>(<b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_state" title='xfrm_state' data-ref="xfrm_state" data-ref-filename="xfrm_state">xfrm_state</a> *<dfn class="local col3 decl" id="583x" title='x' data-type='struct xfrm_state *' data-ref="583x" data-ref-filename="583x">x</dfn>, <a class="typedef" href="../../include/uapi/linux/xfrm.h.html#xfrm_address_t" title='xfrm_address_t' data-type='union xfrm_address_t' data-ref="xfrm_address_t" data-ref-filename="xfrm_address_t">xfrm_address_t</a> *<dfn class="local col4 decl" id="584ipaddr" title='ipaddr' data-type='xfrm_address_t *' data-ref="584ipaddr" data-ref-filename="584ipaddr">ipaddr</dfn>,</td></tr>
<tr><th id="3194">3194</th><td>			     <a class="typedef" href="../../include/uapi/linux/types.h.html#__be16" title='__be16' data-type='__u16' data-ref="__be16" data-ref-filename="__be16">__be16</a> <dfn class="local col5 decl" id="585sport" title='sport' data-type='__be16' data-ref="585sport" data-ref-filename="585sport">sport</dfn>)</td></tr>
<tr><th id="3195">3195</th><td>{</td></tr>
<tr><th id="3196">3196</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col6 decl" id="586net" title='net' data-type='struct net *' data-ref="586net" data-ref-filename="586net">net</dfn> = <a class="ref fn" href="../../include/net/xfrm.h.html#xs_net" title='xs_net' data-ref="xs_net" data-ref-filename="xs_net">xs_net</a>(<a class="local col3 ref" href="#583x" title='x' data-ref="583x" data-ref-filename="583x">x</a>);</td></tr>
<tr><th id="3197">3197</th><td>	<b>struct</b> <a class="type" href="../../include/linux/skbuff.h.html#sk_buff" title='sk_buff' data-ref="sk_buff" data-ref-filename="sk_buff">sk_buff</a> *<dfn class="local col7 decl" id="587skb" title='skb' data-type='struct sk_buff *' data-ref="587skb" data-ref-filename="587skb">skb</dfn>;</td></tr>
<tr><th id="3198">3198</th><td>	<em>int</em> <dfn class="local col8 decl" id="588err" title='err' data-type='int' data-ref="588err" data-ref-filename="588err">err</dfn>;</td></tr>
<tr><th id="3199">3199</th><td></td></tr>
<tr><th id="3200">3200</th><td>	<b>if</b> (<a class="local col3 ref" href="#583x" title='x' data-ref="583x" data-ref-filename="583x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::id" title='xfrm_state::id' data-ref="xfrm_state::id" data-ref-filename="xfrm_state..id">id</a>.<a class="ref field" href="../../include/uapi/linux/xfrm.h.html#xfrm_id::proto" title='xfrm_id::proto' data-ref="xfrm_id::proto" data-ref-filename="xfrm_id..proto">proto</a> != <a class="macro" href="../../include/uapi/linux/in.h.html#58" title="IPPROTO_ESP" data-ref="_M/IPPROTO_ESP">IPPROTO_ESP</a>)</td></tr>
<tr><th id="3201">3201</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="3202">3202</th><td></td></tr>
<tr><th id="3203">3203</th><td>	<b>if</b> (!<a class="local col3 ref" href="#583x" title='x' data-ref="583x" data-ref-filename="583x">x</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_state::encap" title='xfrm_state::encap' data-ref="xfrm_state::encap" data-ref-filename="xfrm_state..encap">encap</a>)</td></tr>
<tr><th id="3204">3204</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#26" title="22" data-ref="_M/EINVAL">EINVAL</a>;</td></tr>
<tr><th id="3205">3205</th><td></td></tr>
<tr><th id="3206">3206</th><td>	<a class="local col7 ref" href="#587skb" title='skb' data-ref="587skb" data-ref-filename="587skb">skb</a> = <a class="ref fn" href="../../include/net/netlink.h.html#nlmsg_new" title='nlmsg_new' data-ref="nlmsg_new" data-ref-filename="nlmsg_new">nlmsg_new</a>(<a class="tu ref fn" href="#xfrm_mapping_msgsize" title='xfrm_mapping_msgsize' data-use='c' data-ref="xfrm_mapping_msgsize" data-ref-filename="xfrm_mapping_msgsize">xfrm_mapping_msgsize</a>(), <a class="macro" href="../../include/linux/gfp.h.html#272" title="((( gfp_t)0x20u)|(( gfp_t)0x80000u)|(( gfp_t)0x1000000u))" data-ref="_M/GFP_ATOMIC">GFP_ATOMIC</a>);</td></tr>
<tr><th id="3207">3207</th><td>	<b>if</b> (<a class="local col7 ref" href="#587skb" title='skb' data-ref="587skb" data-ref-filename="587skb">skb</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3208">3208</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="3209">3209</th><td></td></tr>
<tr><th id="3210">3210</th><td>	<a class="local col8 ref" href="#588err" title='err' data-ref="588err" data-ref-filename="588err">err</a> = <a class="tu ref fn" href="#build_mapping" title='build_mapping' data-use='c' data-ref="build_mapping" data-ref-filename="build_mapping">build_mapping</a>(<a class="local col7 ref" href="#587skb" title='skb' data-ref="587skb" data-ref-filename="587skb">skb</a>, <a class="local col3 ref" href="#583x" title='x' data-ref="583x" data-ref-filename="583x">x</a>, <a class="local col4 ref" href="#584ipaddr" title='ipaddr' data-ref="584ipaddr" data-ref-filename="584ipaddr">ipaddr</a>, <a class="local col5 ref" href="#585sport" title='sport' data-ref="585sport" data-ref-filename="585sport">sport</a>);</td></tr>
<tr><th id="3211">3211</th><td>	<a class="macro" href="../../include/asm-generic/bug.h.html#60" title="do { if (__builtin_expect(!!(err &lt; 0), 0)) do { do { asm volatile(&quot;1:\t&quot; &quot;.byte 0x0f, 0x0b&quot; &quot;\n&quot; &quot;.pushsection __bug_table,\&quot;aw\&quot;\n&quot; &quot;2:\t&quot; &quot;.long &quot; &quot;1b&quot; &quot; - 2b&quot; &quot;\t# bug_entry::bug_addr\n&quot; &quot;\t&quot; &quot;.long &quot; &quot;%c0&quot; &quot; - 2b&quot; &quot;\t# bug_entry::file\n&quot; &quot;\t.word %c1&quot; &quot;\t# bug_entry::line\n&quot; &quot;\t.word %c2&quot; &quot;\t# bug_entry::flags\n&quot; &quot;\t.org 2b+%c3\n&quot; &quot;.popsection&quot; : : &quot;i&quot; (&quot;/root/linux-4.15.10/net/xfrm/xfrm_user.c&quot;), &quot;i&quot; (3211), &quot;i&quot; (0), &quot;i&quot; (sizeof(struct bug_entry))); } while (0); do { ({ asm volatile(&quot;%c0:\n\t&quot; &quot;.pushsection .discard.reachable\n\t&quot; &quot;.long %c0b - .\n\t&quot; &quot;.popsection\n\t&quot; : : &quot;i&quot; (148)); }); do { } while (1); } while (0); } while (0); } while (0)" data-ref="_M/BUG_ON">BUG_ON</a>(<a class="local col8 ref" href="#588err" title='err' data-ref="588err" data-ref-filename="588err">err</a> &lt; <var>0</var>);</td></tr>
<tr><th id="3212">3212</th><td></td></tr>
<tr><th id="3213">3213</th><td>	<b>return</b> <a class="tu ref fn" href="#xfrm_nlmsg_multicast" title='xfrm_nlmsg_multicast' data-use='c' data-ref="xfrm_nlmsg_multicast" data-ref-filename="xfrm_nlmsg_multicast">xfrm_nlmsg_multicast</a>(<a class="local col6 ref" href="#586net" title='net' data-ref="586net" data-ref-filename="586net">net</a>, <a class="local col7 ref" href="#587skb" title='skb' data-ref="587skb" data-ref-filename="587skb">skb</a>, <var>0</var>, <a class="macro" href="../../include/uapi/linux/xfrm.h.html#534" title="XFRMNLGRP_MAPPING" data-ref="_M/XFRMNLGRP_MAPPING">XFRMNLGRP_MAPPING</a>);</td></tr>
<tr><th id="3214">3214</th><td>}</td></tr>
<tr><th id="3215">3215</th><td></td></tr>
<tr><th id="3216">3216</th><td><em>static</em> <a class="typedef" href="../../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool" data-ref-filename="bool">bool</a> <dfn class="tu decl def fn" id="xfrm_is_alive" title='xfrm_is_alive' data-type='bool xfrm_is_alive(const struct km_event * c)' data-ref="xfrm_is_alive" data-ref-filename="xfrm_is_alive">xfrm_is_alive</dfn>(<em>const</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#km_event" title='km_event' data-ref="km_event" data-ref-filename="km_event">km_event</a> *<dfn class="local col9 decl" id="589c" title='c' data-type='const struct km_event *' data-ref="589c" data-ref-filename="589c">c</dfn>)</td></tr>
<tr><th id="3217">3217</th><td>{</td></tr>
<tr><th id="3218">3218</th><td>	<b>return</b> (<a class="typedef" href="../../include/linux/types.h.html#bool" title='bool' data-type='_Bool' data-ref="bool" data-ref-filename="bool">bool</a>)<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_acquire_is_on" title='xfrm_acquire_is_on' data-ref="xfrm_acquire_is_on" data-ref-filename="xfrm_acquire_is_on">xfrm_acquire_is_on</a>(<a class="local col9 ref" href="#589c" title='c' data-ref="589c" data-ref-filename="589c">c</a>-&gt;<a class="ref field" href="../../include/net/xfrm.h.html#km_event::net" title='km_event::net' data-ref="km_event::net" data-ref-filename="km_event..net">net</a>);</td></tr>
<tr><th id="3219">3219</th><td>}</td></tr>
<tr><th id="3220">3220</th><td></td></tr>
<tr><th id="3221">3221</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/net/xfrm.h.html#xfrm_mgr" title='xfrm_mgr' data-ref="xfrm_mgr" data-ref-filename="xfrm_mgr">xfrm_mgr</a> <dfn class="tu decl def" id="netlink_mgr" title='netlink_mgr' data-type='struct xfrm_mgr' data-ref="netlink_mgr" data-ref-filename="netlink_mgr">netlink_mgr</dfn> = {</td></tr>
<tr><th id="3222">3222</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::notify" title='xfrm_mgr::notify' data-ref="xfrm_mgr::notify" data-ref-filename="xfrm_mgr..notify">notify</a>		= <a class="tu ref fn" href="#xfrm_send_state_notify" title='xfrm_send_state_notify' data-ref="xfrm_send_state_notify" data-ref-filename="xfrm_send_state_notify">xfrm_send_state_notify</a>,</td></tr>
<tr><th id="3223">3223</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::acquire" title='xfrm_mgr::acquire' data-ref="xfrm_mgr::acquire" data-ref-filename="xfrm_mgr..acquire">acquire</a>	= <a class="tu ref fn" href="#xfrm_send_acquire" title='xfrm_send_acquire' data-ref="xfrm_send_acquire" data-ref-filename="xfrm_send_acquire">xfrm_send_acquire</a>,</td></tr>
<tr><th id="3224">3224</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::compile_policy" title='xfrm_mgr::compile_policy' data-ref="xfrm_mgr::compile_policy" data-ref-filename="xfrm_mgr..compile_policy">compile_policy</a>	= <a class="tu ref fn" href="#xfrm_compile_policy" title='xfrm_compile_policy' data-ref="xfrm_compile_policy" data-ref-filename="xfrm_compile_policy">xfrm_compile_policy</a>,</td></tr>
<tr><th id="3225">3225</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::notify_policy" title='xfrm_mgr::notify_policy' data-ref="xfrm_mgr::notify_policy" data-ref-filename="xfrm_mgr..notify_policy">notify_policy</a>	= <a class="tu ref fn" href="#xfrm_send_policy_notify" title='xfrm_send_policy_notify' data-ref="xfrm_send_policy_notify" data-ref-filename="xfrm_send_policy_notify">xfrm_send_policy_notify</a>,</td></tr>
<tr><th id="3226">3226</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::report" title='xfrm_mgr::report' data-ref="xfrm_mgr::report" data-ref-filename="xfrm_mgr..report">report</a>		= <a class="tu ref fn" href="#xfrm_send_report" title='xfrm_send_report' data-ref="xfrm_send_report" data-ref-filename="xfrm_send_report">xfrm_send_report</a>,</td></tr>
<tr><th id="3227">3227</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::migrate" title='xfrm_mgr::migrate' data-ref="xfrm_mgr::migrate" data-ref-filename="xfrm_mgr..migrate">migrate</a>	= <a class="tu ref fn" href="#xfrm_send_migrate" title='xfrm_send_migrate' data-ref="xfrm_send_migrate" data-ref-filename="xfrm_send_migrate">xfrm_send_migrate</a>,</td></tr>
<tr><th id="3228">3228</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::new_mapping" title='xfrm_mgr::new_mapping' data-ref="xfrm_mgr::new_mapping" data-ref-filename="xfrm_mgr..new_mapping">new_mapping</a>	= <a class="tu ref fn" href="#xfrm_send_mapping" title='xfrm_send_mapping' data-ref="xfrm_send_mapping" data-ref-filename="xfrm_send_mapping">xfrm_send_mapping</a>,</td></tr>
<tr><th id="3229">3229</th><td>	.<a class="ref field" href="../../include/net/xfrm.h.html#xfrm_mgr::is_alive" title='xfrm_mgr::is_alive' data-ref="xfrm_mgr::is_alive" data-ref-filename="xfrm_mgr..is_alive">is_alive</a>	= <a class="tu ref fn" href="#xfrm_is_alive" title='xfrm_is_alive' data-ref="xfrm_is_alive" data-ref-filename="xfrm_is_alive">xfrm_is_alive</a>,</td></tr>
<tr><th id="3230">3230</th><td>};</td></tr>
<tr><th id="3231">3231</th><td></td></tr>
<tr><th id="3232">3232</th><td><em>static</em> <em>int</em> <a class="macro" href="../../include/net/net_namespace.h.html#293" title="" data-ref="_M/__net_init">__net_init</a> <dfn class="tu decl def fn" id="xfrm_user_net_init" title='xfrm_user_net_init' data-type='int xfrm_user_net_init(struct net * net)' data-ref="xfrm_user_net_init" data-ref-filename="xfrm_user_net_init">xfrm_user_net_init</dfn>(<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col0 decl" id="590net" title='net' data-type='struct net *' data-ref="590net" data-ref-filename="590net">net</dfn>)</td></tr>
<tr><th id="3233">3233</th><td>{</td></tr>
<tr><th id="3234">3234</th><td>	<b>struct</b> <a class="type" href="../../include/net/sock.h.html#sock" title='sock' data-ref="sock" data-ref-filename="sock">sock</a> *<dfn class="local col1 decl" id="591nlsk" title='nlsk' data-type='struct sock *' data-ref="591nlsk" data-ref-filename="591nlsk">nlsk</dfn>;</td></tr>
<tr><th id="3235">3235</th><td>	<b>struct</b> <a class="type" href="../../include/linux/netlink.h.html#netlink_kernel_cfg" title='netlink_kernel_cfg' data-ref="netlink_kernel_cfg" data-ref-filename="netlink_kernel_cfg">netlink_kernel_cfg</a> <dfn class="local col2 decl" id="592cfg" title='cfg' data-type='struct netlink_kernel_cfg' data-ref="592cfg" data-ref-filename="592cfg">cfg</dfn> = {</td></tr>
<tr><th id="3236">3236</th><td>		.<a class="ref field" href="../../include/linux/netlink.h.html#netlink_kernel_cfg::groups" title='netlink_kernel_cfg::groups' data-ref="netlink_kernel_cfg::groups" data-ref-filename="netlink_kernel_cfg..groups">groups</a>	= <a class="macro" href="../../include/uapi/linux/xfrm.h.html#537" title="(__XFRMNLGRP_MAX - 1)" data-ref="_M/XFRMNLGRP_MAX">XFRMNLGRP_MAX</a>,</td></tr>
<tr><th id="3237">3237</th><td>		.<a class="ref field" href="../../include/linux/netlink.h.html#netlink_kernel_cfg::input" title='netlink_kernel_cfg::input' data-ref="netlink_kernel_cfg::input" data-ref-filename="netlink_kernel_cfg..input">input</a>	= <a class="tu ref fn" href="#xfrm_netlink_rcv" title='xfrm_netlink_rcv' data-use='r' data-ref="xfrm_netlink_rcv" data-ref-filename="xfrm_netlink_rcv">xfrm_netlink_rcv</a>,</td></tr>
<tr><th id="3238">3238</th><td>	};</td></tr>
<tr><th id="3239">3239</th><td></td></tr>
<tr><th id="3240">3240</th><td>	<a class="local col1 ref" href="#591nlsk" title='nlsk' data-ref="591nlsk" data-ref-filename="591nlsk">nlsk</a> = <a class="ref fn" href="../../include/linux/netlink.h.html#netlink_kernel_create" title='netlink_kernel_create' data-ref="netlink_kernel_create" data-ref-filename="netlink_kernel_create">netlink_kernel_create</a>(<a class="local col0 ref" href="#590net" title='net' data-ref="590net" data-ref-filename="590net">net</a>, <a class="macro" href="../../include/uapi/linux/netlink.h.html#15" title="6" data-ref="_M/NETLINK_XFRM">NETLINK_XFRM</a>, &amp;<a class="local col2 ref" href="#592cfg" title='cfg' data-ref="592cfg" data-ref-filename="592cfg">cfg</a>);</td></tr>
<tr><th id="3241">3241</th><td>	<b>if</b> (<a class="local col1 ref" href="#591nlsk" title='nlsk' data-ref="591nlsk" data-ref-filename="591nlsk">nlsk</a> == <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>)</td></tr>
<tr><th id="3242">3242</th><td>		<b>return</b> -<a class="macro" href="../../include/uapi/asm-generic/errno-base.h.html#16" title="12" data-ref="_M/ENOMEM">ENOMEM</a>;</td></tr>
<tr><th id="3243">3243</th><td>	<a class="local col0 ref" href="#590net" title='net' data-ref="590net" data-ref-filename="590net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk_stash" title='netns_xfrm::nlsk_stash' data-ref="netns_xfrm::nlsk_stash" data-ref-filename="netns_xfrm..nlsk_stash">nlsk_stash</a> = <a class="local col1 ref" href="#591nlsk" title='nlsk' data-ref="591nlsk" data-ref-filename="591nlsk">nlsk</a>; <i>/* Don't set to NULL */</i></td></tr>
<tr><th id="3244">3244</th><td>	<a class="macro" href="../../include/linux/rcupdate.h.html#404" title="({ uintptr_t _r_a_p__v = (uintptr_t)(nlsk); if (__builtin_constant_p(nlsk) &amp;&amp; (_r_a_p__v) == (uintptr_t)((void *)0)) ({ union { typeof((net-&gt;xfrm.nlsk)) __val; char __c[1]; } __u = { .__val = ( typeof((net-&gt;xfrm.nlsk))) ((typeof(net-&gt;xfrm.nlsk))(_r_a_p__v)) }; __write_once_size(&amp;((net-&gt;xfrm.nlsk)), __u.__c, sizeof((net-&gt;xfrm.nlsk))); __u.__val; }); else do { do { bool __cond = !((sizeof(*&amp;net-&gt;xfrm.nlsk) == sizeof(char) || sizeof(*&amp;net-&gt;xfrm.nlsk) == sizeof(short) || sizeof(*&amp;net-&gt;xfrm.nlsk) == sizeof(int) || sizeof(*&amp;net-&gt;xfrm.nlsk) == sizeof(long))); extern void __compiletime_assert_3244(void) ; if (__cond) __compiletime_assert_3244(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); __asm__ __volatile__(&quot;&quot;: : :&quot;memory&quot;); ({ union { typeof(*&amp;net-&gt;xfrm.nlsk) __val; char __c[1]; } __u = { .__val = ( typeof(*&amp;net-&gt;xfrm.nlsk)) ((typeof(*((typeof(net-&gt;xfrm.nlsk))_r_a_p__v)) *)((typeof(net-&gt;xfrm.nlsk))_r_a_p__v)) }; __write_once_size(&amp;(*&amp;net-&gt;xfrm.nlsk), __u.__c, sizeof(*&amp;net-&gt;xfrm.nlsk)); __u.__val; }); } while (0); _r_a_p__v; })" data-ref="_M/rcu_assign_pointer">rcu_assign_pointer</a>(<a class="local col0 ref" href="#590net" title='net' data-ref="590net" data-ref-filename="590net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="local col1 ref" href="#591nlsk" title='nlsk' data-ref="591nlsk" data-ref-filename="591nlsk">nlsk</a>);</td></tr>
<tr><th id="3245">3245</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="3246">3246</th><td>}</td></tr>
<tr><th id="3247">3247</th><td></td></tr>
<tr><th id="3248">3248</th><td><em>static</em> <em>void</em> <a class="macro" href="../../include/net/net_namespace.h.html#294" title="" data-ref="_M/__net_exit">__net_exit</a> <dfn class="tu decl def fn" id="xfrm_user_net_exit" title='xfrm_user_net_exit' data-type='void xfrm_user_net_exit(struct list_head * net_exit_list)' data-ref="xfrm_user_net_exit" data-ref-filename="xfrm_user_net_exit">xfrm_user_net_exit</dfn>(<b>struct</b> <a class="type" href="../../include/linux/types.h.html#list_head" title='list_head' data-ref="list_head" data-ref-filename="list_head">list_head</a> *<dfn class="local col3 decl" id="593net_exit_list" title='net_exit_list' data-type='struct list_head *' data-ref="593net_exit_list" data-ref-filename="593net_exit_list">net_exit_list</dfn>)</td></tr>
<tr><th id="3249">3249</th><td>{</td></tr>
<tr><th id="3250">3250</th><td>	<b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#net" title='net' data-ref="net" data-ref-filename="net">net</a> *<dfn class="local col4 decl" id="594net" title='net' data-type='struct net *' data-ref="594net" data-ref-filename="594net">net</dfn>;</td></tr>
<tr><th id="3251">3251</th><td>	<a class="macro" href="../../include/linux/list.h.html#463" title="for (net = ({ void *__mptr = (void *)((net_exit_list)-&gt;next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((net_exit_list)-&gt;next)), typeof(((typeof(*net) *)0)-&gt;exit_list)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((net_exit_list)-&gt;next)), typeof(void)))); extern void __compiletime_assert_3251(void) ; if (__cond) __compiletime_assert_3251(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((typeof(*net) *)(__mptr - __builtin_offsetof(typeof(*net), exit_list))); }); &amp;net-&gt;exit_list != (net_exit_list); net = ({ void *__mptr = (void *)((net)-&gt;exit_list.next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((net)-&gt;exit_list.next)), typeof(((typeof(*(net)) *)0)-&gt;exit_list)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((net)-&gt;exit_list.next)), typeof(void)))); extern void __compiletime_assert_3251(void) ; if (__cond) __compiletime_assert_3251(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((typeof(*(net)) *)(__mptr - __builtin_offsetof(typeof(*(net)), exit_list))); }))" data-ref="_M/list_for_each_entry">list_for_each_entry</a>(<a class="local col4 ref" href="#594net" title='net' data-ref="594net" data-ref-filename="594net">net</a>, <a class="local col3 ref" href="#593net_exit_list" title='net_exit_list' data-ref="593net_exit_list" data-ref-filename="593net_exit_list">net_exit_list</a>, <a class="ref field" href="../../include/net/net_namespace.h.html#net::exit_list" title='net::exit_list' data-ref="net::exit_list" data-ref-filename="net..exit_list">exit_list</a>)</td></tr>
<tr><th id="3252">3252</th><td>		<a class="macro" href="../../include/linux/rcupdate.h.html#818" title="do { ; ({ union { typeof(net-&gt;xfrm.nlsk) __val; char __c[1]; } __u = { .__val = ( typeof(net-&gt;xfrm.nlsk)) ((typeof(*(((void *)0))) *)(((void *)0))) }; __write_once_size(&amp;(net-&gt;xfrm.nlsk), __u.__c, sizeof(net-&gt;xfrm.nlsk)); __u.__val; }); } while (0)" data-ref="_M/RCU_INIT_POINTER">RCU_INIT_POINTER</a>(<a class="local col4 ref" href="#594net" title='net' data-ref="594net" data-ref-filename="594net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk" title='netns_xfrm::nlsk' data-ref="netns_xfrm::nlsk" data-ref-filename="netns_xfrm..nlsk">nlsk</a>, <a class="macro" href="../../include/linux/stddef.h.html#8" title="((void *)0)" data-ref="_M/NULL">NULL</a>);</td></tr>
<tr><th id="3253">3253</th><td>	<a class="ref fn" href="../../include/linux/netdevice.h.html#synchronize_net" title='synchronize_net' data-ref="synchronize_net" data-ref-filename="synchronize_net">synchronize_net</a>();</td></tr>
<tr><th id="3254">3254</th><td>	<a class="macro" href="../../include/linux/list.h.html#463" title="for (net = ({ void *__mptr = (void *)((net_exit_list)-&gt;next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((net_exit_list)-&gt;next)), typeof(((typeof(*net) *)0)-&gt;exit_list)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((net_exit_list)-&gt;next)), typeof(void)))); extern void __compiletime_assert_3254(void) ; if (__cond) __compiletime_assert_3254(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((typeof(*net) *)(__mptr - __builtin_offsetof(typeof(*net), exit_list))); }); &amp;net-&gt;exit_list != (net_exit_list); net = ({ void *__mptr = (void *)((net)-&gt;exit_list.next); do { bool __cond = !(!(!__builtin_types_compatible_p(typeof(*((net)-&gt;exit_list.next)), typeof(((typeof(*(net)) *)0)-&gt;exit_list)) &amp;&amp; !__builtin_types_compatible_p(typeof(*((net)-&gt;exit_list.next)), typeof(void)))); extern void __compiletime_assert_3254(void) ; if (__cond) __compiletime_assert_3254(); do { ((void)sizeof(char[1 - 2 * __cond])); } while (0); } while (0); ((typeof(*(net)) *)(__mptr - __builtin_offsetof(typeof(*(net)), exit_list))); }))" data-ref="_M/list_for_each_entry">list_for_each_entry</a>(<a class="local col4 ref" href="#594net" title='net' data-ref="594net" data-ref-filename="594net">net</a>, <a class="local col3 ref" href="#593net_exit_list" title='net_exit_list' data-ref="593net_exit_list" data-ref-filename="593net_exit_list">net_exit_list</a>, <a class="ref field" href="../../include/net/net_namespace.h.html#net::exit_list" title='net::exit_list' data-ref="net::exit_list" data-ref-filename="net..exit_list">exit_list</a>)</td></tr>
<tr><th id="3255">3255</th><td>		<a class="ref fn" href="../../include/linux/netlink.h.html#netlink_kernel_release" title='netlink_kernel_release' data-ref="netlink_kernel_release" data-ref-filename="netlink_kernel_release">netlink_kernel_release</a>(<a class="local col4 ref" href="#594net" title='net' data-ref="594net" data-ref-filename="594net">net</a>-&gt;<a class="ref field" href="../../include/net/net_namespace.h.html#net::xfrm" title='net::xfrm' data-ref="net::xfrm" data-ref-filename="net..xfrm">xfrm</a>.<a class="ref field" href="../../include/net/netns/xfrm.h.html#netns_xfrm::nlsk_stash" title='netns_xfrm::nlsk_stash' data-ref="netns_xfrm::nlsk_stash" data-ref-filename="netns_xfrm..nlsk_stash">nlsk_stash</a>);</td></tr>
<tr><th id="3256">3256</th><td>}</td></tr>
<tr><th id="3257">3257</th><td></td></tr>
<tr><th id="3258">3258</th><td><em>static</em> <b>struct</b> <a class="type" href="../../include/net/net_namespace.h.html#pernet_operations" title='pernet_operations' data-ref="pernet_operations" data-ref-filename="pernet_operations">pernet_operations</a> <dfn class="tu decl def" id="xfrm_user_net_ops" title='xfrm_user_net_ops' data-type='struct pernet_operations' data-ref="xfrm_user_net_ops" data-ref-filename="xfrm_user_net_ops">xfrm_user_net_ops</dfn> = {</td></tr>
<tr><th id="3259">3259</th><td>	.<a class="ref field" href="../../include/net/net_namespace.h.html#pernet_operations::init" title='pernet_operations::init' data-ref="pernet_operations::init" data-ref-filename="pernet_operations..init">init</a>	    = <a class="tu ref fn" href="#xfrm_user_net_init" title='xfrm_user_net_init' data-ref="xfrm_user_net_init" data-ref-filename="xfrm_user_net_init">xfrm_user_net_init</a>,</td></tr>
<tr><th id="3260">3260</th><td>	.<a class="ref field" href="../../include/net/net_namespace.h.html#pernet_operations::exit_batch" title='pernet_operations::exit_batch' data-ref="pernet_operations::exit_batch" data-ref-filename="pernet_operations..exit_batch">exit_batch</a> = <a class="tu ref fn" href="#xfrm_user_net_exit" title='xfrm_user_net_exit' data-ref="xfrm_user_net_exit" data-ref-filename="xfrm_user_net_exit">xfrm_user_net_exit</a>,</td></tr>
<tr><th id="3261">3261</th><td>};</td></tr>
<tr><th id="3262">3262</th><td></td></tr>
<tr><th id="3263">3263</th><td><em>static</em> <em>int</em> <a class="macro" href="../../include/linux/init.h.html#50" title="__attribute__ ((__section__(&quot;.init.text&quot;)))" data-ref="_M/__init">__init</a> <dfn class="tu decl def fn" id="xfrm_user_init" title='xfrm_user_init' data-type='int xfrm_user_init()' data-ref="xfrm_user_init" data-ref-filename="xfrm_user_init">xfrm_user_init</dfn>(<em>void</em>)</td></tr>
<tr><th id="3264">3264</th><td>{</td></tr>
<tr><th id="3265">3265</th><td>	<em>int</em> <dfn class="local col5 decl" id="595rv" title='rv' data-type='int' data-ref="595rv" data-ref-filename="595rv">rv</dfn>;</td></tr>
<tr><th id="3266">3266</th><td></td></tr>
<tr><th id="3267">3267</th><td>	<a class="ref fn" href="../../include/linux/printk.h.html#printk" title='printk' data-ref="printk" data-ref-filename="printk">printk</a>(<a class="macro" href="../../include/linux/kern_levels.h.html#14" title="&quot;\001&quot; &quot;6&quot;" data-ref="_M/KERN_INFO">KERN_INFO</a> <q>"Initializing XFRM netlink socket\n"</q>);</td></tr>
<tr><th id="3268">3268</th><td></td></tr>
<tr><th id="3269">3269</th><td>	<a class="local col5 ref" href="#595rv" title='rv' data-ref="595rv" data-ref-filename="595rv">rv</a> = <a class="ref fn" href="../../include/net/net_namespace.h.html#register_pernet_subsys" title='register_pernet_subsys' data-ref="register_pernet_subsys" data-ref-filename="register_pernet_subsys">register_pernet_subsys</a>(&amp;<a class="tu ref" href="#xfrm_user_net_ops" title='xfrm_user_net_ops' data-use='a' data-ref="xfrm_user_net_ops" data-ref-filename="xfrm_user_net_ops">xfrm_user_net_ops</a>);</td></tr>
<tr><th id="3270">3270</th><td>	<b>if</b> (<a class="local col5 ref" href="#595rv" title='rv' data-ref="595rv" data-ref-filename="595rv">rv</a> &lt; <var>0</var>)</td></tr>
<tr><th id="3271">3271</th><td>		<b>return</b> <a class="local col5 ref" href="#595rv" title='rv' data-ref="595rv" data-ref-filename="595rv">rv</a>;</td></tr>
<tr><th id="3272">3272</th><td>	<a class="local col5 ref" href="#595rv" title='rv' data-ref="595rv" data-ref-filename="595rv">rv</a> = <a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_register_km" title='xfrm_register_km' data-ref="xfrm_register_km" data-ref-filename="xfrm_register_km">xfrm_register_km</a>(&amp;<a class="tu ref" href="#netlink_mgr" title='netlink_mgr' data-use='a' data-ref="netlink_mgr" data-ref-filename="netlink_mgr">netlink_mgr</a>);</td></tr>
<tr><th id="3273">3273</th><td>	<b>if</b> (<a class="local col5 ref" href="#595rv" title='rv' data-ref="595rv" data-ref-filename="595rv">rv</a> &lt; <var>0</var>)</td></tr>
<tr><th id="3274">3274</th><td>		<a class="ref fn" href="../../include/net/net_namespace.h.html#unregister_pernet_subsys" title='unregister_pernet_subsys' data-ref="unregister_pernet_subsys" data-ref-filename="unregister_pernet_subsys">unregister_pernet_subsys</a>(&amp;<a class="tu ref" href="#xfrm_user_net_ops" title='xfrm_user_net_ops' data-use='a' data-ref="xfrm_user_net_ops" data-ref-filename="xfrm_user_net_ops">xfrm_user_net_ops</a>);</td></tr>
<tr><th id="3275">3275</th><td>	<b>return</b> <a class="local col5 ref" href="#595rv" title='rv' data-ref="595rv" data-ref-filename="595rv">rv</a>;</td></tr>
<tr><th id="3276">3276</th><td>}</td></tr>
<tr><th id="3277">3277</th><td></td></tr>
<tr><th id="3278">3278</th><td><em>static</em> <em>void</em> <a class="macro" href="../../include/linux/init.h.html#83" title="__attribute__ ((__section__(&quot;.exit.text&quot;))) __attribute__((__used__)) __attribute__((no_instrument_function))" data-ref="_M/__exit">__exit</a> <dfn class="tu decl def fn" id="xfrm_user_exit" title='xfrm_user_exit' data-type='void xfrm_user_exit()' data-ref="xfrm_user_exit" data-ref-filename="xfrm_user_exit">xfrm_user_exit</dfn>(<em>void</em>)</td></tr>
<tr><th id="3279">3279</th><td>{</td></tr>
<tr><th id="3280">3280</th><td>	<a class="ref fn" href="../../include/net/xfrm.h.html#xfrm_unregister_km" title='xfrm_unregister_km' data-ref="xfrm_unregister_km" data-ref-filename="xfrm_unregister_km">xfrm_unregister_km</a>(&amp;<a class="tu ref" href="#netlink_mgr" title='netlink_mgr' data-use='a' data-ref="netlink_mgr" data-ref-filename="netlink_mgr">netlink_mgr</a>);</td></tr>
<tr><th id="3281">3281</th><td>	<a class="ref fn" href="../../include/net/net_namespace.h.html#unregister_pernet_subsys" title='unregister_pernet_subsys' data-ref="unregister_pernet_subsys" data-ref-filename="unregister_pernet_subsys">unregister_pernet_subsys</a>(&amp;<a class="tu ref" href="#xfrm_user_net_ops" title='xfrm_user_net_ops' data-use='a' data-ref="xfrm_user_net_ops" data-ref-filename="xfrm_user_net_ops">xfrm_user_net_ops</a>);</td></tr>
<tr><th id="3282">3282</th><td>}</td></tr>
<tr><th id="3283">3283</th><td></td></tr>
<tr><th id="3284">3284</th><td><a class="macro" href="../../include/linux/module.h.html#85" title="static initcall_t __initcall_xfrm_user_init6 __attribute__((__used__)) __attribute__((__section__(&quot;.initcall&quot; &quot;6&quot; &quot;.init&quot;))) = xfrm_user_init;;" data-ref="_M/module_init">module_init</a>(<a class="tu ref fn" href="#xfrm_user_init" title='xfrm_user_init' data-ref="xfrm_user_init" data-ref-filename="xfrm_user_init">xfrm_user_init</a>);</td></tr>
<tr><th id="3285">3285</th><td><a class="macro" href="../../include/linux/module.h.html#97" title="static exitcall_t __exitcall_xfrm_user_exit __attribute__((__used__)) __attribute__ ((__section__(&quot;.exitcall.exit&quot;))) = xfrm_user_exit;" data-ref="_M/module_exit">module_exit</a>(<a class="tu ref fn" href="#xfrm_user_exit" title='xfrm_user_exit' data-ref="xfrm_user_exit" data-ref-filename="xfrm_user_exit">xfrm_user_exit</a>);</td></tr>
<tr><th id="3286">3286</th><td><a class="macro" href="../../include/linux/module.h.html#198" title="struct __UNIQUE_ID_license150 {}" data-ref="_M/MODULE_LICENSE">MODULE_LICENSE</a>(<q>"GPL"</q>);</td></tr>
<tr><th id="3287">3287</th><td><a class="macro" href="../../include/linux/net.h.html#318" title="struct __UNIQUE_ID_alias152 {}" data-ref="_M/MODULE_ALIAS_NET_PF_PROTO">MODULE_ALIAS_NET_PF_PROTO</a>(<a class="macro" href="../../include/linux/socket.h.html#231" title="16" data-ref="_M/PF_NETLINK">PF_NETLINK</a>, <a class="macro" href="../../include/uapi/linux/netlink.h.html#15" title="6" data-ref="_M/NETLINK_XFRM">NETLINK_XFRM</a>);</td></tr>
<tr><th id="3288">3288</th><td></td></tr>
<tr><th id="3289">3289</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2019-Oct-10</em> from project linux revision <em>4.15.10</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
