<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>intel_guc_ads.c source code [linux-5.3.1/drivers/gpu/drm/i915/intel_guc_ads.c] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="__guc_ads_blob "/>
<link rel="stylesheet" href="../../../../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'linux-5.3.1/drivers/gpu/drm/i915/intel_guc_ads.c'; var root_path = '../../../../..'; var data_path = '../../../../../../data'; var ecma_script_api_version = 2;</script>
<script src='../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>linux-5.3.1</a>/<a href='../../..'>drivers</a>/<a href='../..'>gpu</a>/<a href='..'>drm</a>/<a href='./'>i915</a>/<a href='intel_guc_ads.c.html'>intel_guc_ads.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * Copyright Â© 2014-2017 Intel Corporation</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Permission is hereby granted, free of charge, to any person obtaining a</i></td></tr>
<tr><th id="5">5</th><td><i> * copy of this software and associated documentation files (the "Software"),</i></td></tr>
<tr><th id="6">6</th><td><i> * to deal in the Software without restriction, including without limitation</i></td></tr>
<tr><th id="7">7</th><td><i> * the rights to use, copy, modify, merge, publish, distribute, sublicense,</i></td></tr>
<tr><th id="8">8</th><td><i> * and/or sell copies of the Software, and to permit persons to whom the</i></td></tr>
<tr><th id="9">9</th><td><i> * Software is furnished to do so, subject to the following conditions:</i></td></tr>
<tr><th id="10">10</th><td><i> *</i></td></tr>
<tr><th id="11">11</th><td><i> * The above copyright notice and this permission notice (including the next</i></td></tr>
<tr><th id="12">12</th><td><i> * paragraph) shall be included in all copies or substantial portions of the</i></td></tr>
<tr><th id="13">13</th><td><i> * Software.</i></td></tr>
<tr><th id="14">14</th><td><i> *</i></td></tr>
<tr><th id="15">15</th><td><i> * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</i></td></tr>
<tr><th id="16">16</th><td><i> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</i></td></tr>
<tr><th id="17">17</th><td><i> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL</i></td></tr>
<tr><th id="18">18</th><td><i> * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</i></td></tr>
<tr><th id="19">19</th><td><i> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</i></td></tr>
<tr><th id="20">20</th><td><i> * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</i></td></tr>
<tr><th id="21">21</th><td><i> * IN THE SOFTWARE.</i></td></tr>
<tr><th id="22">22</th><td><i> *</i></td></tr>
<tr><th id="23">23</th><td><i> */</i></td></tr>
<tr><th id="24">24</th><td></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="intel_guc_ads.h.html">"intel_guc_ads.h"</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="intel_uc.h.html">"intel_uc.h"</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="i915_drv.h.html">"i915_drv.h"</a></u></td></tr>
<tr><th id="28">28</th><td></td></tr>
<tr><th id="29">29</th><td><i  data-doc="guc_policy_init">/*</i></td></tr>
<tr><th id="30">30</th><td><i  data-doc="guc_policy_init"> * The Additional Data Struct (ADS) has pointers for different buffers used by</i></td></tr>
<tr><th id="31">31</th><td><i  data-doc="guc_policy_init"> * the GuC. One single gem object contains the ADS struct itself (guc_ads), the</i></td></tr>
<tr><th id="32">32</th><td><i  data-doc="guc_policy_init"> * scheduling policies (guc_policies), a structure describing a collection of</i></td></tr>
<tr><th id="33">33</th><td><i  data-doc="guc_policy_init"> * register sets (guc_mmio_reg_state) and some extra pages for the GuC to save</i></td></tr>
<tr><th id="34">34</th><td><i  data-doc="guc_policy_init"> * its internal state for sleep.</i></td></tr>
<tr><th id="35">35</th><td><i  data-doc="guc_policy_init"> */</i></td></tr>
<tr><th id="36">36</th><td></td></tr>
<tr><th id="37">37</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="guc_policy_init" title='guc_policy_init' data-type='void guc_policy_init(struct guc_policy * policy)' data-ref="guc_policy_init" data-ref-filename="guc_policy_init">guc_policy_init</dfn>(<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_policy" title='guc_policy' data-ref="guc_policy" data-ref-filename="guc_policy">guc_policy</a> *<dfn class="local col1 decl" id="1policy" title='policy' data-type='struct guc_policy *' data-ref="1policy" data-ref-filename="1policy">policy</dfn>)</td></tr>
<tr><th id="38">38</th><td>{</td></tr>
<tr><th id="39">39</th><td>	<a class="local col1 ref" href="#1policy" title='policy' data-ref="1policy" data-ref-filename="1policy">policy</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policy::execution_quantum" title='guc_policy::execution_quantum' data-ref="guc_policy::execution_quantum" data-ref-filename="guc_policy..execution_quantum">execution_quantum</a> = <a class="macro" href="intel_guc_fwif.h.html#392" title="1000000" data-ref="_M/POLICY_DEFAULT_EXECUTION_QUANTUM_US">POLICY_DEFAULT_EXECUTION_QUANTUM_US</a>;</td></tr>
<tr><th id="40">40</th><td>	<a class="local col1 ref" href="#1policy" title='policy' data-ref="1policy" data-ref-filename="1policy">policy</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policy::preemption_time" title='guc_policy::preemption_time' data-ref="guc_policy::preemption_time" data-ref-filename="guc_policy..preemption_time">preemption_time</a> = <a class="macro" href="intel_guc_fwif.h.html#393" title="500000" data-ref="_M/POLICY_DEFAULT_PREEMPTION_TIME_US">POLICY_DEFAULT_PREEMPTION_TIME_US</a>;</td></tr>
<tr><th id="41">41</th><td>	<a class="local col1 ref" href="#1policy" title='policy' data-ref="1policy" data-ref-filename="1policy">policy</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policy::fault_time" title='guc_policy::fault_time' data-ref="guc_policy::fault_time" data-ref-filename="guc_policy..fault_time">fault_time</a> = <a class="macro" href="intel_guc_fwif.h.html#394" title="250000" data-ref="_M/POLICY_DEFAULT_FAULT_TIME_US">POLICY_DEFAULT_FAULT_TIME_US</a>;</td></tr>
<tr><th id="42">42</th><td>	<a class="local col1 ref" href="#1policy" title='policy' data-ref="1policy" data-ref-filename="1policy">policy</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policy::policy_flags" title='guc_policy::policy_flags' data-ref="guc_policy::policy_flags" data-ref-filename="guc_policy..policy_flags">policy_flags</a> = <var>0</var>;</td></tr>
<tr><th id="43">43</th><td>}</td></tr>
<tr><th id="44">44</th><td></td></tr>
<tr><th id="45">45</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="guc_policies_init" title='guc_policies_init' data-type='void guc_policies_init(struct guc_policies * policies)' data-ref="guc_policies_init" data-ref-filename="guc_policies_init">guc_policies_init</dfn>(<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_policies" title='guc_policies' data-ref="guc_policies" data-ref-filename="guc_policies">guc_policies</a> *<dfn class="local col2 decl" id="2policies" title='policies' data-type='struct guc_policies *' data-ref="2policies" data-ref-filename="2policies">policies</dfn>)</td></tr>
<tr><th id="46">46</th><td>{</td></tr>
<tr><th id="47">47</th><td>	<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_policy" title='guc_policy' data-ref="guc_policy" data-ref-filename="guc_policy">guc_policy</a> *<dfn class="local col3 decl" id="3policy" title='policy' data-type='struct guc_policy *' data-ref="3policy" data-ref-filename="3policy">policy</dfn>;</td></tr>
<tr><th id="48">48</th><td>	<a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col4 decl" id="4p" title='p' data-type='u32' data-ref="4p" data-ref-filename="4p">p</dfn>, <dfn class="local col5 decl" id="5i" title='i' data-type='u32' data-ref="5i" data-ref-filename="5i">i</dfn>;</td></tr>
<tr><th id="49">49</th><td></td></tr>
<tr><th id="50">50</th><td>	<a class="local col2 ref" href="#2policies" title='policies' data-ref="2policies" data-ref-filename="2policies">policies</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policies::dpc_promote_time" title='guc_policies::dpc_promote_time' data-ref="guc_policies::dpc_promote_time" data-ref-filename="guc_policies..dpc_promote_time">dpc_promote_time</a> = <a class="macro" href="intel_guc_fwif.h.html#391" title="500000" data-ref="_M/POLICY_DEFAULT_DPC_PROMOTE_TIME_US">POLICY_DEFAULT_DPC_PROMOTE_TIME_US</a>;</td></tr>
<tr><th id="51">51</th><td>	<a class="local col2 ref" href="#2policies" title='policies' data-ref="2policies" data-ref-filename="2policies">policies</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policies::max_num_work_items" title='guc_policies::max_num_work_items' data-ref="guc_policies::max_num_work_items" data-ref-filename="guc_policies..max_num_work_items">max_num_work_items</a> = <a class="macro" href="intel_guc_fwif.h.html#390" title="15" data-ref="_M/POLICY_MAX_NUM_WI">POLICY_MAX_NUM_WI</a>;</td></tr>
<tr><th id="52">52</th><td></td></tr>
<tr><th id="53">53</th><td>	<b>for</b> (<a class="local col4 ref" href="#4p" title='p' data-ref="4p" data-ref-filename="4p">p</a> = <var>0</var>; <a class="local col4 ref" href="#4p" title='p' data-ref="4p" data-ref-filename="4p">p</a> &lt; <a class="macro" href="intel_guc_fwif.h.html#30" title="4" data-ref="_M/GUC_CLIENT_PRIORITY_NUM">GUC_CLIENT_PRIORITY_NUM</a>; <a class="local col4 ref" href="#4p" title='p' data-ref="4p" data-ref-filename="4p">p</a>++) {</td></tr>
<tr><th id="54">54</th><td>		<b>for</b> (<a class="local col5 ref" href="#5i" title='i' data-ref="5i" data-ref-filename="5i">i</a> = <var>0</var>; <a class="local col5 ref" href="#5i" title='i' data-ref="5i" data-ref-filename="5i">i</a> &lt; <a class="macro" href="intel_guc_fwif.h.html#47" title="5" data-ref="_M/GUC_MAX_ENGINE_CLASSES">GUC_MAX_ENGINE_CLASSES</a>; <a class="local col5 ref" href="#5i" title='i' data-ref="5i" data-ref-filename="5i">i</a>++) {</td></tr>
<tr><th id="55">55</th><td>			<a class="local col3 ref" href="#3policy" title='policy' data-ref="3policy" data-ref-filename="3policy">policy</a> = &amp;<a class="local col2 ref" href="#2policies" title='policies' data-ref="2policies" data-ref-filename="2policies">policies</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policies::policy" title='guc_policies::policy' data-ref="guc_policies::policy" data-ref-filename="guc_policies..policy">policy</a>[<a class="local col4 ref" href="#4p" title='p' data-ref="4p" data-ref-filename="4p">p</a>][<a class="local col5 ref" href="#5i" title='i' data-ref="5i" data-ref-filename="5i">i</a>];</td></tr>
<tr><th id="56">56</th><td></td></tr>
<tr><th id="57">57</th><td>			<a class="tu ref fn" href="#guc_policy_init" title='guc_policy_init' data-use='c' data-ref="guc_policy_init" data-ref-filename="guc_policy_init">guc_policy_init</a>(<a class="local col3 ref" href="#3policy" title='policy' data-ref="3policy" data-ref-filename="3policy">policy</a>);</td></tr>
<tr><th id="58">58</th><td>		}</td></tr>
<tr><th id="59">59</th><td>	}</td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td>	<a class="local col2 ref" href="#2policies" title='policies' data-ref="2policies" data-ref-filename="2policies">policies</a>-&gt;<a class="ref field" href="intel_guc_fwif.h.html#guc_policies::is_valid" title='guc_policies::is_valid' data-ref="guc_policies::is_valid" data-ref-filename="guc_policies..is_valid">is_valid</a> = <var>1</var>;</td></tr>
<tr><th id="62">62</th><td>}</td></tr>
<tr><th id="63">63</th><td></td></tr>
<tr><th id="64">64</th><td><em>static</em> <em>void</em> <dfn class="tu decl def fn" id="guc_ct_pool_entries_init" title='guc_ct_pool_entries_init' data-type='void guc_ct_pool_entries_init(struct guc_ct_pool_entry * pool, u32 num)' data-ref="guc_ct_pool_entries_init" data-ref-filename="guc_ct_pool_entries_init">guc_ct_pool_entries_init</dfn>(<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_ct_pool_entry" title='guc_ct_pool_entry' data-ref="guc_ct_pool_entry" data-ref-filename="guc_ct_pool_entry">guc_ct_pool_entry</a> *<dfn class="local col6 decl" id="6pool" title='pool' data-type='struct guc_ct_pool_entry *' data-ref="6pool" data-ref-filename="6pool">pool</dfn>, <a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col7 decl" id="7num" title='num' data-type='u32' data-ref="7num" data-ref-filename="7num">num</dfn>)</td></tr>
<tr><th id="65">65</th><td>{</td></tr>
<tr><th id="66">66</th><td>	<a class="ref fn" href="../../../../arch/x86/include/asm/string_64.h.html#memset" title='memset' data-ref="memset" data-ref-filename="memset">memset</a>(<a class="local col6 ref" href="#6pool" title='pool' data-ref="6pool" data-ref-filename="6pool">pool</a>, <var>0</var>, <a class="local col7 ref" href="#7num" title='num' data-ref="7num" data-ref-filename="7num">num</a> * <b>sizeof</b>(*<a class="local col6 ref" href="#6pool" title='pool' data-ref="6pool" data-ref-filename="6pool">pool</a>));</td></tr>
<tr><th id="67">67</th><td>}</td></tr>
<tr><th id="68">68</th><td></td></tr>
<tr><th id="69">69</th><td><i>/*</i></td></tr>
<tr><th id="70">70</th><td><i> * The first 80 dwords of the register state context, containing the</i></td></tr>
<tr><th id="71">71</th><td><i> * execlists and ppgtt registers.</i></td></tr>
<tr><th id="72">72</th><td><i> */</i></td></tr>
<tr><th id="73">73</th><td><u>#define <dfn class="macro" id="_M/LR_HW_CONTEXT_SIZE" data-ref="_M/LR_HW_CONTEXT_SIZE">LR_HW_CONTEXT_SIZE</dfn>	(80 * sizeof(<a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32" data-ref-filename="u32">u32</a>))</u></td></tr>
<tr><th id="74">74</th><td></td></tr>
<tr><th id="75">75</th><td><i>/* The ads obj includes the struct itself and buffers passed to GuC */</i></td></tr>
<tr><th id="76">76</th><td><b>struct</b> <dfn class="type def" id="__guc_ads_blob" title='__guc_ads_blob' data-ref="__guc_ads_blob" data-ref-filename="__guc_ads_blob">__guc_ads_blob</dfn> {</td></tr>
<tr><th id="77">77</th><td>	<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_ads" title='guc_ads' data-ref="guc_ads" data-ref-filename="guc_ads">guc_ads</a> <dfn class="tu decl field" id="__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-type='struct guc_ads' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</dfn>;</td></tr>
<tr><th id="78">78</th><td>	<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_policies" title='guc_policies' data-ref="guc_policies" data-ref-filename="guc_policies">guc_policies</a> <dfn class="tu decl field" id="__guc_ads_blob::policies" title='__guc_ads_blob::policies' data-type='struct guc_policies' data-ref="__guc_ads_blob::policies" data-ref-filename="__guc_ads_blob..policies">policies</dfn>;</td></tr>
<tr><th id="79">79</th><td>	<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_mmio_reg_state" title='guc_mmio_reg_state' data-ref="guc_mmio_reg_state" data-ref-filename="guc_mmio_reg_state">guc_mmio_reg_state</a> <dfn class="tu decl field" id="__guc_ads_blob::reg_state" title='__guc_ads_blob::reg_state' data-type='struct guc_mmio_reg_state' data-ref="__guc_ads_blob::reg_state" data-ref-filename="__guc_ads_blob..reg_state">reg_state</dfn>;</td></tr>
<tr><th id="80">80</th><td>	<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_gt_system_info" title='guc_gt_system_info' data-ref="guc_gt_system_info" data-ref-filename="guc_gt_system_info">guc_gt_system_info</a> <dfn class="tu decl field" id="__guc_ads_blob::system_info" title='__guc_ads_blob::system_info' data-type='struct guc_gt_system_info' data-ref="__guc_ads_blob::system_info" data-ref-filename="__guc_ads_blob..system_info">system_info</dfn>;</td></tr>
<tr><th id="81">81</th><td>	<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_clients_info" title='guc_clients_info' data-ref="guc_clients_info" data-ref-filename="guc_clients_info">guc_clients_info</a> <dfn class="tu decl field" id="__guc_ads_blob::clients_info" title='__guc_ads_blob::clients_info' data-type='struct guc_clients_info' data-ref="__guc_ads_blob::clients_info" data-ref-filename="__guc_ads_blob..clients_info">clients_info</dfn>;</td></tr>
<tr><th id="82">82</th><td>	<b>struct</b> <a class="type" href="intel_guc_fwif.h.html#guc_ct_pool_entry" title='guc_ct_pool_entry' data-ref="guc_ct_pool_entry" data-ref-filename="guc_ct_pool_entry">guc_ct_pool_entry</a> <dfn class="tu decl field" id="__guc_ads_blob::ct_pool" title='__guc_ads_blob::ct_pool' data-type='struct guc_ct_pool_entry [2]' data-ref="__guc_ads_blob::ct_pool" data-ref-filename="__guc_ads_blob..ct_pool">ct_pool</dfn>[<a class="macro" href="intel_guc_fwif.h.html#470" title="2" data-ref="_M/GUC_CT_POOL_SIZE">GUC_CT_POOL_SIZE</a>];</td></tr>
<tr><th id="83">83</th><td>	<a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='__u8' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="tu decl field" id="__guc_ads_blob::reg_state_buffer" title='__guc_ads_blob::reg_state_buffer' data-type='u8 [40960]' data-ref="__guc_ads_blob::reg_state_buffer" data-ref-filename="__guc_ads_blob..reg_state_buffer">reg_state_buffer</dfn>[<a class="macro" href="intel_guc_fwif.h.html#431" title="10" data-ref="_M/GUC_S3_SAVE_SPACE_PAGES">GUC_S3_SAVE_SPACE_PAGES</a> * <a class="macro" href="../../../../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a>];</td></tr>
<tr><th id="84">84</th><td>} <a class="macro" href="../../../../include/linux/compiler_attributes.h.html#220" title="__attribute__((__packed__))" data-ref="_M/__packed">__packed</a>;</td></tr>
<tr><th id="85">85</th><td></td></tr>
<tr><th id="86">86</th><td><em>static</em> <em>int</em> <dfn class="tu decl def fn" id="__guc_ads_init" title='__guc_ads_init' data-type='int __guc_ads_init(struct intel_guc * guc)' data-ref="__guc_ads_init" data-ref-filename="__guc_ads_init">__guc_ads_init</dfn>(<b>struct</b> <a class="type" href="intel_guc.h.html#intel_guc" title='intel_guc' data-ref="intel_guc" data-ref-filename="intel_guc">intel_guc</a> *<dfn class="local col8 decl" id="8guc" title='guc' data-type='struct intel_guc *' data-ref="8guc" data-ref-filename="8guc">guc</dfn>)</td></tr>
<tr><th id="87">87</th><td>{</td></tr>
<tr><th id="88">88</th><td>	<b>struct</b> <a class="type" href="i915_drv.h.html#drm_i915_private" title='drm_i915_private' data-ref="drm_i915_private" data-ref-filename="drm_i915_private">drm_i915_private</a> *<dfn class="local col9 decl" id="9dev_priv" title='dev_priv' data-type='struct drm_i915_private *' data-ref="9dev_priv" data-ref-filename="9dev_priv">dev_priv</dfn> = <a class="ref fn" href="i915_drv.h.html#guc_to_i915" title='guc_to_i915' data-ref="guc_to_i915" data-ref-filename="guc_to_i915">guc_to_i915</a>(<a class="local col8 ref" href="#8guc" title='guc' data-ref="8guc" data-ref-filename="8guc">guc</a>);</td></tr>
<tr><th id="89">89</th><td>	<b>struct</b> <a class="type" href="#__guc_ads_blob" title='__guc_ads_blob' data-ref="__guc_ads_blob" data-ref-filename="__guc_ads_blob">__guc_ads_blob</a> *<dfn class="local col0 decl" id="10blob" title='blob' data-type='struct __guc_ads_blob *' data-ref="10blob" data-ref-filename="10blob">blob</dfn>;</td></tr>
<tr><th id="90">90</th><td>	<em>const</em> <a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col1 decl" id="11skipped_size" title='skipped_size' data-type='const u32' data-ref="11skipped_size" data-ref-filename="11skipped_size">skipped_size</dfn> = <a class="macro" href="gt/intel_lrc.h.html#97" title="(1)" data-ref="_M/LRC_PPHWSP_SZ">LRC_PPHWSP_SZ</a> * <a class="macro" href="../../../../arch/x86/include/asm/page_types.h.html#11" title="((1UL) &lt;&lt; 12)" data-ref="_M/PAGE_SIZE">PAGE_SIZE</a> + <a class="macro" href="#73" title="(80 * sizeof(u32))" data-ref="_M/LR_HW_CONTEXT_SIZE">LR_HW_CONTEXT_SIZE</a>;</td></tr>
<tr><th id="91">91</th><td>	<a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col2 decl" id="12base" title='base' data-type='u32' data-ref="12base" data-ref-filename="12base">base</dfn>;</td></tr>
<tr><th id="92">92</th><td>	<a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u8" title='u8' data-type='__u8' data-ref="u8" data-ref-filename="u8">u8</a> <dfn class="local col3 decl" id="13engine_class" title='engine_class' data-type='u8' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</dfn>;</td></tr>
<tr><th id="93">93</th><td></td></tr>
<tr><th id="94">94</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a> = <a class="ref fn" href="gem/i915_gem_object.h.html#i915_gem_object_pin_map" title='i915_gem_object_pin_map' data-ref="i915_gem_object_pin_map" data-ref-filename="i915_gem_object_pin_map">i915_gem_object_pin_map</a>(<a class="local col8 ref" href="#8guc" title='guc' data-ref="8guc" data-ref-filename="8guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a>-&gt;<a class="ref field" href="i915_vma.h.html#i915_vma::obj" title='i915_vma::obj' data-ref="i915_vma::obj" data-ref-filename="i915_vma..obj">obj</a>, <a class="enum" href="gem/i915_gem_object.h.html#I915_MAP_WB" title='I915_MAP_WB' data-ref="I915_MAP_WB" data-ref-filename="I915_MAP_WB">I915_MAP_WB</a>);</td></tr>
<tr><th id="95">95</th><td>	<b>if</b> (<a class="ref fn" href="../../../../include/linux/err.h.html#IS_ERR" title='IS_ERR' data-ref="IS_ERR" data-ref-filename="IS_ERR">IS_ERR</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>))</td></tr>
<tr><th id="96">96</th><td>		<b>return</b> <a class="ref fn" href="../../../../include/linux/err.h.html#PTR_ERR" title='PTR_ERR' data-ref="PTR_ERR" data-ref-filename="PTR_ERR">PTR_ERR</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>);</td></tr>
<tr><th id="97">97</th><td></td></tr>
<tr><th id="98">98</th><td>	<i>/* GuC scheduling policies */</i></td></tr>
<tr><th id="99">99</th><td>	<a class="tu ref fn" href="#guc_policies_init" title='guc_policies_init' data-use='c' data-ref="guc_policies_init" data-ref-filename="guc_policies_init">guc_policies_init</a>(&amp;<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::policies" title='__guc_ads_blob::policies' data-use='a' data-ref="__guc_ads_blob::policies" data-ref-filename="__guc_ads_blob..policies">policies</a>);</td></tr>
<tr><th id="100">100</th><td></td></tr>
<tr><th id="101">101</th><td>	<i>/*</i></td></tr>
<tr><th id="102">102</th><td><i>	 * GuC expects a per-engine-class context image and size</i></td></tr>
<tr><th id="103">103</th><td><i>	 * (minus hwsp and ring context). The context image will be</i></td></tr>
<tr><th id="104">104</th><td><i>	 * used to reinitialize engines after a reset. It must exist</i></td></tr>
<tr><th id="105">105</th><td><i>	 * and be pinned in the GGTT, so that the address won't change after</i></td></tr>
<tr><th id="106">106</th><td><i>	 * we have told GuC where to find it. The context size will be used</i></td></tr>
<tr><th id="107">107</th><td><i>	 * to validate that the LRC base + size fall within allowed GGTT.</i></td></tr>
<tr><th id="108">108</th><td><i>	 */</i></td></tr>
<tr><th id="109">109</th><td>	<b>for</b> (<a class="local col3 ref" href="#13engine_class" title='engine_class' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</a> = <var>0</var>; <a class="local col3 ref" href="#13engine_class" title='engine_class' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</a> &lt;= <a class="macro" href="i915_reg.h.html#291" title="4" data-ref="_M/MAX_ENGINE_CLASS">MAX_ENGINE_CLASS</a>; ++<a class="local col3 ref" href="#13engine_class" title='engine_class' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</a>) {</td></tr>
<tr><th id="110">110</th><td>		<b>if</b> (<a class="local col3 ref" href="#13engine_class" title='engine_class' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</a> == <a class="macro" href="i915_reg.h.html#290" title="4" data-ref="_M/OTHER_CLASS">OTHER_CLASS</a>)</td></tr>
<tr><th id="111">111</th><td>			<b>continue</b>;</td></tr>
<tr><th id="112">112</th><td>		<i>/*</i></td></tr>
<tr><th id="113">113</th><td><i>		 * TODO: Set context pointer to default state to allow</i></td></tr>
<tr><th id="114">114</th><td><i>		 * GuC to re-init guilty contexts after internal reset.</i></td></tr>
<tr><th id="115">115</th><td><i>		 */</i></td></tr>
<tr><th id="116">116</th><td>		<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-use='m' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_ads::golden_context_lrca" title='guc_ads::golden_context_lrca' data-ref="guc_ads::golden_context_lrca" data-ref-filename="guc_ads..golden_context_lrca">golden_context_lrca</a>[<a class="local col3 ref" href="#13engine_class" title='engine_class' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</a>] = <var>0</var>;</td></tr>
<tr><th id="117">117</th><td>		<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-use='m' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_ads::eng_state_size" title='guc_ads::eng_state_size' data-ref="guc_ads::eng_state_size" data-ref-filename="guc_ads..eng_state_size">eng_state_size</a>[<a class="local col3 ref" href="#13engine_class" title='engine_class' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</a>] =</td></tr>
<tr><th id="118">118</th><td>			<a class="ref fn" href="gt/intel_engine.h.html#intel_engine_context_size" title='intel_engine_context_size' data-ref="intel_engine_context_size" data-ref-filename="intel_engine_context_size">intel_engine_context_size</a>(<a class="local col9 ref" href="#9dev_priv" title='dev_priv' data-ref="9dev_priv" data-ref-filename="9dev_priv">dev_priv</a>, <a class="local col3 ref" href="#13engine_class" title='engine_class' data-ref="13engine_class" data-ref-filename="13engine_class">engine_class</a>) -</td></tr>
<tr><th id="119">119</th><td>			<a class="local col1 ref" href="#11skipped_size" title='skipped_size' data-ref="11skipped_size" data-ref-filename="11skipped_size">skipped_size</a>;</td></tr>
<tr><th id="120">120</th><td>	}</td></tr>
<tr><th id="121">121</th><td></td></tr>
<tr><th id="122">122</th><td>	<i>/* System info */</i></td></tr>
<tr><th id="123">123</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::system_info" title='__guc_ads_blob::system_info' data-use='m' data-ref="__guc_ads_blob::system_info" data-ref-filename="__guc_ads_blob..system_info">system_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_gt_system_info::slice_enabled" title='guc_gt_system_info::slice_enabled' data-ref="guc_gt_system_info::slice_enabled" data-ref-filename="guc_gt_system_info..slice_enabled">slice_enabled</a> = <a class="macro" href="../../../../include/asm-generic/bitops/const_hweight.h.html#26" title="(__builtin_constant_p((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) ? ((unsigned int) ((!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 0))) + (!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 1))) + (!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 2))) + (!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 3))) + (!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 4))) + (!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 5))) + (!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 6))) + (!!(((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask) &amp; (1ULL &lt;&lt; 7))))) : __arch_hweight8((&amp;(dev_priv)-&gt;__runtime)-&gt;sseu.slice_mask))" data-ref="_M/hweight8">hweight8</a>(<a class="macro" href="i915_drv.h.html#2003" title="(&amp;(dev_priv)-&gt;__runtime)" data-ref="_M/RUNTIME_INFO">RUNTIME_INFO</a>(<a class="local col9 ref" href="#9dev_priv" title='dev_priv' data-ref="9dev_priv" data-ref-filename="9dev_priv">dev_priv</a>)-&gt;<a class="ref field" href="intel_device_info.h.html#intel_runtime_info::sseu" title='intel_runtime_info::sseu' data-ref="intel_runtime_info::sseu" data-ref-filename="intel_runtime_info..sseu">sseu</a>.<a class="ref field" href="gt/intel_sseu.h.html#sseu_dev_info::slice_mask" title='sseu_dev_info::slice_mask' data-ref="sseu_dev_info::slice_mask" data-ref-filename="sseu_dev_info..slice_mask">slice_mask</a>);</td></tr>
<tr><th id="124">124</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::system_info" title='__guc_ads_blob::system_info' data-use='m' data-ref="__guc_ads_blob::system_info" data-ref-filename="__guc_ads_blob..system_info">system_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_gt_system_info::rcs_enabled" title='guc_gt_system_info::rcs_enabled' data-ref="guc_gt_system_info::rcs_enabled" data-ref-filename="guc_gt_system_info..rcs_enabled">rcs_enabled</a> = <var>1</var>;</td></tr>
<tr><th id="125">125</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::system_info" title='__guc_ads_blob::system_info' data-use='m' data-ref="__guc_ads_blob::system_info" data-ref-filename="__guc_ads_blob..system_info">system_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_gt_system_info::bcs_enabled" title='guc_gt_system_info::bcs_enabled' data-ref="guc_gt_system_info::bcs_enabled" data-ref-filename="guc_gt_system_info..bcs_enabled">bcs_enabled</a> = <var>1</var>;</td></tr>
<tr><th id="126">126</th><td></td></tr>
<tr><th id="127">127</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::system_info" title='__guc_ads_blob::system_info' data-use='m' data-ref="__guc_ads_blob::system_info" data-ref-filename="__guc_ads_blob..system_info">system_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_gt_system_info::vdbox_enable_mask" title='guc_gt_system_info::vdbox_enable_mask' data-ref="guc_gt_system_info::vdbox_enable_mask" data-ref-filename="guc_gt_system_info..vdbox_enable_mask">vdbox_enable_mask</a> = <a class="macro" href="i915_drv.h.html#2241" title="({ unsigned int first__ = (VCS0); unsigned int count__ = (4); ((&amp;(dev_priv)-&gt;__info)-&gt;engine_mask &amp; (((~(((0UL)))) - ((((1UL))) &lt;&lt; (first__)) + 1) &amp; (~(((0UL))) &gt;&gt; (64 - 1 - (first__ + count__ - 1))))) &gt;&gt; first__; })" data-ref="_M/VDBOX_MASK">VDBOX_MASK</a>(<a class="local col9 ref" href="#9dev_priv" title='dev_priv' data-ref="9dev_priv" data-ref-filename="9dev_priv">dev_priv</a>);</td></tr>
<tr><th id="128">128</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::system_info" title='__guc_ads_blob::system_info' data-use='m' data-ref="__guc_ads_blob::system_info" data-ref-filename="__guc_ads_blob..system_info">system_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_gt_system_info::vebox_enable_mask" title='guc_gt_system_info::vebox_enable_mask' data-ref="guc_gt_system_info::vebox_enable_mask" data-ref-filename="guc_gt_system_info..vebox_enable_mask">vebox_enable_mask</a> = <a class="macro" href="i915_drv.h.html#2243" title="({ unsigned int first__ = (VECS0); unsigned int count__ = (2); ((&amp;(dev_priv)-&gt;__info)-&gt;engine_mask &amp; (((~(((0UL)))) - ((((1UL))) &lt;&lt; (first__)) + 1) &amp; (~(((0UL))) &gt;&gt; (64 - 1 - (first__ + count__ - 1))))) &gt;&gt; first__; })" data-ref="_M/VEBOX_MASK">VEBOX_MASK</a>(<a class="local col9 ref" href="#9dev_priv" title='dev_priv' data-ref="9dev_priv" data-ref-filename="9dev_priv">dev_priv</a>);</td></tr>
<tr><th id="129">129</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::system_info" title='__guc_ads_blob::system_info' data-use='m' data-ref="__guc_ads_blob::system_info" data-ref-filename="__guc_ads_blob..system_info">system_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_gt_system_info::vdbox_sfc_support_mask" title='guc_gt_system_info::vdbox_sfc_support_mask' data-ref="guc_gt_system_info::vdbox_sfc_support_mask" data-ref-filename="guc_gt_system_info..vdbox_sfc_support_mask">vdbox_sfc_support_mask</a> = <a class="macro" href="i915_drv.h.html#2003" title="(&amp;(dev_priv)-&gt;__runtime)" data-ref="_M/RUNTIME_INFO">RUNTIME_INFO</a>(<a class="local col9 ref" href="#9dev_priv" title='dev_priv' data-ref="9dev_priv" data-ref-filename="9dev_priv">dev_priv</a>)-&gt;<a class="ref field" href="intel_device_info.h.html#intel_runtime_info::vdbox_sfc_access" title='intel_runtime_info::vdbox_sfc_access' data-ref="intel_runtime_info::vdbox_sfc_access" data-ref-filename="intel_runtime_info..vdbox_sfc_access">vdbox_sfc_access</a>;</td></tr>
<tr><th id="130">130</th><td></td></tr>
<tr><th id="131">131</th><td>	<a class="local col2 ref" href="#12base" title='base' data-ref="12base" data-ref-filename="12base">base</a> = <a class="ref fn" href="intel_guc.h.html#intel_guc_ggtt_offset" title='intel_guc_ggtt_offset' data-ref="intel_guc_ggtt_offset" data-ref-filename="intel_guc_ggtt_offset">intel_guc_ggtt_offset</a>(<a class="local col8 ref" href="#8guc" title='guc' data-ref="8guc" data-ref-filename="8guc">guc</a>, <a class="local col8 ref" href="#8guc" title='guc' data-ref="8guc" data-ref-filename="8guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a>);</td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td>	<i>/* Clients info  */</i></td></tr>
<tr><th id="134">134</th><td>	<a class="tu ref fn" href="#guc_ct_pool_entries_init" title='guc_ct_pool_entries_init' data-use='c' data-ref="guc_ct_pool_entries_init" data-ref-filename="guc_ct_pool_entries_init">guc_ct_pool_entries_init</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ct_pool" title='__guc_ads_blob::ct_pool' data-use='r' data-ref="__guc_ads_blob::ct_pool" data-ref-filename="__guc_ads_blob..ct_pool">ct_pool</a>, <a class="macro" href="../../../../include/linux/kernel.h.html#47" title="(sizeof(blob-&gt;ct_pool) / sizeof((blob-&gt;ct_pool)[0]) + (sizeof(struct { int:(-!!(__builtin_types_compatible_p(typeof((blob-&gt;ct_pool)), typeof(&amp;(blob-&gt;ct_pool)[0])))); })))" data-ref="_M/ARRAY_SIZE">ARRAY_SIZE</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ct_pool" title='__guc_ads_blob::ct_pool' data-use='r' data-ref="__guc_ads_blob::ct_pool" data-ref-filename="__guc_ads_blob..ct_pool">ct_pool</a>));</td></tr>
<tr><th id="135">135</th><td></td></tr>
<tr><th id="136">136</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::clients_info" title='__guc_ads_blob::clients_info' data-use='m' data-ref="__guc_ads_blob::clients_info" data-ref-filename="__guc_ads_blob..clients_info">clients_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_clients_info::clients_num" title='guc_clients_info::clients_num' data-ref="guc_clients_info::clients_num" data-ref-filename="guc_clients_info..clients_num">clients_num</a> = <var>1</var>;</td></tr>
<tr><th id="137">137</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::clients_info" title='__guc_ads_blob::clients_info' data-use='m' data-ref="__guc_ads_blob::clients_info" data-ref-filename="__guc_ads_blob..clients_info">clients_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_clients_info::ct_pool_addr" title='guc_clients_info::ct_pool_addr' data-ref="guc_clients_info::ct_pool_addr" data-ref-filename="guc_clients_info..ct_pool_addr">ct_pool_addr</a> = <a class="local col2 ref" href="#12base" title='base' data-ref="12base" data-ref-filename="12base">base</a> + <a class="macro" href="i915_utils.h.html#141" title="__builtin_offsetof(typeof(*(blob)), ct_pool)" data-ref="_M/ptr_offset">ptr_offset</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>, ct_pool);</td></tr>
<tr><th id="138">138</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::clients_info" title='__guc_ads_blob::clients_info' data-use='m' data-ref="__guc_ads_blob::clients_info" data-ref-filename="__guc_ads_blob..clients_info">clients_info</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_clients_info::ct_pool_count" title='guc_clients_info::ct_pool_count' data-ref="guc_clients_info::ct_pool_count" data-ref-filename="guc_clients_info..ct_pool_count">ct_pool_count</a> = <a class="macro" href="../../../../include/linux/kernel.h.html#47" title="(sizeof(blob-&gt;ct_pool) / sizeof((blob-&gt;ct_pool)[0]) + (sizeof(struct { int:(-!!(__builtin_types_compatible_p(typeof((blob-&gt;ct_pool)), typeof(&amp;(blob-&gt;ct_pool)[0])))); })))" data-ref="_M/ARRAY_SIZE">ARRAY_SIZE</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ct_pool" title='__guc_ads_blob::ct_pool' data-use='r' data-ref="__guc_ads_blob::ct_pool" data-ref-filename="__guc_ads_blob..ct_pool">ct_pool</a>);</td></tr>
<tr><th id="139">139</th><td></td></tr>
<tr><th id="140">140</th><td>	<i>/* ADS */</i></td></tr>
<tr><th id="141">141</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-use='m' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_ads::scheduler_policies" title='guc_ads::scheduler_policies' data-ref="guc_ads::scheduler_policies" data-ref-filename="guc_ads..scheduler_policies">scheduler_policies</a> = <a class="local col2 ref" href="#12base" title='base' data-ref="12base" data-ref-filename="12base">base</a> + <a class="macro" href="i915_utils.h.html#141" title="__builtin_offsetof(typeof(*(blob)), policies)" data-ref="_M/ptr_offset">ptr_offset</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>, policies);</td></tr>
<tr><th id="142">142</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-use='m' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_ads::reg_state_buffer" title='guc_ads::reg_state_buffer' data-ref="guc_ads::reg_state_buffer" data-ref-filename="guc_ads..reg_state_buffer">reg_state_buffer</a> = <a class="local col2 ref" href="#12base" title='base' data-ref="12base" data-ref-filename="12base">base</a> + <a class="macro" href="i915_utils.h.html#141" title="__builtin_offsetof(typeof(*(blob)), reg_state_buffer)" data-ref="_M/ptr_offset">ptr_offset</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>, reg_state_buffer);</td></tr>
<tr><th id="143">143</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-use='m' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_ads::reg_state_addr" title='guc_ads::reg_state_addr' data-ref="guc_ads::reg_state_addr" data-ref-filename="guc_ads..reg_state_addr">reg_state_addr</a> = <a class="local col2 ref" href="#12base" title='base' data-ref="12base" data-ref-filename="12base">base</a> + <a class="macro" href="i915_utils.h.html#141" title="__builtin_offsetof(typeof(*(blob)), reg_state)" data-ref="_M/ptr_offset">ptr_offset</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>, reg_state);</td></tr>
<tr><th id="144">144</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-use='m' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_ads::gt_system_info" title='guc_ads::gt_system_info' data-ref="guc_ads::gt_system_info" data-ref-filename="guc_ads..gt_system_info">gt_system_info</a> = <a class="local col2 ref" href="#12base" title='base' data-ref="12base" data-ref-filename="12base">base</a> + <a class="macro" href="i915_utils.h.html#141" title="__builtin_offsetof(typeof(*(blob)), system_info)" data-ref="_M/ptr_offset">ptr_offset</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>, system_info);</td></tr>
<tr><th id="145">145</th><td>	<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>-&gt;<a class="tu ref field" href="#__guc_ads_blob::ads" title='__guc_ads_blob::ads' data-use='m' data-ref="__guc_ads_blob::ads" data-ref-filename="__guc_ads_blob..ads">ads</a>.<a class="ref field" href="intel_guc_fwif.h.html#guc_ads::clients_info" title='guc_ads::clients_info' data-ref="guc_ads::clients_info" data-ref-filename="guc_ads..clients_info">clients_info</a> = <a class="local col2 ref" href="#12base" title='base' data-ref="12base" data-ref-filename="12base">base</a> + <a class="macro" href="i915_utils.h.html#141" title="__builtin_offsetof(typeof(*(blob)), clients_info)" data-ref="_M/ptr_offset">ptr_offset</a>(<a class="local col0 ref" href="#10blob" title='blob' data-ref="10blob" data-ref-filename="10blob">blob</a>, clients_info);</td></tr>
<tr><th id="146">146</th><td></td></tr>
<tr><th id="147">147</th><td>	<a class="ref fn" href="gem/i915_gem_object.h.html#i915_gem_object_unpin_map" title='i915_gem_object_unpin_map' data-ref="i915_gem_object_unpin_map" data-ref-filename="i915_gem_object_unpin_map">i915_gem_object_unpin_map</a>(<a class="local col8 ref" href="#8guc" title='guc' data-ref="8guc" data-ref-filename="8guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a>-&gt;<a class="ref field" href="i915_vma.h.html#i915_vma::obj" title='i915_vma::obj' data-ref="i915_vma::obj" data-ref-filename="i915_vma..obj">obj</a>);</td></tr>
<tr><th id="148">148</th><td></td></tr>
<tr><th id="149">149</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="150">150</th><td>}</td></tr>
<tr><th id="151">151</th><td></td></tr>
<tr><th id="152">152</th><td><i class="doc">/**</i></td></tr>
<tr><th id="153">153</th><td><i class="doc"> * intel_guc_ads_create() - allocates and initializes GuC ADS.</i></td></tr>
<tr><th id="154">154</th><td><i class="doc"> *<span class="command"> @guc</span>: intel_guc struct</i></td></tr>
<tr><th id="155">155</th><td><i class="doc"> *</i></td></tr>
<tr><th id="156">156</th><td><i class="doc"> * GuC needs memory block (Additional Data Struct), where it will store</i></td></tr>
<tr><th id="157">157</th><td><i class="doc"> * some data. Allocate and initialize such memory block for GuC use.</i></td></tr>
<tr><th id="158">158</th><td><i class="doc"> */</i></td></tr>
<tr><th id="159">159</th><td><em>int</em> <dfn class="decl def fn" id="intel_guc_ads_create" title='intel_guc_ads_create' data-ref="intel_guc_ads_create" data-ref-filename="intel_guc_ads_create">intel_guc_ads_create</dfn>(<b>struct</b> <a class="type" href="intel_guc.h.html#intel_guc" title='intel_guc' data-ref="intel_guc" data-ref-filename="intel_guc">intel_guc</a> *<dfn class="local col4 decl" id="14guc" title='guc' data-type='struct intel_guc *' data-ref="14guc" data-ref-filename="14guc">guc</dfn>)</td></tr>
<tr><th id="160">160</th><td>{</td></tr>
<tr><th id="161">161</th><td>	<em>const</em> <a class="typedef" href="../../../../include/asm-generic/int-ll64.h.html#u32" title='u32' data-type='__u32' data-ref="u32" data-ref-filename="u32">u32</a> <dfn class="local col5 decl" id="15size" title='size' data-type='const u32' data-ref="15size" data-ref-filename="15size">size</dfn> = <a class="macro" href="../../../../include/linux/mm.h.html#216" title="((((sizeof(struct __guc_ads_blob))) + ((typeof((sizeof(struct __guc_ads_blob))))((((1UL) &lt;&lt; 12))) - 1)) &amp; ~((typeof((sizeof(struct __guc_ads_blob))))((((1UL) &lt;&lt; 12))) - 1))" data-ref="_M/PAGE_ALIGN">PAGE_ALIGN</a>(<b>sizeof</b>(<b>struct</b> <a class="type" href="#__guc_ads_blob" title='__guc_ads_blob' data-ref="__guc_ads_blob" data-ref-filename="__guc_ads_blob">__guc_ads_blob</a>));</td></tr>
<tr><th id="162">162</th><td>	<b>struct</b> <a class="type" href="i915_vma.h.html#i915_vma" title='i915_vma' data-ref="i915_vma" data-ref-filename="i915_vma">i915_vma</a> *<dfn class="local col6 decl" id="16vma" title='vma' data-type='struct i915_vma *' data-ref="16vma" data-ref-filename="16vma">vma</dfn>;</td></tr>
<tr><th id="163">163</th><td>	<em>int</em> <dfn class="local col7 decl" id="17ret" title='ret' data-type='int' data-ref="17ret" data-ref-filename="17ret">ret</dfn>;</td></tr>
<tr><th id="164">164</th><td></td></tr>
<tr><th id="165">165</th><td>	<a class="macro" href="i915_gem.h.html#56" title="((void)(sizeof(( long)(guc-&gt;ads_vma))))" data-ref="_M/GEM_BUG_ON">GEM_BUG_ON</a>(<a class="local col4 ref" href="#14guc" title='guc' data-ref="14guc" data-ref-filename="14guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a>);</td></tr>
<tr><th id="166">166</th><td></td></tr>
<tr><th id="167">167</th><td>	<a class="local col6 ref" href="#16vma" title='vma' data-ref="16vma" data-ref-filename="16vma">vma</a> = <a class="ref fn" href="intel_guc.h.html#intel_guc_allocate_vma" title='intel_guc_allocate_vma' data-ref="intel_guc_allocate_vma" data-ref-filename="intel_guc_allocate_vma">intel_guc_allocate_vma</a>(<a class="local col4 ref" href="#14guc" title='guc' data-ref="14guc" data-ref-filename="14guc">guc</a>, <a class="local col5 ref" href="#15size" title='size' data-ref="15size" data-ref-filename="15size">size</a>);</td></tr>
<tr><th id="168">168</th><td>	<b>if</b> (<a class="ref fn" href="../../../../include/linux/err.h.html#IS_ERR" title='IS_ERR' data-ref="IS_ERR" data-ref-filename="IS_ERR">IS_ERR</a>(<a class="local col6 ref" href="#16vma" title='vma' data-ref="16vma" data-ref-filename="16vma">vma</a>))</td></tr>
<tr><th id="169">169</th><td>		<b>return</b> <a class="ref fn" href="../../../../include/linux/err.h.html#PTR_ERR" title='PTR_ERR' data-ref="PTR_ERR" data-ref-filename="PTR_ERR">PTR_ERR</a>(<a class="local col6 ref" href="#16vma" title='vma' data-ref="16vma" data-ref-filename="16vma">vma</a>);</td></tr>
<tr><th id="170">170</th><td></td></tr>
<tr><th id="171">171</th><td>	<a class="local col4 ref" href="#14guc" title='guc' data-ref="14guc" data-ref-filename="14guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a> = <a class="local col6 ref" href="#16vma" title='vma' data-ref="16vma" data-ref-filename="16vma">vma</a>;</td></tr>
<tr><th id="172">172</th><td></td></tr>
<tr><th id="173">173</th><td>	<a class="local col7 ref" href="#17ret" title='ret' data-ref="17ret" data-ref-filename="17ret">ret</a> = <a class="tu ref fn" href="#__guc_ads_init" title='__guc_ads_init' data-use='c' data-ref="__guc_ads_init" data-ref-filename="__guc_ads_init">__guc_ads_init</a>(<a class="local col4 ref" href="#14guc" title='guc' data-ref="14guc" data-ref-filename="14guc">guc</a>);</td></tr>
<tr><th id="174">174</th><td>	<b>if</b> (<a class="local col7 ref" href="#17ret" title='ret' data-ref="17ret" data-ref-filename="17ret">ret</a>)</td></tr>
<tr><th id="175">175</th><td>		<b>goto</b> <a class="lbl" href="#18err_vma" data-ref="18err_vma" data-ref-filename="18err_vma">err_vma</a>;</td></tr>
<tr><th id="176">176</th><td></td></tr>
<tr><th id="177">177</th><td>	<b>return</b> <var>0</var>;</td></tr>
<tr><th id="178">178</th><td></td></tr>
<tr><th id="179">179</th><td><dfn class="lbl" id="18err_vma" data-ref="18err_vma" data-ref-filename="18err_vma">err_vma</dfn>:</td></tr>
<tr><th id="180">180</th><td>	<a class="ref fn" href="i915_vma.h.html#i915_vma_unpin_and_release" title='i915_vma_unpin_and_release' data-ref="i915_vma_unpin_and_release" data-ref-filename="i915_vma_unpin_and_release">i915_vma_unpin_and_release</a>(&amp;<a class="local col4 ref" href="#14guc" title='guc' data-ref="14guc" data-ref-filename="14guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a>, <var>0</var>);</td></tr>
<tr><th id="181">181</th><td>	<b>return</b> <a class="local col7 ref" href="#17ret" title='ret' data-ref="17ret" data-ref-filename="17ret">ret</a>;</td></tr>
<tr><th id="182">182</th><td>}</td></tr>
<tr><th id="183">183</th><td></td></tr>
<tr><th id="184">184</th><td><em>void</em> <dfn class="decl def fn" id="intel_guc_ads_destroy" title='intel_guc_ads_destroy' data-ref="intel_guc_ads_destroy" data-ref-filename="intel_guc_ads_destroy">intel_guc_ads_destroy</dfn>(<b>struct</b> <a class="type" href="intel_guc.h.html#intel_guc" title='intel_guc' data-ref="intel_guc" data-ref-filename="intel_guc">intel_guc</a> *<dfn class="local col9 decl" id="19guc" title='guc' data-type='struct intel_guc *' data-ref="19guc" data-ref-filename="19guc">guc</dfn>)</td></tr>
<tr><th id="185">185</th><td>{</td></tr>
<tr><th id="186">186</th><td>	<a class="ref fn" href="i915_vma.h.html#i915_vma_unpin_and_release" title='i915_vma_unpin_and_release' data-ref="i915_vma_unpin_and_release" data-ref-filename="i915_vma_unpin_and_release">i915_vma_unpin_and_release</a>(&amp;<a class="local col9 ref" href="#19guc" title='guc' data-ref="19guc" data-ref-filename="19guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a>, <var>0</var>);</td></tr>
<tr><th id="187">187</th><td>}</td></tr>
<tr><th id="188">188</th><td></td></tr>
<tr><th id="189">189</th><td><i class="doc">/**</i></td></tr>
<tr><th id="190">190</th><td><i class="doc"> * intel_guc_ads_reset() - prepares GuC Additional Data Struct for reuse</i></td></tr>
<tr><th id="191">191</th><td><i class="doc"> *<span class="command"> @guc</span>: intel_guc struct</i></td></tr>
<tr><th id="192">192</th><td><i class="doc"> *</i></td></tr>
<tr><th id="193">193</th><td><i class="doc"> * GuC stores some data in ADS, which might be stale after a reset.</i></td></tr>
<tr><th id="194">194</th><td><i class="doc"> * Reinitialize whole ADS in case any part of it was corrupted during</i></td></tr>
<tr><th id="195">195</th><td><i class="doc"> * previous GuC run.</i></td></tr>
<tr><th id="196">196</th><td><i class="doc"> */</i></td></tr>
<tr><th id="197">197</th><td><em>void</em> <dfn class="decl def fn" id="intel_guc_ads_reset" title='intel_guc_ads_reset' data-ref="intel_guc_ads_reset" data-ref-filename="intel_guc_ads_reset">intel_guc_ads_reset</dfn>(<b>struct</b> <a class="type" href="intel_guc.h.html#intel_guc" title='intel_guc' data-ref="intel_guc" data-ref-filename="intel_guc">intel_guc</a> *<dfn class="local col0 decl" id="20guc" title='guc' data-type='struct intel_guc *' data-ref="20guc" data-ref-filename="20guc">guc</dfn>)</td></tr>
<tr><th id="198">198</th><td>{</td></tr>
<tr><th id="199">199</th><td>	<b>if</b> (!<a class="local col0 ref" href="#20guc" title='guc' data-ref="20guc" data-ref-filename="20guc">guc</a>-&gt;<a class="ref field" href="intel_guc.h.html#intel_guc::ads_vma" title='intel_guc::ads_vma' data-ref="intel_guc::ads_vma" data-ref-filename="intel_guc..ads_vma">ads_vma</a>)</td></tr>
<tr><th id="200">200</th><td>		<b>return</b>;</td></tr>
<tr><th id="201">201</th><td>	<a class="tu ref fn" href="#__guc_ads_init" title='__guc_ads_init' data-use='c' data-ref="__guc_ads_init" data-ref-filename="__guc_ads_init">__guc_ads_init</a>(<a class="local col0 ref" href="#20guc" title='guc' data-ref="20guc" data-ref-filename="20guc">guc</a>);</td></tr>
<tr><th id="202">202</th><td>}</td></tr>
<tr><th id="203">203</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2020-Jun-10</em> from project linux-5.3.1 revision <em>5.3.1</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
