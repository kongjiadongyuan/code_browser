<dec f='linux-5.3.1/include/linux/netfilter/x_tables.h' l='427' type='bool xt_percpu_counter_alloc(struct xt_percpu_counter_alloc_state * state, struct xt_counters * counter)'/>
<use f='linux-5.3.1/net/ipv4/netfilter/ip_tables.c' l='527' u='c' c='find_check_entry'/>
<use f='linux-5.3.1/net/ipv6/netfilter/ip6_tables.c' l='546' u='c' c='find_check_entry'/>
<def f='linux-5.3.1/net/netfilter/x_tables.c' l='1833' ll='1854' type='bool xt_percpu_counter_alloc(struct xt_percpu_counter_alloc_state * state, struct xt_counters * counter)'/>
<dec f='linux-5.3.1/net/netfilter/x_tables.c' l='1855' type='bool xt_percpu_counter_alloc(struct xt_percpu_counter_alloc_state * , struct xt_counters * )'/>
<use f='linux-5.3.1/net/netfilter/x_tables.c' l='1855' c='xt_percpu_counter_alloc'/>
<use f='linux-5.3.1/net/netfilter/x_tables.c' l='1855' u='a'/>
<doc f='linux-5.3.1/net/netfilter/x_tables.c' l='1811'>/**
 * xt_percpu_counter_alloc - allocate x_tables rule counter
 *
 * @state: pointer to xt_percpu allocation state
 * @counter: pointer to counter struct inside the ip(6)/arpt_entry struct
 *
 * On SMP, the packet counter [ ip(6)t_entry-&gt;counters.pcnt ] will then
 * contain the address of the real (percpu) counter.
 *
 * Rule evaluation needs to use xt_get_this_cpu_counter() helper
 * to fetch the real percpu counter.
 *
 * To speed up allocation and improve data locality, a 4kb block is
 * allocated.  Freeing any counter may free an entire block, so all
 * counters allocated using the same state must be freed at the same
 * time.
 *
 * xt_percpu_counter_alloc_state contains the base address of the
 * allocated page and the current sub-offset.
 *
 * returns false on error.
 */</doc>
