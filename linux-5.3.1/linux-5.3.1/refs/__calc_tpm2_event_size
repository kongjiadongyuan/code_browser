<def f='linux-5.3.1/include/linux/tpm_eventlog.h' l='158' ll='265' type='int __calc_tpm2_event_size(struct tcg_pcr_event2_head * event, struct tcg_pcr_event * event_header, bool do_mapping)'/>
<use f='linux-5.3.1/drivers/firmware/efi/libstub/tpm.c' l='118' u='c' c='efi_retrieve_tpm2_eventlog'/>
<use f='linux-5.3.1/drivers/firmware/efi/libstub/tpm.c' l='158' u='c' c='efi_retrieve_tpm2_eventlog'/>
<doc f='linux-5.3.1/include/linux/tpm_eventlog.h' l='139'>/**
 * __calc_tpm2_event_size - calculate the size of a TPM2 event log entry
 * @event:        Pointer to the event whose size should be calculated
 * @event_header: Pointer to the initial event containing the digest lengths
 * @do_mapping:   Whether or not the event needs to be mapped
 *
 * The TPM2 event log format can contain multiple digests corresponding to
 * separate PCR banks, and also contains a variable length of the data that
 * was measured. This requires knowledge of how long each digest type is,
 * and this information is contained within the first event in the log.
 *
 * We calculate the length by examining the number of events, and then looking
 * at each event in turn to determine how much space is used for events in
 * total. Once we&apos;ve done this we know the offset of the data length field,
 * and can calculate the total size of the event.
 *
 * Return: size of the event on success, &lt;0 on failure
 */</doc>
<use f='linux-5.3.1/drivers/firmware/efi/tpm.c' l='26' u='c' c='tpm2_calc_event_log_size'/>
