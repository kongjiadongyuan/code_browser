<dec f='linux-5.3.1/security/keys/internal.h' l='139' type='key_ref_t keyring_search_rcu(key_ref_t keyring_ref, struct keyring_search_context * ctx)'/>
<def f='linux-5.3.1/security/keys/keyring.c' l='903' ll='929' type='key_ref_t keyring_search_rcu(key_ref_t keyring_ref, struct keyring_search_context * ctx)'/>
<use f='linux-5.3.1/security/keys/keyring.c' l='968' u='c' c='keyring_search'/>
<doc f='linux-5.3.1/security/keys/keyring.c' l='869'>/**
 * keyring_search_rcu - Search a keyring tree for a matching key under RCU
 * @keyring_ref: A pointer to the keyring with possession indicator.
 * @ctx: The keyring search context.
 *
 * Search the supplied keyring tree for a key that matches the criteria given.
 * The root keyring and any linked keyrings must grant Search permission to the
 * caller to be searchable and keys can only be found if they too grant Search
 * to the caller. The possession flag on the root keyring pointer controls use
 * of the possessor bits in permissions checking of the entire tree.  In
 * addition, the LSM gets to forbid keyring searches and key matches.
 *
 * The search is performed as a breadth-then-depth search up to the prescribed
 * limit (KEYRING_SEARCH_MAX_DEPTH).  The caller must hold the RCU read lock to
 * prevent keyrings from being destroyed or rearranged whilst they are being
 * searched.
 *
 * Keys are matched to the type provided and are then filtered by the match
 * function, which is given the description to use in any way it sees fit.  The
 * match function may use any attributes of a key that it wishes to to
 * determine the match.  Normally the match function from the key type would be
 * used.
 *
 * RCU can be used to prevent the keyring key lists from disappearing without
 * the need to take lots of locks.
 *
 * Returns a pointer to the found key and increments the key usage count if
 * successful; -EAGAIN if no matching keys were found, or if expired or revoked
 * keys were found; -ENOKEY if only negative keys were found; -ENOTDIR if the
 * specified keyring wasn&apos;t a keyring.
 *
 * In the case of a successful return, the possession attribute from
 * @keyring_ref is propagated to the returned key reference.
 */</doc>
<use f='linux-5.3.1/security/keys/process_keys.c' l='208' u='c' c='get_user_session_keyring_rcu'/>
<use f='linux-5.3.1/security/keys/process_keys.c' l='441' u='c' c='search_cred_keyrings_rcu'/>
<use f='linux-5.3.1/security/keys/process_keys.c' l='459' u='c' c='search_cred_keyrings_rcu'/>
<use f='linux-5.3.1/security/keys/process_keys.c' l='480' u='c' c='search_cred_keyrings_rcu'/>
<use f='linux-5.3.1/security/keys/process_keys.c' l='501' u='c' c='search_cred_keyrings_rcu'/>
