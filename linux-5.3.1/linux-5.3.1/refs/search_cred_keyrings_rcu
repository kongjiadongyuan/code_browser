<dec f='linux-5.3.1/security/keys/internal.h' l='142' type='key_ref_t search_cred_keyrings_rcu(struct keyring_search_context * ctx)'/>
<use f='linux-5.3.1/security/keys/proc.c' l='180' u='c' c='proc_keys_show'/>
<def f='linux-5.3.1/security/keys/process_keys.c' l='422' ll='527' type='key_ref_t search_cred_keyrings_rcu(struct keyring_search_context * ctx)'/>
<use f='linux-5.3.1/security/keys/process_keys.c' l='544' u='c' c='search_process_keyrings_rcu'/>
<use f='linux-5.3.1/security/keys/process_keys.c' l='564' u='c' c='search_process_keyrings_rcu'/>
<doc f='linux-5.3.1/security/keys/process_keys.c' l='400'>/*
 * Search the process keyrings attached to the supplied cred for the first
 * matching key under RCU conditions (the caller must be holding the RCU read
 * lock).
 *
 * The search criteria are the type and the match function.  The description is
 * given to the match function as a parameter, but doesn&apos;t otherwise influence
 * the search.  Typically the match function will compare the description
 * parameter to the key&apos;s description.
 *
 * This can only search keyrings that grant Search permission to the supplied
 * credentials.  Keyrings linked to searched keyrings will also be searched if
 * they grant Search permission too.  Keys can only be found if they grant
 * Search permission to the credentials.
 *
 * Returns a pointer to the key with the key usage count incremented if
 * successful, -EAGAIN if we didn&apos;t find any matching key or -ENOKEY if we only
 * matched negative keys.
 *
 * In the case of a successful return, the possession attribute is set on the
 * returned key reference.
 */</doc>
