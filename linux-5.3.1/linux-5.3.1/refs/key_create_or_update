<dec f='linux-5.3.1/include/linux/key.h' l='350' type='key_ref_t key_create_or_update(key_ref_t keyring, const char * type, const char * description, const void * payload, size_t plen, key_perm_t perm, unsigned long flags)'/>
<use f='linux-5.3.1/certs/system_keyring.c' l='161' u='c' c='load_system_certificate_list'/>
<use f='linux-5.3.1/net/wireless/reg.c' l='742' u='c' c='load_keys_from_buffer'/>
<def f='linux-5.3.1/security/keys/key.c' l='808' ll='969' type='key_ref_t key_create_or_update(key_ref_t keyring_ref, const char * type, const char * description, const void * payload, size_t plen, key_perm_t perm, unsigned long flags)'/>
<dec f='linux-5.3.1/security/keys/key.c' l='970' type='key_ref_t key_create_or_update(key_ref_t , const char * , const char * , const void * , size_t , key_perm_t , unsigned long )'/>
<use f='linux-5.3.1/security/keys/key.c' l='970' c='key_create_or_update'/>
<use f='linux-5.3.1/security/keys/key.c' l='970' u='a'/>
<doc f='linux-5.3.1/security/keys/key.c' l='783'>/**
 * key_create_or_update - Update or create and instantiate a key.
 * @keyring_ref: A pointer to the destination keyring with possession flag.
 * @type: The type of key.
 * @description: The searchable description for the key.
 * @payload: The data to use to instantiate or update the key.
 * @plen: The length of @payload.
 * @perm: The permissions mask for a new key.
 * @flags: The quota flags for a new key.
 *
 * Search the destination keyring for a key of the same description and if one
 * is found, update it, otherwise create and instantiate a new one and create a
 * link to it from that keyring.
 *
 * If perm is KEY_PERM_UNDEF then an appropriate key permissions mask will be
 * concocted.
 *
 * Returns a pointer to the new key if successful, -ENODEV if the key type
 * wasn&apos;t available, -ENOTDIR if the keyring wasn&apos;t a keyring, -EACCES if the
 * caller isn&apos;t permitted to modify the keyring or the LSM did not permit
 * creation of the key.
 *
 * On success, the possession flag from the keyring ref will be tacked on to
 * the key ref before it is returned.
 */</doc>
<use f='linux-5.3.1/security/keys/keyctl.c' l='132' u='c' c='__do_sys_add_key'/>
